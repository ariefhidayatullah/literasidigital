/*! jQuery v1.11.0 | (c) 2005, 2014 jQuery Foundation, Inc. | jquery.org/license */
!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("jQuery requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){var c=[],d=c.slice,e=c.concat,f=c.push,g=c.indexOf,h={},i=h.toString,j=h.hasOwnProperty,k="".trim,l={},m="1.11.0",n=function(a,b){return new n.fn.init(a,b)},o=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,p=/^-ms-/,q=/-([\da-z])/gi,r=function(a,b){return b.toUpperCase()};n.fn=n.prototype={jquery:m,constructor:n,selector:"",length:0,toArray:function(){return d.call(this)},get:function(a){return null!=a?0>a?this[a+this.length]:this[a]:d.call(this)},pushStack:function(a){var b=n.merge(this.constructor(),a);return b.prevObject=this,b.context=this.context,b},each:function(a,b){return n.each(this,a,b)},map:function(a){return this.pushStack(n.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(d.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(0>a?b:0);return this.pushStack(c>=0&&b>c?[this[c]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:f,sort:c.sort,splice:c.splice},n.extend=n.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==typeof g||n.isFunction(g)||(g={}),h===i&&(g=this,h--);i>h;h++)if(null!=(e=arguments[h]))for(d in e)a=g[d],c=e[d],g!==c&&(j&&c&&(n.isPlainObject(c)||(b=n.isArray(c)))?(b?(b=!1,f=a&&n.isArray(a)?a:[]):f=a&&n.isPlainObject(a)?a:{},g[d]=n.extend(j,f,c)):void 0!==c&&(g[d]=c));return g},n.extend({expando:"jQuery"+(m+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return"function"===n.type(a)},isArray:Array.isArray||function(a){return"array"===n.type(a)},isWindow:function(a){return null!=a&&a==a.window},isNumeric:function(a){return a-parseFloat(a)>=0},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},isPlainObject:function(a){var b;if(!a||"object"!==n.type(a)||a.nodeType||n.isWindow(a))return!1;try{if(a.constructor&&!j.call(a,"constructor")&&!j.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}if(l.ownLast)for(b in a)return j.call(a,b);for(b in a);return void 0===b||j.call(a,b)},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?h[i.call(a)]||"object":typeof a},globalEval:function(b){b&&n.trim(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(p,"ms-").replace(q,r)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b,c){var d,e=0,f=a.length,g=s(a);if(c){if(g){for(;f>e;e++)if(d=b.apply(a[e],c),d===!1)break}else for(e in a)if(d=b.apply(a[e],c),d===!1)break}else if(g){for(;f>e;e++)if(d=b.call(a[e],e,a[e]),d===!1)break}else for(e in a)if(d=b.call(a[e],e,a[e]),d===!1)break;return a},trim:k&&!k.call("\ufeff\xa0")?function(a){return null==a?"":k.call(a)}:function(a){return null==a?"":(a+"").replace(o,"")},makeArray:function(a,b){var c=b||[];return null!=a&&(s(Object(a))?n.merge(c,"string"==typeof a?[a]:a):f.call(c,a)),c},inArray:function(a,b,c){var d;if(b){if(g)return g.call(b,a,c);for(d=b.length,c=c?0>c?Math.max(0,d+c):c:0;d>c;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,b){var c=+b.length,d=0,e=a.length;while(c>d)a[e++]=b[d++];if(c!==c)while(void 0!==b[d])a[e++]=b[d++];return a.length=e,a},grep:function(a,b,c){for(var d,e=[],f=0,g=a.length,h=!c;g>f;f++)d=!b(a[f],f),d!==h&&e.push(a[f]);return e},map:function(a,b,c){var d,f=0,g=a.length,h=s(a),i=[];if(h)for(;g>f;f++)d=b(a[f],f,c),null!=d&&i.push(d);else for(f in a)d=b(a[f],f,c),null!=d&&i.push(d);return e.apply([],i)},guid:1,proxy:function(a,b){var c,e,f;return"string"==typeof b&&(f=a[b],b=a,a=f),n.isFunction(a)?(c=d.call(arguments,2),e=function(){return a.apply(b||this,c.concat(d.call(arguments)))},e.guid=a.guid=a.guid||n.guid++,e):void 0},now:function(){return+new Date},support:l}),n.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){h["[object "+b+"]"]=b.toLowerCase()});function s(a){var b=a.length,c=n.type(a);return"function"===c||n.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===c||0===b||"number"==typeof b&&b>0&&b-1 in a}var t=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s="sizzle"+-new Date,t=a.document,u=0,v=0,w=eb(),x=eb(),y=eb(),z=function(a,b){return a===b&&(j=!0),0},A="undefined",B=1<<31,C={}.hasOwnProperty,D=[],E=D.pop,F=D.push,G=D.push,H=D.slice,I=D.indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(this[b]===a)return b;return-1},J="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",K="[\\x20\\t\\r\\n\\f]",L="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",M=L.replace("w","w#"),N="\\["+K+"*("+L+")"+K+"*(?:([*^$|!~]?=)"+K+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+M+")|)|)"+K+"*\\]",O=":("+L+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+N.replace(3,8)+")*)|.*)\\)|)",P=new RegExp("^"+K+"+|((?:^|[^\\\\])(?:\\\\.)*)"+K+"+$","g"),Q=new RegExp("^"+K+"*,"+K+"*"),R=new RegExp("^"+K+"*([>+~]|"+K+")"+K+"*"),S=new RegExp("="+K+"*([^\\]'\"]*?)"+K+"*\\]","g"),T=new RegExp(O),U=new RegExp("^"+M+"$"),V={ID:new RegExp("^#("+L+")"),CLASS:new RegExp("^\\.("+L+")"),TAG:new RegExp("^("+L.replace("w","w*")+")"),ATTR:new RegExp("^"+N),PSEUDO:new RegExp("^"+O),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+K+"*(even|odd|(([+-]|)(\\d*)n|)"+K+"*(?:([+-]|)"+K+"*(\\d+)|))"+K+"*\\)|)","i"),bool:new RegExp("^(?:"+J+")$","i"),needsContext:new RegExp("^"+K+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+K+"*((?:-\\d)?\\d*)"+K+"*\\)|)(?=[^-]|$)","i")},W=/^(?:input|select|textarea|button)$/i,X=/^h\d$/i,Y=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,$=/[+~]/,_=/'|\\/g,ab=new RegExp("\\\\([\\da-f]{1,6}"+K+"?|("+K+")|.)","ig"),bb=function(a,b,c){var d="0x"+b-65536;return d!==d||c?b:0>d?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320)};try{G.apply(D=H.call(t.childNodes),t.childNodes),D[t.childNodes.length].nodeType}catch(cb){G={apply:D.length?function(a,b){F.apply(a,H.call(b))}:function(a,b){var c=a.length,d=0;while(a[c++]=b[d++]);a.length=c-1}}}function db(a,b,d,e){var f,g,h,i,j,m,p,q,u,v;if((b?b.ownerDocument||b:t)!==l&&k(b),b=b||l,d=d||[],!a||"string"!=typeof a)return d;if(1!==(i=b.nodeType)&&9!==i)return[];if(n&&!e){if(f=Z.exec(a))if(h=f[1]){if(9===i){if(g=b.getElementById(h),!g||!g.parentNode)return d;if(g.id===h)return d.push(g),d}else if(b.ownerDocument&&(g=b.ownerDocument.getElementById(h))&&r(b,g)&&g.id===h)return d.push(g),d}else{if(f[2])return G.apply(d,b.getElementsByTagName(a)),d;if((h=f[3])&&c.getElementsByClassName&&b.getElementsByClassName)return G.apply(d,b.getElementsByClassName(h)),d}if(c.qsa&&(!o||!o.test(a))){if(q=p=s,u=b,v=9===i&&a,1===i&&"object"!==b.nodeName.toLowerCase()){m=ob(a),(p=b.getAttribute("id"))?q=p.replace(_,"\\$&"):b.setAttribute("id",q),q="[id='"+q+"'] ",j=m.length;while(j--)m[j]=q+pb(m[j]);u=$.test(a)&&mb(b.parentNode)||b,v=m.join(",")}if(v)try{return G.apply(d,u.querySelectorAll(v)),d}catch(w){}finally{p||b.removeAttribute("id")}}}return xb(a.replace(P,"$1"),b,d,e)}function eb(){var a=[];function b(c,e){return a.push(c+" ")>d.cacheLength&&delete b[a.shift()],b[c+" "]=e}return b}function fb(a){return a[s]=!0,a}function gb(a){var b=l.createElement("div");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function hb(a,b){var c=a.split("|"),e=a.length;while(e--)d.attrHandle[c[e]]=b}function ib(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||B)-(~a.sourceIndex||B);if(d)return d;if(c)while(c=c.nextSibling)if(c===b)return-1;return a?1:-1}function jb(a){return function(b){var c=b.nodeName.toLowerCase();return"input"===c&&b.type===a}}function kb(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function lb(a){return fb(function(b){return b=+b,fb(function(c,d){var e,f=a([],c.length,b),g=f.length;while(g--)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function mb(a){return a&&typeof a.getElementsByTagName!==A&&a}c=db.support={},f=db.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return b?"HTML"!==b.nodeName:!1},k=db.setDocument=function(a){var b,e=a?a.ownerDocument||a:t,g=e.defaultView;return e!==l&&9===e.nodeType&&e.documentElement?(l=e,m=e.documentElement,n=!f(e),g&&g!==g.top&&(g.addEventListener?g.addEventListener("unload",function(){k()},!1):g.attachEvent&&g.attachEvent("onunload",function(){k()})),c.attributes=gb(function(a){return a.className="i",!a.getAttribute("className")}),c.getElementsByTagName=gb(function(a){return a.appendChild(e.createComment("")),!a.getElementsByTagName("*").length}),c.getElementsByClassName=Y.test(e.getElementsByClassName)&&gb(function(a){return a.innerHTML="<div class='a'></div><div class='a i'></div>",a.firstChild.className="i",2===a.getElementsByClassName("i").length}),c.getById=gb(function(a){return m.appendChild(a).id=s,!e.getElementsByName||!e.getElementsByName(s).length}),c.getById?(d.find.ID=function(a,b){if(typeof b.getElementById!==A&&n){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},d.filter.ID=function(a){var b=a.replace(ab,bb);return function(a){return a.getAttribute("id")===b}}):(delete d.find.ID,d.filter.ID=function(a){var b=a.replace(ab,bb);return function(a){var c=typeof a.getAttributeNode!==A&&a.getAttributeNode("id");return c&&c.value===b}}),d.find.TAG=c.getElementsByTagName?function(a,b){return typeof b.getElementsByTagName!==A?b.getElementsByTagName(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){while(c=f[e++])1===c.nodeType&&d.push(c);return d}return f},d.find.CLASS=c.getElementsByClassName&&function(a,b){return typeof b.getElementsByClassName!==A&&n?b.getElementsByClassName(a):void 0},p=[],o=[],(c.qsa=Y.test(e.querySelectorAll))&&(gb(function(a){a.innerHTML="<select t=''><option selected=''></option></select>",a.querySelectorAll("[t^='']").length&&o.push("[*^$]="+K+"*(?:''|\"\")"),a.querySelectorAll("[selected]").length||o.push("\\["+K+"*(?:value|"+J+")"),a.querySelectorAll(":checked").length||o.push(":checked")}),gb(function(a){var b=e.createElement("input");b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&o.push("name"+K+"*[*^$|!~]?="),a.querySelectorAll(":enabled").length||o.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),o.push(",.*:")})),(c.matchesSelector=Y.test(q=m.webkitMatchesSelector||m.mozMatchesSelector||m.oMatchesSelector||m.msMatchesSelector))&&gb(function(a){c.disconnectedMatch=q.call(a,"div"),q.call(a,"[s!='']:x"),p.push("!=",O)}),o=o.length&&new RegExp(o.join("|")),p=p.length&&new RegExp(p.join("|")),b=Y.test(m.compareDocumentPosition),r=b||Y.test(m.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)while(b=b.parentNode)if(b===a)return!0;return!1},z=b?function(a,b){if(a===b)return j=!0,0;var d=!a.compareDocumentPosition-!b.compareDocumentPosition;return d?d:(d=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&d||!c.sortDetached&&b.compareDocumentPosition(a)===d?a===e||a.ownerDocument===t&&r(t,a)?-1:b===e||b.ownerDocument===t&&r(t,b)?1:i?I.call(i,a)-I.call(i,b):0:4&d?-1:1)}:function(a,b){if(a===b)return j=!0,0;var c,d=0,f=a.parentNode,g=b.parentNode,h=[a],k=[b];if(!f||!g)return a===e?-1:b===e?1:f?-1:g?1:i?I.call(i,a)-I.call(i,b):0;if(f===g)return ib(a,b);c=a;while(c=c.parentNode)h.unshift(c);c=b;while(c=c.parentNode)k.unshift(c);while(h[d]===k[d])d++;return d?ib(h[d],k[d]):h[d]===t?-1:k[d]===t?1:0},e):l},db.matches=function(a,b){return db(a,null,null,b)},db.matchesSelector=function(a,b){if((a.ownerDocument||a)!==l&&k(a),b=b.replace(S,"='$1']"),!(!c.matchesSelector||!n||p&&p.test(b)||o&&o.test(b)))try{var d=q.call(a,b);if(d||c.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(e){}return db(b,l,null,[a]).length>0},db.contains=function(a,b){return(a.ownerDocument||a)!==l&&k(a),r(a,b)},db.attr=function(a,b){(a.ownerDocument||a)!==l&&k(a);var e=d.attrHandle[b.toLowerCase()],f=e&&C.call(d.attrHandle,b.toLowerCase())?e(a,b,!n):void 0;return void 0!==f?f:c.attributes||!n?a.getAttribute(b):(f=a.getAttributeNode(b))&&f.specified?f.value:null},db.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},db.uniqueSort=function(a){var b,d=[],e=0,f=0;if(j=!c.detectDuplicates,i=!c.sortStable&&a.slice(0),a.sort(z),j){while(b=a[f++])b===a[f]&&(e=d.push(f));while(e--)a.splice(d[e],1)}return i=null,a},e=db.getText=function(a){var b,c="",d=0,f=a.nodeType;if(f){if(1===f||9===f||11===f){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=e(a)}else if(3===f||4===f)return a.nodeValue}else while(b=a[d++])c+=e(b);return c},d=db.selectors={cacheLength:50,createPseudo:fb,match:V,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(ab,bb),a[3]=(a[4]||a[5]||"").replace(ab,bb),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||db.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&db.error(a[0]),a},PSEUDO:function(a){var b,c=!a[5]&&a[2];return V.CHILD.test(a[0])?null:(a[3]&&void 0!==a[4]?a[2]=a[4]:c&&T.test(c)&&(b=ob(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(ab,bb).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=w[a+" "];return b||(b=new RegExp("(^|"+K+")"+a+"("+K+"|$)"))&&w(a,function(a){return b.test("string"==typeof a.className&&a.className||typeof a.getAttribute!==A&&a.getAttribute("class")||"")})},ATTR:function(a,b,c){return function(d){var e=db.attr(d,a);return null==e?"!="===b:b?(e+="","="===b?e===c:"!="===b?e!==c:"^="===b?c&&0===e.indexOf(c):"*="===b?c&&e.indexOf(c)>-1:"$="===b?c&&e.slice(-c.length)===c:"~="===b?(" "+e+" ").indexOf(c)>-1:"|="===b?e===c||e.slice(0,c.length+1)===c+"-":!1):!0}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),t=!i&&!h;if(q){if(f){while(p){l=b;while(l=l[p])if(h?l.nodeName.toLowerCase()===r:1===l.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&t){k=q[s]||(q[s]={}),j=k[a]||[],n=j[0]===u&&j[1],m=j[0]===u&&j[2],l=n&&q.childNodes[n];while(l=++n&&l&&l[p]||(m=n=0)||o.pop())if(1===l.nodeType&&++m&&l===b){k[a]=[u,n,m];break}}else if(t&&(j=(b[s]||(b[s]={}))[a])&&j[0]===u)m=j[1];else while(l=++n&&l&&l[p]||(m=n=0)||o.pop())if((h?l.nodeName.toLowerCase()===r:1===l.nodeType)&&++m&&(t&&((l[s]||(l[s]={}))[a]=[u,m]),l===b))break;return m-=e,m===d||m%d===0&&m/d>=0}}},PSEUDO:function(a,b){var c,e=d.pseudos[a]||d.setFilters[a.toLowerCase()]||db.error("unsupported pseudo: "+a);return e[s]?e(b):e.length>1?(c=[a,a,"",b],d.setFilters.hasOwnProperty(a.toLowerCase())?fb(function(a,c){var d,f=e(a,b),g=f.length;while(g--)d=I.call(a,f[g]),a[d]=!(c[d]=f[g])}):function(a){return e(a,0,c)}):e}},pseudos:{not:fb(function(a){var b=[],c=[],d=g(a.replace(P,"$1"));return d[s]?fb(function(a,b,c,e){var f,g=d(a,null,e,[]),h=a.length;while(h--)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,e,f){return b[0]=a,d(b,null,f,c),!c.pop()}}),has:fb(function(a){return function(b){return db(a,b).length>0}}),contains:fb(function(a){return function(b){return(b.textContent||b.innerText||e(b)).indexOf(a)>-1}}),lang:fb(function(a){return U.test(a||"")||db.error("unsupported lang: "+a),a=a.replace(ab,bb).toLowerCase(),function(b){var c;do if(c=n?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===m},focus:function(a){return a===l.activeElement&&(!l.hasFocus||l.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return a.disabled===!1},disabled:function(a){return a.disabled===!0},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType<6)return!1;return!0},parent:function(a){return!d.pseudos.empty(a)},header:function(a){return X.test(a.nodeName)},input:function(a){return W.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:lb(function(){return[0]}),last:lb(function(a,b){return[b-1]}),eq:lb(function(a,b,c){return[0>c?c+b:c]}),even:lb(function(a,b){for(var c=0;b>c;c+=2)a.push(c);return a}),odd:lb(function(a,b){for(var c=1;b>c;c+=2)a.push(c);return a}),lt:lb(function(a,b,c){for(var d=0>c?c+b:c;--d>=0;)a.push(d);return a}),gt:lb(function(a,b,c){for(var d=0>c?c+b:c;++d<b;)a.push(d);return a})}},d.pseudos.nth=d.pseudos.eq;for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})d.pseudos[b]=jb(b);for(b in{submit:!0,reset:!0})d.pseudos[b]=kb(b);function nb(){}nb.prototype=d.filters=d.pseudos,d.setFilters=new nb;function ob(a,b){var c,e,f,g,h,i,j,k=x[a+" "];if(k)return b?0:k.slice(0);h=a,i=[],j=d.preFilter;while(h){(!c||(e=Q.exec(h)))&&(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),c=!1,(e=R.exec(h))&&(c=e.shift(),f.push({value:c,type:e[0].replace(P," ")}),h=h.slice(c.length));for(g in d.filter)!(e=V[g].exec(h))||j[g]&&!(e=j[g](e))||(c=e.shift(),f.push({value:c,type:g,matches:e}),h=h.slice(c.length));if(!c)break}return b?h.length:h?db.error(a):x(a,i).slice(0)}function pb(a){for(var b=0,c=a.length,d="";c>b;b++)d+=a[b].value;return d}function qb(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=v++;return b.first?function(b,c,f){while(b=b[d])if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j=[u,f];if(g){while(b=b[d])if((1===b.nodeType||e)&&a(b,c,g))return!0}else while(b=b[d])if(1===b.nodeType||e){if(i=b[s]||(b[s]={}),(h=i[d])&&h[0]===u&&h[1]===f)return j[2]=h[2];if(i[d]=j,j[2]=a(b,c,g))return!0}}}function rb(a){return a.length>1?function(b,c,d){var e=a.length;while(e--)if(!a[e](b,c,d))return!1;return!0}:a[0]}function sb(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;i>h;h++)(f=a[h])&&(!c||c(f,d,e))&&(g.push(f),j&&b.push(h));return g}function tb(a,b,c,d,e,f){return d&&!d[s]&&(d=tb(d)),e&&!e[s]&&(e=tb(e,f)),fb(function(f,g,h,i){var j,k,l,m=[],n=[],o=g.length,p=f||wb(b||"*",h.nodeType?[h]:h,[]),q=!a||!f&&b?p:sb(p,m,a,h,i),r=c?e||(f?a:o||d)?[]:g:q;if(c&&c(q,r,h,i),d){j=sb(r,n),d(j,[],h,i),k=j.length;while(k--)(l=j[k])&&(r[n[k]]=!(q[n[k]]=l))}if(f){if(e||a){if(e){j=[],k=r.length;while(k--)(l=r[k])&&j.push(q[k]=l);e(null,r=[],j,i)}k=r.length;while(k--)(l=r[k])&&(j=e?I.call(f,l):m[k])>-1&&(f[j]=!(g[j]=l))}}else r=sb(r===g?r.splice(o,r.length):r),e?e(null,g,r,i):G.apply(g,r)})}function ub(a){for(var b,c,e,f=a.length,g=d.relative[a[0].type],i=g||d.relative[" "],j=g?1:0,k=qb(function(a){return a===b},i,!0),l=qb(function(a){return I.call(b,a)>-1},i,!0),m=[function(a,c,d){return!g&&(d||c!==h)||((b=c).nodeType?k(a,c,d):l(a,c,d))}];f>j;j++)if(c=d.relative[a[j].type])m=[qb(rb(m),c)];else{if(c=d.filter[a[j].type].apply(null,a[j].matches),c[s]){for(e=++j;f>e;e++)if(d.relative[a[e].type])break;return tb(j>1&&rb(m),j>1&&pb(a.slice(0,j-1).concat({value:" "===a[j-2].type?"*":""})).replace(P,"$1"),c,e>j&&ub(a.slice(j,e)),f>e&&ub(a=a.slice(e)),f>e&&pb(a))}m.push(c)}return rb(m)}function vb(a,b){var c=b.length>0,e=a.length>0,f=function(f,g,i,j,k){var m,n,o,p=0,q="0",r=f&&[],s=[],t=h,v=f||e&&d.find.TAG("*",k),w=u+=null==t?1:Math.random()||.1,x=v.length;for(k&&(h=g!==l&&g);q!==x&&null!=(m=v[q]);q++){if(e&&m){n=0;while(o=a[n++])if(o(m,g,i)){j.push(m);break}k&&(u=w)}c&&((m=!o&&m)&&p--,f&&r.push(m))}if(p+=q,c&&q!==p){n=0;while(o=b[n++])o(r,s,g,i);if(f){if(p>0)while(q--)r[q]||s[q]||(s[q]=E.call(j));s=sb(s)}G.apply(j,s),k&&!f&&s.length>0&&p+b.length>1&&db.uniqueSort(j)}return k&&(u=w,h=t),r};return c?fb(f):f}g=db.compile=function(a,b){var c,d=[],e=[],f=y[a+" "];if(!f){b||(b=ob(a)),c=b.length;while(c--)f=ub(b[c]),f[s]?d.push(f):e.push(f);f=y(a,vb(e,d))}return f};function wb(a,b,c){for(var d=0,e=b.length;e>d;d++)db(a,b[d],c);return c}function xb(a,b,e,f){var h,i,j,k,l,m=ob(a);if(!f&&1===m.length){if(i=m[0]=m[0].slice(0),i.length>2&&"ID"===(j=i[0]).type&&c.getById&&9===b.nodeType&&n&&d.relative[i[1].type]){if(b=(d.find.ID(j.matches[0].replace(ab,bb),b)||[])[0],!b)return e;a=a.slice(i.shift().value.length)}h=V.needsContext.test(a)?0:i.length;while(h--){if(j=i[h],d.relative[k=j.type])break;if((l=d.find[k])&&(f=l(j.matches[0].replace(ab,bb),$.test(i[0].type)&&mb(b.parentNode)||b))){if(i.splice(h,1),a=f.length&&pb(i),!a)return G.apply(e,f),e;break}}}return g(a,m)(f,b,!n,e,$.test(a)&&mb(b.parentNode)||b),e}return c.sortStable=s.split("").sort(z).join("")===s,c.detectDuplicates=!!j,k(),c.sortDetached=gb(function(a){return 1&a.compareDocumentPosition(l.createElement("div"))}),gb(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||hb("type|href|height|width",function(a,b,c){return c?void 0:a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),c.attributes&&gb(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")})||hb("value",function(a,b,c){return c||"input"!==a.nodeName.toLowerCase()?void 0:a.defaultValue}),gb(function(a){return null==a.getAttribute("disabled")})||hb(J,function(a,b,c){var d;return c?void 0:a[b]===!0?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),db}(a);n.find=t,n.expr=t.selectors,n.expr[":"]=n.expr.pseudos,n.unique=t.uniqueSort,n.text=t.getText,n.isXMLDoc=t.isXML,n.contains=t.contains;var u=n.expr.match.needsContext,v=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,w=/^.[^:#\[\.,]*$/;function x(a,b,c){if(n.isFunction(b))return n.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return n.grep(a,function(a){return a===b!==c});if("string"==typeof b){if(w.test(b))return n.filter(b,a,c);b=n.filter(b,a)}return n.grep(a,function(a){return n.inArray(a,b)>=0!==c})}n.filter=function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?n.find.matchesSelector(d,a)?[d]:[]:n.find.matches(a,n.grep(b,function(a){return 1===a.nodeType}))},n.fn.extend({find:function(a){var b,c=[],d=this,e=d.length;if("string"!=typeof a)return this.pushStack(n(a).filter(function(){for(b=0;e>b;b++)if(n.contains(d[b],this))return!0}));for(b=0;e>b;b++)n.find(a,d[b],c);return c=this.pushStack(e>1?n.unique(c):c),c.selector=this.selector?this.selector+" "+a:a,c},filter:function(a){return this.pushStack(x(this,a||[],!1))},not:function(a){return this.pushStack(x(this,a||[],!0))},is:function(a){return!!x(this,"string"==typeof a&&u.test(a)?n(a):a||[],!1).length}});var y,z=a.document,A=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,B=n.fn.init=function(a,b){var c,d;if(!a)return this;if("string"==typeof a){if(c="<"===a.charAt(0)&&">"===a.charAt(a.length-1)&&a.length>=3?[null,a,null]:A.exec(a),!c||!c[1]&&b)return!b||b.jquery?(b||y).find(a):this.constructor(b).find(a);if(c[1]){if(b=b instanceof n?b[0]:b,n.merge(this,n.parseHTML(c[1],b&&b.nodeType?b.ownerDocument||b:z,!0)),v.test(c[1])&&n.isPlainObject(b))for(c in b)n.isFunction(this[c])?this[c](b[c]):this.attr(c,b[c]);return this}if(d=z.getElementById(c[2]),d&&d.parentNode){if(d.id!==c[2])return y.find(a);this.length=1,this[0]=d}return this.context=z,this.selector=a,this}return a.nodeType?(this.context=this[0]=a,this.length=1,this):n.isFunction(a)?"undefined"!=typeof y.ready?y.ready(a):a(n):(void 0!==a.selector&&(this.selector=a.selector,this.context=a.context),n.makeArray(a,this))};B.prototype=n.fn,y=n(z);var C=/^(?:parents|prev(?:Until|All))/,D={children:!0,contents:!0,next:!0,prev:!0};n.extend({dir:function(a,b,c){var d=[],e=a[b];while(e&&9!==e.nodeType&&(void 0===c||1!==e.nodeType||!n(e).is(c)))1===e.nodeType&&d.push(e),e=e[b];return d},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}}),n.fn.extend({has:function(a){var b,c=n(a,this),d=c.length;return this.filter(function(){for(b=0;d>b;b++)if(n.contains(this,c[b]))return!0})},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=u.test(a)||"string"!=typeof a?n(a,b||this.context):0;e>d;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType<11&&(g?g.index(c)>-1:1===c.nodeType&&n.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(f.length>1?n.unique(f):f)},index:function(a){return a?"string"==typeof a?n.inArray(this[0],n(a)):n.inArray(a.jquery?a[0]:a,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(n.unique(n.merge(this.get(),n(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}});function E(a,b){do a=a[b];while(a&&1!==a.nodeType);return a}n.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return n.dir(a,"parentNode")},parentsUntil:function(a,b,c){return n.dir(a,"parentNode",c)},next:function(a){return E(a,"nextSibling")},prev:function(a){return E(a,"previousSibling")},nextAll:function(a){return n.dir(a,"nextSibling")},prevAll:function(a){return n.dir(a,"previousSibling")},nextUntil:function(a,b,c){return n.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return n.dir(a,"previousSibling",c)},siblings:function(a){return n.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return n.sibling(a.firstChild)},contents:function(a){return n.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:n.merge([],a.childNodes)}},function(a,b){n.fn[a]=function(c,d){var e=n.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=n.filter(d,e)),this.length>1&&(D[a]||(e=n.unique(e)),C.test(a)&&(e=e.reverse())),this.pushStack(e)}});var F=/\S+/g,G={};function H(a){var b=G[a]={};return n.each(a.match(F)||[],function(a,c){b[c]=!0}),b}n.Callbacks=function(a){a="string"==typeof a?G[a]||H(a):n.extend({},a);var b,c,d,e,f,g,h=[],i=!a.once&&[],j=function(l){for(c=a.memory&&l,d=!0,f=g||0,g=0,e=h.length,b=!0;h&&e>f;f++)if(h[f].apply(l[0],l[1])===!1&&a.stopOnFalse){c=!1;break}b=!1,h&&(i?i.length&&j(i.shift()):c?h=[]:k.disable())},k={add:function(){if(h){var d=h.length;!function f(b){n.each(b,function(b,c){var d=n.type(c);"function"===d?a.unique&&k.has(c)||h.push(c):c&&c.length&&"string"!==d&&f(c)})}(arguments),b?e=h.length:c&&(g=d,j(c))}return this},remove:function(){return h&&n.each(arguments,function(a,c){var d;while((d=n.inArray(c,h,d))>-1)h.splice(d,1),b&&(e>=d&&e--,f>=d&&f--)}),this},has:function(a){return a?n.inArray(a,h)>-1:!(!h||!h.length)},empty:function(){return h=[],e=0,this},disable:function(){return h=i=c=void 0,this},disabled:function(){return!h},lock:function(){return i=void 0,c||k.disable(),this},locked:function(){return!i},fireWith:function(a,c){return!h||d&&!i||(c=c||[],c=[a,c.slice?c.slice():c],b?i.push(c):j(c)),this},fire:function(){return k.fireWith(this,arguments),this},fired:function(){return!!d}};return k},n.extend({Deferred:function(a){var b=[["resolve","done",n.Callbacks("once memory"),"resolved"],["reject","fail",n.Callbacks("once memory"),"rejected"],["notify","progress",n.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return n.Deferred(function(c){n.each(b,function(b,f){var g=n.isFunction(a[b])&&a[b];e[f[1]](function(){var a=g&&g.apply(this,arguments);a&&n.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[f[0]+"With"](this===d?c.promise():this,g?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?n.extend(a,d):d}},e={};return d.pipe=d.then,n.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this},e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b=0,c=d.call(arguments),e=c.length,f=1!==e||a&&n.isFunction(a.promise)?e:0,g=1===f?a:n.Deferred(),h=function(a,b,c){return function(e){b[a]=this,c[a]=arguments.length>1?d.call(arguments):e,c===i?g.notifyWith(b,c):--f||g.resolveWith(b,c)}},i,j,k;if(e>1)for(i=new Array(e),j=new Array(e),k=new Array(e);e>b;b++)c[b]&&n.isFunction(c[b].promise)?c[b].promise().done(h(b,k,c)).fail(g.reject).progress(h(b,j,i)):--f;return f||g.resolveWith(k,c),g.promise()}});var I;n.fn.ready=function(a){return n.ready.promise().done(a),this},n.extend({isReady:!1,readyWait:1,holdReady:function(a){a?n.readyWait++:n.ready(!0)},ready:function(a){if(a===!0?!--n.readyWait:!n.isReady){if(!z.body)return setTimeout(n.ready);n.isReady=!0,a!==!0&&--n.readyWait>0||(I.resolveWith(z,[n]),n.fn.trigger&&n(z).trigger("ready").off("ready"))}}});function J(){z.addEventListener?(z.removeEventListener("DOMContentLoaded",K,!1),a.removeEventListener("load",K,!1)):(z.detachEvent("onreadystatechange",K),a.detachEvent("onload",K))}function K(){(z.addEventListener||"load"===event.type||"complete"===z.readyState)&&(J(),n.ready())}n.ready.promise=function(b){if(!I)if(I=n.Deferred(),"complete"===z.readyState)setTimeout(n.ready);else if(z.addEventListener)z.addEventListener("DOMContentLoaded",K,!1),a.addEventListener("load",K,!1);else{z.attachEvent("onreadystatechange",K),a.attachEvent("onload",K);var c=!1;try{c=null==a.frameElement&&z.documentElement}catch(d){}c&&c.doScroll&&!function e(){if(!n.isReady){try{c.doScroll("left")}catch(a){return setTimeout(e,50)}J(),n.ready()}}()}return I.promise(b)};var L="undefined",M;for(M in n(l))break;l.ownLast="0"!==M,l.inlineBlockNeedsLayout=!1,n(function(){var a,b,c=z.getElementsByTagName("body")[0];c&&(a=z.createElement("div"),a.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",b=z.createElement("div"),c.appendChild(a).appendChild(b),typeof b.style.zoom!==L&&(b.style.cssText="border:0;margin:0;width:1px;padding:1px;display:inline;zoom:1",(l.inlineBlockNeedsLayout=3===b.offsetWidth)&&(c.style.zoom=1)),c.removeChild(a),a=b=null)}),function(){var a=z.createElement("div");if(null==l.deleteExpando){l.deleteExpando=!0;try{delete a.test}catch(b){l.deleteExpando=!1}}a=null}(),n.acceptData=function(a){var b=n.noData[(a.nodeName+" ").toLowerCase()],c=+a.nodeType||1;return 1!==c&&9!==c?!1:!b||b!==!0&&a.getAttribute("classid")===b};var N=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,O=/([A-Z])/g;function P(a,b,c){if(void 0===c&&1===a.nodeType){var d="data-"+b.replace(O,"-$1").toLowerCase();if(c=a.getAttribute(d),"string"==typeof c){try{c="true"===c?!0:"false"===c?!1:"null"===c?null:+c+""===c?+c:N.test(c)?n.parseJSON(c):c}catch(e){}n.data(a,b,c)}else c=void 0}return c}function Q(a){var b;for(b in a)if(("data"!==b||!n.isEmptyObject(a[b]))&&"toJSON"!==b)return!1;return!0}function R(a,b,d,e){if(n.acceptData(a)){var f,g,h=n.expando,i=a.nodeType,j=i?n.cache:a,k=i?a[h]:a[h]&&h;if(k&&j[k]&&(e||j[k].data)||void 0!==d||"string"!=typeof b)return k||(k=i?a[h]=c.pop()||n.guid++:h),j[k]||(j[k]=i?{}:{toJSON:n.noop}),("object"==typeof b||"function"==typeof b)&&(e?j[k]=n.extend(j[k],b):j[k].data=n.extend(j[k].data,b)),g=j[k],e||(g.data||(g.data={}),g=g.data),void 0!==d&&(g[n.camelCase(b)]=d),"string"==typeof b?(f=g[b],null==f&&(f=g[n.camelCase(b)])):f=g,f
}}function S(a,b,c){if(n.acceptData(a)){var d,e,f=a.nodeType,g=f?n.cache:a,h=f?a[n.expando]:n.expando;if(g[h]){if(b&&(d=c?g[h]:g[h].data)){n.isArray(b)?b=b.concat(n.map(b,n.camelCase)):b in d?b=[b]:(b=n.camelCase(b),b=b in d?[b]:b.split(" ")),e=b.length;while(e--)delete d[b[e]];if(c?!Q(d):!n.isEmptyObject(d))return}(c||(delete g[h].data,Q(g[h])))&&(f?n.cleanData([a],!0):l.deleteExpando||g!=g.window?delete g[h]:g[h]=null)}}}n.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(a){return a=a.nodeType?n.cache[a[n.expando]]:a[n.expando],!!a&&!Q(a)},data:function(a,b,c){return R(a,b,c)},removeData:function(a,b){return S(a,b)},_data:function(a,b,c){return R(a,b,c,!0)},_removeData:function(a,b){return S(a,b,!0)}}),n.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=n.data(f),1===f.nodeType&&!n._data(f,"parsedAttrs"))){c=g.length;while(c--)d=g[c].name,0===d.indexOf("data-")&&(d=n.camelCase(d.slice(5)),P(f,d,e[d]));n._data(f,"parsedAttrs",!0)}return e}return"object"==typeof a?this.each(function(){n.data(this,a)}):arguments.length>1?this.each(function(){n.data(this,a,b)}):f?P(f,a,n.data(f,a)):void 0},removeData:function(a){return this.each(function(){n.removeData(this,a)})}}),n.extend({queue:function(a,b,c){var d;return a?(b=(b||"fx")+"queue",d=n._data(a,b),c&&(!d||n.isArray(c)?d=n._data(a,b,n.makeArray(c)):d.push(c)),d||[]):void 0},dequeue:function(a,b){b=b||"fx";var c=n.queue(a,b),d=c.length,e=c.shift(),f=n._queueHooks(a,b),g=function(){n.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return n._data(a,c)||n._data(a,c,{empty:n.Callbacks("once memory").add(function(){n._removeData(a,b+"queue"),n._removeData(a,c)})})}}),n.fn.extend({queue:function(a,b){var c=2;return"string"!=typeof a&&(b=a,a="fx",c--),arguments.length<c?n.queue(this[0],a):void 0===b?this:this.each(function(){var c=n.queue(this,a,b);n._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&n.dequeue(this,a)})},dequeue:function(a){return this.each(function(){n.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=n.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};"string"!=typeof a&&(b=a,a=void 0),a=a||"fx";while(g--)c=n._data(f[g],a+"queueHooks"),c&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});var T=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,U=["Top","Right","Bottom","Left"],V=function(a,b){return a=b||a,"none"===n.css(a,"display")||!n.contains(a.ownerDocument,a)},W=n.access=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if("object"===n.type(c)){e=!0;for(h in c)n.access(a,b,h,c[h],!0,f,g)}else if(void 0!==d&&(e=!0,n.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){return j.call(n(a),c)})),b))for(;i>h;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f},X=/^(?:checkbox|radio)$/i;!function(){var a=z.createDocumentFragment(),b=z.createElement("div"),c=z.createElement("input");if(b.setAttribute("className","t"),b.innerHTML="  <link/><table></table><a href='/a'>a</a>",l.leadingWhitespace=3===b.firstChild.nodeType,l.tbody=!b.getElementsByTagName("tbody").length,l.htmlSerialize=!!b.getElementsByTagName("link").length,l.html5Clone="<:nav></:nav>"!==z.createElement("nav").cloneNode(!0).outerHTML,c.type="checkbox",c.checked=!0,a.appendChild(c),l.appendChecked=c.checked,b.innerHTML="<textarea>x</textarea>",l.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue,a.appendChild(b),b.innerHTML="<input type='radio' checked='checked' name='t'/>",l.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,l.noCloneEvent=!0,b.attachEvent&&(b.attachEvent("onclick",function(){l.noCloneEvent=!1}),b.cloneNode(!0).click()),null==l.deleteExpando){l.deleteExpando=!0;try{delete b.test}catch(d){l.deleteExpando=!1}}a=b=c=null}(),function(){var b,c,d=z.createElement("div");for(b in{submit:!0,change:!0,focusin:!0})c="on"+b,(l[b+"Bubbles"]=c in a)||(d.setAttribute(c,"t"),l[b+"Bubbles"]=d.attributes[c].expando===!1);d=null}();var Y=/^(?:input|select|textarea)$/i,Z=/^key/,$=/^(?:mouse|contextmenu)|click/,_=/^(?:focusinfocus|focusoutblur)$/,ab=/^([^.]*)(?:\.(.+)|)$/;function bb(){return!0}function cb(){return!1}function db(){try{return z.activeElement}catch(a){}}n.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,o,p,q,r=n._data(a);if(r){c.handler&&(i=c,c=i.handler,e=i.selector),c.guid||(c.guid=n.guid++),(g=r.events)||(g=r.events={}),(k=r.handle)||(k=r.handle=function(a){return typeof n===L||a&&n.event.triggered===a.type?void 0:n.event.dispatch.apply(k.elem,arguments)},k.elem=a),b=(b||"").match(F)||[""],h=b.length;while(h--)f=ab.exec(b[h])||[],o=q=f[1],p=(f[2]||"").split(".").sort(),o&&(j=n.event.special[o]||{},o=(e?j.delegateType:j.bindType)||o,j=n.event.special[o]||{},l=n.extend({type:o,origType:q,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&n.expr.match.needsContext.test(e),namespace:p.join(".")},i),(m=g[o])||(m=g[o]=[],m.delegateCount=0,j.setup&&j.setup.call(a,d,p,k)!==!1||(a.addEventListener?a.addEventListener(o,k,!1):a.attachEvent&&a.attachEvent("on"+o,k))),j.add&&(j.add.call(a,l),l.handler.guid||(l.handler.guid=c.guid)),e?m.splice(m.delegateCount++,0,l):m.push(l),n.event.global[o]=!0);a=null}},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,o,p,q,r=n.hasData(a)&&n._data(a);if(r&&(k=r.events)){b=(b||"").match(F)||[""],j=b.length;while(j--)if(h=ab.exec(b[j])||[],o=q=h[1],p=(h[2]||"").split(".").sort(),o){l=n.event.special[o]||{},o=(d?l.delegateType:l.bindType)||o,m=k[o]||[],h=h[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),i=f=m.length;while(f--)g=m[f],!e&&q!==g.origType||c&&c.guid!==g.guid||h&&!h.test(g.namespace)||d&&d!==g.selector&&("**"!==d||!g.selector)||(m.splice(f,1),g.selector&&m.delegateCount--,l.remove&&l.remove.call(a,g));i&&!m.length&&(l.teardown&&l.teardown.call(a,p,r.handle)!==!1||n.removeEvent(a,o,r.handle),delete k[o])}else for(o in k)n.event.remove(a,o+b[j],c,d,!0);n.isEmptyObject(k)&&(delete r.handle,n._removeData(a,"events"))}},trigger:function(b,c,d,e){var f,g,h,i,k,l,m,o=[d||z],p=j.call(b,"type")?b.type:b,q=j.call(b,"namespace")?b.namespace.split("."):[];if(h=l=d=d||z,3!==d.nodeType&&8!==d.nodeType&&!_.test(p+n.event.triggered)&&(p.indexOf(".")>=0&&(q=p.split("."),p=q.shift(),q.sort()),g=p.indexOf(":")<0&&"on"+p,b=b[n.expando]?b:new n.Event(p,"object"==typeof b&&b),b.isTrigger=e?2:3,b.namespace=q.join("."),b.namespace_re=b.namespace?new RegExp("(^|\\.)"+q.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=d),c=null==c?[b]:n.makeArray(c,[b]),k=n.event.special[p]||{},e||!k.trigger||k.trigger.apply(d,c)!==!1)){if(!e&&!k.noBubble&&!n.isWindow(d)){for(i=k.delegateType||p,_.test(i+p)||(h=h.parentNode);h;h=h.parentNode)o.push(h),l=h;l===(d.ownerDocument||z)&&o.push(l.defaultView||l.parentWindow||a)}m=0;while((h=o[m++])&&!b.isPropagationStopped())b.type=m>1?i:k.bindType||p,f=(n._data(h,"events")||{})[b.type]&&n._data(h,"handle"),f&&f.apply(h,c),f=g&&h[g],f&&f.apply&&n.acceptData(h)&&(b.result=f.apply(h,c),b.result===!1&&b.preventDefault());if(b.type=p,!e&&!b.isDefaultPrevented()&&(!k._default||k._default.apply(o.pop(),c)===!1)&&n.acceptData(d)&&g&&d[p]&&!n.isWindow(d)){l=d[g],l&&(d[g]=null),n.event.triggered=p;try{d[p]()}catch(r){}n.event.triggered=void 0,l&&(d[g]=l)}return b.result}},dispatch:function(a){a=n.event.fix(a);var b,c,e,f,g,h=[],i=d.call(arguments),j=(n._data(this,"events")||{})[a.type]||[],k=n.event.special[a.type]||{};if(i[0]=a,a.delegateTarget=this,!k.preDispatch||k.preDispatch.call(this,a)!==!1){h=n.event.handlers.call(this,a,j),b=0;while((f=h[b++])&&!a.isPropagationStopped()){a.currentTarget=f.elem,g=0;while((e=f.handlers[g++])&&!a.isImmediatePropagationStopped())(!a.namespace_re||a.namespace_re.test(e.namespace))&&(a.handleObj=e,a.data=e.data,c=((n.event.special[e.origType]||{}).handle||e.handler).apply(f.elem,i),void 0!==c&&(a.result=c)===!1&&(a.preventDefault(),a.stopPropagation()))}return k.postDispatch&&k.postDispatch.call(this,a),a.result}},handlers:function(a,b){var c,d,e,f,g=[],h=b.delegateCount,i=a.target;if(h&&i.nodeType&&(!a.button||"click"!==a.type))for(;i!=this;i=i.parentNode||this)if(1===i.nodeType&&(i.disabled!==!0||"click"!==a.type)){for(e=[],f=0;h>f;f++)d=b[f],c=d.selector+" ",void 0===e[c]&&(e[c]=d.needsContext?n(c,this).index(i)>=0:n.find(c,this,null,[i]).length),e[c]&&e.push(d);e.length&&g.push({elem:i,handlers:e})}return h<b.length&&g.push({elem:this,handlers:b.slice(h)}),g},fix:function(a){if(a[n.expando])return a;var b,c,d,e=a.type,f=a,g=this.fixHooks[e];g||(this.fixHooks[e]=g=$.test(e)?this.mouseHooks:Z.test(e)?this.keyHooks:{}),d=g.props?this.props.concat(g.props):this.props,a=new n.Event(f),b=d.length;while(b--)c=d[b],a[c]=f[c];return a.target||(a.target=f.srcElement||z),3===a.target.nodeType&&(a.target=a.target.parentNode),a.metaKey=!!a.metaKey,g.filter?g.filter(a,f):a},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){var c,d,e,f=b.button,g=b.fromElement;return null==a.pageX&&null!=b.clientX&&(d=a.target.ownerDocument||z,e=d.documentElement,c=d.body,a.pageX=b.clientX+(e&&e.scrollLeft||c&&c.scrollLeft||0)-(e&&e.clientLeft||c&&c.clientLeft||0),a.pageY=b.clientY+(e&&e.scrollTop||c&&c.scrollTop||0)-(e&&e.clientTop||c&&c.clientTop||0)),!a.relatedTarget&&g&&(a.relatedTarget=g===a.target?b.toElement:g),a.which||void 0===f||(a.which=1&f?1:2&f?3:4&f?2:0),a}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==db()&&this.focus)try{return this.focus(),!1}catch(a){}},delegateType:"focusin"},blur:{trigger:function(){return this===db()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return n.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(a){return n.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&(a.originalEvent.returnValue=a.result)}}},simulate:function(a,b,c,d){var e=n.extend(new n.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?n.event.trigger(e,null,b):n.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},n.removeEvent=z.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){var d="on"+b;a.detachEvent&&(typeof a[d]===L&&(a[d]=null),a.detachEvent(d,c))},n.Event=function(a,b){return this instanceof n.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&(a.returnValue===!1||a.getPreventDefault&&a.getPreventDefault())?bb:cb):this.type=a,b&&n.extend(this,b),this.timeStamp=a&&a.timeStamp||n.now(),void(this[n.expando]=!0)):new n.Event(a,b)},n.Event.prototype={isDefaultPrevented:cb,isPropagationStopped:cb,isImmediatePropagationStopped:cb,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=bb,a&&(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=bb,a&&(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=bb,this.stopPropagation()}},n.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){n.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return(!e||e!==d&&!n.contains(d,e))&&(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),l.submitBubbles||(n.event.special.submit={setup:function(){return n.nodeName(this,"form")?!1:void n.event.add(this,"click._submit keypress._submit",function(a){var b=a.target,c=n.nodeName(b,"input")||n.nodeName(b,"button")?b.form:void 0;c&&!n._data(c,"submitBubbles")&&(n.event.add(c,"submit._submit",function(a){a._submit_bubble=!0}),n._data(c,"submitBubbles",!0))})},postDispatch:function(a){a._submit_bubble&&(delete a._submit_bubble,this.parentNode&&!a.isTrigger&&n.event.simulate("submit",this.parentNode,a,!0))},teardown:function(){return n.nodeName(this,"form")?!1:void n.event.remove(this,"._submit")}}),l.changeBubbles||(n.event.special.change={setup:function(){return Y.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(n.event.add(this,"propertychange._change",function(a){"checked"===a.originalEvent.propertyName&&(this._just_changed=!0)}),n.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1),n.event.simulate("change",this,a,!0)})),!1):void n.event.add(this,"beforeactivate._change",function(a){var b=a.target;Y.test(b.nodeName)&&!n._data(b,"changeBubbles")&&(n.event.add(b,"change._change",function(a){!this.parentNode||a.isSimulated||a.isTrigger||n.event.simulate("change",this.parentNode,a,!0)}),n._data(b,"changeBubbles",!0))})},handle:function(a){var b=a.target;return this!==b||a.isSimulated||a.isTrigger||"radio"!==b.type&&"checkbox"!==b.type?a.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return n.event.remove(this,"._change"),!Y.test(this.nodeName)}}),l.focusinBubbles||n.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function(a){n.event.simulate(b,a.target,n.event.fix(a),!0)};n.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=n._data(d,b);e||d.addEventListener(a,c,!0),n._data(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=n._data(d,b)-1;e?n._data(d,b,e):(d.removeEventListener(a,c,!0),n._removeData(d,b))}}}),n.fn.extend({on:function(a,b,c,d,e){var f,g;if("object"==typeof a){"string"!=typeof b&&(c=c||b,b=void 0);for(f in a)this.on(f,b,c,a[f],e);return this}if(null==c&&null==d?(d=b,c=b=void 0):null==d&&("string"==typeof b?(d=c,c=void 0):(d=c,c=b,b=void 0)),d===!1)d=cb;else if(!d)return this;return 1===e&&(g=d,d=function(a){return n().off(a),g.apply(this,arguments)},d.guid=g.guid||(g.guid=n.guid++)),this.each(function(){n.event.add(this,a,d,c,b)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,n(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return(b===!1||"function"==typeof b)&&(c=b,b=void 0),c===!1&&(c=cb),this.each(function(){n.event.remove(this,a,c,b)})},trigger:function(a,b){return this.each(function(){n.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];return c?n.event.trigger(a,b,c,!0):void 0}});function eb(a){var b=fb.split("|"),c=a.createDocumentFragment();if(c.createElement)while(b.length)c.createElement(b.pop());return c}var fb="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",gb=/ jQuery\d+="(?:null|\d+)"/g,hb=new RegExp("<(?:"+fb+")[\\s/>]","i"),ib=/^\s+/,jb=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,kb=/<([\w:]+)/,lb=/<tbody/i,mb=/<|&#?\w+;/,nb=/<(?:script|style|link)/i,ob=/checked\s*(?:[^=]|=\s*.checked.)/i,pb=/^$|\/(?:java|ecma)script/i,qb=/^true\/(.*)/,rb=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,sb={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:l.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},tb=eb(z),ub=tb.appendChild(z.createElement("div"));sb.optgroup=sb.option,sb.tbody=sb.tfoot=sb.colgroup=sb.caption=sb.thead,sb.th=sb.td;function vb(a,b){var c,d,e=0,f=typeof a.getElementsByTagName!==L?a.getElementsByTagName(b||"*"):typeof a.querySelectorAll!==L?a.querySelectorAll(b||"*"):void 0;if(!f)for(f=[],c=a.childNodes||a;null!=(d=c[e]);e++)!b||n.nodeName(d,b)?f.push(d):n.merge(f,vb(d,b));return void 0===b||b&&n.nodeName(a,b)?n.merge([a],f):f}function wb(a){X.test(a.type)&&(a.defaultChecked=a.checked)}function xb(a,b){return n.nodeName(a,"table")&&n.nodeName(11!==b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function yb(a){return a.type=(null!==n.find.attr(a,"type"))+"/"+a.type,a}function zb(a){var b=qb.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function Ab(a,b){for(var c,d=0;null!=(c=a[d]);d++)n._data(c,"globalEval",!b||n._data(b[d],"globalEval"))}function Bb(a,b){if(1===b.nodeType&&n.hasData(a)){var c,d,e,f=n._data(a),g=n._data(b,f),h=f.events;if(h){delete g.handle,g.events={};for(c in h)for(d=0,e=h[c].length;e>d;d++)n.event.add(b,c,h[c][d])}g.data&&(g.data=n.extend({},g.data))}}function Cb(a,b){var c,d,e;if(1===b.nodeType){if(c=b.nodeName.toLowerCase(),!l.noCloneEvent&&b[n.expando]){e=n._data(b);for(d in e.events)n.removeEvent(b,d,e.handle);b.removeAttribute(n.expando)}"script"===c&&b.text!==a.text?(yb(b).text=a.text,zb(b)):"object"===c?(b.parentNode&&(b.outerHTML=a.outerHTML),l.html5Clone&&a.innerHTML&&!n.trim(b.innerHTML)&&(b.innerHTML=a.innerHTML)):"input"===c&&X.test(a.type)?(b.defaultChecked=b.checked=a.checked,b.value!==a.value&&(b.value=a.value)):"option"===c?b.defaultSelected=b.selected=a.defaultSelected:("input"===c||"textarea"===c)&&(b.defaultValue=a.defaultValue)}}n.extend({clone:function(a,b,c){var d,e,f,g,h,i=n.contains(a.ownerDocument,a);if(l.html5Clone||n.isXMLDoc(a)||!hb.test("<"+a.nodeName+">")?f=a.cloneNode(!0):(ub.innerHTML=a.outerHTML,ub.removeChild(f=ub.firstChild)),!(l.noCloneEvent&&l.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||n.isXMLDoc(a)))for(d=vb(f),h=vb(a),g=0;null!=(e=h[g]);++g)d[g]&&Cb(e,d[g]);if(b)if(c)for(h=h||vb(a),d=d||vb(f),g=0;null!=(e=h[g]);g++)Bb(e,d[g]);else Bb(a,f);return d=vb(f,"script"),d.length>0&&Ab(d,!i&&vb(a,"script")),d=h=e=null,f},buildFragment:function(a,b,c,d){for(var e,f,g,h,i,j,k,m=a.length,o=eb(b),p=[],q=0;m>q;q++)if(f=a[q],f||0===f)if("object"===n.type(f))n.merge(p,f.nodeType?[f]:f);else if(mb.test(f)){h=h||o.appendChild(b.createElement("div")),i=(kb.exec(f)||["",""])[1].toLowerCase(),k=sb[i]||sb._default,h.innerHTML=k[1]+f.replace(jb,"<$1></$2>")+k[2],e=k[0];while(e--)h=h.lastChild;if(!l.leadingWhitespace&&ib.test(f)&&p.push(b.createTextNode(ib.exec(f)[0])),!l.tbody){f="table"!==i||lb.test(f)?"<table>"!==k[1]||lb.test(f)?0:h:h.firstChild,e=f&&f.childNodes.length;while(e--)n.nodeName(j=f.childNodes[e],"tbody")&&!j.childNodes.length&&f.removeChild(j)}n.merge(p,h.childNodes),h.textContent="";while(h.firstChild)h.removeChild(h.firstChild);h=o.lastChild}else p.push(b.createTextNode(f));h&&o.removeChild(h),l.appendChecked||n.grep(vb(p,"input"),wb),q=0;while(f=p[q++])if((!d||-1===n.inArray(f,d))&&(g=n.contains(f.ownerDocument,f),h=vb(o.appendChild(f),"script"),g&&Ab(h),c)){e=0;while(f=h[e++])pb.test(f.type||"")&&c.push(f)}return h=null,o},cleanData:function(a,b){for(var d,e,f,g,h=0,i=n.expando,j=n.cache,k=l.deleteExpando,m=n.event.special;null!=(d=a[h]);h++)if((b||n.acceptData(d))&&(f=d[i],g=f&&j[f])){if(g.events)for(e in g.events)m[e]?n.event.remove(d,e):n.removeEvent(d,e,g.handle);j[f]&&(delete j[f],k?delete d[i]:typeof d.removeAttribute!==L?d.removeAttribute(i):d[i]=null,c.push(f))}}}),n.fn.extend({text:function(a){return W(this,function(a){return void 0===a?n.text(this):this.empty().append((this[0]&&this[0].ownerDocument||z).createTextNode(a))},null,a,arguments.length)},append:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=xb(this,a);b.appendChild(a)}})},prepend:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=xb(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var c,d=a?n.filter(a,this):this,e=0;null!=(c=d[e]);e++)b||1!==c.nodeType||n.cleanData(vb(c)),c.parentNode&&(b&&n.contains(c.ownerDocument,c)&&Ab(vb(c,"script")),c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++){1===a.nodeType&&n.cleanData(vb(a,!1));while(a.firstChild)a.removeChild(a.firstChild);a.options&&n.nodeName(a,"select")&&(a.options.length=0)}return this},clone:function(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return n.clone(this,a,b)})},html:function(a){return W(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a)return 1===b.nodeType?b.innerHTML.replace(gb,""):void 0;if(!("string"!=typeof a||nb.test(a)||!l.htmlSerialize&&hb.test(a)||!l.leadingWhitespace&&ib.test(a)||sb[(kb.exec(a)||["",""])[1].toLowerCase()])){a=a.replace(jb,"<$1></$2>");try{for(;d>c;c++)b=this[c]||{},1===b.nodeType&&(n.cleanData(vb(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=arguments[0];return this.domManip(arguments,function(b){a=this.parentNode,n.cleanData(vb(this)),a&&a.replaceChild(b,this)}),a&&(a.length||a.nodeType)?this:this.remove()},detach:function(a){return this.remove(a,!0)},domManip:function(a,b){a=e.apply([],a);var c,d,f,g,h,i,j=0,k=this.length,m=this,o=k-1,p=a[0],q=n.isFunction(p);if(q||k>1&&"string"==typeof p&&!l.checkClone&&ob.test(p))return this.each(function(c){var d=m.eq(c);q&&(a[0]=p.call(this,c,d.html())),d.domManip(a,b)});if(k&&(i=n.buildFragment(a,this[0].ownerDocument,!1,this),c=i.firstChild,1===i.childNodes.length&&(i=c),c)){for(g=n.map(vb(i,"script"),yb),f=g.length;k>j;j++)d=i,j!==o&&(d=n.clone(d,!0,!0),f&&n.merge(g,vb(d,"script"))),b.call(this[j],d,j);if(f)for(h=g[g.length-1].ownerDocument,n.map(g,zb),j=0;f>j;j++)d=g[j],pb.test(d.type||"")&&!n._data(d,"globalEval")&&n.contains(h,d)&&(d.src?n._evalUrl&&n._evalUrl(d.src):n.globalEval((d.text||d.textContent||d.innerHTML||"").replace(rb,"")));i=c=null}return this}}),n.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){n.fn[a]=function(a){for(var c,d=0,e=[],g=n(a),h=g.length-1;h>=d;d++)c=d===h?this:this.clone(!0),n(g[d])[b](c),f.apply(e,c.get());return this.pushStack(e)}});var Db,Eb={};function Fb(b,c){var d=n(c.createElement(b)).appendTo(c.body),e=a.getDefaultComputedStyle?a.getDefaultComputedStyle(d[0]).display:n.css(d[0],"display");return d.detach(),e}function Gb(a){var b=z,c=Eb[a];return c||(c=Fb(a,b),"none"!==c&&c||(Db=(Db||n("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement),b=(Db[0].contentWindow||Db[0].contentDocument).document,b.write(),b.close(),c=Fb(a,b),Db.detach()),Eb[a]=c),c}!function(){var a,b,c=z.createElement("div"),d="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0";c.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",a=c.getElementsByTagName("a")[0],a.style.cssText="float:left;opacity:.5",l.opacity=/^0.5/.test(a.style.opacity),l.cssFloat=!!a.style.cssFloat,c.style.backgroundClip="content-box",c.cloneNode(!0).style.backgroundClip="",l.clearCloneStyle="content-box"===c.style.backgroundClip,a=c=null,l.shrinkWrapBlocks=function(){var a,c,e,f;if(null==b){if(a=z.getElementsByTagName("body")[0],!a)return;f="border:0;width:0;height:0;position:absolute;top:0;left:-9999px",c=z.createElement("div"),e=z.createElement("div"),a.appendChild(c).appendChild(e),b=!1,typeof e.style.zoom!==L&&(e.style.cssText=d+";width:1px;padding:1px;zoom:1",e.innerHTML="<div></div>",e.firstChild.style.width="5px",b=3!==e.offsetWidth),a.removeChild(c),a=c=e=null}return b}}();var Hb=/^margin/,Ib=new RegExp("^("+T+")(?!px)[a-z%]+$","i"),Jb,Kb,Lb=/^(top|right|bottom|left)$/;a.getComputedStyle?(Jb=function(a){return a.ownerDocument.defaultView.getComputedStyle(a,null)},Kb=function(a,b,c){var d,e,f,g,h=a.style;return c=c||Jb(a),g=c?c.getPropertyValue(b)||c[b]:void 0,c&&(""!==g||n.contains(a.ownerDocument,a)||(g=n.style(a,b)),Ib.test(g)&&Hb.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f)),void 0===g?g:g+""}):z.documentElement.currentStyle&&(Jb=function(a){return a.currentStyle},Kb=function(a,b,c){var d,e,f,g,h=a.style;return c=c||Jb(a),g=c?c[b]:void 0,null==g&&h&&h[b]&&(g=h[b]),Ib.test(g)&&!Lb.test(b)&&(d=h.left,e=a.runtimeStyle,f=e&&e.left,f&&(e.left=a.currentStyle.left),h.left="fontSize"===b?"1em":g,g=h.pixelLeft+"px",h.left=d,f&&(e.left=f)),void 0===g?g:g+""||"auto"});function Mb(a,b){return{get:function(){var c=a();if(null!=c)return c?void delete this.get:(this.get=b).apply(this,arguments)}}}!function(){var b,c,d,e,f,g,h=z.createElement("div"),i="border:0;width:0;height:0;position:absolute;top:0;left:-9999px",j="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0";h.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",b=h.getElementsByTagName("a")[0],b.style.cssText="float:left;opacity:.5",l.opacity=/^0.5/.test(b.style.opacity),l.cssFloat=!!b.style.cssFloat,h.style.backgroundClip="content-box",h.cloneNode(!0).style.backgroundClip="",l.clearCloneStyle="content-box"===h.style.backgroundClip,b=h=null,n.extend(l,{reliableHiddenOffsets:function(){if(null!=c)return c;var a,b,d,e=z.createElement("div"),f=z.getElementsByTagName("body")[0];if(f)return e.setAttribute("className","t"),e.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",a=z.createElement("div"),a.style.cssText=i,f.appendChild(a).appendChild(e),e.innerHTML="<table><tr><td></td><td>t</td></tr></table>",b=e.getElementsByTagName("td"),b[0].style.cssText="padding:0;margin:0;border:0;display:none",d=0===b[0].offsetHeight,b[0].style.display="",b[1].style.display="none",c=d&&0===b[0].offsetHeight,f.removeChild(a),e=f=null,c},boxSizing:function(){return null==d&&k(),d},boxSizingReliable:function(){return null==e&&k(),e},pixelPosition:function(){return null==f&&k(),f},reliableMarginRight:function(){var b,c,d,e;if(null==g&&a.getComputedStyle){if(b=z.getElementsByTagName("body")[0],!b)return;c=z.createElement("div"),d=z.createElement("div"),c.style.cssText=i,b.appendChild(c).appendChild(d),e=d.appendChild(z.createElement("div")),e.style.cssText=d.style.cssText=j,e.style.marginRight=e.style.width="0",d.style.width="1px",g=!parseFloat((a.getComputedStyle(e,null)||{}).marginRight),b.removeChild(c)}return g}});function k(){var b,c,h=z.getElementsByTagName("body")[0];h&&(b=z.createElement("div"),c=z.createElement("div"),b.style.cssText=i,h.appendChild(b).appendChild(c),c.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;display:block;padding:1px;border:1px;width:4px;margin-top:1%;top:1%",n.swap(h,null!=h.style.zoom?{zoom:1}:{},function(){d=4===c.offsetWidth}),e=!0,f=!1,g=!0,a.getComputedStyle&&(f="1%"!==(a.getComputedStyle(c,null)||{}).top,e="4px"===(a.getComputedStyle(c,null)||{width:"4px"}).width),h.removeChild(b),c=h=null)}}(),n.swap=function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e};var Nb=/alpha\([^)]*\)/i,Ob=/opacity\s*=\s*([^)]*)/,Pb=/^(none|table(?!-c[ea]).+)/,Qb=new RegExp("^("+T+")(.*)$","i"),Rb=new RegExp("^([+-])=("+T+")","i"),Sb={position:"absolute",visibility:"hidden",display:"block"},Tb={letterSpacing:0,fontWeight:400},Ub=["Webkit","O","Moz","ms"];function Vb(a,b){if(b in a)return b;var c=b.charAt(0).toUpperCase()+b.slice(1),d=b,e=Ub.length;while(e--)if(b=Ub[e]+c,b in a)return b;return d}function Wb(a,b){for(var c,d,e,f=[],g=0,h=a.length;h>g;g++)d=a[g],d.style&&(f[g]=n._data(d,"olddisplay"),c=d.style.display,b?(f[g]||"none"!==c||(d.style.display=""),""===d.style.display&&V(d)&&(f[g]=n._data(d,"olddisplay",Gb(d.nodeName)))):f[g]||(e=V(d),(c&&"none"!==c||!e)&&n._data(d,"olddisplay",e?c:n.css(d,"display"))));for(g=0;h>g;g++)d=a[g],d.style&&(b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none"));return a}function Xb(a,b,c){var d=Qb.exec(b);return d?Math.max(0,d[1]-(c||0))+(d[2]||"px"):b}function Yb(a,b,c,d,e){for(var f=c===(d?"border":"content")?4:"width"===b?1:0,g=0;4>f;f+=2)"margin"===c&&(g+=n.css(a,c+U[f],!0,e)),d?("content"===c&&(g-=n.css(a,"padding"+U[f],!0,e)),"margin"!==c&&(g-=n.css(a,"border"+U[f]+"Width",!0,e))):(g+=n.css(a,"padding"+U[f],!0,e),"padding"!==c&&(g+=n.css(a,"border"+U[f]+"Width",!0,e)));return g}function Zb(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=Jb(a),g=l.boxSizing()&&"border-box"===n.css(a,"boxSizing",!1,f);if(0>=e||null==e){if(e=Kb(a,b,f),(0>e||null==e)&&(e=a.style[b]),Ib.test(e))return e;d=g&&(l.boxSizingReliable()||e===a.style[b]),e=parseFloat(e)||0}return e+Yb(a,b,c||(g?"border":"content"),d,f)+"px"}n.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=Kb(a,"opacity");return""===c?"1":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":l.cssFloat?"cssFloat":"styleFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=n.camelCase(b),i=a.style;if(b=n.cssProps[h]||(n.cssProps[h]=Vb(i,h)),g=n.cssHooks[b]||n.cssHooks[h],void 0===c)return g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b];if(f=typeof c,"string"===f&&(e=Rb.exec(c))&&(c=(e[1]+1)*e[2]+parseFloat(n.css(a,b)),f="number"),null!=c&&c===c&&("number"!==f||n.cssNumber[h]||(c+="px"),l.clearCloneStyle||""!==c||0!==b.indexOf("background")||(i[b]="inherit"),!(g&&"set"in g&&void 0===(c=g.set(a,c,d)))))try{i[b]="",i[b]=c}catch(j){}}},css:function(a,b,c,d){var e,f,g,h=n.camelCase(b);return b=n.cssProps[h]||(n.cssProps[h]=Vb(a.style,h)),g=n.cssHooks[b]||n.cssHooks[h],g&&"get"in g&&(f=g.get(a,!0,c)),void 0===f&&(f=Kb(a,b,d)),"normal"===f&&b in Tb&&(f=Tb[b]),""===c||c?(e=parseFloat(f),c===!0||n.isNumeric(e)?e||0:f):f}}),n.each(["height","width"],function(a,b){n.cssHooks[b]={get:function(a,c,d){return c?0===a.offsetWidth&&Pb.test(n.css(a,"display"))?n.swap(a,Sb,function(){return Zb(a,b,d)}):Zb(a,b,d):void 0},set:function(a,c,d){var e=d&&Jb(a);return Xb(a,c,d?Yb(a,b,d,l.boxSizing()&&"border-box"===n.css(a,"boxSizing",!1,e),e):0)}}}),l.opacity||(n.cssHooks.opacity={get:function(a,b){return Ob.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=n.isNumeric(b)?"alpha(opacity="+100*b+")":"",f=d&&d.filter||c.filter||"";c.zoom=1,(b>=1||""===b)&&""===n.trim(f.replace(Nb,""))&&c.removeAttribute&&(c.removeAttribute("filter"),""===b||d&&!d.filter)||(c.filter=Nb.test(f)?f.replace(Nb,e):f+" "+e)}}),n.cssHooks.marginRight=Mb(l.reliableMarginRight,function(a,b){return b?n.swap(a,{display:"inline-block"},Kb,[a,"marginRight"]):void 0}),n.each({margin:"",padding:"",border:"Width"},function(a,b){n.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];4>d;d++)e[a+U[d]+b]=f[d]||f[d-2]||f[0];return e}},Hb.test(a)||(n.cssHooks[a+b].set=Xb)}),n.fn.extend({css:function(a,b){return W(this,function(a,b,c){var d,e,f={},g=0;if(n.isArray(b)){for(d=Jb(a),e=b.length;e>g;g++)f[b[g]]=n.css(a,b[g],!1,d);return f}return void 0!==c?n.style(a,b,c):n.css(a,b)
},a,b,arguments.length>1)},show:function(){return Wb(this,!0)},hide:function(){return Wb(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){V(this)?n(this).show():n(this).hide()})}});function $b(a,b,c,d,e){return new $b.prototype.init(a,b,c,d,e)}n.Tween=$b,$b.prototype={constructor:$b,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(n.cssNumber[c]?"":"px")},cur:function(){var a=$b.propHooks[this.prop];return a&&a.get?a.get(this):$b.propHooks._default.get(this)},run:function(a){var b,c=$b.propHooks[this.prop];return this.pos=b=this.options.duration?n.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):$b.propHooks._default.set(this),this}},$b.prototype.init.prototype=$b.prototype,$b.propHooks={_default:{get:function(a){var b;return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(b=n.css(a.elem,a.prop,""),b&&"auto"!==b?b:0):a.elem[a.prop]},set:function(a){n.fx.step[a.prop]?n.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[n.cssProps[a.prop]]||n.cssHooks[a.prop])?n.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}},$b.propHooks.scrollTop=$b.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},n.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}},n.fx=$b.prototype.init,n.fx.step={};var _b,ac,bc=/^(?:toggle|show|hide)$/,cc=new RegExp("^(?:([+-])=|)("+T+")([a-z%]*)$","i"),dc=/queueHooks$/,ec=[jc],fc={"*":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=cc.exec(b),f=e&&e[3]||(n.cssNumber[a]?"":"px"),g=(n.cssNumber[a]||"px"!==f&&+d)&&cc.exec(n.css(c.elem,a)),h=1,i=20;if(g&&g[3]!==f){f=f||g[3],e=e||[],g=+d||1;do h=h||".5",g/=h,n.style(c.elem,a,g+f);while(h!==(h=c.cur()/d)&&1!==h&&--i)}return e&&(g=c.start=+g||+d||0,c.unit=f,c.end=e[1]?g+(e[1]+1)*e[2]:+e[2]),c}]};function gc(){return setTimeout(function(){_b=void 0}),_b=n.now()}function hc(a,b){var c,d={height:a},e=0;for(b=b?1:0;4>e;e+=2-b)c=U[e],d["margin"+c]=d["padding"+c]=a;return b&&(d.opacity=d.width=a),d}function ic(a,b,c){for(var d,e=(fc[b]||[]).concat(fc["*"]),f=0,g=e.length;g>f;f++)if(d=e[f].call(c,b,a))return d}function jc(a,b,c){var d,e,f,g,h,i,j,k,m=this,o={},p=a.style,q=a.nodeType&&V(a),r=n._data(a,"fxshow");c.queue||(h=n._queueHooks(a,"fx"),null==h.unqueued&&(h.unqueued=0,i=h.empty.fire,h.empty.fire=function(){h.unqueued||i()}),h.unqueued++,m.always(function(){m.always(function(){h.unqueued--,n.queue(a,"fx").length||h.empty.fire()})})),1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[p.overflow,p.overflowX,p.overflowY],j=n.css(a,"display"),k=Gb(a.nodeName),"none"===j&&(j=k),"inline"===j&&"none"===n.css(a,"float")&&(l.inlineBlockNeedsLayout&&"inline"!==k?p.zoom=1:p.display="inline-block")),c.overflow&&(p.overflow="hidden",l.shrinkWrapBlocks()||m.always(function(){p.overflow=c.overflow[0],p.overflowX=c.overflow[1],p.overflowY=c.overflow[2]}));for(d in b)if(e=b[d],bc.exec(e)){if(delete b[d],f=f||"toggle"===e,e===(q?"hide":"show")){if("show"!==e||!r||void 0===r[d])continue;q=!0}o[d]=r&&r[d]||n.style(a,d)}if(!n.isEmptyObject(o)){r?"hidden"in r&&(q=r.hidden):r=n._data(a,"fxshow",{}),f&&(r.hidden=!q),q?n(a).show():m.done(function(){n(a).hide()}),m.done(function(){var b;n._removeData(a,"fxshow");for(b in o)n.style(a,b,o[b])});for(d in o)g=ic(q?r[d]:0,d,m),d in r||(r[d]=g.start,q&&(g.end=g.start,g.start="width"===d||"height"===d?1:0))}}function kc(a,b){var c,d,e,f,g;for(c in a)if(d=n.camelCase(c),e=b[d],f=a[c],n.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=n.cssHooks[d],g&&"expand"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function lc(a,b,c){var d,e,f=0,g=ec.length,h=n.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=_b||gc(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;i>g;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),1>f&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:n.extend({},b),opts:n.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:_b||gc(),duration:c.duration,tweens:[],createTween:function(b,c){var d=n.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;d>c;c++)j.tweens[c].run(1);return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this}}),k=j.props;for(kc(k,j.opts.specialEasing);g>f;f++)if(d=ec[f].call(j,a,k,j.opts))return d;return n.map(k,ic,j),n.isFunction(j.opts.start)&&j.opts.start.call(a,j),n.fx.timer(n.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}n.Animation=n.extend(lc,{tweener:function(a,b){n.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;e>d;d++)c=a[d],fc[c]=fc[c]||[],fc[c].unshift(b)},prefilter:function(a,b){b?ec.unshift(a):ec.push(a)}}),n.speed=function(a,b,c){var d=a&&"object"==typeof a?n.extend({},a):{complete:c||!c&&b||n.isFunction(a)&&a,duration:a,easing:c&&b||b&&!n.isFunction(b)&&b};return d.duration=n.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in n.fx.speeds?n.fx.speeds[d.duration]:n.fx.speeds._default,(null==d.queue||d.queue===!0)&&(d.queue="fx"),d.old=d.complete,d.complete=function(){n.isFunction(d.old)&&d.old.call(this),d.queue&&n.dequeue(this,d.queue)},d},n.fn.extend({fadeTo:function(a,b,c,d){return this.filter(V).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=n.isEmptyObject(a),f=n.speed(b,c,d),g=function(){var b=lc(this,n.extend({},a),f);(e||n._data(this,"finish"))&&b.stop(!0)};return g.finish=g,e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=n.timers,g=n._data(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&dc.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));(b||!c)&&n.dequeue(this,a)})},finish:function(a){return a!==!1&&(a=a||"fx"),this.each(function(){var b,c=n._data(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=n.timers,g=d?d.length:0;for(c.finish=!0,n.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;g>b;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),n.each(["toggle","show","hide"],function(a,b){var c=n.fn[b];n.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(hc(b,!0),a,d,e)}}),n.each({slideDown:hc("show"),slideUp:hc("hide"),slideToggle:hc("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){n.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),n.timers=[],n.fx.tick=function(){var a,b=n.timers,c=0;for(_b=n.now();c<b.length;c++)a=b[c],a()||b[c]!==a||b.splice(c--,1);b.length||n.fx.stop(),_b=void 0},n.fx.timer=function(a){n.timers.push(a),a()?n.fx.start():n.timers.pop()},n.fx.interval=13,n.fx.start=function(){ac||(ac=setInterval(n.fx.tick,n.fx.interval))},n.fx.stop=function(){clearInterval(ac),ac=null},n.fx.speeds={slow:600,fast:200,_default:400},n.fn.delay=function(a,b){return a=n.fx?n.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},function(){var a,b,c,d,e=z.createElement("div");e.setAttribute("className","t"),e.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",a=e.getElementsByTagName("a")[0],c=z.createElement("select"),d=c.appendChild(z.createElement("option")),b=e.getElementsByTagName("input")[0],a.style.cssText="top:1px",l.getSetAttribute="t"!==e.className,l.style=/top/.test(a.getAttribute("style")),l.hrefNormalized="/a"===a.getAttribute("href"),l.checkOn=!!b.value,l.optSelected=d.selected,l.enctype=!!z.createElement("form").enctype,c.disabled=!0,l.optDisabled=!d.disabled,b=z.createElement("input"),b.setAttribute("value",""),l.input=""===b.getAttribute("value"),b.value="t",b.setAttribute("type","radio"),l.radioValue="t"===b.value,a=b=c=d=e=null}();var mc=/\r/g;n.fn.extend({val:function(a){var b,c,d,e=this[0];{if(arguments.length)return d=n.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(e=d?a.call(this,c,n(this).val()):a,null==e?e="":"number"==typeof e?e+="":n.isArray(e)&&(e=n.map(e,function(a){return null==a?"":a+""})),b=n.valHooks[this.type]||n.valHooks[this.nodeName.toLowerCase()],b&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e))});if(e)return b=n.valHooks[e.type]||n.valHooks[e.nodeName.toLowerCase()],b&&"get"in b&&void 0!==(c=b.get(e,"value"))?c:(c=e.value,"string"==typeof c?c.replace(mc,""):null==c?"":c)}}}),n.extend({valHooks:{option:{get:function(a){var b=n.find.attr(a,"value");return null!=b?b:n.text(a)}},select:{get:function(a){for(var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||0>e,g=f?null:[],h=f?e+1:d.length,i=0>e?h:f?e:0;h>i;i++)if(c=d[i],!(!c.selected&&i!==e||(l.optDisabled?c.disabled:null!==c.getAttribute("disabled"))||c.parentNode.disabled&&n.nodeName(c.parentNode,"optgroup"))){if(b=n(c).val(),f)return b;g.push(b)}return g},set:function(a,b){var c,d,e=a.options,f=n.makeArray(b),g=e.length;while(g--)if(d=e[g],n.inArray(n.valHooks.option.get(d),f)>=0)try{d.selected=c=!0}catch(h){d.scrollHeight}else d.selected=!1;return c||(a.selectedIndex=-1),e}}}}),n.each(["radio","checkbox"],function(){n.valHooks[this]={set:function(a,b){return n.isArray(b)?a.checked=n.inArray(n(a).val(),b)>=0:void 0}},l.checkOn||(n.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})});var nc,oc,pc=n.expr.attrHandle,qc=/^(?:checked|selected)$/i,rc=l.getSetAttribute,sc=l.input;n.fn.extend({attr:function(a,b){return W(this,n.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){n.removeAttr(this,a)})}}),n.extend({attr:function(a,b,c){var d,e,f=a.nodeType;if(a&&3!==f&&8!==f&&2!==f)return typeof a.getAttribute===L?n.prop(a,b,c):(1===f&&n.isXMLDoc(a)||(b=b.toLowerCase(),d=n.attrHooks[b]||(n.expr.match.bool.test(b)?oc:nc)),void 0===c?d&&"get"in d&&null!==(e=d.get(a,b))?e:(e=n.find.attr(a,b),null==e?void 0:e):null!==c?d&&"set"in d&&void 0!==(e=d.set(a,c,b))?e:(a.setAttribute(b,c+""),c):void n.removeAttr(a,b))},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(F);if(f&&1===a.nodeType)while(c=f[e++])d=n.propFix[c]||c,n.expr.match.bool.test(c)?sc&&rc||!qc.test(c)?a[d]=!1:a[n.camelCase("default-"+c)]=a[d]=!1:n.attr(a,c,""),a.removeAttribute(rc?c:d)},attrHooks:{type:{set:function(a,b){if(!l.radioValue&&"radio"===b&&n.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}}}),oc={set:function(a,b,c){return b===!1?n.removeAttr(a,c):sc&&rc||!qc.test(c)?a.setAttribute(!rc&&n.propFix[c]||c,c):a[n.camelCase("default-"+c)]=a[c]=!0,c}},n.each(n.expr.match.bool.source.match(/\w+/g),function(a,b){var c=pc[b]||n.find.attr;pc[b]=sc&&rc||!qc.test(b)?function(a,b,d){var e,f;return d||(f=pc[b],pc[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,pc[b]=f),e}:function(a,b,c){return c?void 0:a[n.camelCase("default-"+b)]?b.toLowerCase():null}}),sc&&rc||(n.attrHooks.value={set:function(a,b,c){return n.nodeName(a,"input")?void(a.defaultValue=b):nc&&nc.set(a,b,c)}}),rc||(nc={set:function(a,b,c){var d=a.getAttributeNode(c);return d||a.setAttributeNode(d=a.ownerDocument.createAttribute(c)),d.value=b+="","value"===c||b===a.getAttribute(c)?b:void 0}},pc.id=pc.name=pc.coords=function(a,b,c){var d;return c?void 0:(d=a.getAttributeNode(b))&&""!==d.value?d.value:null},n.valHooks.button={get:function(a,b){var c=a.getAttributeNode(b);return c&&c.specified?c.value:void 0},set:nc.set},n.attrHooks.contenteditable={set:function(a,b,c){nc.set(a,""===b?!1:b,c)}},n.each(["width","height"],function(a,b){n.attrHooks[b]={set:function(a,c){return""===c?(a.setAttribute(b,"auto"),c):void 0}}})),l.style||(n.attrHooks.style={get:function(a){return a.style.cssText||void 0},set:function(a,b){return a.style.cssText=b+""}});var tc=/^(?:input|select|textarea|button|object)$/i,uc=/^(?:a|area)$/i;n.fn.extend({prop:function(a,b){return W(this,n.prop,a,b,arguments.length>1)},removeProp:function(a){return a=n.propFix[a]||a,this.each(function(){try{this[a]=void 0,delete this[a]}catch(b){}})}}),n.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(a,b,c){var d,e,f,g=a.nodeType;if(a&&3!==g&&8!==g&&2!==g)return f=1!==g||!n.isXMLDoc(a),f&&(b=n.propFix[b]||b,e=n.propHooks[b]),void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]},propHooks:{tabIndex:{get:function(a){var b=n.find.attr(a,"tabindex");return b?parseInt(b,10):tc.test(a.nodeName)||uc.test(a.nodeName)&&a.href?0:-1}}}}),l.hrefNormalized||n.each(["href","src"],function(a,b){n.propHooks[b]={get:function(a){return a.getAttribute(b,4)}}}),l.optSelected||(n.propHooks.selected={get:function(a){var b=a.parentNode;return b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex),null}}),n.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){n.propFix[this.toLowerCase()]=this}),l.enctype||(n.propFix.enctype="encoding");var vc=/[\t\r\n\f]/g;n.fn.extend({addClass:function(a){var b,c,d,e,f,g,h=0,i=this.length,j="string"==typeof a&&a;if(n.isFunction(a))return this.each(function(b){n(this).addClass(a.call(this,b,this.className))});if(j)for(b=(a||"").match(F)||[];i>h;h++)if(c=this[h],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(vc," "):" ")){f=0;while(e=b[f++])d.indexOf(" "+e+" ")<0&&(d+=e+" ");g=n.trim(d),c.className!==g&&(c.className=g)}return this},removeClass:function(a){var b,c,d,e,f,g,h=0,i=this.length,j=0===arguments.length||"string"==typeof a&&a;if(n.isFunction(a))return this.each(function(b){n(this).removeClass(a.call(this,b,this.className))});if(j)for(b=(a||"").match(F)||[];i>h;h++)if(c=this[h],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(vc," "):"")){f=0;while(e=b[f++])while(d.indexOf(" "+e+" ")>=0)d=d.replace(" "+e+" "," ");g=a?n.trim(d):"",c.className!==g&&(c.className=g)}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):this.each(n.isFunction(a)?function(c){n(this).toggleClass(a.call(this,c,this.className,b),b)}:function(){if("string"===c){var b,d=0,e=n(this),f=a.match(F)||[];while(b=f[d++])e.hasClass(b)?e.removeClass(b):e.addClass(b)}else(c===L||"boolean"===c)&&(this.className&&n._data(this,"__className__",this.className),this.className=this.className||a===!1?"":n._data(this,"__className__")||"")})},hasClass:function(a){for(var b=" "+a+" ",c=0,d=this.length;d>c;c++)if(1===this[c].nodeType&&(" "+this[c].className+" ").replace(vc," ").indexOf(b)>=0)return!0;return!1}}),n.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){n.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),n.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}});var wc=n.now(),xc=/\?/,yc=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;n.parseJSON=function(b){if(a.JSON&&a.JSON.parse)return a.JSON.parse(b+"");var c,d=null,e=n.trim(b+"");return e&&!n.trim(e.replace(yc,function(a,b,e,f){return c&&b&&(d=0),0===d?a:(c=e||b,d+=!f-!e,"")}))?Function("return "+e)():n.error("Invalid JSON: "+b)},n.parseXML=function(b){var c,d;if(!b||"string"!=typeof b)return null;try{a.DOMParser?(d=new DOMParser,c=d.parseFromString(b,"text/xml")):(c=new ActiveXObject("Microsoft.XMLDOM"),c.async="false",c.loadXML(b))}catch(e){c=void 0}return c&&c.documentElement&&!c.getElementsByTagName("parsererror").length||n.error("Invalid XML: "+b),c};var zc,Ac,Bc=/#.*$/,Cc=/([?&])_=[^&]*/,Dc=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Ec=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Fc=/^(?:GET|HEAD)$/,Gc=/^\/\//,Hc=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Ic={},Jc={},Kc="*/".concat("*");try{Ac=location.href}catch(Lc){Ac=z.createElement("a"),Ac.href="",Ac=Ac.href}zc=Hc.exec(Ac.toLowerCase())||[];function Mc(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(F)||[];if(n.isFunction(c))while(d=f[e++])"+"===d.charAt(0)?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function Nc(a,b,c,d){var e={},f=a===Jc;function g(h){var i;return e[h]=!0,n.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||f||e[j]?f?!(i=j):void 0:(b.dataTypes.unshift(j),g(j),!1)}),i}return g(b.dataTypes[0])||!e["*"]&&g("*")}function Oc(a,b){var c,d,e=n.ajaxSettings.flatOptions||{};for(d in b)void 0!==b[d]&&((e[d]?a:c||(c={}))[d]=b[d]);return c&&n.extend(!0,a,c),a}function Pc(a,b,c){var d,e,f,g,h=a.contents,i=a.dataTypes;while("*"===i[0])i.shift(),void 0===e&&(e=a.mimeType||b.getResponseHeader("Content-Type"));if(e)for(g in h)if(h[g]&&h[g].test(e)){i.unshift(g);break}if(i[0]in c)f=i[0];else{for(g in c){if(!i[0]||a.converters[g+" "+i[0]]){f=g;break}d||(d=g)}f=f||d}return f?(f!==i[0]&&i.unshift(f),c[f]):void 0}function Qc(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];f=k.shift();while(f)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(g=j[i+" "+f]||j["* "+f],!g)for(e in j)if(h=e.split(" "),h[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){g===!0?g=j[e]:j[e]!==!0&&(f=h[0],k.unshift(h[1]));break}if(g!==!0)if(g&&a["throws"])b=g(b);else try{b=g(b)}catch(l){return{state:"parsererror",error:g?l:"No conversion from "+i+" to "+f}}}return{state:"success",data:b}}n.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ac,type:"GET",isLocal:Ec.test(zc[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Kc,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":n.parseJSON,"text xml":n.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?Oc(Oc(a,n.ajaxSettings),b):Oc(n.ajaxSettings,a)},ajaxPrefilter:Mc(Ic),ajaxTransport:Mc(Jc),ajax:function(a,b){"object"==typeof a&&(b=a,a=void 0),b=b||{};var c,d,e,f,g,h,i,j,k=n.ajaxSetup({},b),l=k.context||k,m=k.context&&(l.nodeType||l.jquery)?n(l):n.event,o=n.Deferred(),p=n.Callbacks("once memory"),q=k.statusCode||{},r={},s={},t=0,u="canceled",v={readyState:0,getResponseHeader:function(a){var b;if(2===t){if(!j){j={};while(b=Dc.exec(f))j[b[1].toLowerCase()]=b[2]}b=j[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===t?f:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return t||(a=s[c]=s[c]||a,r[a]=b),this},overrideMimeType:function(a){return t||(k.mimeType=a),this},statusCode:function(a){var b;if(a)if(2>t)for(b in a)q[b]=[q[b],a[b]];else v.always(a[v.status]);return this},abort:function(a){var b=a||u;return i&&i.abort(b),x(0,b),this}};if(o.promise(v).complete=p.add,v.success=v.done,v.error=v.fail,k.url=((a||k.url||Ac)+"").replace(Bc,"").replace(Gc,zc[1]+"//"),k.type=b.method||b.type||k.method||k.type,k.dataTypes=n.trim(k.dataType||"*").toLowerCase().match(F)||[""],null==k.crossDomain&&(c=Hc.exec(k.url.toLowerCase()),k.crossDomain=!(!c||c[1]===zc[1]&&c[2]===zc[2]&&(c[3]||("http:"===c[1]?"80":"443"))===(zc[3]||("http:"===zc[1]?"80":"443")))),k.data&&k.processData&&"string"!=typeof k.data&&(k.data=n.param(k.data,k.traditional)),Nc(Ic,k,b,v),2===t)return v;h=k.global,h&&0===n.active++&&n.event.trigger("ajaxStart"),k.type=k.type.toUpperCase(),k.hasContent=!Fc.test(k.type),e=k.url,k.hasContent||(k.data&&(e=k.url+=(xc.test(e)?"&":"?")+k.data,delete k.data),k.cache===!1&&(k.url=Cc.test(e)?e.replace(Cc,"$1_="+wc++):e+(xc.test(e)?"&":"?")+"_="+wc++)),k.ifModified&&(n.lastModified[e]&&v.setRequestHeader("If-Modified-Since",n.lastModified[e]),n.etag[e]&&v.setRequestHeader("If-None-Match",n.etag[e])),(k.data&&k.hasContent&&k.contentType!==!1||b.contentType)&&v.setRequestHeader("Content-Type",k.contentType),v.setRequestHeader("Accept",k.dataTypes[0]&&k.accepts[k.dataTypes[0]]?k.accepts[k.dataTypes[0]]+("*"!==k.dataTypes[0]?", "+Kc+"; q=0.01":""):k.accepts["*"]);for(d in k.headers)v.setRequestHeader(d,k.headers[d]);if(k.beforeSend&&(k.beforeSend.call(l,v,k)===!1||2===t))return v.abort();u="abort";for(d in{success:1,error:1,complete:1})v[d](k[d]);if(i=Nc(Jc,k,b,v)){v.readyState=1,h&&m.trigger("ajaxSend",[v,k]),k.async&&k.timeout>0&&(g=setTimeout(function(){v.abort("timeout")},k.timeout));try{t=1,i.send(r,x)}catch(w){if(!(2>t))throw w;x(-1,w)}}else x(-1,"No Transport");function x(a,b,c,d){var j,r,s,u,w,x=b;2!==t&&(t=2,g&&clearTimeout(g),i=void 0,f=d||"",v.readyState=a>0?4:0,j=a>=200&&300>a||304===a,c&&(u=Pc(k,v,c)),u=Qc(k,u,v,j),j?(k.ifModified&&(w=v.getResponseHeader("Last-Modified"),w&&(n.lastModified[e]=w),w=v.getResponseHeader("etag"),w&&(n.etag[e]=w)),204===a||"HEAD"===k.type?x="nocontent":304===a?x="notmodified":(x=u.state,r=u.data,s=u.error,j=!s)):(s=x,(a||!x)&&(x="error",0>a&&(a=0))),v.status=a,v.statusText=(b||x)+"",j?o.resolveWith(l,[r,x,v]):o.rejectWith(l,[v,x,s]),v.statusCode(q),q=void 0,h&&m.trigger(j?"ajaxSuccess":"ajaxError",[v,k,j?r:s]),p.fireWith(l,[v,x]),h&&(m.trigger("ajaxComplete",[v,k]),--n.active||n.event.trigger("ajaxStop")))}return v},getJSON:function(a,b,c){return n.get(a,b,c,"json")},getScript:function(a,b){return n.get(a,void 0,b,"script")}}),n.each(["get","post"],function(a,b){n[b]=function(a,c,d,e){return n.isFunction(c)&&(e=e||d,d=c,c=void 0),n.ajax({url:a,type:b,dataType:e,data:c,success:d})}}),n.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){n.fn[b]=function(a){return this.on(b,a)}}),n._evalUrl=function(a){return n.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},n.fn.extend({wrapAll:function(a){if(n.isFunction(a))return this.each(function(b){n(this).wrapAll(a.call(this,b))});if(this[0]){var b=n(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstChild&&1===a.firstChild.nodeType)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return this.each(n.isFunction(a)?function(b){n(this).wrapInner(a.call(this,b))}:function(){var b=n(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=n.isFunction(a);return this.each(function(c){n(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){n.nodeName(this,"body")||n(this).replaceWith(this.childNodes)}).end()}}),n.expr.filters.hidden=function(a){return a.offsetWidth<=0&&a.offsetHeight<=0||!l.reliableHiddenOffsets()&&"none"===(a.style&&a.style.display||n.css(a,"display"))},n.expr.filters.visible=function(a){return!n.expr.filters.hidden(a)};var Rc=/%20/g,Sc=/\[\]$/,Tc=/\r?\n/g,Uc=/^(?:submit|button|image|reset|file)$/i,Vc=/^(?:input|select|textarea|keygen)/i;function Wc(a,b,c,d){var e;if(n.isArray(b))n.each(b,function(b,e){c||Sc.test(a)?d(a,e):Wc(a+"["+("object"==typeof e?b:"")+"]",e,c,d)});else if(c||"object"!==n.type(b))d(a,b);else for(e in b)Wc(a+"["+e+"]",b[e],c,d)}n.param=function(a,b){var c,d=[],e=function(a,b){b=n.isFunction(b)?b():null==b?"":b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(void 0===b&&(b=n.ajaxSettings&&n.ajaxSettings.traditional),n.isArray(a)||a.jquery&&!n.isPlainObject(a))n.each(a,function(){e(this.name,this.value)});else for(c in a)Wc(c,a[c],b,e);return d.join("&").replace(Rc,"+")},n.fn.extend({serialize:function(){return n.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=n.prop(this,"elements");return a?n.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!n(this).is(":disabled")&&Vc.test(this.nodeName)&&!Uc.test(a)&&(this.checked||!X.test(a))}).map(function(a,b){var c=n(this).val();return null==c?null:n.isArray(c)?n.map(c,function(a){return{name:b.name,value:a.replace(Tc,"\r\n")}}):{name:b.name,value:c.replace(Tc,"\r\n")}}).get()}}),n.ajaxSettings.xhr=void 0!==a.ActiveXObject?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&$c()||_c()}:$c;var Xc=0,Yc={},Zc=n.ajaxSettings.xhr();a.ActiveXObject&&n(a).on("unload",function(){for(var a in Yc)Yc[a](void 0,!0)}),l.cors=!!Zc&&"withCredentials"in Zc,Zc=l.ajax=!!Zc,Zc&&n.ajaxTransport(function(a){if(!a.crossDomain||l.cors){var b;return{send:function(c,d){var e,f=a.xhr(),g=++Xc;if(f.open(a.type,a.url,a.async,a.username,a.password),a.xhrFields)for(e in a.xhrFields)f[e]=a.xhrFields[e];a.mimeType&&f.overrideMimeType&&f.overrideMimeType(a.mimeType),a.crossDomain||c["X-Requested-With"]||(c["X-Requested-With"]="XMLHttpRequest");for(e in c)void 0!==c[e]&&f.setRequestHeader(e,c[e]+"");f.send(a.hasContent&&a.data||null),b=function(c,e){var h,i,j;if(b&&(e||4===f.readyState))if(delete Yc[g],b=void 0,f.onreadystatechange=n.noop,e)4!==f.readyState&&f.abort();else{j={},h=f.status,"string"==typeof f.responseText&&(j.text=f.responseText);try{i=f.statusText}catch(k){i=""}h||!a.isLocal||a.crossDomain?1223===h&&(h=204):h=j.text?200:404}j&&d(h,i,j,f.getAllResponseHeaders())},a.async?4===f.readyState?setTimeout(b):f.onreadystatechange=Yc[g]=b:b()},abort:function(){b&&b(void 0,!0)}}}});function $c(){try{return new a.XMLHttpRequest}catch(b){}}function _c(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}n.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(a){return n.globalEval(a),a}}}),n.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),n.ajaxTransport("script",function(a){if(a.crossDomain){var b,c=z.head||n("head")[0]||z.documentElement;return{send:function(d,e){b=z.createElement("script"),b.async=!0,a.scriptCharset&&(b.charset=a.scriptCharset),b.src=a.url,b.onload=b.onreadystatechange=function(a,c){(c||!b.readyState||/loaded|complete/.test(b.readyState))&&(b.onload=b.onreadystatechange=null,b.parentNode&&b.parentNode.removeChild(b),b=null,c||e(200,"success"))},c.insertBefore(b,c.firstChild)},abort:function(){b&&b.onload(void 0,!0)}}}});var ad=[],bd=/(=)\?(?=&|$)|\?\?/;n.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=ad.pop()||n.expando+"_"+wc++;return this[a]=!0,a}}),n.ajaxPrefilter("json jsonp",function(b,c,d){var e,f,g,h=b.jsonp!==!1&&(bd.test(b.url)?"url":"string"==typeof b.data&&!(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&bd.test(b.data)&&"data");return h||"jsonp"===b.dataTypes[0]?(e=b.jsonpCallback=n.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(bd,"$1"+e):b.jsonp!==!1&&(b.url+=(xc.test(b.url)?"&":"?")+b.jsonp+"="+e),b.converters["script json"]=function(){return g||n.error(e+" was not called"),g[0]},b.dataTypes[0]="json",f=a[e],a[e]=function(){g=arguments},d.always(function(){a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,ad.push(e)),g&&n.isFunction(f)&&f(g[0]),g=f=void 0}),"script"):void 0}),n.parseHTML=function(a,b,c){if(!a||"string"!=typeof a)return null;"boolean"==typeof b&&(c=b,b=!1),b=b||z;var d=v.exec(a),e=!c&&[];return d?[b.createElement(d[1])]:(d=n.buildFragment([a],b,e),e&&e.length&&n(e).remove(),n.merge([],d.childNodes))};var cd=n.fn.load;n.fn.load=function(a,b,c){if("string"!=typeof a&&cd)return cd.apply(this,arguments);var d,e,f,g=this,h=a.indexOf(" ");return h>=0&&(d=a.slice(h,a.length),a=a.slice(0,h)),n.isFunction(b)?(c=b,b=void 0):b&&"object"==typeof b&&(f="POST"),g.length>0&&n.ajax({url:a,type:f,dataType:"html",data:b}).done(function(a){e=arguments,g.html(d?n("<div>").append(n.parseHTML(a)).find(d):a)}).complete(c&&function(a,b){g.each(c,e||[a.responseText,b,a])}),this},n.expr.filters.animated=function(a){return n.grep(n.timers,function(b){return a===b.elem}).length};var dd=a.document.documentElement;function ed(a){return n.isWindow(a)?a:9===a.nodeType?a.defaultView||a.parentWindow:!1}n.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,j,k=n.css(a,"position"),l=n(a),m={};"static"===k&&(a.style.position="relative"),h=l.offset(),f=n.css(a,"top"),i=n.css(a,"left"),j=("absolute"===k||"fixed"===k)&&n.inArray("auto",[f,i])>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),n.isFunction(b)&&(b=b.call(a,c,h)),null!=b.top&&(m.top=b.top-h.top+g),null!=b.left&&(m.left=b.left-h.left+e),"using"in b?b.using.call(a,m):l.css(m)}},n.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){n.offset.setOffset(this,a,b)});var b,c,d={top:0,left:0},e=this[0],f=e&&e.ownerDocument;if(f)return b=f.documentElement,n.contains(b,e)?(typeof e.getBoundingClientRect!==L&&(d=e.getBoundingClientRect()),c=ed(f),{top:d.top+(c.pageYOffset||b.scrollTop)-(b.clientTop||0),left:d.left+(c.pageXOffset||b.scrollLeft)-(b.clientLeft||0)}):d},position:function(){if(this[0]){var a,b,c={top:0,left:0},d=this[0];return"fixed"===n.css(d,"position")?b=d.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),n.nodeName(a[0],"html")||(c=a.offset()),c.top+=n.css(a[0],"borderTopWidth",!0),c.left+=n.css(a[0],"borderLeftWidth",!0)),{top:b.top-c.top-n.css(d,"marginTop",!0),left:b.left-c.left-n.css(d,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var a=this.offsetParent||dd;while(a&&!n.nodeName(a,"html")&&"static"===n.css(a,"position"))a=a.offsetParent;return a||dd})}}),n.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,b){var c=/Y/.test(b);n.fn[a]=function(d){return W(this,function(a,d,e){var f=ed(a);return void 0===e?f?b in f?f[b]:f.document.documentElement[d]:a[d]:void(f?f.scrollTo(c?n(f).scrollLeft():e,c?e:n(f).scrollTop()):a[d]=e)},a,d,arguments.length,null)}}),n.each(["top","left"],function(a,b){n.cssHooks[b]=Mb(l.pixelPosition,function(a,c){return c?(c=Kb(a,b),Ib.test(c)?n(a).position()[b]+"px":c):void 0})}),n.each({Height:"height",Width:"width"},function(a,b){n.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){n.fn[d]=function(d,e){var f=arguments.length&&(c||"boolean"!=typeof d),g=c||(d===!0||e===!0?"margin":"border");return W(this,function(b,c,d){var e;return n.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(e=b.documentElement,Math.max(b.body["scroll"+a],e["scroll"+a],b.body["offset"+a],e["offset"+a],e["client"+a])):void 0===d?n.css(b,c,g):n.style(b,c,d,g)},b,f?d:void 0,f,null)}})}),n.fn.size=function(){return this.length},n.fn.andSelf=n.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return n});var fd=a.jQuery,gd=a.$;return n.noConflict=function(b){return a.$===n&&(a.$=gd),b&&a.jQuery===n&&(a.jQuery=fd),n},typeof b===L&&(a.jQuery=a.$=n),n});
/*! jQuery Migrate v1.2.1 | (c) 2005, 2013 jQuery Foundation, Inc. and other contributors | jquery.org/license */
jQuery.migrateMute===void 0&&(jQuery.migrateMute=!0),function(e,t,n){function r(n){var r=t.console;i[n]||(i[n]=!0,e.migrateWarnings.push(n),r&&r.warn&&!e.migrateMute&&(r.warn("JQMIGRATE: "+n),e.migrateTrace&&r.trace&&r.trace()))}function a(t,a,i,o){if(Object.defineProperty)try{return Object.defineProperty(t,a,{configurable:!0,enumerable:!0,get:function(){return r(o),i},set:function(e){r(o),i=e}}),n}catch(s){}e._definePropertyBroken=!0,t[a]=i}var i={};e.migrateWarnings=[],!e.migrateMute&&t.console&&t.console.log&&t.console.log("JQMIGRATE: Logging is active"),e.migrateTrace===n&&(e.migrateTrace=!0),e.migrateReset=function(){i={},e.migrateWarnings.length=0},"BackCompat"===document.compatMode&&r("jQuery is not compatible with Quirks Mode");var o=e("<input/>",{size:1}).attr("size")&&e.attrFn,s=e.attr,u=e.attrHooks.value&&e.attrHooks.value.get||function(){return null},c=e.attrHooks.value&&e.attrHooks.value.set||function(){return n},l=/^(?:input|button)$/i,d=/^[238]$/,p=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,f=/^(?:checked|selected)$/i;a(e,"attrFn",o||{},"jQuery.attrFn is deprecated"),e.attr=function(t,a,i,u){var c=a.toLowerCase(),g=t&&t.nodeType;return u&&(4>s.length&&r("jQuery.fn.attr( props, pass ) is deprecated"),t&&!d.test(g)&&(o?a in o:e.isFunction(e.fn[a])))?e(t)[a](i):("type"===a&&i!==n&&l.test(t.nodeName)&&t.parentNode&&r("Can't change the 'type' of an input or button in IE 6/7/8"),!e.attrHooks[c]&&p.test(c)&&(e.attrHooks[c]={get:function(t,r){var a,i=e.prop(t,r);return i===!0||"boolean"!=typeof i&&(a=t.getAttributeNode(r))&&a.nodeValue!==!1?r.toLowerCase():n},set:function(t,n,r){var a;return n===!1?e.removeAttr(t,r):(a=e.propFix[r]||r,a in t&&(t[a]=!0),t.setAttribute(r,r.toLowerCase())),r}},f.test(c)&&r("jQuery.fn.attr('"+c+"') may use property instead of attribute")),s.call(e,t,a,i))},e.attrHooks.value={get:function(e,t){var n=(e.nodeName||"").toLowerCase();return"button"===n?u.apply(this,arguments):("input"!==n&&"option"!==n&&r("jQuery.fn.attr('value') no longer gets properties"),t in e?e.value:null)},set:function(e,t){var a=(e.nodeName||"").toLowerCase();return"button"===a?c.apply(this,arguments):("input"!==a&&"option"!==a&&r("jQuery.fn.attr('value', val) no longer sets properties"),e.value=t,n)}};var g,h,v=e.fn.init,m=e.parseJSON,y=/^([^<]*)(<[\w\W]+>)([^>]*)$/;e.fn.init=function(t,n,a){var i;return t&&"string"==typeof t&&!e.isPlainObject(n)&&(i=y.exec(e.trim(t)))&&i[0]&&("<"!==t.charAt(0)&&r("$(html) HTML strings must start with '<' character"),i[3]&&r("$(html) HTML text after last tag is ignored"),"#"===i[0].charAt(0)&&(r("HTML string cannot start with a '#' character"),e.error("JQMIGRATE: Invalid selector string (XSS)")),n&&n.context&&(n=n.context),e.parseHTML)?v.call(this,e.parseHTML(i[2],n,!0),n,a):v.apply(this,arguments)},e.fn.init.prototype=e.fn,e.parseJSON=function(e){return e||null===e?m.apply(this,arguments):(r("jQuery.parseJSON requires a valid JSON string"),null)},e.uaMatch=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||0>e.indexOf("compatible")&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},e.browser||(g=e.uaMatch(navigator.userAgent),h={},g.browser&&(h[g.browser]=!0,h.version=g.version),h.chrome?h.webkit=!0:h.webkit&&(h.safari=!0),e.browser=h),a(e,"browser",e.browser,"jQuery.browser is deprecated"),e.sub=function(){function t(e,n){return new t.fn.init(e,n)}e.extend(!0,t,this),t.superclass=this,t.fn=t.prototype=this(),t.fn.constructor=t,t.sub=this.sub,t.fn.init=function(r,a){return a&&a instanceof e&&!(a instanceof t)&&(a=t(a)),e.fn.init.call(this,r,a,n)},t.fn.init.prototype=t.fn;var n=t(document);return r("jQuery.sub() is deprecated"),t},e.ajaxSetup({converters:{"text json":e.parseJSON}});var b=e.fn.data;e.fn.data=function(t){var a,i,o=this[0];return!o||"events"!==t||1!==arguments.length||(a=e.data(o,t),i=e._data(o,t),a!==n&&a!==i||i===n)?b.apply(this,arguments):(r("Use of jQuery.fn.data('events') is deprecated"),i)};var j=/\/(java|ecma)script/i,w=e.fn.andSelf||e.fn.addBack;e.fn.andSelf=function(){return r("jQuery.fn.andSelf() replaced by jQuery.fn.addBack()"),w.apply(this,arguments)},e.clean||(e.clean=function(t,a,i,o){a=a||document,a=!a.nodeType&&a[0]||a,a=a.ownerDocument||a,r("jQuery.clean() is deprecated");var s,u,c,l,d=[];if(e.merge(d,e.buildFragment(t,a).childNodes),i)for(c=function(e){return!e.type||j.test(e.type)?o?o.push(e.parentNode?e.parentNode.removeChild(e):e):i.appendChild(e):n},s=0;null!=(u=d[s]);s++)e.nodeName(u,"script")&&c(u)||(i.appendChild(u),u.getElementsByTagName!==n&&(l=e.grep(e.merge([],u.getElementsByTagName("script")),c),d.splice.apply(d,[s+1,0].concat(l)),s+=l.length));return d});var Q=e.event.add,x=e.event.remove,k=e.event.trigger,N=e.fn.toggle,T=e.fn.live,M=e.fn.die,S="ajaxStart|ajaxStop|ajaxSend|ajaxComplete|ajaxError|ajaxSuccess",C=RegExp("\\b(?:"+S+")\\b"),H=/(?:^|\s)hover(\.\S+|)\b/,A=function(t){return"string"!=typeof t||e.event.special.hover?t:(H.test(t)&&r("'hover' pseudo-event is deprecated, use 'mouseenter mouseleave'"),t&&t.replace(H,"mouseenter$1 mouseleave$1"))};e.event.props&&"attrChange"!==e.event.props[0]&&e.event.props.unshift("attrChange","attrName","relatedNode","srcElement"),e.event.dispatch&&a(e.event,"handle",e.event.dispatch,"jQuery.event.handle is undocumented and deprecated"),e.event.add=function(e,t,n,a,i){e!==document&&C.test(t)&&r("AJAX events should be attached to document: "+t),Q.call(this,e,A(t||""),n,a,i)},e.event.remove=function(e,t,n,r,a){x.call(this,e,A(t)||"",n,r,a)},e.fn.error=function(){var e=Array.prototype.slice.call(arguments,0);return r("jQuery.fn.error() is deprecated"),e.splice(0,0,"error"),arguments.length?this.bind.apply(this,e):(this.triggerHandler.apply(this,e),this)},e.fn.toggle=function(t,n){if(!e.isFunction(t)||!e.isFunction(n))return N.apply(this,arguments);r("jQuery.fn.toggle(handler, handler...) is deprecated");var a=arguments,i=t.guid||e.guid++,o=0,s=function(n){var r=(e._data(this,"lastToggle"+t.guid)||0)%o;return e._data(this,"lastToggle"+t.guid,r+1),n.preventDefault(),a[r].apply(this,arguments)||!1};for(s.guid=i;a.length>o;)a[o++].guid=i;return this.click(s)},e.fn.live=function(t,n,a){return r("jQuery.fn.live() is deprecated"),T?T.apply(this,arguments):(e(this.context).on(t,this.selector,n,a),this)},e.fn.die=function(t,n){return r("jQuery.fn.die() is deprecated"),M?M.apply(this,arguments):(e(this.context).off(t,this.selector||"**",n),this)},e.event.trigger=function(e,t,n,a){return n||C.test(e)||r("Global events are undocumented and deprecated"),k.call(this,e,t,n||document,a)},e.each(S.split("|"),function(t,n){e.event.special[n]={setup:function(){var t=this;return t!==document&&(e.event.add(document,n+"."+e.guid,function(){e.event.trigger(n,null,t,!0)}),e._data(this,n,e.guid++)),!1},teardown:function(){return this!==document&&e.event.remove(document,n+"."+e._data(this,n)),!1}}})}(jQuery,window);;jQuery.easing['jswing']=jQuery.easing['swing'];jQuery.extend(jQuery.easing,{def:'easeOutQuad',swing:function(x,t,b,c,d){return jQuery.easing[jQuery.easing.def](x,t,b,c,d);},easeInQuad:function(x,t,b,c,d){return c*(t/=d)*t+b;},easeOutQuad:function(x,t,b,c,d){return-c*(t/=d)*(t-2)+b;},easeInOutQuad:function(x,t,b,c,d){if((t/=d/2)<1)return c/2*t*t+b;return-c/2*((--t)*(t-2)-1)+b;},easeInCubic:function(x,t,b,c,d){return c*(t/=d)*t*t+b;},easeOutCubic:function(x,t,b,c,d){return c*((t=t/d-1)*t*t+1)+b;},easeInOutCubic:function(x,t,b,c,d){if((t/=d/2)<1)return c/2*t*t*t+b;return c/2*((t-=2)*t*t+2)+b;},easeInQuart:function(x,t,b,c,d){return c*(t/=d)*t*t*t+b;},easeOutQuart:function(x,t,b,c,d){return-c*((t=t/d-1)*t*t*t-1)+b;},easeInOutQuart:function(x,t,b,c,d){if((t/=d/2)<1)return c/2*t*t*t*t+b;return-c/2*((t-=2)*t*t*t-2)+b;},easeInQuint:function(x,t,b,c,d){return c*(t/=d)*t*t*t*t+b;},easeOutQuint:function(x,t,b,c,d){return c*((t=t/d-1)*t*t*t*t+1)+b;},easeInOutQuint:function(x,t,b,c,d){if((t/=d/2)<1)return c/2*t*t*t*t*t+b;return c/2*((t-=2)*t*t*t*t+2)+b;},easeInSine:function(x,t,b,c,d){return-c*Math.cos(t/d*(Math.PI/2))+c+b;},easeOutSine:function(x,t,b,c,d){return c*Math.sin(t/d*(Math.PI/2))+b;},easeInOutSine:function(x,t,b,c,d){return-c/2*(Math.cos(Math.PI*t/d)-1)+b;},easeInExpo:function(x,t,b,c,d){return(t==0)?b:c*Math.pow(2,10*(t/d-1))+b;},easeOutExpo:function(x,t,b,c,d){return(t==d)?b+c:c*(-Math.pow(2,-10*t/d)+1)+b;},easeInOutExpo:function(x,t,b,c,d){if(t==0)return b;if(t==d)return b+c;if((t/=d/2)<1)return c/2*Math.pow(2,10*(t-1))+b;return c/2*(-Math.pow(2,-10*--t)+2)+b;},easeInCirc:function(x,t,b,c,d){return-c*(Math.sqrt(1-(t/=d)*t)-1)+b;},easeOutCirc:function(x,t,b,c,d){return c*Math.sqrt(1-(t=t/d-1)*t)+b;},easeInOutCirc:function(x,t,b,c,d){if((t/=d/2)<1)return-c/2*(Math.sqrt(1-t*t)-1)+b;return c/2*(Math.sqrt(1-(t-=2)*t)+1)+b;},easeInElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0)return b;if((t/=d)==1)return b+c;if(!p)p=d*.3;if(a<Math.abs(c)){a=c;var s=p/4;}
else var s=p/(2*Math.PI)*Math.asin(c/a);return-(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b;},easeOutElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0)return b;if((t/=d)==1)return b+c;if(!p)p=d*.3;if(a<Math.abs(c)){a=c;var s=p/4;}
else var s=p/(2*Math.PI)*Math.asin(c/a);return a*Math.pow(2,-10*t)*Math.sin((t*d-s)*(2*Math.PI)/p)+c+b;},easeInOutElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0)return b;if((t/=d/2)==2)return b+c;if(!p)p=d*(.3*1.5);if(a<Math.abs(c)){a=c;var s=p/4;}
else var s=p/(2*Math.PI)*Math.asin(c/a);if(t<1)return-.5*(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b;return a*Math.pow(2,-10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)*.5+c+b;},easeInBack:function(x,t,b,c,d,s){if(s==undefined)s=1.70158;return c*(t/=d)*t*((s+1)*t-s)+b;},easeOutBack:function(x,t,b,c,d,s){if(s==undefined)s=1.70158;return c*((t=t/d-1)*t*((s+1)*t+s)+1)+b;},easeInOutBack:function(x,t,b,c,d,s){if(s==undefined)s=1.70158;if((t/=d/2)<1)return c/2*(t*t*(((s*=(1.525))+1)*t-s))+b;return c/2*((t-=2)*t*(((s*=(1.525))+1)*t+s)+2)+b;},easeInBounce:function(x,t,b,c,d){return c-jQuery.easing.easeOutBounce(x,d-t,0,c,d)+b;},easeOutBounce:function(x,t,b,c,d){if((t/=d)<(1/2.75)){return c*(7.5625*t*t)+b;}else if(t<(2/2.75)){return c*(7.5625*(t-=(1.5/2.75))*t+.75)+b;}else if(t<(2.5/2.75)){return c*(7.5625*(t-=(2.25/2.75))*t+.9375)+b;}else{return c*(7.5625*(t-=(2.625/2.75))*t+.984375)+b;}},easeInOutBounce:function(x,t,b,c,d){if(t<d/2)return jQuery.easing.easeInBounce(x,t*2,0,c,d)*.5+b;return jQuery.easing.easeOutBounce(x,t*2-d,0,c,d)*.5+c*.5+b;}});;function formatedNumberToFloat(price,currencyFormat,currencySign)
{price=price.replace(currencySign,'');if(currencyFormat===1)
return parseFloat(price.replace(',','').replace(' ',''));else if(currencyFormat===2)
return parseFloat(price.replace(' ','').replace(',','.'));else if(currencyFormat===3)
return parseFloat(price.replace('.','').replace(' ','').replace(',','.'));else if(currencyFormat===4)
return parseFloat(price.replace(',','').replace(' ',''));return price;}
function formatNumber(value,numberOfDecimal,thousenSeparator,virgule)
{value=value.toFixed(numberOfDecimal);var val_string=value+'';var tmp=val_string.split('.');var abs_val_string=(tmp.length===2)?tmp[0]:val_string;var deci_string=('0.'+(tmp.length===2?tmp[1]:0)).substr(2);var nb=abs_val_string.length;for(var i=1;i<4;i++)
if(value>=Math.pow(10,(3*i)))
abs_val_string=abs_val_string.substring(0,nb-(3*i))+thousenSeparator+abs_val_string.substring(nb-(3*i));if(parseInt(numberOfDecimal)===0)
return abs_val_string;return abs_val_string+virgule+(deci_string>0?deci_string:'00');}
function formatCurrency(price,currencyFormat,currencySign,currencyBlank)
{var blank='';price=parseFloat(price.toFixed(10));price=ps_round(price,priceDisplayPrecision);if(currencyBlank>0)
blank=' ';if(currencyFormat==1)
return currencySign+blank+formatNumber(price,priceDisplayPrecision,',','.');if(currencyFormat==2)
return(formatNumber(price,priceDisplayPrecision,' ',',')+blank+currencySign);if(currencyFormat==3)
return(currencySign+blank+formatNumber(price,priceDisplayPrecision,'.',','));if(currencyFormat==4)
return(formatNumber(price,priceDisplayPrecision,',','.')+blank+currencySign);if(currencyFormat==5)
return(currencySign+blank+formatNumber(price,priceDisplayPrecision,'\'','.'));return price;}
function ps_round_helper(value,mode)
{if(value>=0.0)
{tmp_value=Math.floor(value+0.5);if((mode==3&&value==(-0.5+tmp_value))||(mode==4&&value==(0.5+2*Math.floor(tmp_value/2.0)))||(mode==5&&value==(0.5+2*Math.floor(tmp_value/2.0)-1.0)))
tmp_value-=1.0;}
else
{tmp_value=Math.ceil(value-0.5);if((mode==3&&value==(0.5+tmp_value))||(mode==4&&value==(-0.5+2*Math.ceil(tmp_value/2.0)))||(mode==5&&value==(-0.5+2*Math.ceil(tmp_value/2.0)+1.0)))
tmp_value+=1.0;}
return tmp_value;}
function ps_log10(value)
{return Math.log(value)/Math.LN10;}
function ps_round_half_up(value,precision)
{var mul=Math.pow(10,precision);var val=value*mul;var next_digit=Math.floor(val*10)-10*Math.floor(val);if(next_digit>=5)
val=Math.ceil(val);else
val=Math.floor(val);return val/mul;}
function ps_round(value,places)
{if(typeof(roundMode)==='undefined')
roundMode=2;if(typeof(places)==='undefined')
places=2;var method=roundMode;if(method===0)
return ceilf(value,places);else if(method===1)
return floorf(value,places);else if(method===2)
return ps_round_half_up(value,places);else if(method==3||method==4||method==5)
{var precision_places=14-Math.floor(ps_log10(Math.abs(value)));var f1=Math.pow(10,Math.abs(places));if(precision_places>places&&precision_places-places<15)
{var f2=Math.pow(10,Math.abs(precision_places));if(precision_places>=0)
tmp_value=value*f2;else
tmp_value=value/f2;tmp_value=ps_round_helper(tmp_value,roundMode);f2=Math.pow(10,Math.abs(places-precision_places));tmp_value/=f2;}
else
{if(places>=0)
tmp_value=value*f1;else
tmp_value=value/f1;if(Math.abs(tmp_value)>=1e15)
return value;}
tmp_value=ps_round_helper(tmp_value,roundMode);if(places>0)
tmp_value=tmp_value/f1;else
tmp_value=tmp_value*f1;return tmp_value;}}
function autoUrl(name,dest)
{var loc;var id_list;id_list=document.getElementById(name);loc=id_list.options[id_list.selectedIndex].value;if(loc!=0)
location.href=dest+loc;return;}
function autoUrlNoList(name,dest)
{var loc;loc=document.getElementById(name).checked;location.href=dest+(loc==true?1:0);return;}
function toggle(e,show)
{e.style.display=show?'':'none';}
function toggleMultiple(tab)
{var len=tab.length;for(var i=0;i<len;i++)
if(tab[i].style)
toggle(tab[i],tab[i].style.display=='none');}
function showElemFromSelect(select_id,elem_id)
{var select=document.getElementById(select_id);for(var i=0;i<select.length;++i)
{var elem=document.getElementById(elem_id+select.options[i].value);if(elem!=null)
toggle(elem,i==select.selectedIndex);}}
function openCloseAllDiv(name,option)
{var tab=$('*[name='+name+']');for(var i=0;i<tab.length;++i)
toggle(tab[i],option);}
function toggleDiv(name,option)
{$('*[name='+name+']').each(function(){if(option=='open')
{$('#buttonall').data('status','close');$(this).hide();}
else
{$('#buttonall').data('status','open');$(this).show();}})}
function toggleButtonValue(id_button,text1,text2)
{if($('#'+id_button).find('i').first().hasClass('process-icon-compress'))
{$('#'+id_button).find('i').first().removeClass('process-icon-compress').addClass('process-icon-expand');$('#'+id_button).find('span').first().html(text1);}
else
{$('#'+id_button).find('i').first().removeClass('process-icon-expand').addClass('process-icon-compress');$('#'+id_button).find('span').first().html(text2);}}
function toggleElemValue(id_button,text1,text2)
{var obj=document.getElementById(id_button);if(obj)
obj.value=((!obj.value||obj.value==text2)?text1:text2);}
function addBookmark(url,title)
{if(window.sidebar&&window.sidebar.addPanel)
return window.sidebar.addPanel(title,url,"");else if(window.external&&('AddFavorite'in window.external))
return window.external.AddFavorite(url,title);}
function writeBookmarkLink(url,title,text,img)
{var insert='';if(img)
insert=writeBookmarkLinkObject(url,title,'<img src="'+img+'" alt="'+escape(text)+'" title="'+removeQuotes(text)+'" />')+'&nbsp';insert+=writeBookmarkLinkObject(url,title,text);if(window.sidebar||window.opera&&window.print||(window.external&&('AddFavorite'in window.external)))
$('.add_bookmark, #header_link_bookmark').append(insert);}
function writeBookmarkLinkObject(url,title,insert)
{if(window.sidebar||window.external)
return('<a href="javascript:addBookmark(\''+escape(url)+'\', \''+removeQuotes(title)+'\')">'+insert+'</a>');else if(window.opera&&window.print)
return('<a rel="sidebar" href="'+escape(url)+'" title="'+removeQuotes(title)+'">'+insert+'</a>');return('');}
function checkCustomizations()
{var pattern=new RegExp(' ?filled ?');if(typeof customizationFields!='undefined')
for(var i=0;i<customizationFields.length;i++)
{if(parseInt(customizationFields[i][1])==1&&($('#'+customizationFields[i][0]).html()==''||$('#'+customizationFields[i][0]).text()!=$('#'+customizationFields[i][0]).val())&&!pattern.test($('#'+customizationFields[i][0]).attr('class')))
return false;}
return true;}
function emptyCustomizations()
{customizationId=null;if(typeof(customizationFields)=='undefined')return;$('.customization_block .success').fadeOut(function(){$(this).remove();});$('.customization_block .error').fadeOut(function(){$(this).remove();});for(var i=0;i<customizationFields.length;i++)
{$('#'+customizationFields[i][0]).html('');$('#'+customizationFields[i][0]).val('');}}
function ceilf(value,precision)
{if(typeof(precision)==='undefined')
precision=0;var precisionFactor=precision===0?1:Math.pow(10,precision);var tmp=value*precisionFactor;var tmp2=tmp.toString();if(tmp2[tmp2.length-1]===0)
return value;return Math.ceil(value*precisionFactor)/precisionFactor;}
function floorf(value,precision)
{if(typeof(precision)==='undefined')
precision=0;var precisionFactor=precision===0?1:Math.pow(10,precision);var tmp=value*precisionFactor;var tmp2=tmp.toString();if(tmp2[tmp2.length-1]===0)
return value;return Math.floor(value*precisionFactor)/precisionFactor;}
function setCurrency(id_currency)
{$.ajax({type:'POST',headers:{"cache-control":"no-cache"},url:baseDir+'index.php'+'?rand='+new Date().getTime(),data:'controller=change-currency&id_currency='+parseInt(id_currency),success:function(msg)
{location.reload(true);}});}
function isArrowKey(k_ev)
{var unicode=k_ev.keyCode?k_ev.keyCode:k_ev.charCode;if(unicode>=37&&unicode<=40)
return true;return false;}
function removeQuotes(value)
{value=value.replace(/\\"/g,'');value=value.replace(/"/g,'');value=value.replace(/\\'/g,'');value=value.replace(/'/g,'');return value;}
function sprintf(format)
{for(var i=1;i<arguments.length;i++)
format=format.replace(/%s/,arguments[i]);return format;}
function fancyMsgBox(msg,title)
{if(title)msg="<h2>"+title+"</h2><p>"+msg+"</p>";msg+="<br/><p class=\"submit\" style=\"text-align:right; padding-bottom: 0\"><input class=\"button\" type=\"button\" value=\"OK\" onclick=\"$.fancybox.close();\" /></p>";if(!!$.prototype.fancybox)
$.fancybox(msg,{'autoDimensions':false,'autoSize':false,'width':500,'height':'auto','openEffect':'none','closeEffect':'none'});}
function fancyChooseBox(question,title,buttons,otherParams)
{var msg,funcName,action;msg='';if(title)
msg="<h2>"+title+"</h2><p>"+question+"</p>";msg+="<br/><p class=\"submit\" style=\"text-align:right; padding-bottom: 0\">";var i=0;for(var caption in buttons){if(!buttons.hasOwnProperty(caption))continue;funcName=buttons[caption];if(typeof otherParams=='undefined')otherParams=0;otherParams=escape(JSON.stringify(otherParams));action=funcName?"$.fancybox.close();window['"+funcName+"'](JSON.parse(unescape('"+otherParams+"')), "+i+")":"$.fancybox.close()";msg+='<button type="submit" class="button btn-default button-medium" style="margin-right: 5px;" value="true" onclick="'+action+'" >';msg+='<span>'+caption+'</span></button>'
i++;}
msg+="</p>";if(!!$.prototype.fancybox)
$.fancybox(msg,{'autoDimensions':false,'width':500,'height':'auto','openEffect':'none','closeEffect':'none'});}
function toggleLayer(whichLayer,flag)
{if(!flag)
$(whichLayer).hide();else
$(whichLayer).show();}
function openCloseLayer(whichLayer,action)
{if(!action)
{if($(whichLayer).css('display')=='none')
$(whichLayer).show();else
$(whichLayer).hide();}
else if(action=='open')
$(whichLayer).show();else if(action=='close')
$(whichLayer).hide();}
function updateTextWithEffect(jQueryElement,text,velocity,effect1,effect2,newClass)
{if(jQueryElement.text()!==text)
{if(effect1==='fade')
jQueryElement.fadeOut(velocity,function(){$(this).addClass(newClass);if(effect2==='fade')$(this).text(text).fadeIn(velocity);else if(effect2==='slide')$(this).text(text).slideDown(velocity);else if(effect2==='show')$(this).text(text).show(velocity,function(){});});else if(effect1==='slide')
jQueryElement.slideUp(velocity,function(){$(this).addClass(newClass);if(effect2==='fade')$(this).text(text).fadeIn(velocity);else if(effect2==='slide')$(this).text(text).slideDown(velocity);else if(effect2==='show')$(this).text(text).show(velocity);});else if(effect1==='hide')
jQueryElement.hide(velocity,function(){$(this).addClass(newClass);if(effect2==='fade')$(this).text(text).fadeIn(velocity);else if(effect2==='slide')$(this).text(text).slideDown(velocity);else if(effect2==='show')$(this).text(text).show(velocity);});}}
function dbg(value)
{var active=false;var firefox=true;if(active)
if(firefox)
console.log(value);else
alert(value);}
function print_r(element,limit,depth)
{depth=depth?depth:0;limit=limit?limit:1;returnString='<ol>';for(property in element)
{if(property!='domConfig')
{returnString+='<li><strong>'+property+'</strong> <small>('+(typeof element[property])+')</small>';if(typeof element[property]=='number'||typeof element[property]=='boolean')
returnString+=' : <em>'+element[property]+'</em>';if(typeof element[property]=='string'&&element[property])
returnString+=': <div style="background:#C9C9C9;border:1px solid black; overflow:auto;"><code>'+
element[property].replace(/</g,'&amp;lt;').replace(/>/g,'&amp;gt;')+'</code></div>';if((typeof element[property]=='object')&&(depth<limit))
returnString+=print_r(element[property],limit,(depth+1));returnString+='</li>';}}
returnString+='</ol>';if(depth==0)
{winpop=window.open("","","width=800,height=600,scrollbars,resizable");winpop.document.write('<pre>'+returnString+'</pre>');winpop.document.close();}
return returnString;}
function in_array(value,array)
{for(var i in array)
if((array[i]+'')===(value+''))
return true;return false;}
function isCleanHtml(content)
{var events='onmousedown|onmousemove|onmmouseup|onmouseover|onmouseout|onload|onunload|onfocus|onblur|onchange';events+='|onsubmit|ondblclick|onclick|onkeydown|onkeyup|onkeypress|onmouseenter|onmouseleave|onerror|onselect|onreset|onabort|ondragdrop|onresize|onactivate|onafterprint|onmoveend';events+='|onafterupdate|onbeforeactivate|onbeforecopy|onbeforecut|onbeforedeactivate|onbeforeeditfocus|onbeforepaste|onbeforeprint|onbeforeunload|onbeforeupdate|onmove';events+='|onbounce|oncellchange|oncontextmenu|oncontrolselect|oncopy|oncut|ondataavailable|ondatasetchanged|ondatasetcomplete|ondeactivate|ondrag|ondragend|ondragenter|onmousewheel';events+='|ondragleave|ondragover|ondragstart|ondrop|onerrorupdate|onfilterchange|onfinish|onfocusin|onfocusout|onhashchange|onhelp|oninput|onlosecapture|onmessage|onmouseup|onmovestart';events+='|onoffline|ononline|onpaste|onpropertychange|onreadystatechange|onresizeend|onresizestart|onrowenter|onrowexit|onrowsdelete|onrowsinserted|onscroll|onsearch|onselectionchange';events+='|onselectstart|onstart|onstop';var script1=/<[\s]*script/im;var script2=new RegExp('('+events+')[\s]*=','im');var script3=/.*script\:/im;var script4=/<[\s]*(i?frame|embed|object)/im;if(script1.test(content)||script2.test(content)||script3.test(content)||script4.test(content))
return false;return true;}
function sleep(milliseconds)
{var start=new Date().getTime();for(var i=0;i<1e7;i++){if((new Date().getTime()-start)>milliseconds){break;}}}
$(document).ready(function()
{$('form').submit(function(){$(this).find('.hideOnSubmit').hide();});$.fn.checkboxChange=function(fnChecked,fnUnchecked){if($(this).prop('checked')&&fnChecked)
fnChecked.call(this);else if(fnUnchecked)
fnUnchecked.call(this);if(!$(this).attr('eventCheckboxChange'))
{$(this).on('change',function(){$(this).checkboxChange(fnChecked,fnUnchecked);});$(this).attr('eventCheckboxChange',true);}};$('a._blank, a.js-new-window').attr('target','_blank');});(function(a){a.fn.filer=function(b){return this.each(function(q,c){var u=a(c),m=".jFiler",d=a(),e=a(),h=a(),i=[],g=a.extend(true,{},a.fn.filer.defaults,b),j={init:function(){u.wrap('<div class="jFiler"></div>');d=u.closest(m);j._changeInput()},_bindInput:function(){if(g.changeInput&&e.size()>0){e.bind("click",j._clickHandler)}u.on({focus:function(){e.addClass("focused")},blur:function(){e.removeClass("focused")},change:function(){j._onChange()}});if(g.dragDrop){(e.length>0?e:u).bind("drop",j._dragDrop.drop).bind("dragover",j._dragDrop.dragEnter).bind("dragleave",j._dragDrop.dragLeave)}if(g.uploadFile&&g.clipBoardPaste){a(window).on("paste",j._clipboardPaste)}},_unbindInput:function(){if(g.changeInput&&e.size()>0){e.unbind("click",j._clickHandler)}},_clickHandler:function(){u.click()},_applyAttrSettings:function(){var n=["name","limit","maxSize","minSize","extensions","changeInput","showThumbs","appendTo","theme","addMore","excludeName","files"];for(var f in n){var l="data-jfiler-"+n[f];if(j._assets.hasAttr(l)){switch(n[f]){case"changeInput":case"showThumbs":case"addMore":g[n[f]]=(["true","false"].indexOf(u.attr(l))>-1?u.attr(l)=="true":u.attr(l));break;case"extensions":g[n[f]]=u.attr(l).replace(/ /g,"").split(",");break;case"files":g[n[f]]=JSON.parse(u.attr(l));break;default:g[n[f]]=u.attr(l)}u.removeAttr(l)}}},_changeInput:function(){j._applyAttrSettings();if(g.theme){d.addClass("jFiler-theme-"+g.theme)}if(u.get(0).tagName.toLowerCase()!="input"&&u.get(0).type!="file"){e=u;u=a('<input type="file" name="'+g.name+'" />');u.css({position:"absolute",left:"-9999px",top:"-9999px","z-index":"-9999"});d.prepend(u);j._isGn=u}else{if(g.changeInput){switch(typeof g.changeInput){case"boolean":e=a('<div class="jFiler-input"><div class="jFiler-input-caption"><span>'+g.captions.feedback+'</span></div><div class="jFiler-input-button">'+g.captions.button+'</div></div>"');break;case"string":case"object":e=a(g.changeInput);break;case"function":e=a(g.changeInput(d,u,g));break}u.after(e);u.css({position:"absolute",left:"-9999px",top:"-9999px","z-index":"-9999"})}}if(!g.limit||(g.limit&&g.limit>=2)){u.attr("multiple","multiple");u.attr("name").slice(-2)!="[]"?u.attr("name",u.attr("name")+"[]"):null}j._bindInput();if(g.files){j._append(false,{files:g.files})}},_clear:function(){j.files=null;if(!g.uploadFile&&!g.addMore){j._reset()}j._set("feedback",(j._itFl&&j._itFl.length>0?j._itFl.length+" "+g.captions.feedback2:g.captions.feedback));g.onEmpty!=null&&typeof g.onEmpty=="function"?g.onEmpty(d,e,u):null},_reset:function(f){if(!f){if(!g.uploadFile&&g.addMore){for(var l=0;l<i.length;l++){i[l].remove()}i=[];j._unbindInput();if(j._isGn){u=j._isGn}else{u=a(c)}j._bindInput()}j._set("input","")}j._itFl=[];j._itFc=null;d.find("input[name^='jfiler-items-exclude-']:hidden").remove();h.fadeOut("fast",function(){a(this).remove()});h=a()},_set:function(f,l){switch(f){case"input":u.val("");break;case"feedback":if(e.length>0){e.find(".jFiler-input-caption span").html(l)}break}},_filesCheck:function(){var p=0;if(g.limit&&j.files.length+j._itFl.length>g.limit){alert(j._assets.textParse(g.captions.errors.filesLimit));return false}for(var o=0;o<j.files.length;o++){var l=j.files[o].name.split(".").pop().toLowerCase(),n=j.files[o],f={name:n.name,size:n.size,size2:j._assets.bytesToSize(n.size),type:n.type,ext:l};if(g.extensions!=null&&a.inArray(l,g.extensions)==-1){alert(j._assets.textParse(g.captions.errors.filesType,f));return false;break}if(g.maxSize!=null&&j.files[o].size>g.maxSize*1048576){alert(j._assets.textParse(g.captions.errors.filesSize,f));return false;break}if(g.minSize!=null&&j.files[o].size<g.minSize*1048576){alert(j._assets.textParse(g.captions.errors.filesSizeMin,f));return false;break}if(n.size==4096&&n.type.length==0){return false;break}p+=j.files[o].size}if(g.maxSize!=null&&p>=Math.round(g.maxSize*1048576)){alert(j._assets.textParse(g.captions.errors.filesSizeAll));return false}if(g.minSize!=null&&p<Math.round(g.minSize*1048576)){alert(j._assets.textParse(g.captions.errors.filesSizeMin));return false}if((g.addMore||g.uploadFile)){var f=j._itFl.filter(function(s,r){if(s.file.name==n.name&&s.file.size==n.size&&s.file.type==n.type&&(n.lastModified?s.file.lastModified==n.lastModified:true)){return true}});if(f.length>0){return false}}return true},_thumbCreator:{create:function(r){var p=j.files[r],n=(j._itFc?j._itFc.id:r),l=p.name,w=p.size,v=p.type.split("/",1).toString().toLowerCase(),o=l.indexOf(".")!=-1?l.split(".").pop().toLowerCase():"",t=g.uploadFile?'<div class="jFiler-jProgressBar">'+g.templates.progressBar+"</div>":"",f={id:n,name:l,size:w,size2:j._assets.bytesToSize(w),type:v,extension:o,icon:j._assets.getIcon(o,v),icon2:j._thumbCreator.generateIcon({type:v,extension:o}),image:'<div class="jFiler-item-thumb-image fi-loading"></div>',progressBar:t,_appended:p._appended},s="";
if(p.opts){f=a.extend({},p.opts,f)}s=a(j._thumbCreator.renderContent(f)).attr("data-jfiler-index",n);s.get(0).jfiler_id=n;j._thumbCreator.renderFile(p,s,f);if(p.forList){return s}j._itFc.html=s;s.hide()[g.templates.itemAppendToEnd?"appendTo":"prependTo"](h.find(g.templates._selectors.list)).show();if(!p._appended){j._onSelect(r)}},renderContent:function(f){return j._assets.textParse((f._appended?g.templates.itemAppend:g.templates.item),f)},renderFile:function(n,l,p){if(l.find(".jFiler-item-thumb-image").size()==0){return false}if(n.file&&p.type=="image"){var o='<img src="'+n.file+'" draggable="false" />',f=l.find(".jFiler-item-thumb-image.fi-loading");a(o).error(function(){o=j._thumbCreator.generateIcon(p);l.addClass("jFiler-no-thumbnail");f.removeClass("fi-loading").html(o)}).load(function(){f.removeClass("fi-loading").html(o)});return true}if(window.File&&window.FileList&&window.FileReader&&p.type=="image"){var r=new FileReader;r.onload=function(v){var t='<img src="'+v.target.result+'" draggable="false" />',s=l.find(".jFiler-item-thumb-image.fi-loading");a(t).error(function(){t=j._thumbCreator.generateIcon(p);l.addClass("jFiler-no-thumbnail");s.removeClass("fi-loading").html(t)}).load(function(){s.removeClass("fi-loading").html(t)})};r.readAsDataURL(n)}else{var o=j._thumbCreator.generateIcon(p),f=l.find(".jFiler-item-thumb-image.fi-loading");l.addClass("jFiler-no-thumbnail");f.removeClass("fi-loading").html(o)}},generateIcon:function(p){var f=new Array(3);if(p&&p.type&&p.extension){switch(p.type){case"image":f[0]="f-image";f[1]='<i class="icon-jfi-file-image"></i>';break;case"video":f[0]="f-video";f[1]='<i class="icon-jfi-file-video"></i>';break;case"audio":f[0]="f-audio";f[1]='<i class="icon-jfi-file-audio"></i>';break;default:f[0]="f-file f-file-ext-"+p.extension;f[1]=(p.extension.length>0?"."+p.extension:"");f[2]=1}}else{f[0]="f-file";f[1]=(p.extension&&p.extension.length>0?"."+p.extension:"");f[2]=1}var o='<span class="jFiler-icon-file '+f[0]+'">'+f[1]+"</span>";if(f[2]==1){var r=j._assets.text2Color(p.extension);if(r){var l=a(o).appendTo("body"),n=l.css("box-shadow");n=r+n.substring(n.replace(/^.*(rgba?\([^)]+\)).*$/,"$1").length,n.length);l.css({"-webkit-box-shadow":n,"-moz-box-shadow":n,"box-shadow":n});o=l.prop("outerHTML");l.remove()}}return o},_box:function(n){if(g.beforeShow!=null&&typeof g.beforeShow=="function"?!g.beforeShow(j.files,h,d,e,u):false){return false}if(h.length<1){if(g.appendTo){var f=a(g.appendTo)}else{var f=d}f.find(".jFiler-items").remove();h=a('<div class="jFiler-items jFiler-row"></div>');h.append(j._assets.textParse(g.templates.box)).appendTo(f);h.on("click",g.templates._selectors.remove,function(p){p.preventDefault();var o=g.templates.removeConfirmation?confirm(g.captions.removeConfirmation):true;if(o){j._remove(n?n.remove.event:p,n?n.remove.el:a(this).closest(g.templates._selectors.item))}})}for(var l=0;l<j.files.length;l++){j._addToMemory(l);j._thumbCreator.create(l)}}},_upload:function(f){var l=j._itFc.html,n=new FormData();n.append(u.attr("name"),j._itFc.file,(j._itFc.file.name?j._itFc.file.name:false));if(g.uploadFile.data!=null&&a.isPlainObject(g.uploadFile.data)){for(k in g.uploadFile.data){n.append(k,g.uploadFile.data[k])}}j._ajax.send(l,n,j._itFc)},_ajax:{send:function(f,l,n){n.ajax=a.ajax({url:g.uploadFile.url,data:l,type:g.uploadFile.type,enctype:g.uploadFile.enctype,xhr:function(){var o=a.ajaxSettings.xhr();if(o.upload){o.upload.addEventListener("progress",function(p){j._ajax.progressHandling(p,f)},false)}return o},complete:function(){n.ajax=false},beforeSend:function(p,o){return g.uploadFile.beforeSend!=null&&typeof g.uploadFile.beforeSend=="function"?g.uploadFile.beforeSend(f,h,d,e,u,p,o):true},success:function(p,r,o){n.uploaded=true;g.uploadFile.success!=null&&typeof g.uploadFile.success=="function"?g.uploadFile.success(p,f,h,d,e,u,r,o):null},error:function(o,r,p){n.uploaded=false;g.uploadFile.error!=null&&typeof g.uploadFile.error=="function"?g.uploadFile.error(f,h,d,e,u,o,r,p):null},statusCode:g.uploadFile.statusCode,cache:false,contentType:false,processData:false});return n.ajax},progressHandling:function(n,l){if(n.lengthComputable){var f=Math.round(n.loaded*100/n.total).toString();g.uploadFile.onProgress!=null&&typeof g.uploadFile.onProgress=="function"?g.uploadFile.onProgress(f,l,h,d,e,u):null;l.find(".jFiler-jProgressBar").find(g.templates._selectors.progressBar).css("width",f+"%")}}},_dragDrop:{dragEnter:function(f){f.preventDefault();f.stopPropagation();d.addClass("dragged");j._set("feedback",g.captions.drop);g.dragDrop.dragEnter!=null&&typeof g.dragDrop.dragEnter=="function"?g.dragDrop.dragEnter(f,e,u,d):null},dragLeave:function(f){f.preventDefault();f.stopPropagation();if(!j._dragDrop._dragLeaveCheck(f)){return false}d.removeClass("dragged");j._set("feedback",g.captions.feedback);g.dragDrop.dragLeave!=null&&typeof g.dragDrop.dragLeave=="function"?g.dragDrop.dragLeave(f,e,u,d):null},drop:function(f){f.preventDefault();d.removeClass("dragged");if(!f.originalEvent.dataTransfer.files||f.originalEvent.dataTransfer.files.length<=0){return
}j._set("feedback",g.captions.feedback);j._onChange(f,f.originalEvent.dataTransfer.files);g.dragDrop.drop!=null&&typeof g.dragDrop.drop=="function"?g.dragDrop.drop(f.originalEvent.dataTransfer.files,f,e,u,d):null},_dragLeaveCheck:function(n){var l=n.relatedTarget,f=false;if(l!==e){if(l){f=a.contains(e,l)}if(f){return false}}return true}},_clipboardPaste:function(r,n){if(!n&&(!r.originalEvent.clipboardData&&!r.originalEvent.clipboardData.items)){return}if(n&&(!r.originalEvent.dataTransfer&&!r.originalEvent.dataTransfer.items)){return}if(j._clPsePre){return}var l=(n?r.originalEvent.dataTransfer.items:r.originalEvent.clipboardData.items),p=function(D,C,v){C=C||"";v=v||512;var y=atob(D);var A=[];for(var w=0;w<y.length;w+=v){var B=y.slice(w,w+v);var z=new Array(B.length);for(var x=0;x<B.length;x++){z[x]=B.charCodeAt(x)}var t=new Uint8Array(z);A.push(t)}var s=new Blob(A,{type:C});return s};if(l){for(var o=0;o<l.length;o++){if(l[o].type.indexOf("image")!==-1||l[o].type.indexOf("text/uri-list")!==-1){if(n){try{window.atob(r.originalEvent.dataTransfer.getData("text/uri-list").toString().split(",")[1])}catch(r){return}}var f=(n?p(r.originalEvent.dataTransfer.getData("text/uri-list").toString().split(",")[1],"image/png"):l[o].getAsFile());f.name=Math.random().toString(36).substring(5);f.name+=f.type.indexOf("/")!=-1?"."+f.type.split("/")[1].toString().toLowerCase():".png";j._onChange(r,[f]);j._clPsePre=setTimeout(function(){delete j._clPsePre},1000)}}}},_onSelect:function(f){if(g.uploadFile&&!a.isEmptyObject(g.uploadFile)){j._upload(f)}g.onSelect!=null&&typeof g.onSelect=="function"?g.onSelect(j.files[f],j._itFc.html,h,d,e,u):null;if(f+1>=j.files.length){g.afterShow!=null&&typeof g.afterShow=="function"?g.afterShow(h,d,e,u):null}},_onChange:function(o,p){if(!p){if(!u.get(0).files||typeof u.get(0).files=="undefined"||u.get(0).files.length==0){if(!g.uploadFile&&!g.addMore){j._set("input","");j._clear()}return false}j.files=u.get(0).files}else{if(!p||p.length==0){j._set("input","");j._clear();return false}j.files=p}if(!g.uploadFile&&!g.addMore){j._reset(true)}if(!j._filesCheck()){j._set("input","");j._clear();return false}j._set("feedback",j.files.length+j._itFl.length+" "+g.captions.feedback2);if(g.showThumbs){j._thumbCreator._box()}else{for(var l=0;l<j.files.length;l++){j._addToMemory(l);j._onSelect(l)}}if(!g.uploadFile&&g.addMore){var n=a('<input type="file" />');var f=u.prop("attributes");a.each(f,function(){n.attr(this.name,this.value)});u.after(n);j._unbindInput();i.push(n);u=n;j._bindInput()}},_append:function(o,n){var l=(!n?false:n.files);if(!l||l.length<=0){return}j.files=l;if(g.showThumbs){for(var f=0;f<j.files.length;f++){j.files[f]._appended=true}j._thumbCreator._box()}},_getList:function(p,o){var n=(!o?false:o.files);if(!n||n.length<=0){return}j.files=n;if(g.showThumbs){var l=[];for(var f=0;f<j.files.length;f++){j.files[f].forList=true;l.push(j._thumbCreator.create(f))}if(o.callback){o.callback(l,h,d,e,u)}}},_remove:function(p,n){if(n.binded){if(n.data.id){n=h.find(g.templates._selectors.item+"[data-jfiler-index='"+n.data.id+"']");if(n.size()==0){return false}}if(n.data.el){n=n.data.el}}var o=n.get(0).jfiler_id||n.attr("data-jfiler-index"),s=null,f=function(x){var t=d.find("input[name^='jfiler-items-exclude-']:hidden").first(),v=j._itFl[x].file,w=[];if(t.size()==0){t=a('<input type="hidden" name="jfiler-items-exclude-'+(g.excludeName?g.excludeName:(u.attr("name").slice(-2)!="[]"?u.attr("name"):u.attr("name").substring(0,u.attr("name").length-2))+"-"+q)+'">');t.appendTo(d)}else{w=JSON.parse(t.val())}w.push(v.name);w=JSON.stringify(w);t.val(w)},r=function(t,v){f(v);j._itFl.splice(v,1);if(j._itFl.length<1){j._reset();j._clear()}else{j._set("feedback",j._itFl.length+" "+g.captions.feedback2)}t.fadeOut("fast",function(){a(this).remove()})};for(var l in j._itFl){if(l==="length"||!j._itFl.hasOwnProperty(l)){continue}if(j._itFl[l].id==o){s=l}}if(!j._itFl.hasOwnProperty(s)){return false}if(j._itFl[s].ajax){j._itFl[s].ajax.abort();r(n,s);return}g.onRemove!=null&&typeof g.onRemove=="function"?g.onRemove(n,j._itFl[s].file,s,h,d,e,u):null;r(n,s)},_addToMemory:function(f){j._itFl.push({id:j._itFl.length,file:j.files[f],html:a(),ajax:false,uploaded:false});j._itFc=j._itFl[j._itFl.length-1]},_assets:{bytesToSize:function(f){if(f==0){return"0 Byte"}var l=1000;var o=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"];var n=Math.floor(Math.log(f)/Math.log(l));return(f/Math.pow(l,n)).toPrecision(3)+" "+o[n]},hasAttr:function(f,n){var n=(!n?u:n),l=n.attr(f);if(!l||typeof l=="undefined"){return false}else{return true}},getIcon:function(n,l){var f=["audio","image","text","video"];if(a.inArray(l,f)>-1){return'<i class="icon-jfi-file-'+l+" jfi-file-ext-"+n+'"></i>'}return'<i class="icon-jfi-file-o jfi-file-type-'+l+" jfi-file-ext-"+n+'"></i>'},textParse:function(l,f){f=a.extend({},{limit:g.limit,maxSize:g.maxSize,minSize:g.minSize},(f&&a.isPlainObject(f)?f:{}));switch(typeof(l)){case"string":return l.replace(/\{\{fi-(.*?)\}\}/g,function(o,n){n=n.replace(/ /g,"");
if(n.match(/(.*?)\|limitTo\:(\d+)/)){return n.replace(/(.*?)\|limitTo\:(\d+)/,function(s,r,p){var r=(f[r]?f[r]:""),t=r.substring(0,p);t=(r.length>t.length?t.substring(0,t.length-3)+"...":t);return t})}else{return(f[n]?f[n]:"")}});break;case"function":return l(f);break;default:return l}},text2Color:function(o){if(!o||o.length==0){return false}for(var f=0,n=0;f<o.length;n=o.charCodeAt(f++)+((n<<5)-n)){}for(var f=0,l="#";f<3;l+=("00"+((n>>f++*2)&255).toString(16)).slice(-2)){}return l}},files:null,_itFl:[],_itFc:null};j.init();u.on("filer.append",function(l,f){j._append(l,f)});u.on("filer.remove",function(l,f){f.binded=true;j._remove(l,f)});u.on("filer.reset",function(f){j._reset();j._clear();return true});u.on("filer.generateList",function(l,f){return j._getList(l,f)});return this})};a.fn.filer.defaults={limit:null,maxSize:null,minSize:null,extensions:null,changeInput:true,showThumbs:false,appendTo:null,theme:null,templates:{box:null,item:null,itemAppend:null,progressBar:null,itemAppendToEnd:false,removeConfirmation:true,_selectors:{list:null,item:null,progressBar:null,remove:null}},files:null,uploadFile:null,dragDrop:null,addMore:false,clipBoardPaste:true,excludeName:null,beforeShow:null,onSelect:null,afterShow:null,onRemove:null,onEmpty:null,captions:{button:"Choose Files",feedback:"Choose files To Upload",feedback2:"files were chosen",drop:"Drop file here to Upload",removeConfirmation:"Are you sure you want to remove this file?",errors:{filesLimit:"Only {{fi-limit}} files are allowed to be uploaded.",filesType:"Only Images are allowed to be uploaded.",filesSize:"{{fi-name}} is too large! Please upload file up to {{fi-maxSize}} MB.",filesSizeMin:"{{fi-name}} is too small! Please upload file min {{fi-minSize}} MB.",filesSizeAll:"Files you've choosed are too large! Please upload files up to {{fi-maxSize}} MB."}}}})(jQuery);;$(document).ready(function(){$('#home-page-tabs li:first, #index .tab-content ul:first').addClass('active');var showChar=90;var ellipsestext="...";var moretext="selengkapnya";var lesstext="sembunyikan";$('.more').each(function(){var content=$(this).html();if(content.length>showChar){var c=content.substr(0,showChar);var h=content.substr(showChar,content.length-showChar);var html=c+'<span class="moreellipses">'+ellipsestext+'&nbsp;</span><span class="morecontent"><span>'+h+'</span>&nbsp;&nbsp;<a href="" class="morelink">'+moretext+'</a></span>';$(this).html(html);}});$(".morelink").click(function(){if($(this).hasClass("less")){$(this).removeClass("less");$(this).html(moretext);}else{$(this).addClass("less");$(this).html(lesstext);}
$(this).parent().prev().toggle();$(this).prev().toggle();return false;});size_li=$("#newlistproduct a").size();x=8;y=2;clicky=0;$('#newlistproduct a:lt('+x+')').show();$('#newlistproduct .row:lt('+y+')').show();$('#loadMore').click(function(){clicky++;z=2+clicky;x=(x+4<=size_li)?x+4:size_li;$('#newlistproduct .row:lt('+z+')').show();$('#newlistproduct a:lt('+x+')').show();if(x>=size_li){$('#loadMore').hide();}});size_cat=$("#categorylist .catlistdata").size();y=6;$('#categorylist .catlistdata:lt('+y+')').show();$('#loadMoreCat').click(function(){y=(y+3<=size_cat)?y+3:size_cat;$('#categorylist .catlistdata:lt('+y+')').show();if(y>=size_cat){$('#loadMoreCat').hide();}});var $itemmini=$('#minicarousel .item');var $mHeight=180;$itemmini.eq(0).addClass('active');$itemmini.height($mHeight);$('.header-minibanner-container').css({'background-color':$("#minicarousel .active").attr('dir')});$('#minicarousel img').each(function(){var $src=$(this).attr('src');var $dir=$(this).attr('dir');$(this).parent().css({'background-image':'url('+$src+')','background-position':'top','background-color':$dir});$(this).remove();});$('#minicarousel').carousel({interval:10000,pause:"true"});$("#minicarousel").bind("slid",function(){$('.header-minibanner-container').css({'background-color':$("#minicarousel .active").attr('dir')});})
if($('#customers-testimonials').length>0){$('#customers-testimonials').owlCarousel({loop:true,center:true,items:5,margin:0,autoplay:true,dots:true,autoplayTimeout:10000,smartSpeed:450,responsive:{0:{items:1},768:{items:2},1170:{items:3},1600:{items:5}}});}});;var responsiveflag=false;var t_eque=new Array;var eque=new Array;var last_price;var result;(function(d,e,j,h,f,c,b){d.GoogleAnalyticsObject=f;d[f]=d[f]||function(){(d[f].q=d[f].q||[]).push(arguments)},d[f].l=1*new Date();c=e.createElement(j),b=e.getElementsByTagName(j)[0];c.async=1;c.src=h;b.parentNode.insertBefore(c,b)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga");ga("create","UA-96803395-1","auto");ga("send","pageview");$(document).ready(function(){highdpiInit();responsiveResize();$(window).resize(responsiveResize);if($('#lp-testimonials').length>0){$('#lp-testimonials').owlCarousel({loop:true,center:true,singleItem:true,items:1,nav:true,autoplay:true,autoplayTimeout:10000,smartSpeed:750,navText:['<i class="fa fa-angle-left" aria-hidden="true"></i>','<i class="fa fa-angle-right" aria-hidden="true"></i>']});}
if($('a.lp-portofolio').length>0){$('a.lp-portofolio').fancybox({'hideOnContentClick':true,'openEffect':'elastic','closeEffect':'elastic'});}
if(typeof quickView!=='undefined'&&quickView)
quick_view();dropDown();if(typeof page_name!='undefined'&&!in_array(page_name,['index','product']))
{bindGrid();$(document).on('change','.selectProductSort',function(e){if(typeof request!='undefined'&&request)
var requestSortProducts=request;var splitData=$(this).val().split(':');var url='';if(typeof requestSortProducts!='undefined'&&requestSortProducts)
{url+=requestSortProducts;if(typeof splitData[0]!=='undefined'&&splitData[0])
{url+=(requestSortProducts.indexOf('?')<0?'?':'&')+'orderby='+splitData[0]+(splitData[1]?'&orderway='+splitData[1]:'');if(typeof splitData[1]!=='undefined'&&splitData[1])
url+='&orderway='+splitData[1];}
document.location.href=url;}});$(document).on('change','select[name="n"]',function(){$(this.form).submit();});$(document).on('change','select[name="currency_payment"]',function(){setCurrency($(this).val());});}
$(document).on('change','select[name="manufacturer_list"], select[name="supplier_list"]',function(){if(this.value!='')
location.href=this.value;});$(document).on('click','.back',function(e){e.preventDefault();history.back();});jQuery.curCSS=jQuery.css;if(!!$.prototype.cluetip)
$('a.cluetip').cluetip({local:true,cursor:'pointer',dropShadow:false,dropShadowSteps:0,showTitle:false,tracking:true,sticky:false,mouseOutClose:true,fx:{open:'fadeIn',openSpeed:'fast'}}).css('opacity',0.8);if(!!$.prototype.fancybox)
$.extend($.fancybox.defaults.tpl,{closeBtn:'<a title="'+FancyboxI18nClose+'" class="fancybox-item fancybox-close" href="javascript:;"></a>',next:'<a title="'+FancyboxI18nNext+'" class="fancybox-nav fancybox-next" href="javascript:;"><span></span></a>',prev:'<a title="'+FancyboxI18nPrev+'" class="fancybox-nav fancybox-prev" href="javascript:;"><span></span></a>'});$(".alert.alert-danger").on('click',this,function(e){$(this).fadeOut();});$("#footer-product-slider").lightSlider({loop:true,auto:true,keyPress:true,pager:false,controls:false,speed:1000,pause:10000,item:12});$("#header-product-slider").lightSlider({loop:true,auto:false,keyPress:true,pager:false,controls:false,speed:1000,pause:10000,item:6});$(document).on('click','.header_row nav a',function(e){var group_box=$(this).attr('href').replace('#','');$('.header_row nav').find('li').removeClass('active');$(this).parent().addClass('active');$('.header_row .group_items div.container').removeClass('active');$('.header_row .group_items div.container.'+group_box).addClass('active');});$('#orderaja').click(function(event){event.stopPropagation();$('html, body').animate({scrollTop:$("#topProduct").offset().top},2000);});$("#accordion").collapse();$(".mega-dropdown").hover(function(){$('.dropdown-menu',this).not('.in .dropdown-menu').stop(true,true).slideDown("400");$(this).toggleClass('open');},function(){$('.dropdown-menu',this).not('.in .dropdown-menu').stop(true,true).slideUp("400");$(this).toggleClass('open');});$('#header-products-select').click(function(event){event.stopPropagation();$(this).addClass('active')});$('#header-products-select a').click(function(event){if($(this).hasClass('nav_group')){event.preventDefault();$('#header-products-select').find('li').removeClass('active');$(this).parent().addClass('active');}else{$('#header-products-select').removeClass('active');$(this).closest('ul').find('li').removeClass('active');$(this).parent().addClass('active');}});$(this).on('click touchstart',function(e){$('#header-products-select').removeClass('active');});$(this).on('click touchstart','#popupBox, #coupon_bt, #header-products-select, .eventpPopupBox',function(e){e.stopPropagation();});$(".tentang-content-row").on("click",function(){$(this).toggleClass("tentang-content-row-open");});$(".tentang-content-row div").click(function(e){e.stopPropagation();});$(document).on('click  touchstart',"#testi_client ul li a",function(e){t=$(this).attr("id");if(t=="")return false;$(".testi").hide();$(this).next(".testi").show();switch(t){case"dt-1":$("#testi_arrow").css("margin-left","-435px");break;case"dt-2":$("#testi_arrow").css("margin-left","-275px");break;case"dt-3":$("#testi_arrow").css("margin-left","-105px");break;case"dt-4":$("#testi_arrow").css("margin-left","75px");break;case"dt-5":$("#testi_arrow").css("margin-left","245px");break;case"dt-6":$("#testi_arrow").css("margin-left","395px");break;}
e.preventDefault();});$('.tahap_tab a').eq(0).addClass('active current');$(document).on('click touchstart','.tahap_tab a',function(e){e.preventDefault();var thisIndex=$(this).parents('li').index(),barW=700/3;$('.tahap_tab a').removeClass('active').removeClass('current');tabActive(thisIndex);$(this).addClass('current');$('.tahap_tab .bgline div').animate({'width':barW*thisIndex},400,'linear');$('.tahap_tab_content').find('.active').removeClass('active');$('.tahap_tab_content').find('.tab_content').eq(thisIndex).addClass('active');});function tabActive(cIndex){while(cIndex>=0){$('.tahap_tab').find('li').eq(cIndex).find('a').addClass('active');cIndex--;}}
$(".designPortfolioNav a").first().addClass("active");$(".designPortfolioTab div").first().addClass("active");$(document).on('click touchstart','.designPortfolioNav a',function(e){event.preventDefault();$(".designPortfolioNav a.active").removeClass("active");$(".designPortfolioTab div.active").removeClass("active");$(this).addClass("active");var tab=$(this).attr("href").replace("#",".");$(tab).addClass('active');$(tab).fadeIn();});$(document).on('click touchstart','.detail_order',function(e){e.preventDefault();var id=$(this).attr("id");var inis=id.split("_");var id_detail="detail_"+inis[1];if($('#'+id_detail).css('display')=='none'){$("#"+id_detail).slideDown("slow");}else{$("#"+id_detail).slideUp();}});$(document).on('click touchstart','.pickorder',function(e){e.preventDefault();$("#mpickmanualorder").css("display","block");});$(document).on('click touchstart','.close_mpickmanualorder',function(e){e.preventDefault();$("#mpickmanualorder").css("display","none");});$("#formManual").submit(function(e){e.preventDefault();var url_name=$("#mofile").val();if(url_name&&url_name!=''){$.ajax({type:'POST',url:baseUri+"webservice/json.php",data:$('#formManual').serialize()+"&act=savemn",success:function(data){$("#mpickmanualorder").css("display","none");document.getElementById("formManual").reset();alert("Form Order telah kami terima, Customer Service kami akan segera menghubungi anda.\n\nTerima Kasih");location.reload();}});}else{alert("Silahkan unggah file artwork terlebih dahulu.\n\nTerima Kasih");}});$("#mofiles_upload").filer({limit:1,maxSize:12,extensions:Array('jpg','png','jpeg','psd','eps','tiff','ai','pdf'),changeInput:'<div class="jFiler-input-dragDrop"><div class="jFiler-input-inner"><a class="jFiler-input-choose-btn blue"><img src="https://printyuk.com/img/options/atc/fileUpload.png"> Browse Your Artwork File</a></div></div>',showThumbs:true,theme:"dragdropbox",appendTo:$('#viewUploadFiler'),templates:{box:'<ul class="jFiler-items-list jFiler-items-grid"></ul>',item:'<li class="jFiler-item">\
      <div class="jFiler-item-container">\
       <div class="jFiler-item-inner">\
        <div class="jFiler-item-thumb">\
         <div class="jFiler-item-status"></div>\
         <div class="jFiler-item-thumb-overlay">\
          <div class="jFiler-item-info">\
           <div style="display:table-cell;vertical-align: middle;">\
            <span class="jFiler-item-title"><b title="{{fi-name}}">{{fi-name}}</b></span>\
            <span class="jFiler-item-others">{{fi-size2}}</span>\
           </div>\
          </div>\
         </div>\
         {{fi-image}}\
        </div>\
        <div class="jFiler-item-assets jFiler-row">\
         <ul class="list-inline pull-left">\
          <li>{{fi-progressBar}}</li>\
         </ul>\
         <ul class="list-inline pull-right">\
          <li><a class="icon-jfi-trash jFiler-item-trash-action"></a></li>\
         </ul>\
        </div>\
       </div>\
      </div>\
     </li>',itemAppend:'',progressBar:'<div class="bar"></div>',itemAppendToEnd:false,canvasImage:true,removeConfirmation:true,_selectors:{list:'.jFiler-items-list',item:'.jFiler-item',progressBar:'.bar',remove:'.jFiler-item-trash-action'}},dragDrop:{dragEnter:null,dragLeave:null,drop:null,dragContainer:null,},uploadFile:{url:baseUri+"webservice/file_upload.php",data:null,type:'POST',enctype:'multipart/form-data',synchron:true,beforeSend:function(){},success:function(data,itemEl,listEl,boxEl,newInputEl,inputEl,id){var parent=itemEl.find(".jFiler-jProgressBar").parent();new_file_name=JSON.parse(data);$("#mofile").val(baseUri+"artwork/"+new_file_name);itemEl.find(".jFiler-jProgressBar").fadeOut("slow",function(){$("<div class=\"jFiler-item-others text-success\"><i class=\"icon-jfi-check-circle\"></i> Success</div>").hide().appendTo(parent).fadeIn("slow");});},error:function(el){var parent=el.find(".jFiler-jProgressBar").parent();el.find(".jFiler-jProgressBar").fadeOut("slow",function(){$("<div class=\"jFiler-item-others text-error\"><i class=\"icon-jfi-minus-circle\"></i> Error</div>").hide().appendTo(parent).fadeIn("slow");});},statusCode:null,onProgress:null,onComplete:function(data,itemEl,listEl,boxEl,newInputEl,inputEl,id){var file_type=new_file_name.substr(new_file_name.lastIndexOf('.')).toLowerCase();},},files:null,addMore:false,allowDuplicates:true,clipBoardPaste:true,excludeName:null,beforeRender:function(listEl,parentEl,newInputEl,inputEl){$("#uniform-mofiles_upload").css("display","none");},afterRender:function(listEl,parentEl,newInputEl,inputEl){$("#uniform-mofiles_upload").css("display","none");},beforeShow:null,beforeSelect:function(listEl,parentEl,newInputEl,inputEl){$("#mofile").val('');},onSelect:null,afterShow:function(listEl,parentEl,newInputEl,inputEl){$("#uniform-mofiles_upload").css("display","none");},onRemove:function(itemEl,file,id,listEl,boxEl,newInputEl,inputEl){var url_name=$("#mofile").val();var file_name=url_name.split('/').pop();$.post(baseUri+"webservice/file_remove.php",{file:file_name});$("#mofile").val('');},onEmpty:null,options:null,dialogs:{alert:function(text){return alert(text);},confirm:function(text,callback){confirm(text)?callback():null;}},captions:{button:"Choose Files",feedback:"Choose files To Upload",feedback2:"files were chosen",drop:"Drop file here to Upload",removeConfirmation:"Are you sure you want to remove this file?",errors:{filesLimit:"Only {{fi-limit}} files are allowed to be uploaded, please delete your upload file first.",filesType:"Only file type (pdf, jpg, jpeg, png, psd, eps, tiff, ai) are allowed to be uploaded.",filesSize:"{{fi-name}} is too large! Please upload file up to {{fi-maxSize}} MB. Or Upload Using Google Drive and Pickup using Your Account",filesSizeAll:"Files you've choosed are too large! Please upload files up to {{fi-maxSize}} MB."}}});});function highdpiInit()
{if($('.replace-2x').css('font-size')=="1px")
{var els=$("img.replace-2x").get();for(var i=0;i<els.length;i++)
{src=els[i].src;extension=src.substr((src.lastIndexOf('.')+1));src=src.replace("."+extension,"2x."+extension);var img=new Image();img.src=src;img.height!=0?els[i].src=src:els[i].src=els[i].src;}}}
function scrollCompensate()
{var inner=document.createElement('p');inner.style.width="100%";inner.style.height="200px";var outer=document.createElement('div');outer.style.position="absolute";outer.style.top="0px";outer.style.left="0px";outer.style.visibility="hidden";outer.style.width="200px";outer.style.height="150px";outer.style.overflow="hidden";outer.appendChild(inner);document.body.appendChild(outer);var w1=inner.offsetWidth;outer.style.overflow='scroll';var w2=inner.offsetWidth;if(w1==w2)w2=outer.clientWidth;document.body.removeChild(outer);return(w1-w2);}
function responsiveResize()
{compensante=scrollCompensate();if(($(window).width()+scrollCompensate())<=767&&responsiveflag==false)
{accordion('enable');accordionFooter('enable');responsiveflag=true;}
else if(($(window).width()+scrollCompensate())>=768)
{accordion('disable');accordionFooter('disable');responsiveflag=false;}
blockHover();}
function blockHover(status)
{var screenLg=$('body').find('.container').width()==1170;if($('.product_list').is('.grid'))
if(screenLg)
$('.product_list .button-container').hide();else
$('.product_list .button-container').show();$(document).off('mouseenter').on('mouseenter','.product_list.grid li.ajax_block_product .product-container',function(e){if(screenLg)
{var pcHeight=$(this).parent().outerHeight();var pcPHeight=$(this).parent().find('.button-container').outerHeight()+$(this).parent().find('.comments_note').outerHeight()+$(this).parent().find('.functional-buttons').outerHeight();$(this).parent().addClass('hovered').css({'height':pcHeight+pcPHeight,'margin-bottom':pcPHeight*(-1)});$(this).find('.button-container').show();}});$(document).off('mouseleave').on('mouseleave','.product_list.grid li.ajax_block_product .product-container',function(e){if(screenLg)
{$(this).parent().removeClass('hovered').css({'height':'auto','margin-bottom':'0'});$(this).find('.button-container').hide();}});}
function quick_view()
{$(document).on('click','.quick-view:visible, .quick-view-mobile:visible',function(e){e.preventDefault();var url=this.rel;var anchor='';if(url.indexOf('#')!=-1)
{anchor=url.substring(url.indexOf('#'),url.length);url=url.substring(0,url.indexOf('#'));}
if(url.indexOf('?')!=-1)
url+='&';else
url+='?';if(!!$.prototype.fancybox)
$.fancybox({'padding':0,'width':1087,'height':610,'type':'iframe','href':url+'content_only=1'+anchor});});}
function bindGrid()
{var view=$.totalStorage('display');if(!view&&(typeof displayList!='undefined')&&displayList)
view='list';if(view&&view!='grid')
display(view);else
$('.display').find('li#grid').addClass('selected');$(document).on('click','#grid',function(e){e.preventDefault();display('grid');});$(document).on('click','#list',function(e){e.preventDefault();display('list');});}
function display(view)
{if(view=='list')
{$('ul.product_list').removeClass('grid').addClass('list row');$('.product_list > li').removeClass('col-xs-12 col-sm-6 col-md-4').addClass('col-xs-12');$('.product_list > li').each(function(index,element){html='';html='<div class="product-container"><div class="row">';html+='<div class="left-block col-xs-4 col-sm-5 col-md-4">'+$(element).find('.left-block').html()+'</div>';html+='<div class="center-block col-xs-4 col-sm-7 col-md-4">';html+='<div class="product-flags">'+$(element).find('.product-flags').html()+'</div>';html+='<h5 itemprop="name">'+$(element).find('h5').html()+'</h5>';var rating=$(element).find('.comments_note').html();if(rating!=null){html+='<div itemprop="aggregateRating" itemscope itemtype="http://schema.org/AggregateRating" class="comments_note">'+rating+'</div>';}
html+='<p class="product-desc">'+$(element).find('.product-desc').html()+'</p>';var colorList=$(element).find('.color-list-container').html();if(colorList!=null){html+='<div class="color-list-container">'+colorList+'</div>';}
var availability=$(element).find('.availability').html();if(availability!=null){html+='<span class="availability">'+availability+'</span>';}
html+='</div>';html+='<div class="right-block col-xs-4 col-sm-12 col-md-4"><div class="right-block-content row">';var price=$(element).find('.content_price').html();if(price!=null){html+='<div class="content_price col-xs-5 col-md-12">'+price+'</div>';}
html+='<div class="button-container col-xs-7 col-md-12">'+$(element).find('.button-container').html()+'</div>';html+='<div class="functional-buttons clearfix col-sm-12">'+$(element).find('.functional-buttons').html()+'</div>';html+='</div>';html+='</div></div>';$(element).html(html);});$('.display').find('li#list').addClass('selected');$('.display').find('li#grid').removeAttr('class');$.totalStorage('display','list');}
else
{$('ul.product_list').removeClass('list').addClass('grid row');$('.product_list > li').removeClass('col-xs-12').addClass('col-xs-12 col-sm-6 col-md-4');$('.product_list > li').each(function(index,element){html='';html+='<div class="product-container">';html+='<div class="left-block">'+$(element).find('.left-block').html()+'</div>';html+='<div class="right-block">';html+='<div class="product-flags">'+$(element).find('.product-flags').html()+'</div>';html+='<h5 itemprop="name">'+$(element).find('h5').html()+'</h5>';var rating=$(element).find('.comments_note').html();if(rating!=null){html+='<div itemprop="aggregateRating" itemscope itemtype="http://schema.org/AggregateRating" class="comments_note">'+rating+'</div>';}
html+='<p itemprop="description" class="product-desc">'+$(element).find('.product-desc').html()+'</p>';var price=$(element).find('.content_price').html();if(price!=null){html+='<div class="content_price">'+price+'</div>';}
html+='<div itemprop="offers" itemscope itemtype="http://schema.org/Offer" class="button-container">'+$(element).find('.button-container').html()+'</div>';var colorList=$(element).find('.color-list-container').html();if(colorList!=null){html+='<div class="color-list-container">'+colorList+'</div>';}
var availability=$(element).find('.availability').html();if(availability!=null){html+='<span class="availability">'+availability+'</span>';}
html+='</div>';html+='<div class="functional-buttons clearfix">'+$(element).find('.functional-buttons').html()+'</div>';html+='</div>';$(element).html(html);});$('.display').find('li#grid').addClass('selected');$('.display').find('li#list').removeAttr('class');$.totalStorage('display','grid');}}
function dropDown()
{elementClick='#header .current';elementSlide='ul.toogle_content';activeClass='active';$('#languages-block-top').mouseenter(function(){$(this).find('ul.toogle_content').slideDown();});$('#languages-block-top').mouseleave(function(){$(this).find('ul.toogle_content').slideUp();});}
function accordionFooter(status)
{if(status=='enable')
{$('#footer .footer-block h4').on('click',function(){$(this).toggleClass('active').parent().find('.toggle-footer').stop().slideToggle('medium');})
$('#footer').addClass('accordion').find('.toggle-footer').slideUp('fast');}
else
{$('.footer-block h4').removeClass('active').off().parent().find('.toggle-footer').removeAttr('style').slideDown('fast');$('#footer').removeClass('accordion');}}
function accordion(status)
{leftColumnBlocks=$('#left_column');if(status=='enable')
{var accordion_selector='#right_column .block .title_block, #left_column .block .title_block, #left_column #newsletter_block_left h4,'+'#left_column .shopping_cart > a:first-child, #right_column .shopping_cart > a:first-child';$(accordion_selector).on('click',function(e){$(this).toggleClass('active').parent().find('.block_content').stop().slideToggle('medium');});$('#right_column, #left_column').addClass('accordion').find('.block .block_content').slideUp('fast');if(typeof(ajaxCart)!=='undefined')
ajaxCart.collapse();}
else
{$('#right_column .block .title_block, #left_column .block .title_block, #left_column #newsletter_block_left h4').removeClass('active').off().parent().find('.block_content').removeAttr('style').slideDown('fast');$('#left_column, #right_column').removeClass('accordion');}};/**
* bootstrap.js v3.0.0 by @fat and @mdo
* Copyright 2013 Twitter Inc.
* http://www.apache.org/licenses/LICENSE-2.0
*/
if(!jQuery)throw new Error("Bootstrap requires jQuery");+function(a){"use strict";function b(){var a=document.createElement("bootstrap"),b={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var c in b)if(void 0!==a.style[c])return{end:b[c]}}a.fn.emulateTransitionEnd=function(b){var c=!1,d=this;a(this).one(a.support.transition.end,function(){c=!0});var e=function(){c||a(d).trigger(a.support.transition.end)};return setTimeout(e,b),this},a(function(){a.support.transition=b()})}(window.jQuery),+function(a){"use strict";var b='[data-dismiss="alert"]',c=function(c){a(c).on("click",b,this.close)};c.prototype.close=function(b){function c(){f.trigger("closed.bs.alert").remove()}var d=a(this),e=d.attr("data-target");e||(e=d.attr("href"),e=e&&e.replace(/.*(?=#[^\s]*$)/,""));var f=a(e);b&&b.preventDefault(),f.length||(f=d.hasClass("alert")?d:d.parent()),f.trigger(b=a.Event("close.bs.alert")),b.isDefaultPrevented()||(f.removeClass("in"),a.support.transition&&f.hasClass("fade")?f.one(a.support.transition.end,c).emulateTransitionEnd(150):c())};var d=a.fn.alert;a.fn.alert=function(b){return this.each(function(){var d=a(this),e=d.data("bs.alert");e||d.data("bs.alert",e=new c(this)),"string"==typeof b&&e[b].call(d)})},a.fn.alert.Constructor=c,a.fn.alert.noConflict=function(){return a.fn.alert=d,this},a(document).on("click.bs.alert.data-api",b,c.prototype.close)}(window.jQuery),+function(a){"use strict";var b=function(c,d){this.$element=a(c),this.options=a.extend({},b.DEFAULTS,d)};b.DEFAULTS={loadingText:"loading..."},b.prototype.setState=function(a){var b="disabled",c=this.$element,d=c.is("input")?"val":"html",e=c.data();a+="Text",e.resetText||c.data("resetText",c[d]()),c[d](e[a]||this.options[a]),setTimeout(function(){"loadingText"==a?c.addClass(b).attr(b,b):c.removeClass(b).removeAttr(b)},0)},b.prototype.toggle=function(){var a=this.$element.closest('[data-toggle="buttons"]');if(a.length){var b=this.$element.find("input").prop("checked",!this.$element.hasClass("active")).trigger("change");"radio"===b.prop("type")&&a.find(".active").removeClass("active")}this.$element.toggleClass("active")};var c=a.fn.button;a.fn.button=function(c){return this.each(function(){var d=a(this),e=d.data("bs.button"),f="object"==typeof c&&c;e||d.data("bs.button",e=new b(this,f)),"toggle"==c?e.toggle():c&&e.setState(c)})},a.fn.button.Constructor=b,a.fn.button.noConflict=function(){return a.fn.button=c,this},a(document).on("click.bs.button.data-api","[data-toggle^=button]",function(b){var c=a(b.target);c.hasClass("btn")||(c=c.closest(".btn")),c.button("toggle"),b.preventDefault()})}(window.jQuery),+function(a){"use strict";var b=function(b,c){this.$element=a(b),this.$indicators=this.$element.find(".carousel-indicators"),this.options=c,this.paused=this.sliding=this.interval=this.$active=this.$items=null,"hover"==this.options.pause&&this.$element.on("mouseenter",a.proxy(this.pause,this)).on("mouseleave",a.proxy(this.cycle,this))};b.DEFAULTS={interval:5e3,pause:"hover",wrap:!0},b.prototype.cycle=function(b){return b||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(a.proxy(this.next,this),this.options.interval)),this},b.prototype.getActiveIndex=function(){return this.$active=this.$element.find(".item.active"),this.$items=this.$active.parent().children(),this.$items.index(this.$active)},b.prototype.to=function(b){var c=this,d=this.getActiveIndex();return b>this.$items.length-1||0>b?void 0:this.sliding?this.$element.one("slid",function(){c.to(b)}):d==b?this.pause().cycle():this.slide(b>d?"next":"prev",a(this.$items[b]))},b.prototype.pause=function(b){return b||(this.paused=!0),this.$element.find(".next, .prev").length&&a.support.transition.end&&(this.$element.trigger(a.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},b.prototype.next=function(){return this.sliding?void 0:this.slide("next")},b.prototype.prev=function(){return this.sliding?void 0:this.slide("prev")},b.prototype.slide=function(b,c){var d=this.$element.find(".item.active"),e=c||d[b](),f=this.interval,g="next"==b?"left":"right",h="next"==b?"first":"last",i=this;if(!e.length){if(!this.options.wrap)return;e=this.$element.find(".item")[h]()}this.sliding=!0,f&&this.pause();var j=a.Event("slide.bs.carousel",{relatedTarget:e[0],direction:g});if(!e.hasClass("active")){if(this.$indicators.length&&(this.$indicators.find(".active").removeClass("active"),this.$element.one("slid",function(){var b=a(i.$indicators.children()[i.getActiveIndex()]);b&&b.addClass("active")})),a.support.transition&&this.$element.hasClass("slide")){if(this.$element.trigger(j),j.isDefaultPrevented())return;e.addClass(b),e[0].offsetWidth,d.addClass(g),e.addClass(g),d.one(a.support.transition.end,function(){e.removeClass([b,g].join(" ")).addClass("active"),d.removeClass(["active",g].join(" ")),i.sliding=!1,setTimeout(function(){i.$element.trigger("slid")},0)}).emulateTransitionEnd(600)}else{if(this.$element.trigger(j),j.isDefaultPrevented())return;d.removeClass("active"),e.addClass("active"),this.sliding=!1,this.$element.trigger("slid")}return f&&this.cycle(),this}};var c=a.fn.carousel;a.fn.carousel=function(c){return this.each(function(){var d=a(this),e=d.data("bs.carousel"),f=a.extend({},b.DEFAULTS,d.data(),"object"==typeof c&&c),g="string"==typeof c?c:f.slide;e||d.data("bs.carousel",e=new b(this,f)),"number"==typeof c?e.to(c):g?e[g]():f.interval&&e.pause().cycle()})},a.fn.carousel.Constructor=b,a.fn.carousel.noConflict=function(){return a.fn.carousel=c,this},a(document).on("click.bs.carousel.data-api","[data-slide], [data-slide-to]",function(b){var c,d=a(this),e=a(d.attr("data-target")||(c=d.attr("href"))&&c.replace(/.*(?=#[^\s]+$)/,"")),f=a.extend({},e.data(),d.data()),g=d.attr("data-slide-to");g&&(f.interval=!1),e.carousel(f),(g=d.attr("data-slide-to"))&&e.data("bs.carousel").to(g),b.preventDefault()}),a(window).on("load",function(){a('[data-ride="carousel"]').each(function(){var b=a(this);b.carousel(b.data())})})}(window.jQuery),+function(a){"use strict";var b=function(c,d){this.$element=a(c),this.options=a.extend({},b.DEFAULTS,d),this.transitioning=null,this.options.parent&&(this.$parent=a(this.options.parent)),this.options.toggle&&this.toggle()};b.DEFAULTS={toggle:!0},b.prototype.dimension=function(){var a=this.$element.hasClass("width");return a?"width":"height"},b.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var b=a.Event("show.bs.collapse");if(this.$element.trigger(b),!b.isDefaultPrevented()){var c=this.$parent&&this.$parent.find("> .panel > .in");if(c&&c.length){var d=c.data("bs.collapse");if(d&&d.transitioning)return;c.collapse("hide"),d||c.data("bs.collapse",null)}var e=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[e](0),this.transitioning=1;var f=function(){this.$element.removeClass("collapsing").addClass("in")[e]("auto"),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!a.support.transition)return f.call(this);var g=a.camelCase(["scroll",e].join("-"));this.$element.one(a.support.transition.end,a.proxy(f,this)).emulateTransitionEnd(350)[e](this.$element[0][g])}}},b.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var b=a.Event("hide.bs.collapse");if(this.$element.trigger(b),!b.isDefaultPrevented()){var c=this.dimension();this.$element[c](this.$element[c]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse").removeClass("in"),this.transitioning=1;var d=function(){this.transitioning=0,this.$element.trigger("hidden.bs.collapse").removeClass("collapsing").addClass("collapse")};return a.support.transition?(this.$element[c](0).one(a.support.transition.end,a.proxy(d,this)).emulateTransitionEnd(350),void 0):d.call(this)}}},b.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()};var c=a.fn.collapse;a.fn.collapse=function(c){return this.each(function(){var d=a(this),e=d.data("bs.collapse"),f=a.extend({},b.DEFAULTS,d.data(),"object"==typeof c&&c);e||d.data("bs.collapse",e=new b(this,f)),"string"==typeof c&&e[c]()})},a.fn.collapse.Constructor=b,a.fn.collapse.noConflict=function(){return a.fn.collapse=c,this},a(document).on("click.bs.collapse.data-api","[data-toggle=collapse]",function(b){var c,d=a(this),e=d.attr("data-target")||b.preventDefault()||(c=d.attr("href"))&&c.replace(/.*(?=#[^\s]+$)/,""),f=a(e),g=f.data("bs.collapse"),h=g?"toggle":d.data(),i=d.attr("data-parent"),j=i&&a(i);g&&g.transitioning||(j&&j.find('[data-toggle=collapse][data-parent="'+i+'"]').not(d).addClass("collapsed"),d[f.hasClass("in")?"addClass":"removeClass"]("collapsed")),f.collapse(h)})}(window.jQuery),+function(a){"use strict";function b(){a(d).remove(),a(e).each(function(b){var d=c(a(this));d.hasClass("open")&&(d.trigger(b=a.Event("hide.bs.dropdown")),b.isDefaultPrevented()||d.removeClass("open").trigger("hidden.bs.dropdown"))})}function c(b){var c=b.attr("data-target");c||(c=b.attr("href"),c=c&&/#/.test(c)&&c.replace(/.*(?=#[^\s]*$)/,""));var d=c&&a(c);return d&&d.length?d:b.parent()}var d=".dropdown-backdrop",e="[data-toggle=dropdown]",f=function(b){a(b).on("click.bs.dropdown",this.toggle)};f.prototype.toggle=function(d){var e=a(this);if(!e.is(".disabled, :disabled")){var f=c(e),g=f.hasClass("open");if(b(),!g){if("ontouchstart"in document.documentElement&&a('<div class="dropdown-backdrop"/>').insertAfter(a(this)).on("click",b),f.trigger(d=a.Event("show.bs.dropdown")),d.isDefaultPrevented())return;f.toggleClass("open").trigger("shown.bs.dropdown")}return e.focus(),!1}},f.prototype.keydown=function(b){if(/(38|40|27)/.test(b.keyCode)){var d=a(this);if(b.preventDefault(),b.stopPropagation(),!d.is(".disabled, :disabled")){var f=c(d),g=f.hasClass("open");if(!g||g&&27==b.keyCode)return 27==b.which&&f.find(e).focus(),d.click();var h=a("[role=menu] li:not(.divider):visible a",f);if(h.length){var i=h.index(h.filter(":focus"));38==b.keyCode&&i>0&&i--,40==b.keyCode&&i<h.length-1&&i++,~i||(i=0),h.eq(i).focus()}}}};var g=a.fn.dropdown;a.fn.dropdown=function(b){return this.each(function(){var c=a(this),d=c.data("dropdown");d||c.data("dropdown",d=new f(this)),"string"==typeof b&&d[b].call(c)})},a.fn.dropdown.Constructor=f,a.fn.dropdown.noConflict=function(){return a.fn.dropdown=g,this},a(document).on("click.bs.dropdown.data-api",b).on("click.bs.dropdown.data-api",".dropdown form",function(a){a.stopPropagation()}).on("click.bs.dropdown.data-api",e,f.prototype.toggle).on("keydown.bs.dropdown.data-api",e+", [role=menu]",f.prototype.keydown)}(window.jQuery),+function(a){"use strict";var b=function(b,c){this.options=c,this.$element=a(b).on("click.dismiss.modal",'[data-dismiss="modal"]',a.proxy(this.hide,this)),this.$backdrop=this.isShown=null,this.options.remote&&this.$element.load(this.options.remote)};b.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},b.prototype.toggle=function(a){return this[this.isShown?"hide":"show"](a)},b.prototype.show=function(b){var c=this,d=a.Event("show.bs.modal",{relatedTarget:b});this.$element.trigger(d),this.isShown||d.isDefaultPrevented()||(this.isShown=!0,this.escape(),this.backdrop(function(){var d=a.support.transition&&c.$element.hasClass("fade");c.$element.parent().length||c.$element.appendTo(document.body),c.$element.show(),d&&c.$element[0].offsetWidth,c.$element.addClass("in").attr("aria-hidden",!1),c.enforceFocus();var e=a.Event("shown.bs.modal",{relatedTarget:b});d?c.$element.one(a.support.transition.end,function(){c.$element.focus().trigger(e)}).emulateTransitionEnd(300):c.$element.focus().trigger(e)}))},b.prototype.hide=function(b){b&&b.preventDefault(),b=a.Event("hide.bs.modal"),this.$element.trigger(b),this.isShown&&!b.isDefaultPrevented()&&(this.isShown=!1,this.escape(),a(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.modal"),a.support.transition&&this.$element.hasClass("fade")?this.$element.one(a.support.transition.end,a.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal())},b.prototype.enforceFocus=function(){a(document).off("focusin.bs.modal").on("focusin.bs.modal",a.proxy(function(a){this.$element[0]===a.target||this.$element.has(a.target).length||this.$element.focus()},this))},b.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.bs.modal",a.proxy(function(a){27==a.which&&this.hide()},this)):this.isShown||this.$element.off("keyup.dismiss.bs.modal")},b.prototype.hideModal=function(){var a=this;this.$element.hide(),this.backdrop(function(){a.removeBackdrop(),a.$element.trigger("hidden.bs.modal")})},b.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},b.prototype.backdrop=function(b){var c=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var d=a.support.transition&&c;if(this.$backdrop=a('<div class="modal-backdrop '+c+'" />').appendTo(document.body),this.$element.on("click.dismiss.modal",a.proxy(function(a){a.target===a.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus.call(this.$element[0]):this.hide.call(this))},this)),d&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!b)return;d?this.$backdrop.one(a.support.transition.end,b).emulateTransitionEnd(150):b()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),a.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(a.support.transition.end,b).emulateTransitionEnd(150):b()):b&&b()};var c=a.fn.modal;a.fn.modal=function(c,d){return this.each(function(){var e=a(this),f=e.data("bs.modal"),g=a.extend({},b.DEFAULTS,e.data(),"object"==typeof c&&c);f||e.data("bs.modal",f=new b(this,g)),"string"==typeof c?f[c](d):g.show&&f.show(d)})},a.fn.modal.Constructor=b,a.fn.modal.noConflict=function(){return a.fn.modal=c,this},a(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(b){var c=a(this),d=c.attr("href"),e=a(c.attr("data-target")||d&&d.replace(/.*(?=#[^\s]+$)/,"")),f=e.data("modal")?"toggle":a.extend({remote:!/#/.test(d)&&d},e.data(),c.data());b.preventDefault(),e.modal(f,this).one("hide",function(){c.is(":visible")&&c.focus()})}),a(document).on("shown.bs.modal",".modal",function(){a(document.body).addClass("modal-open")}).on("hidden.bs.modal",".modal",function(){a(document.body).removeClass("modal-open")})}(window.jQuery),+function(a){"use strict";var b=function(a,b){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",a,b)};b.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},b.prototype.init=function(b,c,d){this.enabled=!0,this.type=b,this.$element=a(c),this.options=this.getOptions(d);for(var e=this.options.trigger.split(" "),f=e.length;f--;){var g=e[f];if("click"==g)this.$element.on("click."+this.type,this.options.selector,a.proxy(this.toggle,this));else if("manual"!=g){var h="hover"==g?"mouseenter":"focus",i="hover"==g?"mouseleave":"blur";this.$element.on(h+"."+this.type,this.options.selector,a.proxy(this.enter,this)),this.$element.on(i+"."+this.type,this.options.selector,a.proxy(this.leave,this))}}this.options.selector?this._options=a.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},b.prototype.getDefaults=function(){return b.DEFAULTS},b.prototype.getOptions=function(b){return b=a.extend({},this.getDefaults(),this.$element.data(),b),b.delay&&"number"==typeof b.delay&&(b.delay={show:b.delay,hide:b.delay}),b},b.prototype.getDelegateOptions=function(){var b={},c=this.getDefaults();return this._options&&a.each(this._options,function(a,d){c[a]!=d&&(b[a]=d)}),b},b.prototype.enter=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);return clearTimeout(c.timeout),c.options.delay&&c.options.delay.show?(c.hoverState="in",c.timeout=setTimeout(function(){"in"==c.hoverState&&c.show()},c.options.delay.show),void 0):c.show()},b.prototype.leave=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);return clearTimeout(c.timeout),c.options.delay&&c.options.delay.hide?(c.hoverState="out",c.timeout=setTimeout(function(){"out"==c.hoverState&&c.hide()},c.options.delay.hide),void 0):c.hide()},b.prototype.show=function(){var b=a.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){if(this.$element.trigger(b),b.isDefaultPrevented())return;var c=this.tip();this.setContent(),this.options.animation&&c.addClass("fade");var d="function"==typeof this.options.placement?this.options.placement.call(this,c[0],this.$element[0]):this.options.placement,e=/\s?auto?\s?/i,f=e.test(d);f&&(d=d.replace(e,"")||"top"),c.detach().css({top:0,left:0,display:"block"}).addClass(d),this.options.container?c.appendTo(this.options.container):c.insertAfter(this.$element);var g=this.getPosition(),h=c[0].offsetWidth,i=c[0].offsetHeight;if(f){var j=this.$element.parent(),k=d,l=document.documentElement.scrollTop||document.body.scrollTop,m="body"==this.options.container?window.innerWidth:j.outerWidth(),n="body"==this.options.container?window.innerHeight:j.outerHeight(),o="body"==this.options.container?0:j.offset().left;d="bottom"==d&&g.top+g.height+i-l>n?"top":"top"==d&&g.top-l-i<0?"bottom":"right"==d&&g.right+h>m?"left":"left"==d&&g.left-h<o?"right":d,c.removeClass(k).addClass(d)}var p=this.getCalculatedOffset(d,g,h,i);this.applyPlacement(p,d),this.$element.trigger("shown.bs."+this.type)}},b.prototype.applyPlacement=function(a,b){var c,d=this.tip(),e=d[0].offsetWidth,f=d[0].offsetHeight,g=parseInt(d.css("margin-top"),10),h=parseInt(d.css("margin-left"),10);isNaN(g)&&(g=0),isNaN(h)&&(h=0),a.top=a.top+g,a.left=a.left+h,d.offset(a).addClass("in");var i=d[0].offsetWidth,j=d[0].offsetHeight;if("top"==b&&j!=f&&(c=!0,a.top=a.top+f-j),/bottom|top/.test(b)){var k=0;a.left<0&&(k=-2*a.left,a.left=0,d.offset(a),i=d[0].offsetWidth,j=d[0].offsetHeight),this.replaceArrow(k-e+i,i,"left")}else this.replaceArrow(j-f,j,"top");c&&d.offset(a)},b.prototype.replaceArrow=function(a,b,c){this.arrow().css(c,a?50*(1-a/b)+"%":"")},b.prototype.setContent=function(){var a=this.tip(),b=this.getTitle();a.find(".tooltip-inner")[this.options.html?"html":"text"](b),a.removeClass("fade in top bottom left right")},b.prototype.hide=function(){function b(){c.detach()}var c=this.tip(),d=a.Event("hide.bs."+this.type);return this.$element.trigger(d),d.isDefaultPrevented()?void 0:(c.removeClass("in"),a.support.transition&&this.$tip.hasClass("fade")?c.one(a.support.transition.end,b).emulateTransitionEnd(150):b(),this.$element.trigger("hidden.bs."+this.type),this)},b.prototype.fixTitle=function(){var a=this.$element;(a.attr("title")||"string"!=typeof a.attr("data-original-title"))&&a.attr("data-original-title",a.attr("title")||"").attr("title","")},b.prototype.hasContent=function(){return this.getTitle()},b.prototype.getPosition=function(){var b=this.$element[0];return a.extend({},"function"==typeof b.getBoundingClientRect?b.getBoundingClientRect():{width:b.offsetWidth,height:b.offsetHeight},this.$element.offset())},b.prototype.getCalculatedOffset=function(a,b,c,d){return"bottom"==a?{top:b.top+b.height,left:b.left+b.width/2-c/2}:"top"==a?{top:b.top-d,left:b.left+b.width/2-c/2}:"left"==a?{top:b.top+b.height/2-d/2,left:b.left-c}:{top:b.top+b.height/2-d/2,left:b.left+b.width}},b.prototype.getTitle=function(){var a,b=this.$element,c=this.options;return a=b.attr("data-original-title")||("function"==typeof c.title?c.title.call(b[0]):c.title)},b.prototype.tip=function(){return this.$tip=this.$tip||a(this.options.template)},b.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},b.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},b.prototype.enable=function(){this.enabled=!0},b.prototype.disable=function(){this.enabled=!1},b.prototype.toggleEnabled=function(){this.enabled=!this.enabled},b.prototype.toggle=function(b){var c=b?a(b.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type):this;c.tip().hasClass("in")?c.leave(c):c.enter(c)},b.prototype.destroy=function(){this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var c=a.fn.tooltip;a.fn.tooltip=function(c){return this.each(function(){var d=a(this),e=d.data("bs.tooltip"),f="object"==typeof c&&c;e||d.data("bs.tooltip",e=new b(this,f)),"string"==typeof c&&e[c]()})},a.fn.tooltip.Constructor=b,a.fn.tooltip.noConflict=function(){return a.fn.tooltip=c,this}}(window.jQuery),+function(a){"use strict";var b=function(a,b){this.init("popover",a,b)};if(!a.fn.tooltip)throw new Error("Popover requires tooltip.js");b.DEFAULTS=a.extend({},a.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),b.prototype=a.extend({},a.fn.tooltip.Constructor.prototype),b.prototype.constructor=b,b.prototype.getDefaults=function(){return b.DEFAULTS},b.prototype.setContent=function(){var a=this.tip(),b=this.getTitle(),c=this.getContent();a.find(".popover-title")[this.options.html?"html":"text"](b),a.find(".popover-content")[this.options.html?"html":"text"](c),a.removeClass("fade top bottom left right in"),a.find(".popover-title").html()||a.find(".popover-title").hide()},b.prototype.hasContent=function(){return this.getTitle()||this.getContent()},b.prototype.getContent=function(){var a=this.$element,b=this.options;return a.attr("data-content")||("function"==typeof b.content?b.content.call(a[0]):b.content)},b.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},b.prototype.tip=function(){return this.$tip||(this.$tip=a(this.options.template)),this.$tip};var c=a.fn.popover;a.fn.popover=function(c){return this.each(function(){var d=a(this),e=d.data("bs.popover"),f="object"==typeof c&&c;e||d.data("bs.popover",e=new b(this,f)),"string"==typeof c&&e[c]()})},a.fn.popover.Constructor=b,a.fn.popover.noConflict=function(){return a.fn.popover=c,this}}(window.jQuery),+function(a){"use strict";function b(c,d){var e,f=a.proxy(this.process,this);this.$element=a(c).is("body")?a(window):a(c),this.$body=a("body"),this.$scrollElement=this.$element.on("scroll.bs.scroll-spy.data-api",f),this.options=a.extend({},b.DEFAULTS,d),this.selector=(this.options.target||(e=a(c).attr("href"))&&e.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a",this.offsets=a([]),this.targets=a([]),this.activeTarget=null,this.refresh(),this.process()}b.DEFAULTS={offset:10},b.prototype.refresh=function(){var b=this.$element[0]==window?"offset":"position";this.offsets=a([]),this.targets=a([]);var c=this;this.$body.find(this.selector).map(function(){var d=a(this),e=d.data("target")||d.attr("href"),f=/^#\w/.test(e)&&a(e);return f&&f.length&&[[f[b]().top+(!a.isWindow(c.$scrollElement.get(0))&&c.$scrollElement.scrollTop()),e]]||null}).sort(function(a,b){return a[0]-b[0]}).each(function(){c.offsets.push(this[0]),c.targets.push(this[1])})},b.prototype.process=function(){var a,b=this.$scrollElement.scrollTop()+this.options.offset,c=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight,d=c-this.$scrollElement.height(),e=this.offsets,f=this.targets,g=this.activeTarget;if(b>=d)return g!=(a=f.last()[0])&&this.activate(a);for(a=e.length;a--;)g!=f[a]&&b>=e[a]&&(!e[a+1]||b<=e[a+1])&&this.activate(f[a])},b.prototype.activate=function(b){this.activeTarget=b,a(this.selector).parents(".active").removeClass("active");var c=this.selector+'[data-target="'+b+'"],'+this.selector+'[href="'+b+'"]',d=a(c).parents("li").addClass("active");d.parent(".dropdown-menu").length&&(d=d.closest("li.dropdown").addClass("active")),d.trigger("activate")};var c=a.fn.scrollspy;a.fn.scrollspy=function(c){return this.each(function(){var d=a(this),e=d.data("bs.scrollspy"),f="object"==typeof c&&c;e||d.data("bs.scrollspy",e=new b(this,f)),"string"==typeof c&&e[c]()})},a.fn.scrollspy.Constructor=b,a.fn.scrollspy.noConflict=function(){return a.fn.scrollspy=c,this},a(window).on("load",function(){a('[data-spy="scroll"]').each(function(){var b=a(this);b.scrollspy(b.data())})})}(window.jQuery),+function(a){"use strict";var b=function(b){this.element=a(b)};b.prototype.show=function(){var b=this.element,c=b.closest("ul:not(.dropdown-menu)"),d=b.attr("data-target");if(d||(d=b.attr("href"),d=d&&d.replace(/.*(?=#[^\s]*$)/,"")),!b.parent("li").hasClass("active")){var e=c.find(".active:last a")[0],f=a.Event("show.bs.tab",{relatedTarget:e});if(b.trigger(f),!f.isDefaultPrevented()){var g=a(d);this.activate(b.parent("li"),c),this.activate(g,g.parent(),function(){b.trigger({type:"shown.bs.tab",relatedTarget:e})})}}},b.prototype.activate=function(b,c,d){function e(){f.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),b.addClass("active"),g?(b[0].offsetWidth,b.addClass("in")):b.removeClass("fade"),b.parent(".dropdown-menu")&&b.closest("li.dropdown").addClass("active"),d&&d()}var f=c.find("> .active"),g=d&&a.support.transition&&f.hasClass("fade");g?f.one(a.support.transition.end,e).emulateTransitionEnd(150):e(),f.removeClass("in")};var c=a.fn.tab;a.fn.tab=function(c){return this.each(function(){var d=a(this),e=d.data("bs.tab");e||d.data("bs.tab",e=new b(this)),"string"==typeof c&&e[c]()})},a.fn.tab.Constructor=b,a.fn.tab.noConflict=function(){return a.fn.tab=c,this},a(document).on("click.bs.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(b){b.preventDefault(),a(this).tab("show")})}(window.jQuery),+function(a){"use strict";var b=function(c,d){this.options=a.extend({},b.DEFAULTS,d),this.$window=a(window).on("scroll.bs.affix.data-api",a.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",a.proxy(this.checkPositionWithEventLoop,this)),this.$element=a(c),this.affixed=this.unpin=null,this.checkPosition()};b.RESET="affix affix-top affix-bottom",b.DEFAULTS={offset:0},b.prototype.checkPositionWithEventLoop=function(){setTimeout(a.proxy(this.checkPosition,this),1)},b.prototype.checkPosition=function(){if(this.$element.is(":visible")){var c=a(document).height(),d=this.$window.scrollTop(),e=this.$element.offset(),f=this.options.offset,g=f.top,h=f.bottom;"object"!=typeof f&&(h=g=f),"function"==typeof g&&(g=f.top()),"function"==typeof h&&(h=f.bottom());var i=null!=this.unpin&&d+this.unpin<=e.top?!1:null!=h&&e.top+this.$element.height()>=c-h?"bottom":null!=g&&g>=d?"top":!1;this.affixed!==i&&(this.unpin&&this.$element.css("top",""),this.affixed=i,this.unpin="bottom"==i?e.top-d:null,this.$element.removeClass(b.RESET).addClass("affix"+(i?"-"+i:"")),"bottom"==i&&this.$element.offset({top:document.body.offsetHeight-h-this.$element.height()}))}};var c=a.fn.affix;a.fn.affix=function(c){return this.each(function(){var d=a(this),e=d.data("bs.affix"),f="object"==typeof c&&c;e||d.data("bs.affix",e=new b(this,f)),"string"==typeof c&&e[c]()})},a.fn.affix.Constructor=b,a.fn.affix.noConflict=function(){return a.fn.affix=c,this},a(window).on("load",function(){a('[data-spy="affix"]').each(function(){var b=a(this),c=b.data();c.offset=c.offset||{},c.offsetBottom&&(c.offset.bottom=c.offsetBottom),c.offsetTop&&(c.offset.top=c.offsetTop),b.affix(c)})})}(window.jQuery);/*
 * TotalStorage
 *
 * Copyright (c) 2012 Jared Novack & Upstatement (upstatement.com)
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 *
 * Total Storage is the conceptual the love child of jStorage by Andris Reinman, 
 * and Cookie by Klaus Hartl -- though this is not connected to either project.
 *
 * @name $.totalStorage
 * @cat Plugins/Cookie
 * @author Jared Novack/jared@upstatement.com
 * @version 1.1.2
 * @url http://upstatement.com/blog/2012/01/jquery-local-storage-done-right-and-easy/
 */
(function($){var ls=window.localStorage;var supported;if(typeof ls=='undefined'||typeof window.JSON=='undefined'){supported=false;}else{supported=true;}
$.totalStorage=function(key,value,options){return $.totalStorage.impl.init(key,value);}
$.totalStorage.setItem=function(key,value){return $.totalStorage.impl.setItem(key,value);}
$.totalStorage.getItem=function(key){return $.totalStorage.impl.getItem(key);}
$.totalStorage.getAll=function(){return $.totalStorage.impl.getAll();}
$.totalStorage.deleteItem=function(key){return $.totalStorage.impl.deleteItem(key);}
$.totalStorage.impl={init:function(key,value){if(typeof value!='undefined'){return this.setItem(key,value);}else{return this.getItem(key);}},setItem:function(key,value){if(!supported){try{$.cookie(key,value);return value;}catch(e){console.log('Local Storage not supported by this browser. Install the cookie plugin on your site to take advantage of the same functionality. You can get it at https://github.com/carhartl/jquery-cookie');}}
var saver=JSON.stringify(value);ls.setItem(key,saver);return this.parseResult(saver);},getItem:function(key){if(!supported){try{return this.parseResult($.cookie(key));}catch(e){return null;}}
return this.parseResult(ls.getItem(key));},deleteItem:function(key){if(!supported){try{$.cookie(key,null);return true;}catch(e){return false;}}
ls.removeItem(key);return true;},getAll:function(){var items=new Array();if(!supported){try{var pairs=document.cookie.split(";");for(var i=0;i<pairs.length;i++){var pair=pairs[i].split('=');var key=pair[0];items.push({key:key,value:this.parseResult($.cookie(key))});}}catch(e){return null;}}else{for(var i in ls){if(i.length){items.push({key:i,value:this.parseResult(ls.getItem(i))});}}}
return items;},parseResult:function(res){var ret;try{ret=JSON.parse(res);if(ret=='true'){ret=true;}
if(ret=='false'){ret=false;}
if(parseFloat(ret)==ret&&typeof ret!="object"){ret=parseFloat(ret);}}catch(e){}
return ret;}}})(jQuery);
;(function($){$.fn.html5lightbox=function(k){var l=this;l.options=jQuery.extend({autoplay:true,html5player:true,overlaybgcolor:"#000000",overlayopacity:0.9,bgcolor:"#ffffff",bordersize:8,barheight:36,loadingwidth:64,loadingheight:64,resizespeed:400,fadespeed:400,skinfolder:"skins/",loadingimage:"lightbox-loading.gif",nextimage:"lightbox-next.png",previmage:"lightbox-prev.png",closeimage:"lightbox-close.png",playvideoimage:"lightbox-playvideo.png",titlecss:"{color:#333333; font-size:16px; font-family:Armata,sans-serif,Arial; overflow:hidden; white-space:nowrap;}",errorwidth:280,errorheight:48,errorcss:"{text-align:center; color:#ff0000; font-size:14px; font-family:Arial, sans-serif;}",supportesckey:true,supportarrowkeys:true,version:"1.8",stamp:false,freemark:"html5box.com",freelink:"http://html5box.com/",watermark:"",watermarklink:""},k);if((typeof html5lightbox_options!='undefined')&&html5lightbox_options)jQuery.extend(l.options,html5lightbox_options);l.options.htmlfolder=window.location.href.substr(0,window.location.href.lastIndexOf("/")+1);if((l.options.skinfolder.charAt(0)!="/")&&(l.options.skinfolder.substring(0,5)!="http:")&&(l.options.skinfolder.substring(0,6)!="https:"))l.options.skinfolder=l.options.jsfolder+l.options.skinfolder;l.options.types=["IMAGE","FLASH","VIDEO","YOUTUBE","VIMEO","PDF","MP3","WEB"];l.elemArray=new Array();l.options.curElem=-1;l.options.flashInstalled=false;try{if(new ActiveXObject('ShockwaveFlash.ShockwaveFlash'))l.options.flashInstalled=true}catch(e){if(navigator.mimeTypes["application/x-shockwave-flash"])l.options.flashInstalled=true}l.options.html5VideoSupported=(!!document.createElement('video').canPlayType);l.options.isChrome=(navigator.userAgent.match(/Chrome/i)!=null);l.options.isFirefox=(navigator.userAgent.match(/Firefox/i)!=null);l.options.isOpera=(navigator.userAgent.match(/Opera/i)!=null);l.options.isSafari=(navigator.userAgent.match(/Safari/i)!=null);l.options.isIE=(navigator.userAgent.match(/MSIE/i)!=null)&&!l.options.isOpera;l.options.isIE9=l.options.isIE&&l.options.html5VideoSupported;l.options.isIE678=l.options.isIE&&!l.options.isIE9;l.options.isIE6=(navigator.userAgent.match(/MSIE 6/i)!=null)&&!l.options.isOpera;l.options.isAndroid=(navigator.userAgent.match(/Android/i)!=null);l.options.isIPad=(navigator.userAgent.match(/iPad/i)!=null);l.options.isIPhone=((navigator.userAgent.match(/iPod/i)!=null)||(navigator.userAgent.match(/iPhone/i)!=null));l.options.isMobile=(l.options.isAndroid||l.options.isIPad||l.options.isIPhone);l.options.isIOSLess5=l.options.isIPad&&l.options.isIPhone&&((navigator.userAgent.match(/OS 4/i)!=null)||(navigator.userAgent.match(/OS 3/i)!=null));l.options.supportCSSPositionFixed=!l.options.isIE6&&!l.options.isIOSLess5;l.options.resizeTimeout=-1;var l=this;l.init=function(){l.showing=false;l.readData();l.createMarkup();l.supportKeyboard()};var m=0,ELEM_HREF=1,ELEM_TITLE=2,ELEM_GROUP=3,ELEM_WIDTH=4,ELEM_HEIGHT=5,ELEM_HREF_WEBM=6,ELEM_HREF_OGG=7;l.readData=function(){l.each(function(){if(this.nodeName.toLowerCase()!='a')return;var a=$(this);var b=l.checkType(a.attr('href'));if(b<0)return;l.elemArray.push(new Array(b,a.attr('href'),a.attr('title'),a.data('group'),a.data('width'),a.data('height'),a.data('webm'),a.data('ogg')))})};l.createMarkup=function(){var a=('https:'==document.location.protocol?'https':'http')+"://fonts.googleapis.com/css?family=Armata";var b=document.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("href",a);document.getElementsByTagName("head")[0].appendChild(b);var c="#html5-text "+l.options.titlecss;c+=".html5-error "+l.options.errorcss;$("head").append("<style type='text/css'>"+c+"</style>");l.$lightbox=jQuery("<div id='html5-lightbox' style='display:none;top:0px;left:0px;width:100%;height:100%;z-index:9999999;'>"+"<div id='html5-lightbox-overlay' style='display:block;position:absolute;top:0px;left:0px;width:100%;height:100%;background-color:"+l.options.overlaybgcolor+";opacity:"+l.options.overlayopacity+";filter:alpha(opacity="+Math.round(l.options.overlayopacity*100)+");'></div>"+"<div id='html5-lightbox-box' style='display:block;position:relative;margin:0px auto;overflow:hidden;'>"+"<div id='html5-elem-box' style='display:block;position:relative;margin:0px auto;text-align:center;'>"+"<div id='html5-elem-wrap' style='display:block;position:relative;margin:0px auto;text-align:center;background-color:"+l.options.bgcolor+";'>"+"<div id='html5-loading' style='display:none;position:absolute;top:0px;left:0px;text-align:center;width:100%;height:100%;background:url(\""+l.options.skinfolder+l.options.loadingimage+"\") no-repeat center center;'></div>"+"<div id='html5-error' class='html5-error' style='display:none;position:absolute;padding:"+l.options.bordersize+"px;text-align:center;width:"+l.options.errorwidth+"px;height:"+l.options.errorheight+"px;'>"+"The requested content cannot be loaded.<br />Please try again later."+"</div>"+"<div id='html5-image' style='display:none;position:absolute;top:0px;left:0px;padding:"+l.options.bordersize+"px;text-align:center;'></div>"+"</div>"+"<div id='html5-next' style='display:none;cursor:pointer;position:absolute;right:"+l.options.bordersize+"px;top:40%;'><img src='"+l.options.skinfolder+l.options.nextimage+"'></div>"+"<div id='html5-prev' style='display:none;cursor:pointer;position:absolute;left:"+l.options.bordersize+"px;top:40%;'><img src='"+l.options.skinfolder+l.options.previmage+"'></div>"+"</div>"+"<div id='html5-elem-data-box' style='display:none;position:relative;width:100%;margin:0px auto;height:"+l.options.barheight+"px;background-color:"+l.options.bgcolor+";'>"+"<div id='html5-text' style='display:block;float:left;overflow:hidden;margin-left:"+l.options.bordersize+"px;'></div>"+"<div id='html5-close' style='display:block;cursor:pointer;float:right;margin-right:"+l.options.bordersize+"px;'><img src='"+l.options.skinfolder+l.options.closeimage+"'></div>"+"</div>"+"<div id='html5-watermark' style='display:none;position:absolute;left:"+String(l.options.bordersize+2)+"px;top:"+String(l.options.bordersize+2)+"px;'></div>"+"</div>"+"</div>");l.$lightbox.css({position:(l.options.supportCSSPositionFixed?'fixed':'absolute')});l.$lightbox.appendTo("body");l.$lightboxBox=$("#html5-lightbox-box",l.$lightbox);l.$elem=$("#html5-elem-box",l.$lightbox);l.$elemWrap=$("#html5-elem-wrap",l.$lightbox);l.$loading=$("#html5-loading",l.$lightbox);l.$error=$("#html5-error",l.$lightbox);l.$image=$("#html5-image",l.$lightbox);l.$elemData=$("#html5-elem-data-box",l.$lightbox);l.$text=$("#html5-text",l.$lightbox);l.$next=$("#html5-next",l.$lightbox);l.$prev=$("#html5-prev",l.$lightbox);l.$close=$("#html5-close",l.$lightbox);l.$watermark=$("#html5-watermark",l.$lightbox);if(l.options.stamp){l.$watermark.html("<a href='"+l.options.freelink+"' style='text-decoration:none;'><div style='display:block;width:120px;height:20px;text-align:center;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;filter:alpha(opacity=60);opacity:0.6;background-color:#333333;color:#ffffff;font:12px Armata,sans-serif,Arial;'><div style='line-height:20px;'>"+l.options.freemark+"</div></div></a>")}else if(l.options.watermark){var d="<img src='"+l.options.watermark+"' style='border:none;' />";if(l.options.watermarklink)d="<a href='"+l.options.watermarklink+"' target='_blank'>"+d+"</a>";l.$watermark.html(d)}$("#html5-lightbox-overlay",l.$lightbox).click(l.finish);l.$close.click(l.finish);l.$next.click(function(){l.gotoSlide(-1)});l.$prev.click(function(){l.gotoSlide(-2)});$(window).resize(function(){if(!l.options.isMobile){clearTimeout(l.options.resizeTimeout);l.options.resizeTimeout=setTimeout(function(){l.resizeWindow()},500)}});$(window).scroll(function(){l.scrollBox()});$(window).bind('orientationchange',function(e){if(l.options.isMobile)l.resizeWindow()})};l.calcNextPrevElem=function(){l.options.nextElem=-1;l.options.prevElem=-1;var j,curGroup=l.elemArray[l.options.curElem][ELEM_GROUP];if((curGroup!=undefined)&&(curGroup!=null)){for(j=l.options.curElem+1;j<l.elemArray.length;j++){if(l.elemArray[j][ELEM_GROUP]==curGroup){l.options.nextElem=j;break}}if(l.options.nextElem<0){for(j=0;j<l.options.curElem;j++){if(l.elemArray[j][ELEM_GROUP]==curGroup){l.options.nextElem=j;break}}}if(l.options.nextElem>=0){for(j=l.options.curElem-1;j>=0;j--){if(l.elemArray[j][ELEM_GROUP]==curGroup){l.options.prevElem=j;break}}if(l.options.prevElem<0){for(j=l.elemArray.length-1;j>l.options.curElem;j--){if(l.elemArray[j][ELEM_GROUP]==curGroup){l.options.prevElem=j;break}}}}}};l.clickHandler=function(){if(l.elemArray.length<=0)return true;var a=$(this);l.hideObjects();for(var i=0;i<l.elemArray.length;i++){if(l.elemArray[i][ELEM_HREF]==a.attr("href"))break}if(i==l.elemArray.length)return true;l.options.curElem=i;l.options.nextElem=-1;l.options.prevElem=-1;l.calcNextPrevElem();l.$next.hide();l.$prev.hide();l.reset();l.$lightbox.show();if(!l.options.supportCSSPositionFixed)l.$lightbox.css("top",$(window).scrollTop());var b=l.options.loadingwidth+2*l.options.bordersize;var c=l.options.loadingheight+2*l.options.bordersize;var d=Math.round($(window).height()/2-(c+l.options.barheight)/2);l.$lightboxBox.css({"margin-top":d,"width":b,"height":c});l.$elemWrap.css({"width":b,"height":c});l.loadCurElem();return false};l.loadElem=function(a){l.showing=true;l.$elem.unbind("mouseenter").unbind("mouseleave").unbind("mousemove");l.$next.hide();l.$prev.hide();l.$loading.show();switch(a[m]){case 0:var b=new Image();$(b).load(function(){l.showImage(a,b.width,b.height)});$(b).error(function(){l.showError()});b.src=a[ELEM_HREF];break;case 1:l.showSWF(a);break;case 2:l.showVideo(a);break;case 3:case 4:l.showYoutubeVimeo(a);break;case 5:l.showPDF(a);break;case 6:l.showMP3(a);break;case 7:l.showWeb(a);break}};l.loadCurElem=function(){l.loadElem(l.elemArray[l.options.curElem])};l.showError=function(){l.$loading.hide();l.resizeLightbox(l.options.errorwidth,l.options.errorheight,true,function(){l.$error.show();l.$elem.fadeIn(l.options.fadespeed,function(){l.showData()})})};l.calcTextWidth=function(a){var b=a-36;if((l.options.prevElem>0)||(l.options.nextElem>0))b-=36;return b};l.showImage=function(a,b,c){var d,elemH;if(a[ELEM_WIDTH]){d=a[ELEM_WIDTH]}else{d=b;a[ELEM_WIDTH]=b}if(a[ELEM_HEIGHT]){elemH=a[ELEM_HEIGHT]}else{elemH=c;a[ELEM_HEIGHT]=c}var e=l.calcElemSize({w:d,h:elemH});l.resizeLightbox(e.w,e.h,true,function(){l.$text.css({width:l.calcTextWidth(e.w)});l.$text.html(a[ELEM_TITLE]);l.$image.show().css({width:e.w,height:e.h});l.$image.html("<img src='"+a[ELEM_HREF]+"' width='"+e.w+"' height='"+e.h+"' />");l.$elem.fadeIn(l.options.fadespeed,function(){l.showData()})})};l.showSWF=function(a){var b=(a[ELEM_WIDTH])?a[ELEM_WIDTH]:480;var c=(a[ELEM_HEIGHT])?a[ELEM_HEIGHT]:270;var d=l.calcElemSize({w:b,h:c});b=d.w;c=d.h;l.resizeLightbox(b,c,true,function(){l.$text.css({width:l.calcTextWidth(b)});l.$text.html(a[ELEM_TITLE]);l.$image.html("<div id='html5lightbox-swf' style='display:block;width:"+b+"px;height:"+c+"px;'></div>").show();l.embedFlash($("#html5lightbox-swf"),b,c,a[ELEM_HREF],'window',{width:b,height:c});l.$elem.show();l.showData()})};l.showVideo=function(d){var e=(d[ELEM_WIDTH])?d[ELEM_WIDTH]:480;var f=(d[ELEM_HEIGHT])?d[ELEM_HEIGHT]:270;var g=l.calcElemSize({w:e,h:f});e=g.w;f=g.h;l.resizeLightbox(e,f,true,function(){l.$text.css({width:l.calcTextWidth(e)});l.$text.html(d[ELEM_TITLE]);l.$image.html("<div id='html5lightbox-video' style='display:block;width:"+e+"px;height:"+f+"px;'></div>").show();var a=false;if(l.options.isMobile){a=true}else if((l.options.html5player||!l.options.flashInstalled)&&l.options.html5VideoSupported){if((!l.options.isFirefox)||(l.options.isFirefox&&(d[ELEM_HREF_OGG]||d[ELEM_HREF_WEBM])))a=true}if(a){var b=d[ELEM_HREF];if(l.options.isFirefox||!b)b=d[ELEM_HREF_WEBM]?d[ELEM_HREF_WEBM]:d[ELEM_HREF_OGG];l.embedHTML5Video($("#html5lightbox-video"),e,f,b,l.options.autoplay)}else{var c=d[ELEM_HREF];if((c.charAt(0)!="/")&&(c.substring(0,5)!="http:")&&(c.substring(0,6)!="https:"))c=l.options.htmlfolder+c;l.embedFlash($("#html5lightbox-video"),e,f,l.options.jsfolder+"html5boxplayer.swf",'transparent',{width:e,height:f,videofile:c,autoplay:(l.options.autoplay?"1":"0"),errorcss:".html5box-error"+l.options.errorcss,id:0})}l.$elem.show();l.showData()})};l.prepareYoutubeHref=function(a){var b='';var c=/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\??v?=?))([^#\&\?]*).*/;var d=a.match(c);if(d&&d[7]&&(d[7].length==11))b=d[7];return'http://www.youtube.com/embed/'+b};l.showYoutubeVimeo=function(b){var c=(b[ELEM_WIDTH])?b[ELEM_WIDTH]:480;var d=(b[ELEM_HEIGHT])?b[ELEM_HEIGHT]:270;var e=l.calcElemSize({w:c,h:d});c=e.w;d=e.h;l.resizeLightbox(c,d,true,function(){l.$text.css({width:l.calcTextWidth(c)});l.$text.html(b[ELEM_TITLE]);l.$image.html("<div id='html5lightbox-video' style='display:block;width:"+c+"px;height:"+d+"px;'></div>").show();var a=b[ELEM_HREF];if(b[m]==3)a=l.prepareYoutubeHref(a);if(l.options.autoplay){if(a.indexOf("?")<0)a+="?autoplay=1";else a+="&autoplay=1"}if(b[m]==3){if(a.indexOf('?')<0)a+='?wmode=transparent&rel=0';else a+='&wmode=transparent&rel=0'}$("#html5lightbox-video").html("<iframe width='"+c+"' height='"+d+"' src='"+a+"' frameborder='0' webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>");l.$elem.show();l.showData()})};l.showPDF=function(a){};l.showMP3=function(a){};l.showWeb=function(a){var b=(a[ELEM_WIDTH])?a[ELEM_WIDTH]:$(window).width();var c=(a[ELEM_HEIGHT])?a[ELEM_HEIGHT]:$(window).height();var d=l.calcElemSize({w:b,h:c});b=d.w;c=d.h;l.resizeLightbox(b,c,true,function(){l.$text.css({width:l.calcTextWidth(b)});l.$text.html(a[ELEM_TITLE]);l.$image.html("<div id='html5lightbox-web' style='display:block;width:"+b+"px;height:"+c+"px;'></div>").show();$("#html5lightbox-web").html("<iframe width='"+b+"' height='"+c+"' src='"+a[ELEM_HREF]+"' frameborder='0'></iframe>");l.$elem.show();l.showData()})};l.scrollBox=function(){if(!l.options.supportCSSPositionFixed)l.$lightbox.css("top",$(window).scrollTop())};l.resizeWindow=function(){var a=Math.round($(window).height()/2-(l.$lightboxBox.height()+l.options.barheight)/2);l.$lightboxBox.animate({"margin-top":a},l.options.resizespeed)};l.calcElemSize=function(a){var b=$(window).height()-l.options.barheight-2*l.options.bordersize;if(a.h>b){a.w=Math.round(a.w*b/a.h);a.h=b}var c=$(window).width()-2*l.options.bordersize;if(a.w>c){a.h=Math.round(a.h*c/a.w);a.w=c}return a};l.showData=function(){l.$elemData.show();l.$lightboxBox.animate({height:l.$lightboxBox.height()+l.options.barheight},{queue:true,duration:l.options.resizespeed})};l.resizeLightbox=function(a,b,c,d){var e=(c)?l.options.resizespeed:0;var f=a+2*l.options.bordersize;var g=b+2*l.options.bordersize;var h=Math.round($(window).height()/2-(g+l.options.barheight)/2);if((f==l.$elemWrap.width())&&(g==l.$elemWrap.height()))e=0;l.$loading.hide();l.$watermark.hide();l.$lightboxBox.animate({"margin-top":h},e,function(){l.$lightboxBox.css({"width":f,"height":g});l.$elemWrap.animate({width:f},e).animate({height:g},e,function(){l.$loading.show();l.$watermark.hide();l.$elem.bind("mouseenter mousemove",function(){if((l.options.prevElem>=0)||(l.options.nextElem>=0)){l.$next.fadeIn();l.$prev.fadeIn()}});l.$elem.bind("mouseleave",function(){l.$next.fadeOut();l.$prev.fadeOut()});d()})})};l.reset=function(){if(l.options.stamp)l.$watermark.hide();l.showing=false;l.$image.empty();l.$text.empty();l.$error.hide();l.$loading.hide();l.$image.hide();l.$elemData.hide()};l.finish=function(){l.reset();l.$lightbox.hide();l.showObjects()};l.pauseSlide=function(){};l.playSlide=function(){};l.gotoSlide=function(a){if(a==-1){if(l.options.nextElem<0)return;l.options.curElem=l.options.nextElem}else if(a==-2){if(l.options.prevElem<0)return;l.options.curElem=l.options.prevElem}l.calcNextPrevElem();l.reset();l.loadCurElem()};l.supportKeyboard=function(){$(document).keyup(function(e){if(!l.showing)return;if(l.options.supportesckey&&e.keyCode==27){l.finish()}else if(l.options.supportarrowkeys){if(e.keyCode==39)l.gotoSlide(-1);else if(e.keyCode==37)l.gotoSlide(-2)}})};l.enableSwipe=function(){};l.hideObjects=function(){$('select, embed, object').css({'visibility':'hidden'})};l.showObjects=function(){$('select, embed, object').css({'visibility':'visible'})};l.embedHTML5Video=function(a,w,h,b,c){a.html("<div style='position:absolute;display:block;width:"+w+"px;height:"+h+"px;'><video width="+w+" height="+h+((c)?" autoplay":"")+" controls='controls' src='"+b+"'></div>");if(l.options.isAndroid){var d=$("<div style='position:absolute;display:block;cursor:pointer;width:"+w+"px;height:"+h+"px;background:url(\""+l.options.skinfolder+l.options.playvideoimage+"\") no-repeat center center;'></div>").appendTo(a);d.unbind('click').click(function(){$("video",$(this).parent())[0].play()})}};l.embedFlash=function(a,w,h,b,c,d){if(l.options.flashInstalled){var e={pluginspage:"http://www.adobe.com/go/getflashplayer",quality:"high",allowFullScreen:"true",allowScriptAccess:"always",type:"application/x-shockwave-flash"};e.width=w;e.height=h;e.src=b;e.flashVars=$.param(d);e.wmode=c;var f="";for(var g in e)f+=g+"="+e[g]+" ";a.html("<embed "+f+"/>")}else{a.html("<div class='html5lightbox-flash-error' style='display:block; position:relative;text-align:center; width:"+w+"px; left:0px; top:"+Math.round(h/2-10)+"px;'><div class='html5-error'><div>The required Adobe Flash Player plugin is not installed</div><br /><div style='display:block;position:relative;text-align:center;width:112px;height:33px;margin:0px auto;'><a href='http://www.adobe.com/go/getflashplayer'><img src='http://www.adobe.com/images/shared/download_buttons/get_flash_player.gif' alt='Get Adobe Flash player' width='112' height='33'></img></a></div></div>")}};l.checkType=function(a){if(!a)return-1;if(a.match(/\.(jpg|gif|png|bmp|jpeg)(.*)?$/i))return 0;if(a.match(/[^\.]\.(swf)\s*$/i))return 1;if(a.match(/\.(flv|mp4|m4v|ogv|ogg|webm)(.*)?$/i))return 2;if((a.match(/\:\/\/.*(youtube\.com)/i))||(a.match(/\:\/\/.*(youtu\.be)/i)))return 3;if(a.match(/\:\/\/.*(vimeo\.com)/i))return 4;if(a.match(/[^\.]\.(pdf)\s*$/i))return 5;if(a.match(/[^\.]\.(mp3)\s*$/i))return 6;return 7};l.showLightbox=function(a,b,c,d,e,f,g){l.$next.hide();l.$prev.hide();l.reset();l.$lightbox.show();if(!l.options.supportCSSPositionFixed)l.$lightbox.css("top",$(window).scrollTop());var h=l.options.loadingwidth+2*l.options.bordersize;var i=l.options.loadingheight+2*l.options.bordersize;var j=Math.round($(window).height()/2-(i+l.options.barheight)/2);l.$lightboxBox.css({"margin-top":j,"width":h,"height":i});l.$elemWrap.css({"width":h,"height":i});l.loadElem(new Array(a,b,c,null,d,e,f,g))};l.addItem=function(a,b,c,d,e,f,g){type=l.checkType(a);l.elemArray.push(new Array(type,a,b,c,d,e,f,g))};l.showItem=function(a){if(l.elemArray.length<=0)return true;l.hideObjects();for(var i=0;i<l.elemArray.length;i++){if(l.elemArray[i][ELEM_HREF]==a)break}if(i==l.elemArray.length)return true;l.options.curElem=i;l.options.nextElem=-1;l.options.prevElem=-1;l.calcNextPrevElem();l.$next.hide();l.$prev.hide();l.reset();l.$lightbox.show();if(!l.options.supportCSSPositionFixed)l.$lightbox.css("top",$(window).scrollTop());var b=l.options.loadingwidth+2*l.options.bordersize;var c=l.options.loadingheight+2*l.options.bordersize;var d=Math.round($(window).height()/2-(c+l.options.barheight)/2);l.$lightboxBox.css({"margin-top":d,"width":b,"height":c});l.$elemWrap.css({"width":b,"height":c});l.loadCurElem();return false};l.init();return l.unbind('click').click(l.clickHandler)}})(jQuery);function ASTimer(a,b,c){var d=50;var e=null;var f=0;var g=false;var h=false;this.pause=function(){if(h){g=true;clearInterval(e)}};this.resume=function(){if(h&&g){g=false;e=setInterval(function(){f+=d;if(f>a){clearInterval(e);if(b)b()}if(c)c(f/a)},d)}};this.stop=function(){clearInterval(e);if(c)c(-1);f=0;g=false;h=false};this.start=function(){f=0;g=false;h=true;e=setInterval(function(){f+=d;if(f>a){clearInterval(e);if(b)b()}if(c)c(f/a)},d)}}var ASPlatforms={flashInstalled:function(){var a=false;try{if(new ActiveXObject('ShockwaveFlash.ShockwaveFlash'))a=true}catch(e){if(navigator.mimeTypes["application/x-shockwave-flash"])a=true}return a},html5VideoSupported:function(){return(!!document.createElement('video').canPlayType)},isChrome:function(){return(navigator.userAgent.match(/Chrome/i)!=null)},isFirefox:function(){return(navigator.userAgent.match(/Firefox/i)!=null)},isOpera:function(){return(navigator.userAgent.match(/Opera/i)!=null)},isSafari:function(){return(navigator.userAgent.match(/Safari/i)!=null)},isAndroid:function(){return(navigator.userAgent.match(/Android/i)!=null)},isIPad:function(){return(navigator.userAgent.match(/iPad/i)!=null)},isIPhone:function(){return((navigator.userAgent.match(/iPod/i)!=null)||(navigator.userAgent.match(/iPhone/i)!=null))},isIOS:function(){return this.isIPad()||this.isIPhone()},isIE9:function(){return(navigator.userAgent.match(/MSIE/i)!=null)&&this.html5VideoSupported()&&!this.isOpera()},isIE8:function(){return(navigator.userAgent.match(/MSIE 8/i)!=null)&&!this.isOpera()},isIE7:function(){return(navigator.userAgent.match(/MSIE 7/i)!=null)&&!this.isOpera()},isIE6:function(){return(navigator.userAgent.match(/MSIE 6/i)!=null)&&!this.isOpera()},isIE678:function(){return this.isIE6()||this.isIE7()||this.isIE8()},css33dTransformSupported:function(){return!this.isIE6()&&!this.isIE7()&&!this.isIE8()&&!this.isIE9()&&!this.isOpera()},applyBrowserStyles:function(a,b){var c={};for(var d in a){c[d]=a[d];c['-webkit-'+d]=(b)?'-webkit-'+a[d]:a[d];c['-moz-'+d]=(b)?'-moz-'+a[d]:a[d];c['-ms-'+d]=(b)?'-ms-'+a[d]:a[d];c['-o-'+d]=(b)?'-o-'+a[d]:a[d]}return c}};(function($){$.fn.amazingslider=function(G){var H=0,ELEM_SRC=1,ELEM_TITLE=2,ELEM_DESCRIPTION=3,ELEM_LINK=4,ELEM_TARGET=5,ELEM_VIDEO=6,ELEM_THUMBNAIL=7,ELEM_LIGHTBOX=8,ELEM_LIGHTBOXWIDTH=9,ELEM_LIGHTBOXHEIGHT=10;var I=1,TYPE_SWF=2,TYPE_MP3=3,TYPE_PDF=4,TYPE_VIDEO_FLASH=5,TYPE_VIDEO_MP4=6,TYPE_VIDEO_OGG=7,TYPE_VIDEO_WEBM=8,TYPE_VIDEO_YOUTUBE=9,TYPE_VIDEO_VIMEO=10;var J=function(a,b,c){this.container=a;this.options=b;this.id=c;this.transitionTimeout=null;this.arrowTimeout=null;this.lightboxArray=[];this.elemArray=[];this.container.children().hide();this.container.css({"display":"block","position":"relative"});this.initData(this.init)};J.prototype={initData:function(a){this.readTags();a(this)},readTags:function(){var m=this;$('.amazingslider-slides',this.container).find('li').each(function(){var a=$('img',$(this));if(a.length>0){var b=(a.data("src")&&(a.data("src").length>0))?a.data("src"):'';var c=(a.attr("src")&&(a.attr("src").length>0))?a.attr("src"):b;var d=(a.attr("alt")&&(a.attr("alt").length>0))?a.attr("alt"):'';var e=(a.data("description")&&(a.data("description").length>0))?a.data("description"):'';var f=(a.parent()&&a.parent().is("a"))?a.parent().attr("href"):'';var g=(a.parent()&&a.parent().is("a"))?a.parent().attr("target"):'';var h=(a.parent()&&a.parent().is("a"))?a.parent().hasClass("html5lightbox"):false;var i=(a.parent()&&h)?a.parent().data("width"):0;var j=(a.parent()&&h)?a.parent().data("height"):0;var k=[];if($('video',$(this)).length>0){$('video',$(this)).each(function(){k.push({href:$(this).attr('src'),type:m.checkVideoType($(this).attr('src'))})})}var l=new Array(m.elemArray.length,c,d,e,f,g,k,"",h,i,j);m.elemArray.push(l);if(h)m.lightboxArray.push(l)}});$('.amazingslider-thumbnails',this.container).find('li').each(function(a){var b=$('img',$(this));if((b.length>0)&&(m.elemArray.length>a)){var c=(b.data("src")&&(b.data("src").length>0))?b.data("src"):'';var d=(b.attr("src")&&(b.attr("src").length>0))?b.attr("src"):c;m.elemArray[a][ELEM_THUMBNAIL]=d}});if(this.options.shownumbering){for(var i=0;i<this.elemArray.length;i++){var n=this.options.numberingformat.replace("%NUM",i+1).replace("%TOTAL",this.elemArray.length);this.elemArray[i][ELEM_TITLE]=n+this.elemArray[i][ELEM_TITLE]}}},init:function(a){if(a.elemArray.length<=0)return;a.isAnimating=false;a.isPaused=!a.options.autoplay;a.tempPaused=false;a.initVideoApi();a.createMarkup();a.createStyle();a.createNav();a.createArrows();a.createBottomShadow();a.createBackgroundImage();a.createText();a.createSliderTimeout();a.createWatermark();a.createRibbon();a.createGoogleFonts();a.initHtml5Lightbox();a.curElem=-1;a.prevElem=-1;a.nextElem=-1;a.firstslide=true;a.loopCount=0;a.pauseCarousel=false;var b=0;var c=a.getParams();var d=parseInt(c["firstslideid"]);if(!isNaN(d)&&(d>=1)&&(d<=a.elemArray.length))b=d-1;else if(a.options.randomplay)b=Math.floor(Math.random()*a.elemArray.length);a.slideRun(b)},getParams:function(){var a={};var b=window.location.search.substring(1).split("&");for(var i=0;i<b.length;i++){var c=b[i].split("=");if(c&&(c.length==2))a[c[0].toLowerCase()]=unescape(c[1])}return a},initHtml5Lightbox:function(){var i;if(this.lightboxArray.length>0){var a=(this.options.skinsfoldername.length>0)?(this.options.skinsfoldername+'/'):'';this.html5Lightbox=$([]).html5lightbox({jsfolder:this.options.jsfolder,skinfolder:a});for(i=0;i<this.lightboxArray.length;i++){this.html5Lightbox.addItem(this.lightboxArray[i][ELEM_LINK],this.lightboxArray[i][ELEM_TITLE],'amazingslider'+this.id,this.lightboxArray[i][ELEM_LIGHTBOXWIDTH],this.lightboxArray[i][ELEM_LIGHTBOXHEIGHT],null,null)}}},createGoogleFonts:function(){if(this.options.previewmode)return;if(this.options.addgooglefonts&&this.options.googlefonts&&this.options.googlefonts.length>0){var a=('https:'==document.location.protocol?'https':'http')+"://fonts.googleapis.com/css?family="+this.options.googlefonts;var b=document.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("href",a);document.getElementsByTagName("head")[0].appendChild(b)}},createRibbon:function(){if(!this.options.showribbon||(this.options.ribbonimage.length<=0))return;$(".amazingslider-ribbon-"+this.id,this.container).html("<img src='"+this.options.skinsfolder+this.options.ribbonimage+"' style='border:none;' />")},createWatermark:function(){if(!this.options.showwatermark)return;if((this.options.watermarkstyle=='text')&&(this.options.watermarktext.length<=0))return;if((this.options.watermarkstyle=='')&&(this.options.watermarkimage.length<=0))return;var a='';if(this.options.watermarklink){a+="<a href='"+this.options.watermarklink+"' style='"+this.options.watermarklinkcss+"'";if(this.options.watermarktarget)a+=" target='"+this.options.watermarktarget+"'";a+=">"}if(this.options.watermarkstyle==''){a+=this.options.watermarktext}else if(this.options.watermarkstyle==''){a+="<img src='"+this.options.skinsfolder+this.options.watermarkimage+"' style='border:none;' />"}if(this.options.watermarklink)a+="</a>";$(".amazingslider--"+this.id,this.container).html(a)},initVideoApi:function(){var i,j,videos;var a=false,initVimeo=false;for(i=0;i<this.elemArray.length;i++){videos=this.elemArray[i][ELEM_VIDEO];for(j=0;j<videos.length;j++){if(videos[j].type==TYPE_VIDEO_YOUTUBE)a=true;else if(videos[j].type==TYPE_VIDEO_VIMEO)initVimeo=true}}if(a){var b=document.createElement('script');b.src=('https:'==document.location.protocol?'https':'http')+"://www.youtube.com/iframe_api";var c=document.getElementsByTagName('script')[0];c.parentNode.insertBefore(b,c)}if(initVimeo){var b=document.createElement('script');b.src=this.options.jsfolder+"froogaloop2.min.js";var c=document.getElementsByTagName('script')[0];c.parentNode.insertBefore(b,c)}},createSliderTimeout:function(){var b=this;this.sliderTimeout=new ASTimer(this.options.slideinterval,function(){b.slideRun(-1)},((this.options.showtimer)?(function(a){b.updateTimer(a)}):null));if(b.options.pauseonmouseover){$(".amazingslider-slider-"+this.id,this.container).hover(function(){if(!b.isPaused)b.sliderTimeout.pause()},function(){if(!b.isPaused)b.sliderTimeout.resume()})}if(b.options.showtimer)$(".amazingslider-timer-"+b.id,b.container).css({display:'block',position:'absolute',left:'0px',top:((b.options.timerposition=='bottom')?'':'0px'),bottom:((b.options.timerposition=='bottom')?'0px':''),width:'0%',height:b.options.timerheight+'px','background-color':b.options.timercolor,opacity:b.options.timeropacity,filter:'alpha(opacity='+Math.round(100*b.options.timeropacity)+')'})},updateTimer:function(a){w=Math.round(a*100)+1;if(w>100)w=100;if(w<0)w=0;$(".amazingslider-timer-"+this.id,this.container).css({width:w+'%'})},createMarkup:function(){this.$wrapper=jQuery(""+"<div class='amazingslider-wrapper-"+this.id+"'>"+"<div class='amazingslider-background-image-"+this.id+"'></div>"+"<div class='amazingslider-bottom-shadow-"+this.id+"'></div>"+"<div class='amazingslider-slider-"+this.id+"'>"+"<div class='amazingslider-box-"+this.id+"'>"+"<div class='amazingslider-swipe-box-"+this.id+"'>"+"<div class='amazingslider-space-"+this.id+"'></div>"+"<div class='amazingslider-img-box-"+this.id+"'></div>"+"</div>"+"</div>"+"<div class='amazingslider-text-wrapper-"+this.id+"'></div>"+"<div class='amazingslider-play-"+this.id+"'></div>"+"<div class='amazingslider-video-wrapper-"+this.id+"'></div>"+"<div class='amazingslider-ribbon-"+this.id+"'></div>"+"<div class='amazingslider-arrow-left-"+this.id+"'></div>"+"<div class='amazingslider-arrow-right-"+this.id+"'></div>"+"<div class='amazingslider-timer-"+this.id+"'></div>"+"<div class='amazingslider-watermark-"+this.id+"'></div>"+"</div>"+"<div class='amazingslider-nav-"+this.id+"'><div class='amazingslider-nav-container-"+this.id+"'></div></div>"+"</div>");this.$wrapper.appendTo(this.container);var a=this;if(this.options.enabletouchswipe){$(".amazingslider-swipe-box-"+this.id,this.container).touchSwipe({swipeLeft:function(){a.slideRun(-1)},swipeRight:function(){a.slideRun(-2)}})}$(".amazingslider-play-"+this.id,this.container).click(function(){a.playVideo(true)})},playVideo:function(a){var b=this.elemArray[this.curElem][ELEM_VIDEO];if(b.length<=0)return;this.sliderTimeout.stop();this.tempPaused=true;var c=b[0].href;var d=b[0].type;if(d==TYPE_VIDEO_YOUTUBE)this.playYoutubeVideo(c,a);else if(d==TYPE_VIDEO_VIMEO)this.playVimeoVideo(c,a)},playVimeoVideo:function(b,c){var d=$(".amazingslider-video-wrapper-"+this.id,this.container);d.css({display:'block',width:'100%',height:'100%'});if(this.options.previewmode){d.html("<div class='amazingslider-error-"+this.id+"'>To view Vimeo video, publish the slider then open it in your web browser</div>");return}else{var e=b+((b.indexOf("?")<0)?'?':'&')+'autoplay='+(c?'1':'0')+'&api=1&player_id=amazingslider_vimeo_'+this.id;d.html("<iframe id='amazingslider_vimeo_"+this.id+"' width='"+this.options.width+"' height='"+this.options.height+"' src='"+e+"' frameborder='0' webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>");var f=$('#amazingslider_vimeo_'+this.id)[0];var g=$f(f);var h=this;g.addEvent('ready',function(){g.addEvent('finish',function(a){h.tempPaused=false;if(!h.isPaused)h.slideRun(-1)})})}},playYoutubeVideo:function(b,c){var d=$(".amazingslider-video-wrapper-"+this.id,this.container);d.css({display:'block',width:'100%',height:'100%'});if(this.options.previewmode){d.html("<div class='amazingslider-error-"+this.id+"'>To view YouTube video, publish the slider then open it in your web browser</div>");return}var e=this;if(!ASYouTubeIframeAPIReady){ASYouTubeTimeout+=100;if(ASYouTubeTimeout<3000){setTimeout(function(){e.playYoutubeVideo(b,c)},100);return}}if(ASYouTubeIframeAPIReady&&!ASPlatforms.isIE6()&&!ASPlatforms.isIE7()&&!ASPlatforms.isIOS()){d.html("<div id='amazingslider-video-"+this.id+"' style='display:block;'></div>");var f=b.match(/(\?v=|\/\d\/|\/embed\/|\/v\/|\.be\/)([a-zA-Z0-9\-\_]+)/)[2];new YT.Player('amazingslider-video-'+this.id,{width:e.options.width,height:e.options.height,videoId:f,playerVars:{'autoplay':1,'rel':0,'autohide':1,'wmode':'transparent'},events:{'onReady':function(a){a.target.playVideo()},'onStateChange':function(a){if(a.data==YT.PlayerState.ENDED){e.tempPaused=false;if(!e.isPaused)e.slideRun(-1)}}}})}else{var g=b+((b.indexOf("?")<0)?'?':'&')+"autoplay=1&wmode=transparent&rel=0&autohide=1";d.html("<iframe width='"+e.options.width+"' height='"+e.options.height+"' src='"+g+"' frameborder='0' webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>")}},checkVideoType:function(a){if(!a)return-1;if(a.match(/\.(flv)(.*)?$/i))return TYPE_VIDEO_FLASH;if(a.match(/\.(mp4|m4v)(.*)?$/i))return TYPE_VIDEO_MP4;if(a.match(/\.(ogv|ogg)(.*)?$/i))return TYPE_VIDEO_OGG;if(a.match(/\.(webm)(.*)?$/i))return TYPE_VIDEO_WEBM;if((a.match(/\:\/\/.*(youtube\.com)/i))||(a.match(/\:\/\/.*(youtu\.be)/i)))return TYPE_VIDEO_YOUTUBE;if(a.match(/\:\/\/.*(vimeo\.com)/i))return TYPE_VIDEO_VIMEO;return 0},createText:function(){if(this.options.textstyle=='none')return;var m=this;var n=$(".amazingslider-text-wrapper-"+this.id,this.container);if(this.options.textstyle=='static'){n.html("<div class='amazingslider-text-"+this.id+"'>"+"<div class='amazingslider-text-bg-"+this.id+"'></div>"+"<div class='amazingslider-title-"+this.id+"'></div>"+"<div class='amazingslider-description-"+this.id+"'></div>"+"</div>");n.css({display:((this.options.textautohide)?'none':'block'),overflow:'hidden',width:'100%',height:'auto',position:'absolute'});if(this.options.textautohide){$(".amazingslider-slider-"+this.id,this.container).hover(function(){$(".amazingslider-text-wrapper-"+m.id,m.container).fadeIn()},function(){$(".amazingslider-text-wrapper-"+m.id,m.container).fadeOut()})}switch(this.options.textpositionstatic){case'top':n.css({left:'0px',top:'0px','margin-top':this.options.textpositionmarginstatic+'px'});break;case'bottom':n.css({left:'0px',bottom:'0px','margin-bottom':this.options.textpositionmarginstatic+'px'});break;case'topoutside':n.css({left:'0px',bottom:'100%','margin-bottom':this.options.textpositionmarginstatic+'px'});break;case'bottomoutside':n.css({left:'0px',top:'100%','margin-top':this.options.textpositionmarginstatic+'px'});break}}else{n.html("<div class='amazingslider-text-holding-"+this.id+"' style='visibility:hidden;"+this.options.textcss+"'>"+"<div class='amazingslider-text-bg-"+this.id+"'></div>"+"<div class='amazingslider-title-"+this.id+"'></div>"+"<div class='amazingslider-description-"+this.id+"'></div>"+"</div>"+"<div class='amazingslider-text-"+this.id+"' style='position:absolute;top:0%;left:0%;"+(ASPlatforms.isIE678()?"opacity:inherit;filter:inherit;":"")+"'>"+"<div class='amazingslider-text-bg-"+this.id+"'></div>"+"<div class='amazingslider-title-"+this.id+"'></div>"+"<div class='amazingslider-description-"+this.id+"'></div>"+"</div>");n.css({display:'none',overflow:'hidden',position:'absolute'})}$("head").append("<style type='text/css'>"+".amazingslider-text-"+this.id+" {"+this.options.textcss+"} "+".amazingslider-text-bg-"+this.id+" {"+this.options.textbgcss+"} "+".amazingslider-title-"+this.id+" {"+this.options.titlecss+"} "+".amazingslider-description-"+this.id+" {"+this.options.descriptioncss+"} "+"</style>");this.container.bind('amazingslider.switchtext',function(f,g,h){var i=$(".amazingslider-text-wrapper-"+m.id,m.container);var j=$(".amazingslider-text-bg-"+m.id,m.container);var k=$(".amazingslider-title-"+m.id,m.container);var l=$(".amazingslider-description-"+m.id,m.container);if(m.options.textstyle=='static'){k.html(m.elemArray[h][ELEM_TITLE]);l.html(m.elemArray[h][ELEM_DESCRIPTION]);if(!m.elemArray[h][ELEM_TITLE]&&!m.elemArray[h][ELEM_DESCRIPTION])j.hide();else j.show()}else if(m.options.textstyle=='dynamic'){if(!m.elemArray[h][ELEM_TITLE]&&!m.elemArray[h][ELEM_DESCRIPTION])i.fadeOut();else{i.fadeOut(function(){var a='bottomleft';var b=m.options.textpositiondynamic;if(b){b=b.split(",");a=b[Math.floor(Math.random()*b.length)];a=$.trim(a.toLowerCase())}switch(a){case'topleft':i.css({left:'0px',right:'',top:'0px',bottom:''});i.css({margin:m.options.textpositionmargintop+'px '+m.options.textpositionmarginleft+'px'});break;case'topright':i.css({left:'',right:'0px',top:'0px',bottom:''});i.css({margin:m.options.textpositionmargintop+'px '+m.options.textpositionmarginright+'px'});break;case'bottomleft':i.css({left:'0px',right:'',top:'',bottom:'0px'});i.css({margin:m.options.textpositionmarginbottom+'px '+m.options.textpositionmarginleft+'px'});break;case'bottomright':i.css({left:'',right:'0px',top:'',bottom:'0px'});i.css({margin:m.options.textpositionmarginbottom+'px '+m.options.textpositionmarginright+'px'});break}k.html(m.elemArray[h][ELEM_TITLE]);l.html(m.elemArray[h][ELEM_DESCRIPTION]);var c=null;var d=m.options.texteffect;if(d){d=d.split(",");c=d[Math.floor(Math.random()*d.length)];c=$.trim(c.toLowerCase())}var e=$(".amazingslider-text-"+m.id,m.container);switch(c){case'fade':e.hide();i.show();e.delay(500).fadeIn(m.options.texteffectduration);break;case'slide':e.css({left:'-100%',opacity:0,display:'block'});i.show();e.delay(500).animate({left:'0%',opacity:1},m.options.texteffectduration,m.options.texteffecteasing);break;default:e.delay(500).show()}})}}})},createStyle:function(){$(".amazingslider-space-"+this.id,this.container).html("<img style='width:100%;max-width:100%;' src='"+this.elemArray[0][ELEM_SRC]+"' />");if(this.options.isresponsive)this.container.css({"max-width":this.options.width,"max-height":this.options.height});else this.container.css({"width":this.options.width,"height":this.options.height});var a=".amazingslider-wrapper-"+this.id+" {display:block;position:relative;width:100%;height:auto;}";a+=".amazingslider-slider-"+this.id+" {display:block;position:relative;left:0px;top:0px;width:100%;height:auto;";if(this.options.border>0)a+="margin-left:-"+this.options.border+"px;border-width:"+this.options.border+"px;border-style:solid;border-color:"+this.options.bordercolor+";";if(this.options.borderradius>0)a+="border-radius:"+this.options.borderradius+"px;-moz-border-radius:"+this.options.borderradius+"px;-webkit-border-radius:"+this.options.borderradius+"px;";if(this.options.showshadow){var b="0px 0px "+this.options.shadowsize+"px "+this.options.shadowcolor;a+="box-shadow:"+b+";-moz-box-shadow:"+b+";-webkit-box-shadow:"+b+";";if(ASPlatforms.isIE678()||ASPlatforms.isIE9){a+="filter:progid:DXImageTransform.Microsoft.Shadow(color="+this.options.shadowcolor+",direction=135,strength="+this.options.shadowsize+");"}}a+="}";a+=".amazingslider-box-"+this.id+" {display:block;position:relative;left:0px;top:0px;width:100%;height:auto;}";a+=".amazingslider-swipe-box-"+this.id+" {display:block;position:relative;left:0px;top:0px;width:100%;height:auto;}";a+=".amazingslider-space-"+this.id+" {display:block;position:relative;left:0px;top:0px;width:100%;height:auto;visibility:hidden;line-height:0px;font-size:0px;}";a+=".amazingslider-img-box-"+this.id+" {display:block;position:absolute;left:0px;top:0px;width:100%;height:100%;}";a+=".amazingslider-play-"+this.id+" {display:none;position:absolute;left:50%;top:50%;cursor:pointer;width:"+this.options.playvideoimagewidth+"px;height:"+this.options.playvideoimageheight+"px;margin-top:"+"-"+Math.round(this.options.playvideoimageheight/2)+"px;margin-left:"+'-'+Math.round(this.options.playvideoimagewidth/2)+"px; background:url('"+this.options.skinsfolder+this.options.playvideoimage+"') no-repeat left top;}";a+=".amazingslider-video-wrapper-"+this.id+" {display:none;position:absolute;left:0px;top:0px;background-color:#000;text-align:center;}";a+=".amazingslider-error-"+this.id+" {display:block;position:relative;margin:0 auto;width:80%;top:50%;color:#fff;font:16px Arial,Tahoma,Helvetica,sans-serif;}";if(this.options.showwatermark){if(((this.options.watermarkstyle=='text')&&(this.options.watermarktext.length>0))||((this.options.watermarkstyle=='image')&&(this.options.watermarkimage.length>0))){a+=".amazingslider-watermark-"+this.id+" {"+this.options.watermarkpositioncss;if((this.options.watermarkstyle=='text')&&(this.options.watermarktext.length>0))a+=this.options.watermarktextcss;if(this.options.watermarklink)a+="cursor:pointer;";a+="}"}}if(this.options.showribbon){a+=".amazingslider-ribbon-"+this.id+" {display:block;position:absolute;";switch(this.options.ribbonposition){case'topleft':a+="left:"+this.options.ribbonimagex+"px;top:"+this.options.ribbonimagey+"px;";break;case'topright':a+="right:"+this.options.ribbonimagex+"px;top:"+this.options.ribbonimagey+"px;";break;case'bottomleft':a+="left:"+this.options.ribbonimagex+"px;bottom:"+this.options.ribbonimagey+"px;";break;case'bottomright':a+="right:"+this.options.ribbonimagex+"px;bottom:"+this.options.ribbonimagey+"px;";break;case'top':a+="width:100%;height:auto;margin:0 auto;top:"+this.options.ribbonimagey+"px;";case'bottom':a+="width:100%;height:auto;text-align:center;bottom:"+this.options.ribbonimagey+"px;"}a+="}"}a+=".amazingslider-video-wrapper-"+this.id+" video {max-width:100%;height:auto;}";a+=".amazingslider-video-wrapper-"+this.id+" iframe, "+".amazingslider-video-wrapper-"+this.id+" object, "+".amazingslider-video-wrapper-"+this.id+" embed {position:absolute;top:0;left:0;width:100%;height:100%;}";if((this.options.navstyle=="thumbnails")&&(this.options.navthumbstyle!='imageonly')){a+=".amazingslider-nav-thumbnail-tite-"+this.id+" {"+this.options.navthumbtitlecss+"}";a+=".amazingslider-nav-thumbnail-tite-"+this.id+":hover {"+this.options.navthumbtitlehovercss+"}";if(this.options.navthumbstyle=='imageandtitledescription')a+=".amazingslider-nav-thumbnail-description-"+this.id+" {"+this.options.navthumbdescriptioncss+"}"}$("head").append("<style type='text/css'>"+a+"</style>")},createBottomShadow:function(){if(!this.options.showbottomshadow)return;var a=$(".amazingslider-bottom-shadow-"+this.id,this.container);var l=(100-this.options.bottomshadowimagewidth)/2;a.css({display:'block',position:'absolute',left:l+'%',top:this.options.bottomshadowimagetop+'%',width:this.options.bottomshadowimagewidth+'%',height:'auto'});a.html("<img src='"+this.options.skinsfolder+this.options.bottomshadowimage+"' style='display:block;position:relative;width:100%;height:auto;' />")},createBackgroundImage:function(){if(!this.options.showbackgroundimage||!this.options.backgroundimage)return;var a=$(".amazingslider-background-image-"+this.id,this.container);var l=(100-this.options.backgroundimagewidth)/2;a.css({display:'block',position:'absolute',left:l+'%',top:this.options.backgroundimagetop+'%',width:this.options.backgroundimagewidth+'%',height:'auto'});a.html("<img src='"+this.options.skinsfolder+this.options.backgroundimage+"' style='display:block;position:relative;width:100%;height:auto;' />")},createArrows:function(){if(this.options.arrowstyle=='none')return;var a=this;var b=$(".amazingslider-arrow-left-"+this.id,this.container);var c=$(".amazingslider-arrow-right-"+this.id,this.container);b.css({overflow:'hidden',position:'absolute',cursor:'pointer',width:this.options.arrowwidth+'px',height:this.options.arrowheight+'px',left:this.options.arrowmargin+'px',top:this.options.arrowtop+'%','margin-top':'-'+this.options.arrowheight/2+'px',background:"url('"+this.options.skinsfolder+this.options.arrowimage+"') no-repeat left top"});if(ASPlatforms.isIE678())b.css({opacity:'inherit',filter:'inherit'});b.hover(function(){$(this).css({'background-position':'left bottom'})},function(){$(this).css({'background-position':'left top'})});b.click(function(){a.slideRun(-2)});c.css({overflow:'hidden',position:'absolute',cursor:'pointer',width:this.options.arrowwidth+'px',height:this.options.arrowheight+'px',right:this.options.arrowmargin+'px',top:this.options.arrowtop+'%','margin-top':'-'+this.options.arrowheight/2+'px',background:"url('"+this.options.skinsfolder+this.options.arrowimage+"') no-repeat right top"});if(ASPlatforms.isIE678())c.css({opacity:'inherit',filter:'inherit'});c.hover(function(){$(this).css({'background-position':'right bottom'})},function(){$(this).css({'background-position':'right top'})});c.click(function(){a.slideRun(-1)});if(this.options.arrowstyle=='always'){b.css({display:'block'});c.css({display:'block'})}else{b.css({display:'none'});c.css({display:'none'});$(".amazingslider-slider-"+this.id,this.container).hover(function(){clearTimeout(a.arrowTimeout);if(ASPlatforms.isIE678()){$(".amazingslider-arrow-left-"+a.id,a.container).show();$(".amazingslider-arrow-right-"+a.id,a.container).show()}else{$(".amazingslider-arrow-left-"+a.id,a.container).fadeIn();$(".amazingslider-arrow-right-"+a.id,a.container).fadeIn()}},function(){a.arrowTimeout=setTimeout(function(){if(ASPlatforms.isIE678()){$(".amazingslider-arrow-left-"+a.id,a.container).hide();$(".amazingslider-arrow-right-"+a.id,a.container).hide()}else{$(".amazingslider-arrow-left-"+a.id,a.container).fadeOut();$(".amazingslider-arrow-right-"+a.id,a.container).fadeOut()}},a.options.arrowhideonmouseleave)})}},carMoveLeft:function(){var a=$(".amazingslider-nav-container-"+this.id,this.container);var b=$(".amazingslider-bullet-wrapper-"+this.id,this.container);if(a.width()>=b.width())return;if(this.options.navshowpreview)$(".amazingslider-nav-preview-"+this.id,this.container).hide();var c=a.width()+this.options.navspacing;var l=(isNaN(parseInt(b.css("margin-left")))?0:parseInt(b.css("margin-left")))-c;if(l<=(a.width()-b.width()))l=(a.width()-b.width());if(l>=0)l=0;b.animate({"margin-left":l},{queue:false,duration:500,easing:"easeOutCirc"});if(this.options.navthumbnavigationstyle!='auto')this.updateCarouselLeftRightArrow(l)},carMoveRight:function(){var a=$(".amazingslider-nav-container-"+this.id,this.container);var b=$(".amazingslider-bullet-wrapper-"+this.id,this.container);if(a.width()>=b.width())return;if(this.options.navshowpreview)$(".amazingslider-nav-preview-"+this.id,this.container).hide();var c=a.width()+this.options.navspacing;var l=(isNaN(parseInt(b.css("margin-left")))?0:parseInt(b.css("margin-left")))+c;if(l<=(a.width()-b.width()))l=(a.width()-b.width());if(l>=0)l=0;b.animate({"margin-left":l},{queue:false,duration:500,easing:"easeOutCirc"});if(this.options.navthumbnavigationstyle!='auto')this.updateCarouselLeftRightArrow(l)},carMoveBottom:function(){var a=$(".amazingslider-nav-container-"+this.id,this.container);var b=$(".amazingslider-bullet-wrapper-"+this.id,this.container);if(a.height()>=b.height())return;if(this.options.navshowpreview)$(".amazingslider-nav-preview-"+this.id,this.container).hide();var c=a.height()+this.options.navspacing;var l=(isNaN(parseInt(b.css("margin-top")))?0:parseInt(b.css("margin-top")))+c;if(l<=(a.height()-b.height()))l=(a.height()-b.height());if(l>=0)l=0;b.animate({"margin-top":l},{queue:false,duration:500,easing:"easeOutCirc"});if(this.options.navthumbnavigationstyle!='auto')this.updateCarouselLeftRightArrow(l)},carMoveTop:function(){var a=$(".amazingslider-nav-container-"+this.id,this.container);var b=$(".amazingslider-bullet-wrapper-"+this.id,this.container);if(a.height()>=b.height())return;if(this.options.navshowpreview)$(".amazingslider-nav-preview-"+this.id,this.container).hide();var c=a.height()+this.options.navspacing;var l=(isNaN(parseInt(b.css("margin-top")))?0:parseInt(b.css("margin-top")))-c;if(l<=(a.height()-b.height()))l=(a.height()-b.height());if(l>=0)l=0;b.animate({"margin-top":l},{queue:false,duration:500,easing:"easeOutCirc"});if(this.options.navthumbnavigationstyle!='auto')this.updateCarouselLeftRightArrow(l)},updateCarouselLeftRightArrow:function(l){var a=$(".amazingslider-nav-container-"+this.id,this.container);var b=$(".amazingslider-bullet-wrapper-"+this.id,this.container);if(this.options.navdirection=='vertical'){if(l==0){$(".amazingslider-car-left-arrow-"+this.id,this.container).css({'background-position':'left bottom',cursor:''});$(".amazingslider-car-left-arrow-"+this.id,this.container).data('disabled',true)}else{$(".amazingslider-car-left-arrow-"+this.id,this.container).css({'background-position':'left top',cursor:'pointer'});$(".amazingslider-car-left-arrow-"+this.id,this.container).data('disabled',false)}if((l==(a.height()-b.height()))){$(".amazingslider-car-right-arrow-"+this.id,this.container).css({'background-position':'right bottom',cursor:''});$(".amazingslider-car-right-arrow-"+this.id,this.container).data('disabled',true)}else{$(".amazingslider-car-right-arrow-"+this.id,this.container).css({'background-position':'right top',cursor:'pointer'});$(".amazingslider-car-right-arrow-"+this.id,this.container).data('disabled',false)}}else{if(l==0){$(".amazingslider-car-left-arrow-"+this.id,this.container).css({'background-position':'left bottom',cursor:''});$(".amazingslider-car-left-arrow-"+this.id,this.container).data('disabled',true)}else{$(".amazingslider-car-left-arrow-"+this.id,this.container).css({'background-position':'left top',cursor:'pointer'});$(".amazingslider-car-left-arrow-"+this.id,this.container).data('disabled',false)}if((l==(a.width()-b.width()))){$(".amazingslider-car-right-arrow-"+this.id,this.container).css({'background-position':'right bottom',cursor:''});$(".amazingslider-car-right-arrow-"+this.id,this.container).data('disabled',true)}else{$(".amazingslider-car-right-arrow-"+this.id,this.container).css({'background-position':'right top',cursor:'pointer'});$(".amazingslider-car-right-arrow-"+this.id,this.container).data('disabled',false)}}},createNav:function(){if((this.options.navstyle=='none')&&(!this.options.navshowbuttons))return;var f=this;var i;var g=$(".amazingslider-nav-"+this.id,this.container);var h=$(".amazingslider-nav-container-"+this.id,this.container);var j=$("<div class='amazingslider-bullet-wrapper-"+this.id+"' style='display:block;position:relative;'></div>");if(this.options.navstyle=='thumbnails'){this.options.navimagewidth=this.options.navwidth-this.options.navborder*2;this.options.navimageheight=this.options.navheight-this.options.navborder*2;if(this.options.navthumbstyle=='imageandtitle')this.options.navheight+=this.options.navthumbtitleheight;else if(this.options.navthumbstyle=='imageandtitledescription')this.options.navwidth+=this.options.navthumbtitlewidth}if(this.options.navdirection=='vertical'){var k=(this.options.navstyle=='none')?0:this.elemArray.length*this.options.navheight+(this.elemArray.length-1)*this.options.navspacing;if(this.options.navshowbuttons){if(this.options.navshowarrow){k+=(k>0)?this.options.navspacing:0;k+=2*this.options.navheight+this.options.navspacing}if(this.options.navshowplaypause&&!this.options.navshowplaypausestandalone){k+=(k>0)?this.options.navspacing:0;k+=this.options.navheight}}j.css({height:k+"px",width:"auto"})}else{var k=(this.options.navstyle=='none')?0:this.elemArray.length*this.options.navwidth+(this.elemArray.length-1)*this.options.navspacing;if(this.options.navshowbuttons){if(this.options.navshowarrow){k+=(k>0)?this.options.navspacing:0;k+=2*this.options.navwidth+this.options.navspacing}if(this.options.navshowplaypause&&!this.options.navshowplaypausestandalone){k+=(k>0)?this.options.navspacing:0;k+=this.options.navwidth}}j.css({width:k+"px",height:"auto"})}h.append(j);var o=0;var q=(this.options.navdirection=='vertical')?this.options.navwidth:this.options.navheight;if((this.options.navstyle=='thumbnails')&&this.options.navshowfeaturedarrow){q+=(this.options.navdirection=='vertical')?this.options.navfeaturedarrowimagewidth:this.options.navfeaturedarrowimageheight;o=(this.options.navdirection=='vertical')?this.options.navfeaturedarrowimagewidth:this.options.navfeaturedarrowimageheight}var s=('navmarginx'in this.options)?this.options.navmarginx:this.options.navmargin;var t=('navmarginy'in this.options)?this.options.navmarginy:this.options.navmargin;g.css({display:'block',position:'absolute',height:'auto'});switch(this.options.navposition){case'top':j.css({"margin-left":'auto',"margin-right":'auto','height':q+'px'});g.css({overflow:'hidden','width':'100%',top:'0%',left:'0px','margin-top':t+'px'});break;case'topleft':j.css({'height':q+'px'});g.css({overflow:'hidden','max-width':'100%',top:'0px',left:'0px','margin-top':t+'px','margin-left':s+'px'});break;case'topright':j.css({'height':q+'px'});g.css({overflow:'hidden','max-width':'100%',top:'0px',right:'0px','margin-top':t+'px','margin-right':s+'px'});break;case'bottom':j.css({"margin-left":'auto',"margin-right":'auto','margin-top':o+'px'});g.css({overflow:'hidden','width':'100%',top:'100%',left:'0px','margin-top':String(t-o)+'px'});break;case'bottomleft':j.css({'margin-top':o+'px'});g.css({overflow:'hidden','max-width':'100%',bottom:'0px',left:'0px','margin-bottom':t+'px','margin-top':String(t-o)+'px','margin-left':s+'px'});break;case'bottomright':j.css({'margin-top':o+'px'});g.css({overflow:'hidden','max-width':'100%',bottom:'0px',right:'0px','margin-bottom':t+'px','margin-top':String(t-o)+'px','margin-right':s+'px'});break;case'left':j.css({'width':q+'px'});g.css({overflow:'hidden','height':'100%',width:q+'px',top:'0%',left:'0%','margin-left':s+'px'});h.css({display:'block',position:'absolute',top:'0px',bottom:'0px',left:'0px',right:'0px',height:'auto'});break;case'right':j.css({'margin-left':o+'px'});g.css({overflow:'hidden','height':'100%',width:q+'px',top:'0%',left:'100%','margin-left':String(s-o)+'px'});h.css({display:'block',position:'absolute',top:'0px',bottom:'0px',left:'0px',right:'0px',height:'auto'});break}if(this.options.navstyle!='none'){var u;for(i=0;i<this.elemArray.length;i++){u=this.createNavBullet(i);j.append(u)}g.mouseenter(function(){f.pauseCarousel=true});g.mouseleave(function(){f.pauseCarousel=false});if(f.options.navthumbnavigationstyle=='auto'){g.mousemove(function(e){if(f.options.navdirection=='vertical'){if(g.height()>=j.height())return;var d=e.pageY-g.offset().top;if(d<10)d=0;if(d>g.height()-10)d=g.height();var r=d/g.height();var l=(g.height()-j.height())*r;j.animate({"margin-top":l},{queue:false,duration:20,easing:"easeOutCubic"})}else{if(g.width()>=j.width())return;var d=e.pageX-g.offset().left;if(d<10)d=0;if(d>g.width()-10)d=g.width();var r=d/g.width();var l=(g.width()-j.width())*r;j.animate({"margin-left":l},{queue:false,duration:20,easing:"easeOutCubic"})}})}else{if(((f.options.navdirection=='vertical')&&(j.height()>h.height()))||((f.options.navdirection=='horizontal')&&(j.width()>h.width()))){var m=f.options.navthumbnavigationarrowimagewidth+f.options.navspacing;if(f.options.navdirection=="horizontal"){var n=Math.floor(((g.width()-2*m)+f.options.navspacing)/(f.options.navwidth+f.options.navspacing));m=Math.floor((g.width()-n*f.options.navwidth-(n-1)*f.options.navspacing)/2)}if(f.options.navdirection=='vertical')h.css({'margin-top':m+'px','margin-bottom':m+'px',overflow:'hidden'});else h.css({'margin-left':m+'px','margin-right':m+'px',overflow:'hidden'});var v=$("<div class='amazingslider-car-left-arrow-"+f.id+"' style='display:none;'></div>");var w=$("<div class='amazingslider-car-right-arrow-"+f.id+"' style='display:none;'></div>");g.append(v);g.append(w);v.css({overflow:'hidden',position:'absolute',cursor:'pointer',width:f.options.navthumbnavigationarrowimagewidth+'px',height:f.options.navthumbnavigationarrowimageheight+'px',background:"url('"+f.options.skinsfolder+f.options.navthumbnavigationarrowimage+"') no-repeat left top"});w.css({overflow:'hidden',position:'absolute',cursor:'pointer',width:f.options.navthumbnavigationarrowimagewidth+'px',height:f.options.navthumbnavigationarrowimageheight+'px',background:"url('"+f.options.skinsfolder+f.options.navthumbnavigationarrowimage+"') no-repeat right top"});var p=(f.options.navdirection=='vertical')?(f.options.navwidth/2-f.options.navthumbnavigationarrowimagewidth/2):(f.options.navheight/2-f.options.navthumbnavigationarrowimageheight/2);if((f.options.navposition=='bottomleft')||(f.options.navposition=='bottomright')||(f.options.navposition=='bottom')||(f.options.navposition=='right'))p+=o;if(f.options.navdirection=='vertical'){v.css({top:'0px',left:'0px','margin-left':p+'px'});w.css({bottom:'0px',left:'0px','margin-left':p+'px'})}else{v.css({left:'0px',top:'0px','margin-top':p+'px'});w.css({right:'0px',top:'0px','margin-top':p+'px'})}if(ASPlatforms.isIE678())v.css({opacity:'inherit',filter:'inherit'});v.hover(function(){if(!$(this).data('disabled'))$(this).css({'background-position':'left center'})},function(){if(!$(this).data('disabled'))$(this).css({'background-position':'left top'})});v.click(function(){if(f.options.navdirection=='vertical')f.carMoveBottom();else f.carMoveRight()});if(ASPlatforms.isIE678())w.css({opacity:'inherit',filter:'inherit'});w.hover(function(){if(!$(this).data('disabled'))$(this).css({'background-position':'right center'})},function(){if(!$(this).data('disabled'))$(this).css({'background-position':'right top'})});w.click(function(){if(f.options.navdirection=='vertical')f.carMoveTop();else f.carMoveLeft()});v.css({display:'block','background-position':'left bottom',cursor:''});v.data('disabled',true);w.css({display:'block'})}}if(f.options.navdirection=='vertical'){g.touchSwipe({swipeTop:function(a){f.carMoveTop()},swipeBottom:function(){f.carMoveBottom()}})}else{g.touchSwipe({swipeLeft:function(a){f.carMoveLeft()},swipeRight:function(){f.carMoveRight()}})}this.container.bind('amazingslider.switch',function(a,b,c){$(".amazingslider-bullet-"+f.id+"-"+b,f.container)["bulletNormal"+f.id]();$(".amazingslider-bullet-"+f.id+"-"+c,f.container)["bulletSelected"+f.id]()});if(this.options.navshowpreview){var x=$("<div class='amazingslider-nav-preview-"+this.id+"' style='display:none;position:absolute;width:"+this.options.navpreviewwidth+"px;height:"+this.options.navpreviewheight+"px;background-color:"+this.options.navpreviewbordercolor+";padding:"+f.options.navpreviewborder+"px;'></div>");var y=$("<div class='amazingslider-nav-preview-arrow-"+this.id+"' style='display:block;position:absolute;width:"+this.options.navpreviewarrowwidth+"px;height:"+this.options.navpreviewarrowheight+"px;"+"background:url(\""+this.options.skinsfolder+this.options.navpreviewarrowimage+"\") no-repeat center center;' ></div>");switch(this.options.navpreviewposition){case'bottom':y.css({left:'50%',bottom:'100%','margin-left':'-'+Math.round(this.options.navpreviewarrowwidth/2)+'px'});break;case'top':y.css({left:'50%',top:'100%','margin-left':'-'+Math.round(this.options.navpreviewarrowwidth/2)+'px'});break;case'left':y.css({top:'50%',left:'100%','margin-top':'-'+Math.round(this.options.navpreviewarrowheight/2)+'px'});break;case'right':y.css({top:'50%',right:'100%','margin-top':'-'+Math.round(this.options.navpreviewarrowheight/2)+'px'});break}var z=$("<div class='amazingslider-nav-preview-images-"+this.id+"' style='display:block;position:relative;width:100%;height:100%;overflow:hidden;' />");x.append(y);x.append(z);if(this.options.navshowplayvideo){var A=$("<div class='amazingslider-nav-preview-play-"+this.id+"' style='display:none;position:absolute;left:0;top:0;width:100%;height:100%;"+"background:url(\""+this.options.skinsfolder+this.options.navplayvideoimage+"\") no-repeat center center;"+"' ></div>");x.append(A)}$(".amazingslider-wrapper-"+this.id,this.container).append(x)}if(this.options.navshowfeaturedarrow){j.append("<div class='amazingslider-nav-featuredarrow-"+this.id+"' style='display:none;position:absolute;width:"+this.options.navfeaturedarrowimagewidth+"px;"+"height:"+this.options.navfeaturedarrowimageheight+"px;"+"background:url(\""+this.options.skinsfolder+this.options.navfeaturedarrowimage+"\") no-repeat center center;'></div>")}}if(this.options.navshowbuttons){var B=(this.options.navdirection=='vertical')?'top':'left';var C=(this.options.navstyle=='none')?0:this.options.navspacing;if(this.options.navshowarrow){var D=$("<div class='amazingslider-nav-left-"+this.id+"' style='position:relative;float:"+B+";margin-"+B+":"+C+"px;width:"+this.options.navwidth+"px;height:"+this.options.navheight+"px;cursor:pointer;'></div>");j.append(D);if(this.options.navbuttonradius)D.css(ASPlatforms.applyBrowserStyles({'border-radius':this.options.navbuttonradius+'px'}));if(this.options.navbuttoncolor)D.css({'background-color':this.options.navbuttoncolor});if(this.options.navarrowimage)D.css({'background-image':"url('"+this.options.skinsfolder+this.options.navarrowimage+"')",'background-repeat':'no-repeat','background-position':'left top'});D.hover(function(){if(f.options.navbuttonhighlightcolor)$(this).css({'background-color':f.options.navbuttonhighlightcolor});if(f.options.navarrowimage)$(this).css({'background-position':'left bottom'})},function(){if(f.options.navbuttoncolor)$(this).css({'background-color':f.options.navbuttoncolor});if(f.options.navarrowimage)$(this).css({'background-position':'left top'})});D.click(function(){f.slideRun(-2)});C=this.options.navspacing}if(this.options.navshowplaypause){var E,$navPause;if(this.options.navshowplaypausestandalone){E=$("<div class='amazingslider-nav-play-"+this.id+"' style='position:absolute;width:"+this.options.navshowplaypausestandalonewidth+"px;height:"+this.options.navshowplaypausestandaloneheight+"px;'></div>");this.$wrapper.append(E);$navPause=$("<div class='amazingslider-nav-pause-"+this.id+"' style='position:absolute;width:"+this.options.navshowplaypausestandalonewidth+"px;height:"+this.options.navshowplaypausestandaloneheight+"px;'></div>");this.$wrapper.append($navPause);switch(this.options.navshowplaypausestandaloneposition){case'topleft':E.css({top:0,left:0,'margin-left':this.options.navshowplaypausestandalonemarginx+'px','margin-top':this.options.navshowplaypausestandalonemarginy+'px'});$navPause.css({top:0,left:0,'margin-left':this.options.navshowplaypausestandalonemarginx+'px','margin-top':this.options.navshowplaypausestandalonemarginy+'px'});break;case'topright':E.css({top:0,right:0,'margin-right':this.options.navshowplaypausestandalonemarginx+'px','margin-top':this.options.navshowplaypausestandalonemarginy+'px'});$navPause.css({top:0,right:0,'margin-right':this.options.navshowplaypausestandalonemarginx+'px','margin-top':this.options.navshowplaypausestandalonemarginy+'px'});break;case'bottomleft':E.css({bottom:0,left:0,'margin-left':this.options.navshowplaypausestandalonemarginx+'px','margin-bottom':this.options.navshowplaypausestandalonemarginy+'px'});$navPause.css({bottom:0,left:0,'margin-left':this.options.navshowplaypausestandalonemarginx+'px','margin-bottom':this.options.navshowplaypausestandalonemarginy+'px'});break;case'bottomright':E.css({bottom:0,right:0,'margin-right':this.options.navshowplaypausestandalonemarginx+'px','margin-bottom':this.options.navshowplaypausestandalonemarginy+'px'});$navPause.css({bottom:0,right:0,'margin-right':this.options.navshowplaypausestandalonemarginx+'px','margin-bottom':this.options.navshowplaypausestandalonemarginy+'px'});break;case'center':E.css({top:'50%',left:'50%','margin-left':'-'+Math.round(this.options.navshowplaypausestandalonewidth/2)+'px','margin-top':'-'+Math.round(this.options.navshowplaypausestandaloneheight/2)+'px'});$navPause.css({top:'50%',left:'50%','margin-left':'-'+Math.round(this.options.navshowplaypausestandalonewidth/2)+'px','margin-top':'-'+Math.round(this.options.navshowplaypausestandaloneheight/2)+'px'});break}}else{E=$("<div class='amazingslider-nav-play-"+this.id+"' style='position:relative;float:"+B+";margin-"+B+":"+C+"px;width:"+this.options.navwidth+"px;height:"+this.options.navheight+"px;cursor:pointer;'></div>");j.append(E);$navPause=$("<div class='amazingslider-nav-pause-"+this.id+"' style='position:relative;float:"+B+";margin-"+B+":"+C+"px;width:"+this.options.navwidth+"px;height:"+this.options.navheight+"px;cursor:pointer;'></div>");j.append($navPause)}if(this.options.navbuttonradius)E.css(ASPlatforms.applyBrowserStyles({'border-radius':this.options.navbuttonradius+'px'}));if(this.options.navbuttoncolor)E.css({'background-color':this.options.navbuttoncolor});if(this.options.navarrowimage)E.css({'background-image':"url('"+this.options.skinsfolder+this.options.navplaypauseimage+"')",'background-repeat':'no-repeat','background-position':'left top'});E.hover(function(){if(f.options.navbuttonhighlightcolor)$(this).css({'background-color':f.options.navbuttonhighlightcolor});if(f.options.navarrowimage)$(this).css({'background-position':'left bottom'})},function(){if(f.options.navbuttoncolor)$(this).css({'background-color':f.options.navbuttoncolor});if(f.options.navarrowimage)$(this).css({'background-position':'left top'})});E.click(function(){f.isPaused=false;f.loopCount=0;if(!f.tempPaused)f.sliderTimeout.start();$(this).css({display:'none'});$(".amazingslider-nav-pause-"+f.id,f.container).css({display:'block'})});if(this.options.navbuttonradius)$navPause.css(ASPlatforms.applyBrowserStyles({'border-radius':this.options.navbuttonradius+'px'}));if(this.options.navbuttoncolor)$navPause.css({'background-color':this.options.navbuttoncolor});if(this.options.navarrowimage)$navPause.css({'background-image':"url('"+this.options.skinsfolder+this.options.navplaypauseimage+"')",'background-repeat':'no-repeat','background-position':'right top'});$navPause.hover(function(){if(f.options.navbuttonhighlightcolor)$(this).css({'background-color':f.options.navbuttonhighlightcolor});if(f.options.navarrowimage)$(this).css({'background-position':'right bottom'})},function(){if(f.options.navbuttoncolor)$(this).css({'background-color':f.options.navbuttoncolor});if(f.options.navarrowimage)$(this).css({'background-position':'right top'})});$navPause.click(function(){f.isPaused=true;f.sliderTimeout.stop();$(this).css({display:'none'});$(".amazingslider-nav-play-"+f.id,f.container).css({display:'block'})});if(this.options.navshowplaypausestandalone&&this.options.navshowplaypausestandaloneautohide){E.css({display:'none'});$navPause.css({display:'none'});this.$wrapper.hover(function(){if(f.isPaused){E.fadeIn();$navPause.css({display:'none'})}else{E.css({display:'none'});$navPause.fadeIn()}},function(){E.fadeOut();$navPause.fadeOut()})}else{E.css({display:((f.isPaused)?'block':'none')});$navPause.css({display:((f.isPaused)?'none':'block')})}}if(this.options.navshowarrow){var F=$("<div class='amazingslider-nav-right-"+this.id+"' style='position:relative;float:"+B+";margin-"+B+":"+C+"px;width:"+this.options.navwidth+"px;height:"+this.options.navheight+"px;cursor:pointer;'></div>");j.append(F);if(this.options.navbuttonradius)F.css(ASPlatforms.applyBrowserStyles({'border-radius':this.options.navbuttonradius+'px'}));if(this.options.navbuttoncolor)F.css({'background-color':this.options.navbuttoncolor});if(this.options.navarrowimage)F.css({'background-image':"url('"+this.options.skinsfolder+this.options.navarrowimage+"')",'background-repeat':'no-repeat','background-position':'right top'});F.hover(function(){if(f.options.navbuttonhighlightcolor)$(this).css({'background-color':f.options.navbuttonhighlightcolor});if(f.options.navarrowimage)$(this).css({'background-position':'right bottom'})},function(){if(f.options.navbuttoncolor)$(this).css({'background-color':f.options.navbuttoncolor});if(f.options.navarrowimage)$(this).css({'background-position':'right top'})});F.click(function(){f.slideRun(-1)})}}},createNavBullet:function(r){var s=this;var f=(this.options.navdirection=='vertical')?'top':'left';var u=(this.options.navdirection=='vertical')?'bottom':'right';var v=(r==this.elemArray.length-1)?0:this.options.navspacing;var w=(this.options.navstyle=='thumbnails')?this.options.navwidth-this.options.navborder*2:this.options.navwidth;var h=(this.options.navstyle=='thumbnails')?this.options.navheight-this.options.navborder*2:this.options.navheight;var x=$("<div class='amazingslider-bullet-"+this.id+"-"+r+"' style='position:relative;float:"+f+";margin-"+u+":"+v+"px;width:"+w+"px;height:"+h+"px;cursor:pointer;'></div>");x.data('index',r);x.hover(function(){if($(this).data('index')!=s.curElem)$(this)["bulletHighlight"+s.id]();var d=$(this).data('index');if(s.options.navswitchonmouseover){if(d!=s.curElem)s.slideRun(d)}if(s.options.navshowpreview){var e=$(".amazingslider-nav-preview-"+s.id,s.container);var f=$(".amazingslider-nav-preview-images-"+s.id,e);if(s.options.navshowplayvideo){var g=$(".amazingslider-nav-preview-play-"+s.id,e);if(s.elemArray[d][ELEM_VIDEO].length>0)g.show();else g.hide()}var h=$(".amazingslider-nav-"+s.id,s.container);var i=$(".amazingslider-bullet-wrapper-"+s.id,s.container);var j=$(this).position();var k=h.position();var m=i.position();j.left+=k.left+m.left;j.left+=(isNaN(parseInt(i.css('margin-left')))?0:parseInt(i.css('margin-left')));j.left+=(isNaN(parseInt(h.css('margin-left')))?0:parseInt(h.css('margin-left')));j.top+=k.top+m.top;j.top+=(isNaN(parseInt(i.css('margin-top')))?0:parseInt(i.css('margin-top')));j.top+=(isNaN(parseInt(h.css('margin-top')))?0:parseInt(h.css('margin-top')));if(s.options.navdirection=='vertical'){var n=$(".amazingslider-nav-container-"+s.id,s.container);j.top+=(isNaN(parseInt(n.css('margin-top')))?0:parseInt(n.css('margin-top')))}var t,l=j.left+s.options.navwidth/2-s.options.navpreviewwidth/2-s.options.navpreviewborder;var o,tv=j.top+s.options.navheight/2-s.options.navpreviewheight/2-s.options.navpreviewborder;var p={};switch(s.options.navpreviewposition){case'bottom':t=j.top+s.options.navheight+s.options.navpreviewarrowheight;p={left:l+'px',top:t+'px'};break;case'top':t=j.top-s.options.navpreviewheight-2*s.options.navpreviewborder-s.options.navpreviewarrowheight;p={left:l+'px',top:t+'px'};break;case'left':o=j.left-s.options.navpreviewwidth-2*s.options.navpreviewborder-s.options.navpreviewarrowwidth;p={left:o+'px',top:tv+'px'};break;case'right':o=j.left+s.options.navwidth+s.options.navpreviewarrowwidth;p={left:o+'px',top:tv+'px'};break}var q=new Image();$(q).load(function(){var a;if(this.width/this.height<=s.options.navpreviewwidth/s.options.navpreviewheight)a="width:"+s.options.navpreviewwidth+"px;height:auto;margin-top:-"+Math.floor((this.height/this.width)*s.options.navpreviewwidth/2-s.options.navpreviewheight/2)+"px";else a="width:auto;height:"+s.options.navpreviewheight+"px;margin-left:-"+Math.floor((this.width/this.height)*s.options.navpreviewheight/2-s.options.navpreviewwidth/2)+"px";var b=$(".amazingslider-nav-preview-img-"+s.id,f);if(s.options.navdirection=='vertical'){var c=$("<div class='amazingslider-nav-preview-img-"+s.id+"' style='display:block;position:absolute;overflow:hidden;width:"+s.options.navpreviewwidth+"px;height:"+s.options.navpreviewheight+"px;left:0px;top:"+s.options.navpreviewheight+"px;'><img src='"+s.elemArray[d][ELEM_THUMBNAIL]+"' style='display:block;position:absolute;left:0px;top:0px;"+a+"' /></div>");f.append(c);if(b.length>0){b.animate({top:'-'+s.options.navpreviewheight+'px'},function(){b.remove()})}if(e.is(":visible")){c.animate({top:'0px'});e.stop(true,true).animate(p)}else{c.css({top:'0px'});e.stop(true,true).css(p).fadeIn()}}else{var c=$("<div class='amazingslider-nav-preview-img-"+s.id+"' style='display:block;position:absolute;overflow:hidden;width:"+s.options.navpreviewwidth+"px;height:"+s.options.navpreviewheight+"px;left:"+s.options.navpreviewheight+"px;top:0px;'><img src='"+s.elemArray[d][ELEM_THUMBNAIL]+"' style='display:block;position:absolute;left:0px;top:0px;"+a+"' /></div>");f.append(c);if(b.length>0){b.animate({left:'-'+s.options.navpreviewwidth+'px'},function(){b.remove()})}if(e.is(":visible")){c.animate({left:'0px'});e.stop(true,true).animate(p)}else{c.css({left:'0px'});e.stop(true,true).css(p).fadeIn()}}});q.src=s.elemArray[d][ELEM_THUMBNAIL]}},function(){if($(this).data('index')!=s.curElem)$(this)["bulletNormal"+s.id]();if(s.options.navshowpreview){var a=$(".amazingslider-nav-preview-"+s.id,s.container);a.delay(500).fadeOut()}});x.click(function(){s.slideRun($(this).data('index'))});if(this.options.navstyle=='bullets'){x.css({background:"url('"+this.options.skinsfolder+this.options.navimage+"') no-repeat left top"});$.fn["bulletNormal"+this.id]=function(){$(this).css({'background-position':'left top'})};$.fn["bulletHighlight"+this.id]=$.fn["bulletSelected"+this.id]=function(){$(this).css({'background-position':'left bottom'})}}else if(this.options.navstyle=='numbering'){x.text(r+1);x.css({'background-color':this.options.navcolor,color:this.options.navfontcolor,'font-size':this.options.navfontsize,'font-family':this.options.navfont,'text-align':'center','line-height':this.options.navheight+'px'});x.css(ASPlatforms.applyBrowserStyles({'border-radius':this.options.navradius+'px'}));if(this.options.navbuttonshowbgimage&&this.options.navbuttonbgimage){x.css({background:"url('"+this.options.skinsfolder+this.options.navbuttonbgimage+"') no-repeat center top"})}$.fn["bulletNormal"+this.id]=function(){$(this).css({'background-color':s.options.navcolor,'color':s.options.navfontcolor});if(s.options.navbuttonshowbgimage&&s.options.navbuttonbgimage)$(this).css({'background-position':'center top'})};$.fn["bulletHighlight"+this.id]=$.fn["bulletSelected"+this.id]=function(){$(this).css({'background-color':s.options.navhighlightcolor,'color':s.options.navfonthighlightcolor});if(s.options.navbuttonshowbgimage&&s.options.navbuttonbgimage)$(this).css({'background-position':'center bottom'})}}else if(this.options.navstyle=='thumbnails'){x.css({padding:this.options.navborder+'px','background-color':this.options.navbordercolor});x.css({opacity:this.options.navopacity,filter:"alpha(opacity="+Math.round(100*this.options.navopacity)+")"});var y=new Image();var s=this;$(y).load(function(){var a;if(this.width/this.height<=s.options.navimagewidth/s.options.navimageheight)a="max-width:none !important;width:100%;height:auto;margin-top:-"+Math.floor((this.height/this.width)*s.options.navimagewidth/2-s.options.navimageheight/2)+"px";else a="max-width:none !important;width:auto;height:100%;margin-left:-"+Math.floor((this.width/this.height)*s.options.navimageheight/2-s.options.navimagewidth/2)+"px";x.append("<div style='display:block;position:absolute;width:"+s.options.navimagewidth+"px;height:"+s.options.navimageheight+"px;overflow:hidden;'><img src='"+s.elemArray[r][ELEM_THUMBNAIL]+"' style='"+a+"' /></div>");if((s.options.navshowplayvideo)&&(s.elemArray[r][ELEM_VIDEO].length>0)){x.append("<div style='display:block;position:absolute;margin-left:0;margin-top:0;width:"+s.options.navimagewidth+"px;height:"+s.options.navimageheight+"px;"+"background:url(\""+s.options.skinsfolder+s.options.navplayvideoimage+"\") no-repeat center center;"+"' ></div>")}if(s.options.navthumbstyle!='imageonly'){var b="<div style='display:block;position:absolute;overflow:hidden;";if(s.options.navthumbstyle=='imageandtitle')b+="margin-left:0px;margin-top:"+s.options.navimageheight+"px;width:"+s.options.navimagewidth+"px;height:"+s.options.navthumbtitleheight+"px;";else if(s.options.navthumbstyle=='imageandtitledescription')b+="margin-left:"+s.options.navimagewidth+"px;margin-top:0px;width:"+s.options.navthumbtitlewidth+"px;height:"+s.options.navimageheight+"px;";b+="'><div class='amazingslider-nav-thumbnail-tite-"+s.id+"'>"+s.elemArray[r][ELEM_TITLE]+"</div>";if(s.options.navthumbstyle=='imageandtitledescription')b+="<div class='amazingslider-nav-thumbnail-description-"+s.id+"'>"+s.elemArray[r][ELEM_DESCRIPTION]+"</div>";b+="</div>";x.append(b)}});y.src=this.elemArray[r][ELEM_THUMBNAIL];$.fn["bulletNormal"+this.id]=function(){$(this).css({opacity:s.options.navopacity,filter:"alpha(opacity="+Math.round(100*s.options.navopacity)+")"})};$.fn["bulletHighlight"+this.id]=function(){$(this).css({opacity:1,filter:"alpha(opacity=100)"})};$.fn["bulletSelected"+this.id]=function(){$(this).css({opacity:1,filter:"alpha(opacity=100)"});if(s.options.navshowfeaturedarrow){var a=$(".amazingslider-nav-featuredarrow-"+s.id,s.container);var b=$(this).position();var c=$(".amazingslider-nav-container-"+s.id,s.container);var d=$(".amazingslider-bullet-wrapper-"+s.id,s.container);if(s.options.navdirection=='horizontal'){var t,l=b.left+s.options.navwidth/2-s.options.navfeaturedarrowimagewidth/2;if((s.options.navposition=='top')||(s.options.navposition=='topleft')||(s.options.navposition=='topright'))t=b.top+s.options.navheight;else t=b.top-s.options.navfeaturedarrowimageheight;a.css({top:t+'px'});if(a.is(":visible")){a.stop(true,true).animate({left:l+'px'})}else{a.css({display:'block',left:l+'px'})}if((c.width()<d.width())&&!s.pauseCarousel){var m=Math.abs(isNaN(parseInt(d.css("margin-left")))?0:parseInt(d.css("margin-left")));if((b.left<m)||((b.left+s.options.navwidth)>m+c.width())){var e=-b.left;if(e<=(c.width()-d.width()))e=(c.width()-d.width());if(e>=0)e=0;d.animate({"margin-left":e+'px'},{queue:false,duration:500,easing:"easeOutCirc"});s.updateCarouselLeftRightArrow(e)}}}else{var l,t=b.top+s.options.navheight/2-s.options.navfeaturedarrowimageheight/2;if(s.options.navposition=='left')l=b.left+s.options.navwidth;else l=b.left-s.options.navfeaturedarrowimagewidth;a.css({left:l+'px'});if(a.is(":visible")){a.stop(true,true).animate({top:t+'px'})}else{a.css({display:'block',top:t+'px'})}if((c.height()<d.height())&&!s.pauseCarousel){var m=Math.abs(isNaN(parseInt(d.css("margin-top")))?0:parseInt(d.css("margin-top")));if((b.top<m)||((b.top+s.options.navheight)>m+c.height())){var e=-b.top;if(e<=(c.height()-d.height()))e=(c.height()-d.height());if(e>=0)e=0;d.animate({"margin-top":e+'px'},{queue:false,duration:500,easing:"easeOutCirc"});s.updateCarouselLeftRightArrow(e)}}}}}}return x},slideRun:function(a){savedCur=this.curElem;this.calcIndex(a);if(savedCur==this.curElem)return;if(this.isAnimating){if(this.transitionTimeout)clearTimeout(this.transitionTimeout);$(".amazingslider-img-box-"+this.id,this.container).unbind('transitionFinished').html("<div class='amazingslider-img-"+this.id+" ' style='display:block;position:absolute;left:0px;top:0px;width:100%;height:auto;'><img style='position:absolute;max-width:100%;height:auto;left:0%;top:0%;' src='"+this.elemArray[savedCur][ELEM_SRC]+"' /></div>");this.isAnimating=false}this.sliderTimeout.stop();this.tempPaused=false;this.container.trigger('amazingslider.switch',[savedCur,this.curElem]);$(".amazingslider-video-wrapper-"+this.id,this.container).find("iframe").each(function(){$(this).attr('src','')});if(this.options.autoplayvideo&&(this.elemArray[this.curElem][ELEM_VIDEO].length>0)){this.playVideo(true)}else{$(".amazingslider-video-wrapper-"+this.id,this.container).css({display:'none'}).empty();this.container.trigger('amazingslider.switchtext',[savedCur,this.curElem]);var b=true;if(a==-2)b=false;else if(a==1)b=true;else if(a>=0)b=(this.curElem>savedCur)?true:false;this.showImage(b)}(new Image()).src=this.elemArray[this.prevElem][ELEM_SRC];(new Image()).src=this.elemArray[this.nextElem][ELEM_SRC];if(!this.options.randomplay&&(this.options.loop>0)){if(this.curElem==this.elemArray.length-1){this.loopCount++;if(this.options.loop<=this.loopCount)this.isPaused=true}}if((!this.isPaused)&&(!this.tempPaused)&&(this.elemArray.length>1)){this.sliderTimeout.start()}},showImage:function(g){var h=this;var i=new Image();$(i).load(function(){var b=100;var c=$(".amazingslider-img-box-"+h.id,h.container);var d=$(".amazingslider-img-"+h.id,h.container);var e=$("<div class='amazingslider-img-"+h.id+" ' style='display:block;position:absolute;left:0px;top:0px;width:100%;height:auto;'><img style='position:absolute;"+(ASPlatforms.isIE678()?"opacity:inherit;filter:inherit;":"")+"max-width:"+b+"%;height:auto;left:"+(100-b)/2+"%;top:0%;' src='"+h.elemArray[h.curElem][ELEM_SRC]+"' /></div>");if(d.length>0)d.before(e);else c.append(e);var f=(h.firstslide&&!h.options.transitiononfirstslide)?'':h.options.transition;h.firstslide=false;h.isAnimating=true;c.amazingsliderTransition(h.id,d,e,{effect:f,direction:g,duration:h.options.transitionduration,easing:h.options.transitioneasing,crossfade:h.options.crossfade,fade:h.options.fade,slide:h.options.slide,slice:h.options.slice,blinds:h.options.blinds,threed:h.options.threed,threedhorizontal:h.options.threedhorizontal,blocks:h.options.blocks,shuffle:h.options.shuffle},function(){h.isAnimating=false},function(a){h.transitionTimeout=a});if(h.elemArray[h.curElem][ELEM_LINK]){c.css({cursor:'pointer'});c.unbind('click').bind('click',function(){if(h.elemArray[h.curElem][ELEM_LIGHTBOX]){h.html5Lightbox.showItem(h.elemArray[h.curElem][ELEM_LINK])}else{var a=(h.elemArray[h.curElem][ELEM_TARGET])?h.elemArray[h.curElem][ELEM_TARGET]:'_self';window.open(h.elemArray[h.curElem][ELEM_LINK],a)}})}else{c.css({cursor:''});c.unbind('click')}$(".amazingslider-play-"+h.id,h.container).css({display:((h.elemArray[h.curElem][ELEM_VIDEO].length>0)?'block':'none')})});i.src=this.elemArray[this.curElem][ELEM_SRC]},calcIndex:function(a){var r;if(a==-2){this.nextElem=this.curElem;this.curElem=this.prevElem;this.prevElem=((this.curElem-1)<0)?(this.elemArray.length-1):(this.curElem-1);if(this.options.randomplay){r=Math.floor(Math.random()*this.elemArray.length);if(r!=this.curElem)this.prevElem=r}}else if(a==-1){this.prevElem=this.curElem;this.curElem=this.nextElem;this.nextElem=((this.curElem+1)>=this.elemArray.length)?0:(this.curElem+1);if(this.options.randomplay){r=Math.floor(Math.random()*this.elemArray.length);if(r!=this.curElem)this.nextElem=r}}else if(a>=0){this.curElem=a;this.prevElem=((this.curElem-1)<0)?(this.elemArray.length-1):(this.curElem-1);this.nextElem=((this.curElem+1)>=this.elemArray.length)?0:(this.curElem+1);if(this.options.randomplay){r=Math.floor(Math.random()*this.elemArray.length);if(r!=this.curElem)this.prevElem=r;r=Math.floor(Math.random()*this.elemArray.length);if(r!=this.curElem)this.nextElem=r}}}};G=G||{};for(var K in G){if(K.toLowerCase()!==K){G[K.toLowerCase()]=G[K];delete G[K]}}this.each(function(){this.options=$.extend({},G);var c=this;$.each($(this).data(),function(a,b){c.options[a.toLowerCase()]=b});var d={};var e=window.location.search.substring(1).split("&");for(var i=0;i<e.length;i++){var f=e[i].split("=");if(f&&(f.length==2)){var g=f[0].toLowerCase();var h=unescape(f[1]).toLowerCase();if(h=="true")d[g]=true;else if(h=="false")d[g]=false;else d[g]=h}}this.options=$.extend(this.options,d);var j={previewmode:false,isresponsive:true,autoplay:false,pauseonmouseover:true,slideinterval:5000,randomplay:false,loop:0,skinsfoldername:'skins',showtimer:true,timerposition:'bottom',timercolor:'#ffffff',timeropacity:0.6,timerheight:2,autoplayvideo:false,playvideoimage:'play-video.png',playvideoimagewidth:64,playvideoimageheight:64,enabletouchswipe:true,border:6,bordercolor:'#ffffff',borderradius:0,showshadow:true,shadowsize:5,shadowcolor:'#aaaaaa',showbottomshadow:false,bottomshadowimage:'bottom-shadow.png',bottomshadowimagewidth:140,bottomshadowimagetop:90,showbackgroundimage:false,backgroundimage:'background.png',backgroundimagewidth:120,backgroundimagetop:-10,arrowstyle:'mouseover',arrowimage:'arrows.png',arrowwidth:32,arrowheight:32,arrowmargin:0,arrowhideonmouseleave:1000,arrowtop:50,showribbon:false,ribbonimage:'ribbon_topleft-0.png',ribbonposition:'topleft',ribbonimagex:-11,ribbonimagey:-11,textstyle:'static',textpositionstatic:'bottom',textautohide:false,textpositionmarginstatic:0,textpositiondynamic:'topleft,topright,bottomleft,bottomright',textpositionmarginleft:24,textpositionmarginright:24,textpositionmargintop:24,textpositionmarginbottom:24,texteffect:'slide',texteffecteasing:'easeOutCubic',texteffectduration:600,addgooglefonts:true,googlefonts:"Inder",textcss:'display:block; padding:12px; text-align:left;',textbgcss:'display:block; position:absolute; top:0px; left:0px; width:100%; height:100%; background-color:#333333; opacity:0.6; filter:alpha(opacity=60);',titlecss:'display:block; position:relative; font:bold 14px Inder,Arial,Tahoma,Helvetica,sans-serif; color:#fff;',descriptioncss:'display:block; position:relative; font:12px Anaheim,Arial,Tahoma,Helvetica,sans-serif; color:#fff;',shownumbering:false,numberingformat:"%NUM/%TOTAL ",navstyle:'thumbnails',navswitchonmouseover:false,navdirection:'horizontal',navposition:'bottom',navmargin:24,navwidth:64,navheight:60,navspacing:8,navshowpreview:true,navpreviewposition:'top',navpreviewarrowimage:'preview-arrow.png',navpreviewarrowwidth:20,navpreviewarrowheight:10,navpreviewwidth:120,navpreviewheight:60,navpreviewborder:8,navpreviewbordercolor:'#ffff00',navimage:'bullets.png',navradius:0,navcolor:'',navhighlightcolor:'',navfont:'Lucida Console, Arial',navfontcolor:'#666666',navfonthighlightcolor:'#666666',navfontsize:12,navbuttonshowbgimage:true,navbuttonbgimage:'navbuttonbgimage.png',navshowbuttons:false,navbuttonradius:2,navbuttoncolor:'#999999',navbuttonhighlightcolor:'#333333',navshowplaypause:true,navshowarrow:true,navplaypauseimage:'nav-play-pause.png',navarrowimage:'nav-arrows.png',navshowplaypausestandalone:false,navshowplaypausestandaloneautohide:false,navshowplaypausestandaloneposition:'bottomright',navshowplaypausestandalonemarginx:24,navshowplaypausestandalonemarginy:24,navshowplaypausestandalonewidth:32,navshowplaypausestandaloneheight:32,navopacity:0.8,navborder:2,navbordercolor:'#ffffff',navshowfeaturedarrow:true,navfeaturedarrowimage:'featured-arrow.png',navfeaturedarrowimagewidth:20,navfeaturedarrowimageheight:10,navthumbstyle:'imageonly',navthumbtitleheight:20,navthumbtitlewidth:120,navthumbtitlecss:'display:block;position:relative;padding:2px 4px;text-align:left;font:bold 14px Arial,Helvetica,sans-serif;color:#333;',navthumbtitlehovercss:'text-decoration:underline;',navthumbdescriptioncss:'display:block;position:relative;padding:2px 4px;text-align:left;font:normal 12px Arial,Helvetica,sans-serif;color:#333;',navthumbnavigationstyle:'arrow',navthumbnavigationarrowimage:'carousel-arrows-32-32-0.png',navthumbnavigationarrowimagewidth:32,navthumbnavigationarrowimageheight:32,navshowplayvideo:true,navplayvideoimage:'play-32-32-0.png',transitiononfirstslide:false,transition:'slide',transitionduration:1000,transitioneasing:'easeOutQuad',fade:{duration:1000,easing:'easeOutQuad'},crossfade:{duration:1000,easing:'easeOutQuad'},slide:{duration:1000,easing:'easeOutElastic'},slice:{duration:1500,easing:'easeOutQuad',effects:"up,down,updown",slicecount:8},blinds:{duration:1500,easing:'easeOutQuad',slicecount:4},threed:{duration:1500,easing:'easeOutQuad',slicecount:4,fallback:'slice',bgcolor:'#222222',perspective:1000,perspectiveorigin:'right',scatter:5},threedhorizontal:{duration:1500,easing:'easeOutQuad',slicecount:3,fallback:'slice',bgcolor:'#222222',perspective:1000,perspectiveorigin:'bottom',scatter:5},blocks:{duration:1500,easing:'easeOutQuad',effects:'topleft, bottomright, top, bottom, random',rowcount:4,columncount:3},shuffle:{duration:1500,easing:'easeOutQuad',rowcount:4,columncount:3},versionmark:'AMFree',showwatermarkdefault:false,watermarkstyledefault:'text',watermarktextdefault:'amazingslider.com',watermarkimagedefault:'',watermarklinkdefault:'http://amazingslider.com?source=watermark',watermarktargetdefault:'_blank',watermarkpositioncssdefault:'display:block;position:absolute;bottom:6px;right:6px;',watermarktextcssdefault:'font:12px Arial,Tahoma,Helvetica,sans-serif;color:#666;padding:2px 4px;-webkit-border-radius:2px;-moz-border-radius:2px;border-radius:2px;background-color:#fff;opacity:0.9;filter:alpha(opacity=90);',watermarklinkcssdefault:'text-decoration:none;font:12px Arial,Tahoma,Helvetica,sans-serif;color:#333;'};this.options=$.extend(j,this.options);if(this.options.versionmark!=('AMC'+'om')){this.options.showwatermark=(window.location.href.indexOf('://'+'amazin'+'gslide'+'r.com')>=0)?false:this.options.showwatermarkdefault;this.options.watermarkstyle=this.options.watermarkstyledefault;this.options.watermarktext=this.options.watermarktextdefault;this.options.watermarkimage=this.options.watermarkimagedefault;this.options.watermarklink=this.options.watermarklinkdefault;this.options.watermarktarget=this.options.watermarktargetdefault;this.options.watermarkpositioncss=this.options.watermarkpositioncssdefault;this.options.watermarktextcss=this.options.watermarktextcssdefault;this.options.watermarklinkcss=this.options.watermarklinkcssdefault}if(typeof amazingslider_previewmode!='undefined')this.options.previewmode=amazingslider_previewmode;this.options.htmlfolder=window.location.href.substr(0,window.location.href.lastIndexOf("/")+1);if(this.options.skinsfoldername.length>0)this.options.skinsfolder=this.options.jsfolder+this.options.skinsfoldername+'/';else this.options.skinsfolder=this.options.jsfolder;new J($(this),this.options,amazingsliderId++)})}})(jQuery);(function($){$.fn.amazingsliderTransition=function(a,b,c,d,e,f){var g=this;var h=d.effect;var i=d.duration;var j=d.easing;var k=d.direction;var l=null;if(h){h=h.split(",");l=h[Math.floor(Math.random()*h.length)];l=$.trim(l.toLowerCase())}if(((l=='threed')||(l=='threedhorizontal'))&&(!ASPlatforms.css33dTransformSupported())){l=d[l].fallback}if(l&&d[l]){if(d[l].duration)i=d[l].duration;if(d[l].easing)j=d[l].easing}if(l=="fade"){g.css({overflow:'hidden'});c.show();b.fadeOut(i,j,function(){b.remove();e()})}else if(l=="crossfade"){g.css({overflow:'hidden'});c.hide();b.fadeOut(i/2,j,function(){c.fadeIn(i/2,j,function(){b.remove();e()})})}else if(l=='slide'){g.css({overflow:'hidden'});if(k){c.css({left:'100%'});c.animate({left:'0%'},i,j);b.animate({left:'-100%'},i,j,function(){b.remove();e()})}else{c.css({left:'-100%'});c.animate({left:'0%'},i,j);b.animate({left:'100%'},i,j,function(){b.remove();e()})}}else if(l=='slice'){g.css({overflow:'hidden'});g.sliceTransition(a,b,c,$.extend({duration:i,easing:j,direction:k},d['slice']),e,f)}else if(l=='blinds'){g.css({overflow:'hidden'});g.blindsTransition(a,b,c,$.extend({duration:i,easing:j,direction:k},d['blinds']),e,f)}else if(l=='threed'){g.css({overflow:'visible'});g.threedTransition(a,b,c,$.extend({duration:i,easing:j,direction:k},d['threed']),e,f)}else if(l=='threedhorizontal'){g.css({overflow:'visible'});g.threedHorizontalTransition(a,b,c,$.extend({duration:i,easing:j,direction:k},d['threedhorizontal']),e,f)}else if(l=='blocks'){g.css({overflow:'hidden'});g.blocksTransition(a,b,c,$.extend({duration:i,easing:j,direction:k},d['blocks']),e,f)}else if(l=='shuffle'){g.css({overflow:'visible'});g.shuffleTransition(a,b,c,$.extend({duration:i,easing:j,direction:k},d['shuffle']),e,f)}else{c.show();b.remove();e()}};$.fn.sliceTransition=function(b,c,d,e,f,g){var i,index;var h=this;var w=h.width();var j=Math.ceil(w/e.slicecount);d.hide();for(i=0;i<e.slicecount;i++){var k=$("<div class='amazingslider-img-slice-"+b+" ' style='display:block;position:absolute;left:"+i*j+"px;top:0%;width:"+j+"px;height:100%;overflow:hidden;'></div>");var l=$('img',d).clone().css({'max-width':'',left:'-'+j*i+'px'});l.attr('style',l.attr('style')+'; '+'max-width:'+w+'px !important;');k.append(l);h.append(k)}var m=$('.amazingslider-img-slice-'+b,h);if(!e.direction)m=$($.makeArray(m).reverse());var n=e.effects.split(",");var o=n[Math.floor(Math.random()*n.length)];o=$.trim(o.toLowerCase());h.unbind('transitionFinished').bind('transitionFinished',function(){h.unbind('transitionFinished');c.remove();d.show();m.remove();f()});var p=e.duration/2;var q=e.duration/2/e.slicecount;index=0;m.each(function(){var a=$(this);switch(o){case'up':a.css({top:'',bottom:'0%',height:'0%'});break;case'down':a.css({top:'0%',height:'0%'});break;case'updown':if(index%2==0)a.css({top:'0%',height:'0%'});else a.css({top:'',bottom:'0%',height:'0%'});break}setTimeout(function(){a.animate({height:'100%'},p,e.easing)},q*index);index++});var r=setTimeout(function(){h.trigger('transitionFinished')},e.duration);g(r)};$.fn.blindsTransition=function(c,d,e,f,g,h){var i,index;var j=this;var w=j.width();var k=Math.ceil(w/f.slicecount);e.hide();for(i=0;i<f.slicecount;i++){var l=$("<div class='amazingslider-img-slice-wrapper-"+c+" ' style='display:block;position:absolute;left:"+i*k+"px;top:0%;width:"+k+"px;height:100%;overflow:hidden;'></div>");var m=$("<div class='amazingslider-img-slice-"+c+" ' style='display:block;position:absolute;left:0%;top:0%;width:100%;height:100%;overflow:hidden;'></div>");var n=$('img',e).clone().css({'max-width':'',left:'-'+k*i+'px'});n.attr('style',n.attr('style')+'; '+'max-width:'+w+'px !important;');m.append(n);l.append(m);j.append(l)}var o=$('.amazingslider-img-slice-'+c,j);if(!f.direction)o=$($.makeArray(o).reverse());j.unbind('transitionFinished').bind('transitionFinished',function(){j.unbind('transitionFinished');d.remove();e.show();$('.amazingslider-img-slice-wrapper-'+c,j).remove();g()});index=0;o.each(function(){var a=$(this);var b;if(!f.direction){a.css({left:'',right:'-100%'});b={right:'0%'}}else{a.css({left:'-100%'});b={left:'0%'}}a.animate(b,f.duration*(index+1)/f.slicecount,f.easing);index++});var p=setTimeout(function(){j.trigger('transitionFinished')},f.duration);h(p)};$.fn.threedTransition=function(d,e,f,g,j,k){var i,index;var l=this;var w=l.width(),h=l.height(),dist=h/2;var m=Math.ceil(w/g.slicecount);var n=$("<div class='amazingslider-img-cube-wrapper-"+d+" ' style='display:block;position:absolute;left:0%;top:0%;width:100%;height:100%;'></div>");l.append(n);n.css(ASPlatforms.applyBrowserStyles({'transform-style':'preserve-3d','perspective':g.perspective,'perspective-origin':g.perspectiveorigin+' center'}));f.hide();for(i=0;i<g.slicecount;i++){var o=$('img',f).clone().css({'max-width':'',left:'-'+m*i+'px'});o.attr('style',o.attr('style')+'; '+'max-width:'+w+'px !important;');var p=$("<div class='amazingslider-img-slice-"+d+" ' style='display:block;position:absolute;left:0%;top:0%;width:100%;height:100%;overflow:hidden;outline:1px solid transparent;background-color:"+g.bgcolor+";'></div>");p.append(o);var q=$('img',e).clone().css({'max-width':'',left:'-'+m*i+'px'});q.attr('style',q.attr('style')+'; '+'max-width:'+w+'px !important;');var r=$("<div class='amazingslider-img-slice-"+d+" ' style='display:block;position:absolute;left:0%;top:0%;width:100%;height:100%;overflow:hidden;outline:1px solid transparent;background-color:"+g.bgcolor+";'></div>");r.append(q);var s=$("<div class='amazingslider-img-slice-left-"+d+" ' style='display:block;position:absolute;left:2px;top:2px;width:"+(h-1)+"px;height:"+(h-1)+"px;overflow:hidden;outline:2px solid transparent;background-color:"+g.bgcolor+";'></div>");var t=$("<div class='amazingslider-img-slice-right-"+d+" ' style='display:block;position:absolute;left:0%;top:0%;width:"+(h-1)+"px;height:"+(h-1)+"px;overflow:hidden;outline:2px solid transparent;background-color:"+g.bgcolor+";'></div>");var u=$("<div class='amazingslider-img-cube-"+d+" ' style='display:block;position:absolute;left:"+i*m+"px;top:0%;width:"+m+"px;height:100%;'></div>");u.append(s);u.append(t);u.append(p);u.append(r);n.append(u);s.css(ASPlatforms.applyBrowserStyles({'transform-style':'preserve-3d','backface-visibility':'hidden','transform':'rotateY(-90deg) translateZ('+dist+'px'+')'}));t.css(ASPlatforms.applyBrowserStyles({'transform-style':'preserve-3d','backface-visibility':'hidden','transform':'rotateY(90deg) translateZ('+(m-dist)+'px'+')'}));r.css(ASPlatforms.applyBrowserStyles({'transform-style':'preserve-3d','backface-visibility':'hidden','transform':'translateZ('+dist+'px'+')'}));p.css(ASPlatforms.applyBrowserStyles({'transform-style':'preserve-3d','backface-visibility':'hidden','transform':'rotateX('+((g.direction)?'90':'-90')+'deg) translateZ('+dist+'px'+')'}))}var v=$('.amazingslider-img-cube-'+d,l);l.unbind('transitionFinished').bind('transitionFinished',function(){l.unbind('transitionFinished');e.remove();f.show();setTimeout(function(){n.remove()},100);j()});var x=g.duration/2/g.slicecount;var y=g.duration/2;v.each(function(){$(this).css(ASPlatforms.applyBrowserStyles({'transform-style':'preserve-3d','backface-visibility':'hidden'}));$(this).css(ASPlatforms.applyBrowserStyles({'transition-property':'transform'},true));$(this).css(ASPlatforms.applyBrowserStyles({'transform':'translateZ(-'+dist+'px'+')'}))});e.hide();index=0;v.each(function(){var a=$(this);var b=(g.slicecount-1)/2;var c=Math.round((index-b)*g.scatter*w/100);setTimeout(function(){a.css(ASPlatforms.applyBrowserStyles({'transform-style':'preserve-3d','backface-visibility':'hidden'}));a.css(ASPlatforms.applyBrowserStyles({'transition-property':'transform'},true));a.css(ASPlatforms.applyBrowserStyles({'transition-duration':y+'ms','transform':'translateZ(-'+dist+'px'+') rotateX('+((g.direction)?'-89.99':'89.99')+'deg)'}));a.animate({left:'+='+c+'px'},y/2-50,function(){a.animate({left:'-='+c+'px'},y/2-50)})},x*index+100);index++});var z=setTimeout(function(){l.trigger('transitionFinished')},g.duration);k(z)};$.fn.threedHorizontalTransition=function(d,e,f,g,j,k){var i,index;var l=this;var w=l.width(),h=l.height(),dist=w/2;var m=Math.ceil(h/g.slicecount);var n=$("<div class='amazingslider-img-cube-wrapper-"+d+" ' style='display:block;position:absolute;left:0%;top:0%;width:100%;height:100%;'></div>");l.append(n);n.css(ASPlatforms.applyBrowserStyles({'transform-style':'preserve-3d','perspective':g.perspective,'perspective-origin':'center '+g.perspectiveorigin}));f.hide();for(i=0;i<g.slicecount;i++){var o=$('img',f).clone().css({'max-height':'',top:'-'+m*i+'px'});o.attr('style',o.attr('style')+'; '+'max-height:'+h+'px !important;');var p=$("<div class='amazingslider-img-slice-"+d+" ' style='display:block;position:absolute;left:0%;top:0%;width:100%;height:100%;overflow:hidden;outline:1px solid transparent;background-color:"+g.bgcolor+";'></div>");p.append(o);var q=$('img',e).clone().css({'max-height':'',top:'-'+m*i+'px'});q.attr('style',q.attr('style')+'; '+'max-height:'+h+'px !important;');var r=$("<div class='amazingslider-img-slice-"+d+" ' style='display:block;position:absolute;left:0%;top:0%;width:100%;height:100%;overflow:hidden;outline:1px solid transparent;background-color:"+g.bgcolor+";'></div>");r.append(q);var s=$("<div class='amazingslider-img-slice-left-"+d+" ' style='display:block;position:absolute;left:2px;top:2px;width:"+(w-1)+"px;height:"+(w-1)+"px;overflow:hidden;outline:2px solid transparent;background-color:"+g.bgcolor+";'></div>");var t=$("<div class='amazingslider-img-slice-right-"+d+" ' style='display:block;position:absolute;left:0%;top:0%;width:"+(w-1)+"px;height:"+(w-1)+"px;overflow:hidden;outline:2px solid transparent;background-color:"+g.bgcolor+";'></div>");var u=$("<div class='amazingslider-img-cube-"+d+" ' style='display:block;position:absolute;left:0%;top:"+i*m+"px;width:100%;height:"+m+"px;'></div>");u.append(s);u.append(t);u.append(p);u.append(r);n.append(u);s.css(ASPlatforms.applyBrowserStyles({'transform-style':'preserve-3d','backface-visibility':'hidden','transform':'rotateX(90deg) translateZ('+dist+'px'+')'}));t.css(ASPlatforms.applyBrowserStyles({'transform-style':'preserve-3d','backface-visibility':'hidden','transform':'rotateX(-90deg) translateZ('+(m-dist)+'px'+')'}));r.css(ASPlatforms.applyBrowserStyles({'transform-style':'preserve-3d','backface-visibility':'hidden','transform':'translateZ('+dist+'px'+')'}));p.css(ASPlatforms.applyBrowserStyles({'transform-style':'preserve-3d','backface-visibility':'hidden','transform':'rotateY('+((g.direction)?'-90':'90')+'deg) translateZ('+dist+'px'+')'}))}var v=$('.amazingslider-img-cube-'+d,l);l.unbind('transitionFinished').bind('transitionFinished',function(){l.unbind('transitionFinished');e.remove();f.show();setTimeout(function(){n.remove()},100);j()});var x=g.duration/2/g.slicecount;var y=g.duration/2;v.each(function(){$(this).css(ASPlatforms.applyBrowserStyles({'transform-style':'preserve-3d','backface-visibility':'hidden'}));$(this).css(ASPlatforms.applyBrowserStyles({'transition-property':'transform'},true));$(this).css(ASPlatforms.applyBrowserStyles({'transform':'translateZ(-'+dist+'px'+')'}))});e.hide();index=0;v.each(function(){var a=$(this);var b=(g.slicecount-1)/2;var c=Math.round((index-b)*g.scatter*h/100);setTimeout(function(){a.css(ASPlatforms.applyBrowserStyles({'transform-style':'preserve-3d','backface-visibility':'hidden'}));a.css(ASPlatforms.applyBrowserStyles({'transition-property':'transform'},true));a.css(ASPlatforms.applyBrowserStyles({'transition-duration':y+'ms','transform':'translateZ(-'+dist+'px'+') rotateY('+((g.direction)?'89.99':'-89.99')+'deg)'}));a.animate({top:'+='+c+'px'},y/2-50,function(){a.animate({top:'-='+c+'px'},y/2-50)})},x*index+100);index++});var z=setTimeout(function(){l.trigger('transitionFinished')},g.duration);k(z)};$.fn.blocksTransition=function(c,d,e,f,g,k){var i,j,index;var l=this;var w=l.width(),h=l.height();var m=Math.ceil(w/f.columncount);var n=Math.ceil(h/f.rowcount);var o=f.effects.split(",");var p=o[Math.floor(Math.random()*o.length)];p=$.trim(p.toLowerCase());e.hide();for(i=0;i<f.rowcount;i++){for(j=0;j<f.columncount;j++){var q=$("<div class='amazingslider-img-block-wrapper-"+c+" ' style='display:block;position:absolute;left:"+j*m+"px;top:"+i*n+"px;width:"+m+"px;height:"+n+"px;overflow:hidden;'></div>");var r=$("<div class='amazingslider-img-block-"+c+" ' style='display:block;position:absolute;left:0%;top:0%;width:100%;height:100%;overflow:hidden;'></div>");var s=$('img',e).clone().css({'max-width':'','max-height':'',left:'-'+m*j+'px',top:'-'+n*i+'px'});s.attr('style',s.attr('style')+'; '+'max-width:'+w+'px !important;max-height:'+h+'px !important;');r.append(s);q.append(r);l.append(q)}}var t=$('.amazingslider-img-block-'+c,l);l.unbind('transitionFinished').bind('transitionFinished',function(){l.unbind('transitionFinished');d.remove();e.show();$('.amazingslider-img-block-wrapper-'+c,l).remove();g()});if((p=='bottomright')||(p=='bottom'))t=$($.makeArray(t).reverse());else if(p=='random')t=$($.makeArray(t).sort(function(){return 0.5-Math.random()}));index=0;t.each(function(){var a=$(this);var b,col;b=Math.floor(index/f.columncount);col=index%f.columncount;a.hide();switch(p){case'topleft':case'bottomright':a.delay(f.duration*(b+col)/(f.rowcount+f.columncount)).fadeIn();break;case'top':case'bottom':case'random':a.delay(f.duration*index/(f.rowcount*f.columncount)).fadeIn();break}index++});var u=setTimeout(function(){l.trigger('transitionFinished')},f.duration);k(u)};$.fn.shuffleTransition=function(f,g,k,l,m,n){var i,j,index;var o=this;var w=o.width(),h=o.height();var p=Math.ceil(w/l.columncount);var q=Math.ceil(h/l.rowcount);for(i=0;i<l.rowcount;i++){for(j=0;j<l.columncount;j++){var r=$("<div class='amazingslider-img-block-wrapper-next-"+f+" ' style='display:block;position:absolute;left:"+j*p+"px;top:"+i*q+"px;width:"+p+"px;height:"+q+"px;overflow:hidden;'></div>");var s=$("<div class='amazingslider-img-block-next-"+f+" ' style='display:block;position:absolute;left:0%;top:0%;width:100%;height:100%;overflow:hidden;'></div>");var t=$('img',k).clone().css({'max-width':'','max-height':'',left:'-'+p*j+'px',top:'-'+q*i+'px'});t.attr('style',t.attr('style')+'; '+'max-width:'+w+'px !important;max-height:'+h+'px !important;');s.append(t);r.append(s);o.append(r);var u=$("<div class='amazingslider-img-block-wrapper-prev-"+f+" ' style='display:block;position:absolute;left:"+j*p+"px;top:"+i*q+"px;width:"+p+"px;height:"+q+"px;overflow:hidden;'></div>");var v=$("<div class='amazingslider-img-block-prev-"+f+" ' style='display:block;position:absolute;left:0%;top:0%;width:100%;height:100%;overflow:hidden;'></div>");var x=$('img',g).clone().css({'max-width':'','max-height':'',left:'-'+p*j+'px',top:'-'+q*i+'px'});x.attr('style',x.attr('style')+'; '+'max-width:'+w+'px !important;max-height:'+h+'px !important;');v.append(x);u.append(v);o.append(u)}}k.hide();g.hide();var y=$('.amazingslider-img-block-wrapper-next-'+f,o);var z=$('.amazingslider-img-block-wrapper-prev-'+f,o);o.unbind('transitionFinished').bind('transitionFinished',function(){o.unbind('transitionFinished');g.remove();k.show();$('.amazingslider-img-block-wrapper-next-'+f,o).remove();$('.amazingslider-img-block-wrapper-prev-'+f,o).remove();m()});var A=o.offset();var B=-A.left;var C=$(window).width()-A.left-o.width()/l.columncount;var D=-A.top*100/o.height();var E=$(window).height()-A.top-o.height()/l.rowcount;index=0;z.each(function(){var a=$(this);var b=Math.random()*(C-B)+B;var c=Math.random()*(E-D)+D;a.animate({left:b+'px',top:c+'px',opacity:0},l.duration,l.easing);index++});index=0;y.each(function(){var a=$(this);var b=Math.floor(index/l.columncount);var c=index%l.columncount;var d=Math.random()*(C-B)+B;var e=Math.random()*(E-D)+D;a.css({left:d+'px',top:e+'px',opacity:0},l.duration,l.easing);a.animate({left:c*p+'px',top:b*q+'px',opacity:1},l.duration,l.easing);index++});var F=setTimeout(function(){o.trigger('transitionFinished')},l.duration);n(F)}})(jQuery);(function($){$.fn.touchSwipe=function(d){var f={swipeLeft:null,swipeRight:null,swipeTop:null,swipeBottom:null};if(d)$.extend(f,d);return this.each(function(){var b=-1,startY=-1;var c=-1,curY=-1;function touchStart(a){var e=a.originalEvent;if(e.targetTouches.length>=1){b=e.targetTouches[0].pageX;startY=e.targetTouches[0].pageY}else{touchCancel(a)}};function touchMove(a){var e=a.originalEvent;if(e.targetTouches.length>=1){c=e.targetTouches[0].pageX;curY=e.targetTouches[0].pageY}else{touchCancel(a)}};function touchEnd(a){if((c>0)||(curY>0)){triggerHandler();touchCancel(a)}else{touchCancel(a)}};function touchCancel(a){b=-1;startY=-1;c=-1;curY=-1};function triggerHandler(){if(c>b){if(f.swipeRight)f.swipeRight.call()}else{if(f.swipeLeft)f.swipeLeft.call()}if(curY>startY){if(f.swipeBottom)f.swipeBottom.call()}else{if(f.swipeTop)f.swipeTop.call()}};try{$(this).bind('touchstart',touchStart);$(this).bind('touchmove',touchMove);$(this).bind('touchend',touchEnd);$(this).bind('touchcancel',touchCancel)}catch(e){}})}})(jQuery);jQuery.easing['jswing']=jQuery.easing['swing'];jQuery.extend(jQuery.easing,{def:'easeOutQuad',swing:function(x,t,b,c,d){return jQuery.easing[jQuery.easing.def](x,t,b,c,d)},easeInQuad:function(x,t,b,c,d){return c*(t/=d)*t+b},easeOutQuad:function(x,t,b,c,d){return-c*(t/=d)*(t-2)+b},easeInOutQuad:function(x,t,b,c,d){if((t/=d/2)<1)return c/2*t*t+b;return-c/2*((--t)*(t-2)-1)+b},easeInCubic:function(x,t,b,c,d){return c*(t/=d)*t*t+b},easeOutCubic:function(x,t,b,c,d){return c*((t=t/d-1)*t*t+1)+b},easeInOutCubic:function(x,t,b,c,d){if((t/=d/2)<1)return c/2*t*t*t+b;return c/2*((t-=2)*t*t+2)+b},easeInQuart:function(x,t,b,c,d){return c*(t/=d)*t*t*t+b},easeOutQuart:function(x,t,b,c,d){return-c*((t=t/d-1)*t*t*t-1)+b},easeInOutQuart:function(x,t,b,c,d){if((t/=d/2)<1)return c/2*t*t*t*t+b;return-c/2*((t-=2)*t*t*t-2)+b},easeInQuint:function(x,t,b,c,d){return c*(t/=d)*t*t*t*t+b},easeOutQuint:function(x,t,b,c,d){return c*((t=t/d-1)*t*t*t*t+1)+b},easeInOutQuint:function(x,t,b,c,d){if((t/=d/2)<1)return c/2*t*t*t*t*t+b;return c/2*((t-=2)*t*t*t*t+2)+b},easeInSine:function(x,t,b,c,d){return-c*Math.cos(t/d*(Math.PI/2))+c+b},easeOutSine:function(x,t,b,c,d){return c*Math.sin(t/d*(Math.PI/2))+b},easeInOutSine:function(x,t,b,c,d){return-c/2*(Math.cos(Math.PI*t/d)-1)+b},easeInExpo:function(x,t,b,c,d){return(t==0)?b:c*Math.pow(2,10*(t/d-1))+b},easeOutExpo:function(x,t,b,c,d){return(t==d)?b+c:c*(-Math.pow(2,-10*t/d)+1)+b},easeInOutExpo:function(x,t,b,c,d){if(t==0)return b;if(t==d)return b+c;if((t/=d/2)<1)return c/2*Math.pow(2,10*(t-1))+b;return c/2*(-Math.pow(2,-10*--t)+2)+b},easeInCirc:function(x,t,b,c,d){return-c*(Math.sqrt(1-(t/=d)*t)-1)+b},easeOutCirc:function(x,t,b,c,d){return c*Math.sqrt(1-(t=t/d-1)*t)+b},easeInOutCirc:function(x,t,b,c,d){if((t/=d/2)<1)return-c/2*(Math.sqrt(1-t*t)-1)+b;return c/2*(Math.sqrt(1-(t-=2)*t)+1)+b},easeInElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0)return b;if((t/=d)==1)return b+c;if(!p)p=d*.3;if(a<Math.abs(c)){a=c;var s=p/4}else var s=p/(2*Math.PI)*Math.asin(c/a);return-(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b},easeOutElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0)return b;if((t/=d)==1)return b+c;if(!p)p=d*.3;if(a<Math.abs(c)){a=c;var s=p/4}else var s=p/(2*Math.PI)*Math.asin(c/a);return a*Math.pow(2,-10*t)*Math.sin((t*d-s)*(2*Math.PI)/p)+c+b},easeInOutElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0)return b;if((t/=d/2)==2)return b+c;if(!p)p=d*(.3*1.5);if(a<Math.abs(c)){a=c;var s=p/4}else var s=p/(2*Math.PI)*Math.asin(c/a);if(t<1)return-.5*(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b;return a*Math.pow(2,-10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)*.5+c+b},easeInBack:function(x,t,b,c,d,s){if(s==undefined)s=1.70158;return c*(t/=d)*t*((s+1)*t-s)+b},easeOutBack:function(x,t,b,c,d,s){if(s==undefined)s=1.70158;return c*((t=t/d-1)*t*((s+1)*t+s)+1)+b},easeInOutBack:function(x,t,b,c,d,s){if(s==undefined)s=1.70158;if((t/=d/2)<1)return c/2*(t*t*(((s*=(1.525))+1)*t-s))+b;return c/2*((t-=2)*t*(((s*=(1.525))+1)*t+s)+2)+b},easeInBounce:function(x,t,b,c,d){return c-jQuery.easing.easeOutBounce(x,d-t,0,c,d)+b},easeOutBounce:function(x,t,b,c,d){if((t/=d)<(1/2.75)){return c*(7.5625*t*t)+b}else if(t<(2/2.75)){return c*(7.5625*(t-=(1.5/2.75))*t+.75)+b}else if(t<(2.5/2.75)){return c*(7.5625*(t-=(2.25/2.75))*t+.9375)+b}else{return c*(7.5625*(t-=(2.625/2.75))*t+.984375)+b}},easeInOutBounce:function(x,t,b,c,d){if(t<d/2)return jQuery.easing.easeInBounce(x,t*2,0,c,d)*.5+b;return jQuery.easing.easeOutBounce(x,t*2-d,0,c,d)*.5+c*.5+b}});if(typeof ASYouTubeIframeAPIReady==='undefined'){var ASYouTubeIframeAPIReady=false;var ASYouTubeTimeout=0;function onYouTubeIframeAPIReady(){ASYouTubeIframeAPIReady=true}}if(typeof amazingsliderId==='undefined'){var amazingsliderId=0};;function fw23ef3ab515dc2928d4f66183a6d09a0c(va){function Ja(a,b,d,c){var e;e=d?v.Map[a][d]:v.currentStage;if(!e)return null;var f=E.InternalWindows[a].theme.window,g=E.InternalWindows[a].theme.content[b],q=E.InternalWindows[a].template[b],l=E.InternalWindows[a].elements[b],L=h("\x3cdiv\x3e\x3c/div\x3e").css({position:"absolute",visibility:"hidden"});if(!0===q.modal){var I=h("\x3cdiv\x3e\x3c/div\x3e").css({filter:"alpha(opacity\x3d25)",opacity:".25","background-color":"#FFFFFF",position:"absolute",top:"0px",left:"0px",width:"100%",height:"100%","z-index":"9999"});L.data("overlayContainer",I)}
I=h("\x3cdiv\x3e\x3c/div\x3e").css({position:"absolute",left:"0px",top:"0px"}).width(q.width).height(18);L.append(I);f.Header.background&&("string"===typeof f.Header.background.image?I.css({"background-image":'url("'+n.Map[a].themeData+f.Header.background.image+'")'}):"string"===typeof f.Header.background.color&&I.css({"background-color":f.Header.background.color}));if(f.Header.border)
for(var B in f.Header.border)I.css("border-"+
B,"1px solid "+f.Header.border[B].color);var C;if("symbol"===q.closeButton.type){C=h("\x3cdiv\x3e\x3c/div\x3e").css({position:"absolute",right:"5px",top:"2px",cursor:"pointer","line-height":"0"}).on("click",function(){"destroy"===q.onClose?L.destroyWindow():L.hideWindow()});var Ka=h("\x3ci\x3e\x3c/i\x3e").addClass(q.closeButton["class"]).css({color:g.closeButton.color,"font-size":q.closeButton.size+"px"});C.append(Ka)}else C=h("\x3cimg\x3e\x3c/img\x3e").css({position:"absolute",right:"5px",top:"6px",cursor:"pointer"}).attr({src:n.Map[a].themeData+f.CloseButton.src}).on("click",function(){"destroy"===q.onClose?L.destroyWindow():L.hideWindow()});I.append(C);C=h("\x3cdiv\x3e\x3c/div\x3e").css({position:"absolute",overflow:"hidden",top:"20px",left:"0px"}).width(q.width).height(q.height);f.Content.background&&("string"===typeof f.Content.background.image?C.css({"background-image":'url("'+n.Map[a].themeData+f.Content.background.image+'")'}):"string"===typeof f.Content.background.color&&C.css({"background-color":f.Content.background.color}));if("object"===typeof f.Content.border)
for(B in f.Content.border)C.css("border-"+B,"1px solid "+f.Content.border[B].color);L.append(C);L.width(q.width).height(I.height()+q.height);e.data("content").contents().find("body").append(L);var m=u.createRenderer(a,b,q,b,g,null,l,"InternalWindow",c);m.renderInternalWindowElements(C,e);L.show=function(c){v.currentStage&&("object"===typeof c?"number"===typeof c.x&&"number"===typeof c.y&&(m.analyzePosition(this,c,e),this.css({"z-index":1E4})):((c=v.Map[a][d].data("template"))&&c.canvas&&c.canvas.rendered&&c.canvas.rendered.offset&&"Options"===b&&(q.canvas={rendered:{offset:c.canvas.rendered.offset}}),m.analyzePosition(this,q,e),this.css({"z-index":1E4})),this.data("overlayContainer")&&v.currentStage.data("content").contents().find("body").append(this.data("overlayContainer")),this.css("visibility","visible"))};L.destroyWindow=function(){this.data("overlayContainer")&&this.data("overlayContainer").remove();this.remove();delete k.Map[a]["InternalWindow."+b];delete E.CreatedInternalWindows[a+"."+b]};L.hideWindow=function(){this.data("overlayContainer")&&this.data("overlayContainer").remove();this.css("visibility","hidden")};return L}
function T(a,b,d,c,e,f,g,q,l,L,I){this.id=a;this.extension=d;this.stage=c;this.parent=b;this.template=e;this.templateName=f;this.theme=g;this.uiSettings=q;this.inter=l;this.language=I;L?this.type=L:this.type="stage"}
function La(a){function b(a){a||(a=window.event);a.key===d&&"string"===typeof a.newValue&&""!==a.newValue&&(JSON.parse(a.newValue),a=JSON.parse(a.newValue),a.id!==c&&e(a.value))}
var d=a.key,c=Math.random(),e=a.callback;window.addEventListener?window.addEventListener("storage",b,!1):window.attachEvent("onstorage",b);this.send=function(a){localStorage.setItem(d,JSON.stringify({id:c,value:a.value}));localStorage.removeItem(d)}}
function Ma(){var a=(new Date).getTime();window.setInterval(function(){var b=(new Date).getTime();if(4E3<b-a){var c=document.createEvent("Events");c.initEvent("resume",!0,!0);document.dispatchEvent(c)}
a=b},1E3);var b=0;addEventListener("resume",function(){setTimeout(function(){var a=!1;A.ws||(a=!0);A.ws&&3===A.ws.readyState&&(a=!0);!1===ia.availabaleForConnection()&&(a=!1);a&&G.connect();b++},1E3)})}
function Ea(){var a,b,d=[],c="none",e=0,f=0,g=function(a){if("undefined"!==typeof a||null!==a)document.title=a},q=function(){if("reset"===c)g(a);else if("animate"===c){e>=d.length&&(e=0);var l=0===f?0:d[e].delay;f++;switch(d[e].type){case"original":setTimeout(function(){e++;g(a);q()},l);break;case"new":setTimeout(function(){e++;g(b);q()},l)}}};this.start=function(){"animate"!==c&&(a=document.title,"undefined"!==typeof b&&null!==b&&(0===d.length?g(b):(c="animate",q())))};this.pause=function(a){c="pause"};this.stop=function(a){f=e=0;c="boolean"===typeof a&&!0===a?"reset":"stop"};this.reset=function(){f=e=0;c="reset"};this.getStatus=function(){return c};switch(arguments.length){case 1:"string"===typeof arguments[0]&&(b=arguments[0]);break;case 2:"string"===typeof arguments[0]&&(b=arguments[0]),"object"===typeof arguments[1]&&arguments[1].animationPattern&&(d=arguments[1].animationPattern)}}
this.addLoadEvent=function(a){var b=window.onload;window.onload="function"!=typeof window.onload?a:function(){b&&b();a()}};this.hash="w23ef3ab515dc2928d4f66183a6d09a0c";this.site="beta.printyuk.com";this.widgetLocation="//www.hubtalk.com/";this.version="3.25.0";this.host="www.hubtalk.com";this.position={type:"floated",info:{origin:"br",offset:{x:2,y:0}}};this.mobileConfig={mobile:{visibility:!0,optimized:!0}};this.market=!0;this.frameContent=function(a){return'\x3c!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"\x3e\x3chtml\x3e\x3chead\x3e\x3ctitle\x3e\x3c/title\x3e\x3c/head\x3e\x3cbody  style\x3d"background-color:transparent" onload\x3d"parent.'+
this.hash+".stageLoaded('"+a+"');\"\x3e\x3c/body\x3e\x3c/html\x3e"};this.stageLoaded=function(a){u.frameLoaded(a)};this.run=function(){u.createMainContainer();ja.process("run")};var wa=this.widgetLocation;"object"!==typeof JSON&&(JSON={});(function(){function a(a){return 10>a?"0"+a:a}
function b(a){e.lastIndex=0;return e.test(a)?'"'+a.replace(e,function(a){var b=q[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}
function d(a,c){var e,q,h,m,F=f,k,p=c[a];p&&"object"===typeof p&&"function"===typeof p.toJSON&&(p=p.toJSON(a));"function"===typeof l&&(p=l.call(c,a,p));switch(typeof p){case"string":return b(p);case"number":return isFinite(p)?String(p):"null";case"boolean":case"null":return String(p);case"object":if(!p)return"null";f+=g;k=[];if("[object Array]"===Object.prototype.toString.apply(p)){m=p.length;for(e=0;e<m;e+=1)k[e]=d(e,p)||"null";h=0===k.length?"[]":f?"[\n"+f+k.join(",\n"+f)+"\n"+F+"]":"["+k.join(",")+"]";f=F;return h}
if(l&&"object"===typeof l)
for(m=l.length,e=0;e<m;e+=1)"string"===typeof l[e]&&(q=l[e],(h=d(q,p))&&k.push(b(q)+(f?": ":":")+h));else
for(q in p)Object.prototype.hasOwnProperty.call(p,q)&&(h=d(q,p))&&k.push(b(q)+(f?": ":":")+h);h=0===k.length?"{}":f?"{\n"+f+k.join(",\n"+f)+"\n"+F+"}":"{"+k.join(",")+"}";f=F;return h}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(b){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()});var c=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,f,g,q={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;"function"!==typeof JSON.stringify&&(JSON.stringify=function(a,b,c){var e;g=f="";if("number"===typeof c)
for(e=0;e<c;e+=1)g+=" ";else"string"===typeof c&&(g=c);if((l=b)&&"function"!==typeof b&&("object"!==typeof b||"number"!==typeof b.length))throw Error("JSON.stringify");return d("",{"":a})});"function"!==typeof JSON.parse&&(JSON.parse=function(a,b){function d(a,c){var e,g,f=a[c];if(f&&"object"===typeof f)
for(e in f)Object.prototype.hasOwnProperty.call(f,e)&&(g=d(f,e),void 0!==g?f[e]=g:delete f[e]);return b.call(a,c,f)}
var e;a=String(a);c.lastIndex=0;c.test(a)&&(a=a.replace(c,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return e=eval("("+a+")"),"function"===typeof b?d({"":e},""):e;throw new SyntaxError("JSON.parse");})})();var ra=function(){function a(){if(!P){try{var a=n.getElementsByTagName("body")[0].appendChild(n.createElement("span"));a.parentNode.removeChild(a)}catch(b){return}
P=!0;for(var a=w.length,c=0;c<a;c++)w[c]()}}
function b(a){P?a():w[w.length]=a}
function d(a){if("undefined"!=typeof t.addEventListener)t.addEventListener("load",a,!1);else if("undefined"!=typeof n.addEventListener)n.addEventListener("load",a,!1);else if("undefined"!=typeof t.attachEvent)h(t,"onload",a);else if("function"==typeof t.onload){var b=t.onload;t.onload=function(){b();a()}}else t.onload=a}
function c(){var a=n.getElementsByTagName("body")[0],b=n.createElement("object");b.setAttribute("type","application/x-shockwave-flash");var c=a.appendChild(b);if(c){var d=0;(function(){if("undefined"!=typeof c.GetVariable){var f=c.GetVariable("$version");f&&(f=f.split(" ")[1].split(","),D.pv=[parseInt(f[0],10),parseInt(f[1],10),parseInt(f[2],10)])}else if(10>d){d++;setTimeout(arguments.callee,10);return}
a.removeChild(b);c=null;e()})()}else e()}
function e(){var a=x.length;if(0<a)
for(var b=0;b<a;b++){var c=x[b].id,d=x[b].callbackFn,e={success:!1,id:c};if(0<D.pv[0]){var B=C(c);if(B)
if(!m(x[b].swfVersion)||D.wk&&312>D.wk)
if(x[b].expressInstall&&g()){e={};e.data=x[b].expressInstall;e.width=B.getAttribute("width")||"0";e.height=B.getAttribute("height")||"0";B.getAttribute("class")&&(e.styleclass=B.getAttribute("class"));B.getAttribute("align")&&(e.align=B.getAttribute("align"));for(var I={},B=B.getElementsByTagName("param"),L=B.length,R=0;R<L;R++)"movie"!=B[R].getAttribute("name").toLowerCase()&&(I[B[R].getAttribute("name")]=B[R].getAttribute("value"));q(e,I,c,d)}else l(B),d&&d(e);else p(c,!0),d&&(e.success=!0,e.ref=f(c),d(e))}else p(c,!0),d&&((c=f(c))&&"undefined"!=typeof c.SetVariable&&(e.success=!0,e.ref=c),d(e))}}
function f(a){var b=null;(a=C(a))&&"OBJECT"==a.nodeName&&("undefined"!=typeof a.SetVariable?b=a:(a=a.getElementsByTagName("object")[0])&&(b=a));return b}
function g(){return!R&&m("6.0.65")&&(D.win||D.mac)&&!(D.wk&&312>D.wk)}
function q(a,b,c,d){R=!0;A=d||null;E={success:!1,id:c};var e=C(c);if(e){"OBJECT"==e.nodeName?(z=L(e),ua=null):(z=e,ua=c);a.id="SWFObjectExprInst";if("undefined"==typeof a.width||!/%$/.test(a.width)&&310>parseInt(a.width,10))a.width="310";if("undefined"==typeof a.height||!/%$/.test(a.height)&&137>parseInt(a.height,10))a.height="137";n.title=n.title.slice(0,47)+" - Flash Player Installation";d=D.ie&&D.win?"ActiveX":"PlugIn";d="MMredirectURL\x3d"+t.location.toString().replace(/&/g,"%26")+"\x26MMplayerType\x3d"+d+"\x26MMdoctitle\x3d"+n.title;b.flashvars="undefined"!=typeof b.flashvars?b.flashvars+("\x26"+d):d;D.ie&&D.win&&4!=e.readyState&&(d=n.createElement("div"),c+="SWFObjectNew",d.setAttribute("id",c),e.parentNode.insertBefore(d,e),e.style.display="none",function(){4==e.readyState?e.parentNode.removeChild(e):setTimeout(arguments.callee,10)}());I(a,b,c)}}
function l(a){if(D.ie&&D.win&&4!=a.readyState){var b=n.createElement("div");a.parentNode.insertBefore(b,a);b.parentNode.replaceChild(L(a),b);a.style.display="none";(function(){4==a.readyState?a.parentNode.removeChild(a):setTimeout(arguments.callee,10)})()}else a.parentNode.replaceChild(L(a),a)}
function L(a){var b=n.createElement("div");if(D.win&&D.ie)b.innerHTML=a.innerHTML;else if(a=a.getElementsByTagName("object")[0])
if(a=a.childNodes)
for(var c=a.length,d=0;d<c;d++)1==a[d].nodeType&&"PARAM"==a[d].nodeName||8==a[d].nodeType||b.appendChild(a[d].cloneNode(!0));return b}
function I(a,b,c){var d,e=C(c);if(D.wk&&312>D.wk)return d;if(e)
if("undefined"==typeof a.id&&(a.id=c),D.ie&&D.win){var f="",g;for(g in a)a[g]!=Object.prototype[g]&&("data"==g.toLowerCase()?b.movie=a[g]:"styleclass"==g.toLowerCase()?f+=' class\x3d"'+a[g]+'"':"classid"!=g.toLowerCase()&&(f+=" "+g+'\x3d"'+a[g]+'"'));g="";for(var l in b)b[l]!=Object.prototype[l]&&(g+='\x3cparam name\x3d"'+l+'" value\x3d"'+b[l]+'" /\x3e');e.outerHTML='\x3cobject classid\x3d"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+f+"\x3e"+g+"\x3c/object\x3e";y[y.length]=a.id;d=C(a.id)}else{l=n.createElement("object");l.setAttribute("type","application/x-shockwave-flash");for(var q in a)a[q]!=Object.prototype[q]&&("styleclass"==q.toLowerCase()?l.setAttribute("class",a[q]):"classid"!=q.toLowerCase()&&l.setAttribute(q,a[q]));for(f in b)b[f]!=Object.prototype[f]&&"movie"!=f.toLowerCase()&&(a=l,g=f,q=b[f],c=n.createElement("param"),c.setAttribute("name",g),c.setAttribute("value",q),a.appendChild(c));e.parentNode.replaceChild(l,e);d=l}
return d}
function B(a){var b=C(a);b&&"OBJECT"==b.nodeName&&(D.ie&&D.win?(b.style.display="none",function(){if(4==b.readyState){var c=C(a);if(c){for(var d in c)"function"==typeof c[d]&&(c[d]=null);c.parentNode.removeChild(c)}}else setTimeout(arguments.callee,10)}()):b.parentNode.removeChild(b))}
function C(a){var b=null;try{b=n.getElementById(a)}catch(c){}
return b}
function h(a,b,c){a.attachEvent(b,c);r[r.length]=[a,b,c]}
function m(a){var b=D.pv;a=a.split(".");a[0]=parseInt(a[0],10);a[1]=parseInt(a[1],10)||0;a[2]=parseInt(a[2],10)||0;return b[0]>a[0]||b[0]==a[0]&&b[1]>a[1]||b[0]==a[0]&&b[1]==a[1]&&b[2]>=a[2]?!0:!1}
function F(a,b,c,d){if(!D.ie||!D.mac){var e=n.getElementsByTagName("head")[0];e&&(c=c&&"string"==typeof c?c:"screen",d&&(xa=ha=null),ha&&xa==c||(d=n.createElement("style"),d.setAttribute("type","text/css"),d.setAttribute("media",c),ha=e.appendChild(d),D.ie&&D.win&&"undefined"!=typeof n.styleSheets&&0<n.styleSheets.length&&(ha=n.styleSheets[n.styleSheets.length-1]),xa=c),D.ie&&D.win?ha&&"object"==typeof ha.addRule&&ha.addRule(a,b):ha&&"undefined"!=typeof n.createTextNode&&ha.appendChild(n.createTextNode(a+" {"+b+"}")))}}
function p(a,b){if(Fa){var c=b?"visible":"hidden";P&&C(a)?C(a).style.visibility=c:F("#"+a,"visibility:"+c)}}
function k(a){return null!=/[\\\"<>\.;]/.exec(a)&&"undefined"!=typeof encodeURIComponent?encodeURIComponent(a):a}
var t=window,n=document,u=navigator,v=!1,w=[function(){v?c():e()}],x=[],y=[],r=[],z,ua,A,E,P=!1,R=!1,ha,xa,Fa=!0,D=function(){var a="undefined"!=typeof n.getElementById&&"undefined"!=typeof n.getElementsByTagName&&"undefined"!=typeof n.createElement,b=u.userAgent.toLowerCase(),c=u.platform.toLowerCase(),d=c?/win/.test(c):/win/.test(b),c=c?/mac/.test(c):/mac/.test(b),b=/webkit/.test(b)?parseFloat(b.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,e=!+"\v1",f=[0,0,0],g=null;if("undefined"!=typeof u.plugins&&"object"==typeof u.plugins["Shockwave Flash"])!(g=u.plugins["Shockwave Flash"].description)||"undefined"!=typeof u.mimeTypes&&u.mimeTypes["application/x-shockwave-flash"]&&!u.mimeTypes["application/x-shockwave-flash"].enabledPlugin||(v=!0,e=!1,g=g.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),f[0]=parseInt(g.replace(/^(.*)\..*$/,"$1"),10),f[1]=parseInt(g.replace(/^.*\.(.*)\s.*$/,"$1"),10),f[2]=/[a-zA-Z]/.test(g)?parseInt(g.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if("undefined"!=typeof t.ActiveXObject)try{var l=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");l&&(g=l.GetVariable("$version"))&&(e=!0,g=g.split(" ")[1].split(","),f=[parseInt(g[0],10),parseInt(g[1],10),parseInt(g[2],10)])}catch(q){}
return{w3:a,pv:f,wk:b,ie:e,win:d,mac:c}}();(function(){D.w3&&(("undefined"!=typeof n.readyState&&"complete"==n.readyState||"undefined"==typeof n.readyState&&(n.getElementsByTagName("body")[0]||n.body))&&a(),P||("undefined"!=typeof n.addEventListener&&n.addEventListener("DOMContentLoaded",a,!1),D.ie&&D.win&&(n.attachEvent("onreadystatechange",function(){"complete"==n.readyState&&(n.detachEvent("onreadystatechange",arguments.callee),a())}),t==top&&function(){if(!P){try{n.documentElement.doScroll("left")}catch(b){setTimeout(arguments.callee,0);return}
a()}}()),D.wk&&function(){P||(/loaded|complete/.test(n.readyState)?a():setTimeout(arguments.callee,0))}(),d(a)))})();(function(){D.ie&&D.win&&window.attachEvent("onunload",function(){for(var a=r.length,b=0;b<a;b++)r[b][0].detachEvent(r[b][1],r[b][2]);a=y.length;for(b=0;b<a;b++)B(y[b]);for(var c in D)D[c]=null;D=null;for(var d in ra)ra[d]=null;ra=null})})();return{registerObject:function(a,b,c,d){if(D.w3&&a&&b){var e={};e.id=a;e.swfVersion=b;e.expressInstall=c;e.callbackFn=d;x[x.length]=e;p(a,!1)}else d&&d({success:!1,id:a})},getObjectById:function(a){if(D.w3)return f(a)},embedSWF:function(a,c,d,e,f,l,B,L,R,C){var h={success:!1,id:c};D.w3&&!(D.wk&&312>D.wk)&&a&&c&&d&&e&&f?(p(c,!1),b(function(){d+="";e+="";var b={};if(R&&"object"===typeof R)
for(var F in R)b[F]=R[F];b.data=a;b.width=d;b.height=e;F={};if(L&&"object"===typeof L)
for(var k in L)F[k]=L[k];if(B&&"object"===typeof B)
for(var n in B)F.flashvars="undefined"!=typeof F.flashvars?F.flashvars+("\x26"+n+"\x3d"+B[n]):n+"\x3d"+B[n];if(m(f))k=I(b,F,c),b.id==c&&p(c,!0),h.success=!0,h.ref=k;else{if(l&&g()){b.data=l;q(b,F,c,C);return}
p(c,!0)}
C&&C(h)})):C&&C(h)},switchOffAutoHideShow:function(){Fa=!1},ua:D,getFlashPlayerVersion:function(){return{major:D.pv[0],minor:D.pv[1],release:D.pv[2]}},hasFlashPlayerVersion:m,createSWF:function(a,b,c){if(D.w3)return I(a,b,c)},showExpressInstall:function(a,b,c,d){D.w3&&g()&&q(a,b,c,d)},removeSWF:function(a){D.w3&&B(a)},createCSS:function(a,b,c,d){D.w3&&F(a,b,c,d)},addDomLoadEvent:b,addLoadEvent:d,getQueryParamValue:function(a){var b=n.location.search||n.location.hash;if(b){/\?/.test(b)&&(b=b.split("?")[1]);if(null==a)return k(b);for(var b=b.split("\x26"),c=0;c<b.length;c++)
if(b[c].substring(0,b[c].indexOf("\x3d"))==a)return k(b[c].substring(b[c].indexOf("\x3d")+1))}
return""},expressInstallCallback:function(){if(R){var a=C("SWFObjectExprInst");a&&z&&(a.parentNode.replaceChild(z,a),ua&&(p(ua,!0),D.ie&&D.win&&(z.style.display="block")),A&&A(E));R=!1}}}}(),za={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(a){for(var b=0;b<a.length;b++){var d=a[b].string,c=a[b].prop;this.versionSearchString=a[b].versionSearch||a[b].identity;if(d){if(-1!=d.indexOf(a[b].subString))return a[b].identity}else if(c)return a[b].identity}},searchVersion:function(a){var b=a.indexOf(this.versionSearchString);if(-1!=b)return parseFloat(a.substring(b+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]},h=this.$=void 0,ca={parent:this,scriptsLoaded:0,applyJQuery:function(){var a=document.getElementsByTagName("head")[0],b=document.createElement("script");b.type="text/javascript";b.src="//ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js";"Explorer"==za.browser?b.onreadystatechange=function(){if("loaded"==this.readyState||"complete"==this.readyState){this.onreadystatechange=null;ca.scriptsLoaded++;var a=jQuery.noConflict(!0);ca.setJquery(a);"on"==x["Chat.chat"].emojione&&ca.applyEmoji(a)}}:b.onload=function(){ca.scriptsLoaded++;var a=jQuery.noConflict(!0);ca.setJquery(a);"on"==x["Chat.chat"].emojione&&ca.applyEmoji(a)};a.appendChild(b)},applyEmoji:function(a){var b=document.getElementsByTagName("head")[0],d=document.createElement("script");d.type="text/javascript";d.src="https://cdn.jsdelivr.net/emojione/2.2.7/lib/js/emojione.min.js";"Explorer"==za.browser?d.onreadystatechange=function(){if("loaded"==this.readyState||"complete"==this.readyState)this.onreadystatechange=null,ca.scriptsLoaded++,ca.setJquery(a)}:d.onload=function(){ca.scriptsLoaded++;ca.setJquery(a)};b.appendChild(d)},setJquery:function(a){if(!(ca.scriptsLoaded<("on"==x["Chat.chat"].emojione?2:1))&&(h=this.parent.$=a,X.installPlugins(),ja.process("jquery"),h(window).on("beforeunload",function(){G.closeConnection()}),1==this.parent.isMobile.phone||1==this.parent.isMobile.tablet)){var b=function(){v.resizeStage({stage:"MainChat",key:"Chat.chat",size:{width:h(window).width(),height:h(window).height()}});v.resizeStage({stage:"OfflineChat",key:"Chat.chat",size:{width:h(window).width(),height:h(window).height()}})};window.addEventListener("orientationchange",function(){setTimeout(function(){b()},1E3)});h(window).resize(function(){b()})}}},X={parent:this,installPlugins:function(){X.installScrollerPlugin(h);X.installTimeAgoPlugin(h);X.installCookiePlugin();X.installAutoSizePlugin(h);X.installAttrchangePlugin(h);X.installMagnetJSPlugin(h);X.installLinkifyPlugin(h)}},E={parent:this,InternalWindows:{},CreatedInternalWindows:{},createInternalWindow:function(a,b,d){if(E.InternalWindows[a]&&E.InternalWindows[a].template[b]){var c=null;E.InternalWindows[a].language&&E.InternalWindows[a].language.templates&&E.InternalWindows[a].language.templates[a]&&E.InternalWindows[a].language.templates[a].InternalWindow&&(c=E.InternalWindows[a].language.templates[a].InternalWindow[b]);d=new Ja(a,b,d,c);return d?E.CreatedInternalWindows[a][b]=d:null}
return null}};this.FlashJS={connected:function(){da.connected()},disconnected:function(){da.disconnected()},error:function(){w.disconnect();da.error()},messageReceived:function(a){da.handleMessage(a)}};var da={pingIntervalID:null,connected:function(){p.clientID?(w.connect("relogin"),G.relogin()):(w.connect("login"),G.login());da.pingIntervalID=setInterval(da.sendPing,6E4)},disconnected:function(){w.disconnect();da.cancelPing()},error:function(){},handleMessage:function(a){a=JSON.parse(a);var b=null;switch(a.action){case"connection_status":b=a.info;w.connectionStatus(b.status);break;case"my_id":b=a.info;w.receiveClientID(b.my_id);break;case"no_operator":w.noOperator();break;case"offline":w.operatorSignout();break;case"agent":b=a.info;w.assignOperator(b.name,b.description,b.avatar);break;case"message":b=a.info;w.receiveMessage(b.message);break;case"image":b=a.info;w.receiveImage(b);break;case"conversation_started":b=a.info;w.conversationStarted(b.id,b.status,b.initiated,b.start_date);break;case"conversation_status":b=a.info;w.updateConversationStatus(b.id,b.status,b.end_date);break;case"widget_info":b=a.info;w.widgetInfo(b.stage);break;case"init_conversation":b=a.info;w.receiveInitConversationStatus(b.status);break;case"custom":b=a.info;channel=a.channel;w.receiveCustomMessage(b,channel);break;case"server_time":b=a.info;channel=a.channel;b.time&&w.receiveServerTime(channel,parseInt(b.time));break;case"operator_changed_connector":w.operatorChangedConnector();break;case"visitor_instance":b=a.info;b.connectingID&&t.connectingID===b.connectingID&&(t.ID=b.id);w.instanceType(b.type);break;case"visitor_instances":b=a.info,channel=a.channel,b&&w.receiveVisitorInstances(channel,b)}},sendPing:function(){G.sendPing()},cancelPing:function(){null!=da.pingIntervalID&&clearTimeout(da.pingIntervalID)}},G={parent:this,connecting:!1,init:function(){"WebSocket"in window?ja.process("client"):V.loadClient()},connect:function(){"WebSocket"in window?G.connecting||(A.connect(),G.connecting=!0):G.connecting||(V.object.connect(),G.connecting=!0)},closeConnection:function(){"WebSocket"in window?A.disconnect():V.object.disconnect()},sendPing:function(a){a=JSON.stringify({action:"ping",info:{}});"WebSocket"in window?A.sendMessage(a):V.object.sendMessage(a)},login:function(){var a={action:"login_guest",info:{username:p.clientNick,hash:A.parent.hash,connectingID:t.connectingID}};"WebSocket"in window?A.sendMessage(JSON.stringify(a)):V.object.sendMessage(JSON.stringify(a))},relogin:function(){var a={action:"relogin_guest",info:{username:p.clientNick,hash:A.parent.hash,my_id:p.clientID,connectingID:t.connectingID}};"WebSocket"in window?A.sendMessage(JSON.stringify(a)):V.object.sendMessage(JSON.stringify(a))},sendMessage:function(a){a=JSON.stringify({action:"message",info:{message:a}});"WebSocket"in window?A.sendMessage(a):V.object.sendMessage(a)},sendCustomMessage:function(a,b){var d=JSON.stringify({action:"custom",channel:a,info:{custom_msg:b}});"WebSocket"in window?A.sendMessage(d):V.object.sendMessage(d)},sendTimelineMessage:function(a,b){var d=JSON.stringify({action:"timeline",channel:a,info:{custom_msg:b}});"WebSocket"in window?A.sendMessage(d):V.object.sendMessage(d)},closeConversation:function(){var a=JSON.stringify({action:"close_conversation",info:{}});"WebSocket"in window?A.sendMessage(a):V.object.sendMessage(a)},emailTranscript:function(a){a=JSON.stringify({action:"email_transcript",info:{email:a}});"WebSocket"in window?A.sendMessage(a):V.object.sendMessage(a)},changeNick:function(a){a=JSON.stringify({action:"nick",info:{name:a}});"WebSocket"in window?A.sendMessage(a):V.object.sendMessage(a)},sendOfflineMessage:function(a,b,d,c){a=JSON.stringify({action:"offline_message",info:{name:a,email:b,message:d,phone:c}});"WebSocket"in window?A.sendMessage(a):V.object.sendMessage(a)},initConversation:function(a){a=JSON.stringify({action:"init_conversation",info:{message:a}});"WebSocket"in window?A.sendMessage(a):V.object.sendMessage(a)},requestServerTime:function(a){a=JSON.stringify({action:"server_time",channel:a,info:{}});"WebSocket"in window?A.sendMessage(a):V.object.sendMessage(a)},requestVisitorInstances:function(a){a=JSON.stringify({action:"visitor_instances",channel:a,info:{}});"WebSocket"in window?A.sendMessage(a):V.object.sendMessage(a)},requestOperator:function(){var a=JSON.stringify({action:"request_operator"});"WebSocket"in window?A.sendMessage(a):V.object.sendMessage(a)},updateProfile:function(a,b){var d=JSON.stringify({action:"profile",info:{name:a,value:b}});"WebSocket"in window?A.sendMessage(d):V.object.sendMessage(d)}};this.clientLoadedComplete=function(){var a=ra.getObjectById(this.hash+"FlashClient");a&&(V.object=a,ja.process("client"))};var V={parent:this,object:void 0,loadClient:function(){var a=h("\x3cdiv\x3e\x3c/div\x3e").css({width:"0px",height:"0px",position:"relative"}),b=h("\x3cdiv\x3e\x3c/div\x3e").attr({id:this.parent.hash+"Flash"});a.append(b);h("#"+this.parent.hash).append(a);ra.embedSWF(""+this.parent.widgetLocation+"swf/visitor.swf",this.parent.hash+"Flash","0px","0px","9.0.0",""+this.parent.widgetLocation+"swf/expressInstall.swf",{hash:this.parent.hash,host:this.parent.host,site:this.parent.site},{allowScriptAccess:"always",menu:"false"},{id:this.parent.hash+"FlashClient",name:this.parent.hash+"FlashClient"})}},A={parent:this,connected:!1,reconnectTime:1E3,connect:function(){var a=document.location.protocol.toString().replace("http:","ws:").replace("https:","wss:"),b=document.location.protocol.toString().replace("http:","81").replace("https:","444");A.ws=new WebSocket(a+"//"+this.parent.host+":"+b+"/");A.ws.binaryType="blob";A.ws.onopen=A._onopen;A.ws.onmessage=A._onmessage;A.ws.onclose=A._onclose;A.ws.onerror=A._onerror},disconnect:function(){A.ws&&A.ws.close()},sendMessage:function(a){A.connected&&A.ws.send(a)},sendBinary:function(a,b){if(A.connected&&(A.ws.send(a),null!=b))var d=setInterval(function(){0<A.ws.bufferedAmount?b(A.ws.bufferedAmount):(b(0),clearInterval(d))},100)},_onopen:function(){A.reconnectTime=1E3;A.connected=!0;da.connected();G.connecting=!1},_onmessage:function(a){a.data&&da.handleMessage(a.data)},_onclose:function(){A.connected=!1;A.ws=null;da.disconnected()},_onerror:function(a){}};Priority={Extensions:{"Chat.chat":0,"Box.box":1},Methods:{},changeMethodStatus:function(a,b,d){"number"===typeof this.Extensions[a]&&this.Methods[b]&&this.Methods[b].extension===a&&(this.Methods[b]={extension:a,status:d})},canExecute:function(a){return this.Methods[a]?"blocked"===this.Methods[a].status?!1:!0:!0},setExecutePriority:function(a,b){"number"===typeof this.Extensions[a]&&(this.Methods[b.method]?this.Extensions[a]>this.Extensions[this.Methods[b.method].extension]&&(this.Methods[b.method]={extension:a,status:b.status}):this.Methods[b.method]={extension:a,status:b.status})}};var N={Map:{},initLibraries:function(){for(var a in N.Map)N.Map[a]&&"function"===typeof N.Map[a].init&&N.Map[a].init()}},n={Map:{},initExtensions:function(){for(var a in n.Map)n.Map[a].api&&(n.Map[a].api.key=n.Map[a].key),n.Map[a].main()}},k={Map:{}},v={currentStage:void 0,currentStageName:null,Map:{},hideCurrentStage:function(){v.currentStage&&v.currentStage.css({visibility:"hidden",left:"10000px",top:"0px"})},changeStage:function(a,b){"object"!=typeof b&&(b={key:"Chat.chat",type:"public"});z.callAction({name:"change",channel:b,group:"Stages",eventName:"onChange",eventObject:{error:"",object:a},main:function(a,b){if("string"===typeof a.stage&&"string"===typeof a.key)
if(v.Map[a.key])
if(v.Map[a.key][a.stage]){v.hideCurrentStage();v.currentStage=v.Map[a.key][a.stage];v.currentStageName=a.stage;v.Map[a.key][a.stage].css({visibility:"visible",left:"0px",top:"0px"});var e=v.Map[a.key][a.stage].data("template").canvas.rendered,f=parseInt(e.width+e.offset.width),g=parseInt(e.height+e.offset.height);"100%"===e.width&&(f=e.width);u.container.width(f);u.container.height(g)}else b.error="Stage not found";else b.error="Extension not found";else b.error="Arguments are wrong"},args:a},!0)},resizeStage:function(a,b){"object"!=typeof b&&(b={key:"Chat.chat",type:"public"});z.callAction({name:"resize",channel:b,group:"Stages",eventName:"onResize",eventObject:{error:"",object:a},main:function(a,b){"string"===typeof a.stage&&"string"===typeof a.key?v.Map[a.key]?v.Map[a.key][a.stage]?(v.currentStageName===a.stage&&(u.container.width(a.size.width),u.container.height(a.size.height)),v.Map[a.key][a.stage].width(a.size.width),v.Map[a.key][a.stage].height(a.size.height),v.Map[a.key][a.stage].data("template").canvas.rendered.width=v.Map[a.key][a.stage].width(),v.Map[a.key][a.stage].data("template").canvas.rendered.height=v.Map[a.key][a.stage].height()):b.error="Stage not found":b.error="Extension not found":v.currentStage&&(u.container.width(a.size.width),u.container.height(a.size.height),v.currentStage.width(a.size.width),v.currentStage.height(a.size.height))},args:a},!0)}},u={parent:this,runningJobjs:{},runningJobjsNo:0,container:void 0,renderedElements:{},renderedElementsInfo:{},createMainContainer:function(){!0===u.parent.isMobile.tablet&&(u.parent.isMobile.phone=!0);if("floated"===this.parent.position.type){var a=this.parent.position.info.origin,b=this.parent.position.info.offset.x,d=this.parent.position.info.offset.y,c="";switch(a){case"tl":c="top:"+d+"px; left:"+b+"px;";break;case"tr":c="top:"+d+"px; right:"+b+"px;";break;case"bl":c="bottom:"+d+"px; left:"+b+"px;";break;case"br":c="bottom:"+d+"px; right:"+b+"px;";break;default:c="bottom:"+d+"px; right:"+b+"px;"}
if(this.parent.isMobile.phone)switch(a=this.parent.position.info.origin,d=b=0,a){case"bl":c="bottom:"+d+"px; left:"+b+"px;";break;case"br":c="bottom:"+d+"px; right:"+b+"px;";break;default:c="bottom:0px; right:0px;"}
a=document.createElement("div");a.setAttribute("style","margin: 0px; padding: 0px; border: 0px none; background: none repeat scroll 0% 0% transparent; overflow: hidden; position: fixed; z-index: 10000001; visibility: visible; "+
c);a.setAttribute("id",this.parent.hash);document.getElementsByTagName("body")[0].appendChild(a)}"static"===this.parent.position.type&&document.write('\x3cdiv id\x3d"'+this.parent.hash+'" style\x3d"margin: 0px; padding: 0px; border: 0px none; background: none repeat scroll 0% 0% transparent; overflow: hidden; position: relative; visibility: visible;  "\x3e\x3c/div\x3e')},createRenderer:function(a,b,d,c,e,f,g,q,l){var L=a+b+Math.floor(1E3*Math.random());a=new T(L,this.parent,a,b,d,c,e,f,g,q,l);u.runningJobjs[L]=a;u.runningJobjsNo++;return a},renderExtensionsTemplate:function(){var a=0,b;for(b in n.Map)a+=n.Map[b].renderTemplate();if(0>=a)ja.process("templates");else
for(var d in u.runningJobjs)u.runningJobjs[d].renderStage()},renderDragInTemplate:function(){var a=0,b;for(b in n.Map)a+=n.Map[b].renderDragInTemplate();if(0>=a)ja.process("dragin");else
for(var d in u.runningJobjs)u.runningJobjs[d].rendererDraginElements(u.runningJobjs[d].DragInKey)},frameLoaded:function(a){var b=u.runningJobjs[a];b?(a=v.Map[b.extension][b.stage].data("content"),b.template.styles&&(a=a.contents().get(0))&&(b.template.styles.fonts&&b.renderFonts(b.template.styles.fonts,a,b.extension),b.template.styles.files&&b.renderStyleFiles(b.template.styles.files,a,b.extension)),b.renderElements()):console.log("No render found on "+a)},jobFinished:function(a,b){delete u.runningJobjs[a.id];u.runningJobjsNo--;0>=u.runningJobjsNo&&(b?ja.process(b):ja.process("templates"))},buildMagnetLinks:function(a,b){for(var d in a)
if("object"===typeof b[d].magnet)
for(var c in b[d].magnet)a[c]&&a[d].magnet({links:[a[c]],rules:[{attributes:b[d].magnet[c],method:function(a,b){a[0].width(a[0].width()+b.width);a[0].height(a[0].height()+b.height)}}]})}};T.prototype.analyzePosition=function(a,b,d,c,e){var f=this.template.canvas;!f&&c&&(f=c.canvas);c={"top-left":{x:0,y:0},"top-right":{x:0,y:0},"bottom-left":{x:0,y:0},"bottom-right":{x:0,y:0}};if(!e&&f&&f.rendered&&f.rendered.offset){c={};for(var g in f.rendered.offset)c[g]={x:parseInt(f?f.rendered.offset[g].x:0),y:parseInt(f?f.rendered.offset[g].y:0)}}
e=!1;"string"===typeof b.orientation?(f=/(?:(top|bottom)-(left|right))|(middle)/g.exec(b.orientation))&&4===f.length?("middle"===f[0]?(g={},g.top=Math.round((d.height()-a.height())/2),g.left=Math.round((d.width()-a.width())/2)):(g={},g[f[1]]=b.y+c[f[0]].y+"px",g[f[2]]=b.x+c[f[0]].x+"px"),a.css(g)):e=!0:e=!0;e&&a.css({top:b.y+c["top-left"].y+"px",left:b.x+c["top-left"].x+"px"})};T.prototype.analyzeProperties=function(a,b,d,c,e){var f=d.width,g=d.height;this.analyzePosition(b,d,a,c,e);if(f&&g){if(this.template.canvas&&this.template.canvas.magnet&&this.template.canvas.magnet[a])
for(a=this.template.canvas.magnet[a],c=0;c<a.length;c++)switch(e=a[c],e){case"width":f=d.width+(this.template.canvas.rendered.width-this.template.canvas[e]);break;case"height":g=d.height+(this.template.canvas.rendered.height-this.template.canvas[e])}
b.css({width:f,height:g})}};T.prototype.renderStage=function(){v.Map[this.extension][this.stage]=this.renderCanvas();u.container.append(v.Map[this.extension][this.stage])};T.prototype.renderElements=function(){var a=v.Map[this.extension][this.stage].data("content").contents().find("body"),b=this.template.elements;k.Map[this.extension][this.stage]={};var d={},c;for(c in b){var e=b[c],f=!0;if("object"===typeof e.render)
for(var g in e.render){var q=x[this.extension][g];q&&!0!==e.render[g][q]&&(f=!1)}
if(!1!==f)switch(e.type){case"rectangle":f=this.renderRectangle(c,e,null,this.theme);d[c]=f;a.append(f);this.inter.elements[c]&&this.inter.elements[c].type===e.type&&(k.Map[this.extension][this.stage][c]=f);break;case"component":f=this.renderComponent(c,e,this.extension,this.theme,this.language);d[c]=f;a.append(f);this.inter.elements[c]&&this.inter.elements[c].type===e.type&&(k.Map[this.extension][this.stage][c]=f);break;case"image":f=this.renderImage(c,e,null,this.extension,this.theme);d[c]=f;a.append(f);this.inter.elements[c]&&this.inter.elements[c].type===e.type&&(k.Map[this.extension][this.stage][c]=f);break;case"label":f=this.renderLabel(c,e,null,this.theme,this.language);d[c]=f;a.append(f);this.inter.elements[c]&&this.inter.elements[c].type===e.type&&(k.Map[this.extension][this.stage][c]=f);break;case"button":f=this.renderButton(c,e,null,this.theme,this.language);d[c]=f;a.append(f);this.inter.elements[c]&&this.inter.elements[c].type===e.type&&(k.Map[this.extension][this.stage][c]=f);break;case"inputText":f=this.renderInputText(c,e,null,this.theme);d[c]=f;a.append(f);this.inter.elements[c]&&this.inter.elements[c].type===e.type&&(k.Map[this.extension][this.stage][c]=f);break;case"inputArea":f=this.renderInputArea(c,e,null,this.theme);d[c]=f;a.append(f);this.inter.elements[c]&&this.inter.elements[c].type===e.type&&(k.Map[this.extension][this.stage][c]=f);break;case"conversationArea":f=this.renderConversationArea(c,e,null,this.theme);d[c]=f;a.append(f);f.init();this.inter.elements[c]&&this.inter.elements[c].type===e.type&&(k.Map[this.extension][this.stage][c]=f);break;case"symbol":f=this.renderSymbol(c,e,null,this.theme),d[c]=f,a.append(f),this.inter.elements[c]&&this.inter.elements[c].type===e.type&&(k.Map[this.extension][this.stage][c]=f)}}
u.jobFinished(this);d.canvas=v.Map[this.extension][this.stage];b.canvas=this.template.canvas;u.renderedElements[this.extension+"."+this.stage]=d;u.renderedElementsInfo[this.extension+"."+this.stage]=b};T.prototype.renderCanvas=function(){var a=this.template.canvas,b=this.uiSettings,d=this.template.canvas.offset?this.template.canvas.offset:{},d=h.extend(!0,{width:0,height:0,"top-left":{x:0,y:0},"top-right":{x:0,y:0},"bottom-left":{x:0,y:0},"bottom-right":{x:0,y:0}},d);u.parent.isMobile.phone?b.mobile?b=this.template.settings=b.mobile:this.template.settings&&(b=this.template.settings):b["default"]?(this.template.settings=b["default"],b=b["default"]):this.template.settings&&(b=this.template.settings);var c=b.size?b.size.width?this.evaluateValue(b.size.width):a.width:a.width,a=b.size?b.size.height?this.evaluateValue(b.size.height):a.height:a.height;this.template.canvas.rendered={width:c,height:a,offset:d};d=h("\x3cdiv\x3e\x3c/div\x3e").css({margin:"0px",padding:"0px",border:"0px none",background:"none repeat scroll 0% 0% transparent",overflow:"hidden",height:a+d.height+"px",width:c+d.width+"px","z-index":10000001,position:"absolute",visibility:"hidden",left:"10000px",top:"0px"});c=h("\x3ciframe\x3e\x3c/iframe\x3e").css({"background-color":"transparent","vertical-align":"text-bottom",overflow:"hidden",position:"relative",width:"100%",height:"100%",margin:"0px","z-index":999999}).attr({scrolling:"no",frameborder:"0",ALLOWTRANSPARENCY:"true",src:"javascript:parent."+
this.parent.hash+".frameContent('"+this.id+"');"});d.append(c);d.data("content",c);d.data("template",this.template);return d};T.prototype.addStyleToCanvas=function(a,b){var d=a.createElement("style");d.appendChild(a.createTextNode(""));a.head.appendChild(d);for(var d=d.sheet,c=0;c<b.length;c++)d.insertRule(b[c],c)};T.prototype.renderInternalWindowElements=function(a,b){var d=this.template.elements;k.Map[this.extension].InternalWindow[this.stage]={};for(var c in d){var e=d[c];switch(e.type){case"rectangle":var f=this.renderRectangle(c,e,null,this.extension,this.theme);a.append(f);this.inter.elements[c]&&this.inter.elements[c].type===e.type&&(k.Map[this.extension].InternalWindow[this.stage][c]=f);break;case"component":f=this.renderComponent(c,e);a.append(f);this.inter.elements[c]&&this.inter.elements[c].type===e.type&&(k.Map[this.extension].InternalWindow[this.stage][c]=f);break;case"image":f=this.renderImage(c,e,null,this.extension,this.theme);a.append(f);this.inter.elements[c]&&this.inter.elements[c].type===e.type&&(k.Map[this.extension].InternalWindow[this.stage][c]=f);break;case"label":f=this.renderLabel(c,e,null,this.theme,this.language);a.append(f);this.inter.elements[c]&&this.inter.elements[c].type===e.type&&(k.Map[this.extension].InternalWindow[this.stage][c]=f);break;case"button":f=this.renderButton(c,e,null,this.theme,this.language);a.append(f);this.inter.elements[c]&&this.inter.elements[c].type===e.type&&(k.Map[this.extension].InternalWindow[this.stage][c]=f);break;case"inputText":f=this.renderInputText(c,e);a.append(f);this.inter.elements[c]&&this.inter.elements[c].type===e.type&&(k.Map[this.extension].InternalWindow[this.stage][c]=f);break;case"inputArea":f=this.renderInputArea(c,e);a.append(f);this.inter.elements[c]&&this.inter.elements[c].type===e.type&&(k.Map[this.extension].InternalWindow[this.stage][c]=f);break;case"optionsArea":f=this.renderOptionsArea(c,e);a.append(f);f.init(b);this.inter.elements[c]&&this.inter.elements[c].type===e.type&&(k.Map[this.extension].InternalWindow[this.stage][c]=f);break;case"text":a.append(this.renderText(c,e));break;case"symbol":f=this.renderSymbol(c,e,null,this.theme),a.append(f),this.inter.elements[c]&&this.inter.elements[c].type===e.type&&(k.Map[this.extension].InternalWindow[this.stage][c]=f)}}
delete u.runningJobjs[this.id];u.runningJobjsNo--};T.prototype.rendererDraginElements=function(a){var b=v.Map[this.extension][this.stage].data("content").contents().find("body"),d=this.template.elements;k.Map[a].DragIn[this.extension][this.stage]={};for(var c in d){var e=d[c];switch(e.type){case"rectangle":var f=this.renderRectangle(c,e);b.append(f);this.inter.elements[c]&&this.inter.elements[c].type===e.type&&(k.Map[a].DragIn[this.extension][this.stage][c]=f);break;case"component":f=this.renderComponent(c,e,a,this.theme);b.append(f);this.inter.elements[c]&&this.inter.elements[c].type===e.type&&(k.Map[a].DragIn[this.extension][this.stage][c]=f);break;case"image":f=this.renderImage(c,e,null,a,this.theme);b.append(f);this.inter.elements[c]&&this.inter.elements[c].type===e.type&&(k.Map[a].DragIn[this.extension][this.stage][c]=f);break;case"label":f=this.renderLabel(c,e);b.append(f);this.inter.elements[c]&&this.inter.elements[c].type===e.type&&(k.Map[a].DragIn[this.extension][this.stage][c]=f);break;case"inputText":f=this.renderInputText(c,e);b.append(f);this.inter.elements[c]&&this.inter.elements[c].type===e.type&&(k.Map[a].DragIn[this.extension][this.stage][c]=f);break;case"inputArea":f=this.renderInputArea(c,e);b.append(f);this.inter.elements[c]&&this.inter.elements[c].type===e.type&&(k.Map[a].DragIn[this.extension][this.stage][c]=f);break;case"conversationArea":f=this.renderConversationArea(c,e);b.append(f);f.init();this.inter.elements[c]&&this.inter.elements[c].type===e.type&&(k.Map[a].DragIn[this.extension][this.stage][c]=f);break;case"symbol":f=this.renderSymbol(c,e,this.extension,this.theme),b.append(f),this.inter.elements[c]&&this.inter.elements[c].type===e.type&&(k.Map[a].DragIn[this.extension][this.stage][c]=f)}}
u.jobFinished(this,"dragin")};T.prototype.evaluateValue=function(a){if("number"===typeof a)return a;if("string"===typeof a&&(a=a.split("."),"document"===a[0])){if("width"===a[1])return h(window).width();if("height"===a[1])return h(window).height()}};var ja={parent:this,step:0,process:function(a){"jquery"===a?(this.step++,m.init(),G.init()):("client"===a&&this.step++,"run"===a&&this.step++,"templates"===a&&this.step++,"dragin"===a&&this.step++,3===this.step?this.renderTemplates():4===this.step?this.renderDragInTemplate():5===this.step&&this.finished())},renderTemplates:function(){u.container=h("#"+this.parent.hash);u.renderExtensionsTemplate()},renderDragInTemplate:function(){u.renderDragInTemplate()},finished:function(){for(var a in u.renderedElements)u.buildMagnetLinks(u.renderedElements[a],u.renderedElementsInfo[a]),delete u.renderedElements[a],delete u.renderedElementsInfo[a];t.initThisInstance();W.init();N.initLibraries();n.initExtensions();pa.init();Y.init();a=!1;!0===ia.availabaleForConnection()&&(document.visibilityState?"visible"===document.visibilityState&&(a=!0,pa.makeConnection=!0):a=pa.makeConnection=!0);!0===a&&G.connect();"function"===typeof this.parent.loadedComplete&&this.parent.loadedComplete();Ma()}},x={parent:this,Device:this.mobileConfig},pa={parent:this,makeConnection:!1,init:function(){document.addEventListener("visibilitychange",pa.handleVisibilityChange,!1)},handleVisibilityChange:function(){"visible"===document.visibilityState&&!0===ia.availabaleForConnection()&&!1===pa.makeConnection&&(G.connect(),pa.makeConnection=!0)}},z={callAction:function(a,b){a.channel&&"object"==typeof a&&"string"==typeof a.name&&"string"==typeof a.eventName&&"string"==typeof a.group&&"function"==typeof a.main&&"object"==typeof a.args&&"object"==typeof a.eventObject&&"string"==typeof a.eventObject.error&&"object"==typeof a.eventObject.object&&"object"==typeof a.channel&&"string"==typeof a.channel.key&&"string"==typeof a.channel.type&&(Ga.submitAction(a),"boolean"==typeof b&&b&&Ga.run(a.group))}},Ga={Queue:{},submitAction:function(a){"object"==typeof a&&"string"==typeof a.name&&"string"==typeof a.eventName&&"string"==typeof a.group&&"function"==typeof a.main&&"object"==typeof a.args&&"object"==typeof a.eventObject&&"string"==typeof a.eventObject.error&&"object"==typeof a.eventObject.object&&"object"==typeof a.channel&&"string"==typeof a.channel.key&&"string"==typeof a.channel.type&&(void 0==this.Queue[a.group]&&(this.Queue[a.group]={status:"standby",actions:[]}),this.Queue[a.group].actions.push({name:a.name,eventName:a.eventName,channel:a.channel,eventObject:a.eventObject,group:a.group,main:a.main,args:a.args}))},run:function(a){if("string"==typeof a&&void 0!=this.Queue[a]&&null!=this.Queue[a]&&"running"!=this.Queue[a].status){this.Queue[a].status="running";for(var b=this.Queue[a].actions;0<b.length;)y.trigger({group:b[0].group,eventAction:b[0].eventName,when:"before",eventObject:b[0].eventObject,channel:b[0].channel}),b[0].main.call(this,b[0].args,b[0].eventObject),y.trigger({group:b[0].group,eventAction:b[0].eventName,when:"after",eventObject:b[0].eventObject,channel:b[0].channel}),b.shift();this.Queue[a].status="standby"}}},y={parent:this,connect:function(a){a.channel||alert("eventAction key\x3d"+a.group+"."+a.eventAction);"object"==typeof a&&"string"==typeof a.namespace&&"string"==typeof a.eventAction&&"string"==typeof a.group&&"string"==typeof a.when&&"function"==typeof a.main&&""!=a.group&&""!=a.namespace&&""!=a.eventAction&&""!=a.when&&("before"!=a.when&&"after"!=a.when||"object"!=typeof a.channel||Ha.addEvent(a))},trigger:function(a){Ha.trigger(a)}},Ha={parent:this,Queue:{},addEvent:function(a){if("object"==typeof a&&"string"==typeof a.namespace&&"string"==typeof a.eventAction&&"string"==typeof a.group&&"object"==typeof a.channel&&"string"==typeof a.when&&"function"==typeof a.main&&"string"==typeof a.channel.key&&"string"==typeof a.channel.type){var b=a.channel.key.split(".");2>b.length||(void 0==this.Queue[a.group]&&(this.Queue[a.group]={}),void 0==this.Queue[a.group][a.eventAction]&&(this.Queue[a.group][a.eventAction]={}),void 0==this.Queue[a.group][a.eventAction][a.when]&&(this.Queue[a.group][a.eventAction][a.when]={}),void 0==this.Queue[a.group][a.eventAction][a.when][b[0]]&&(this.Queue[a.group][a.eventAction][a.when][b[0]]={}),void 0==this.Queue[a.group][a.eventAction][a.when][b[0]][b[1]]&&(this.Queue[a.group][a.eventAction][a.when][b[0]][b[1]]={}),this.Queue[a.group][a.eventAction][a.when][b[0]][b[1]][a.namespace]={name:a.namespace,eventAction:a.eventAction,group:a.group,when:a.when,channel:a.channel,main:a.main})}},trigger:function(a){if("object"==typeof this.Queue[a.group]&&"object"==typeof this.Queue[a.group][a.eventAction]&&"object"==typeof this.Queue[a.group][a.eventAction][a.when]){var b=a.channel.key.split(".");if(!(2>b.length)){var d,c;switch(a.channel.type){case"public":for(var e in this.Queue[a.group][a.eventAction][a.when])
for(d in b=this.Queue[a.group][a.eventAction][a.when][e],b)
for(c in b[d])b[d][c].main(a.eventObject,a.channel);break;case"private":if("object"!=typeof this.Queue[a.group][a.eventAction][a.when][b[0]])break;b=this.Queue[a.group][a.eventAction][a.when][b[0]];for(d in b)
for(c in b[d])b[d][c].main(a.eventObject,a.channel)}}}}},m={parent:this,hasHTML5Storage:!1,setGeneralValue:function(a){!1===m.hasHTML5Storage&&(a.type="session");switch(a.type){case"session":a.date?this.parent.$.cookie(this.parent.hash+a.key+a.name,a.value,{expires:a.date,path:"/"}):this.parent.$.cookie(this.parent.hash+a.key+a.name,a.value,{path:"/"});break;case"permanent":localStorage.setItem(this.parent.hash+a.key+a.name,a.value);break;case"largeSession":sessionStorage.setItem(this.parent.hash+
a.key+a.name,a.value);break;default:console.log("set unknown storage type")}},getGeneralValue:function(a){!1===m.hasHTML5Storage&&(a.type="session");switch(a.type){case"session":return this.parent.$.cookie(this.parent.hash+a.key+a.name);case"permanent":return localStorage.getItem(this.parent.hash+a.key+a.name);case"largeSession":return sessionStorage.getItem(this.parent.hash+a.key+a.name);default:console.log("get unknown storage type")}},deleteGeneralValue:function(a){!1===m.hasHTML5Storage&&(a.type="session");switch(a.type){case"session":this.parent.$.cookie(this.parent.hash+a.key+a.name,null,{path:"/"});break;case"permanent":localStorage.removeItem(this.parent.hash+a.key+a.name);break;case"largeSession":sessionStorage.removeItem(this.parent.hash+a.key+a.name);break;default:console.log("delete unknown storage type")}},init:function(){m.hasHTML5Storage="undefined"!==typeof Storage?!0:!1},searchStorage:function(a){!1===m.hasHTML5Storage&&(a.type="session");var b={},d=new RegExp(this.parent.hash+
a.key+a.name,"gi");if("session"===a.type){if(document.cookie&&""!==document.cookie){a=document.cookie.split(";");for(var c=0;c<a.length;c++){var e=a[c].split("\x3d");e[0]=e[0].replace(/^ /,"");if(-1!==decodeURIComponent(e[0]).search(d)){var f=decodeURIComponent(e[0]);b[f]=decodeURIComponent(e[1])}}}}else if("permanent"===a.type)
for(c in localStorage)-1!==c.search(d)&&(b[c]=localStorage[c]);else if("largeSession"===a.type)
for(c in localStorage)-1!==c.search(d)&&(b[c]=sessionStorage[c]);return b},setParticularValue:function(a,b,d,c,e){a=this.parent.hash+a+b;"boolean"==typeof e&&0==e&&(a+=(new Date).getTime());this.hasHTML5Storage?localStorage.setItem(a,d):c?this.parent.$.cookie(a,d,{expires:c,path:"/"}):this.parent.$.cookie(a,d,{path:"/"})},getParticularValue:function(a,b,d){"boolean"!=typeof d&&(d=!0);return d?this.hasHTML5Storage?localStorage.getItem(this.parent.hash+a+b):this.parent.$.cookie(this.parent.hash+a+b):m.getAllParticularValuesNamed(a,b)},deleteParticularValue:function(a,b,d){this.hasHTML5Storage?d?localStorage.removeItem(this.parent.hash+
a+b+d):localStorage.removeItem(this.parent.hash+a+b):d?this.parent.$.cookie(this.parent.hash+a+b+d,null,{path:"/"}):this.parent.$.cookie(this.parent.hash+a+b,null,{path:"/"})},getAllParticularValues:function(a,b){var d=[],c=this.parent.hash+a;void 0!=b&&null!=b&&(c+=b);c=new RegExp(c,"gi");if(this.hasHTML5Storage)
for(var e in localStorage)-1!=e.search(c)&&d.push(localStorage[e]);else if(document.cookie&&""!=document.cookie){e=document.cookie.split(";");for(var f=0;f<e.length;f++){var g=e[f].split("\x3d");g[0]=g[0].replace(/^ /,"");-1!=decodeURIComponent(g[0]).search(c)&&d.push(decodeURIComponent(g[1]))}}
return d},getAllParticularValuesNamed:function(a,b){var d={},c=this.parent.hash+a;void 0!=b&&null!=b&&(c+=b);c=new RegExp(c,"gi");if(this.hasHTML5Storage)
for(var e in localStorage)-1!=e.search(c)&&(d[e]=localStorage[e]);else if(document.cookie&&""!=document.cookie){e=document.cookie.split(";");for(var f=0;f<e.length;f++){var g=e[f].split("\x3d");g[0]=g[0].replace(/^ /,"");if(-1!=decodeURIComponent(g[0]).search(c)){var q=decodeURIComponent(g[0]);d[q]=decodeURIComponent(g[1])}}}
return d},clearHtml5StorageValues:function(){var a=new RegExp(this.parent.hash,"gi"),b;for(b in localStorage)-1!=b.search(a)&&localStorage.removeItem(b)}},w={parent:this,acceptStatus:void 0,connectionMethod:void 0,connected:!1,isConnected:function(){return this.connected},changeNick:function(a,b){var d={clientNick:a};"object"!=typeof b&&(b={key:"Chat.chat",type:"public"});z.callAction({name:"changeNick",group:"Network",channel:b,eventName:"onChangingNick",eventObject:{error:"",object:d},main:function(a,b){"string"===typeof a.nick?""!==a.nick&&(p.setNick(a.nick),G.changeNick(a.nick)):b.error="Bad name format"},args:{nick:a}},!0)},receiveClientID:function(a,b){var d={clientID:a};"object"!=typeof b&&(b={key:"Chat.chat",type:"public"});z.callAction({name:"receiveClientID",channel:b,group:"Network",eventName:"onReceivingClientID",eventObject:{error:"",object:d},main:function(a,b){var d=a.clientID;"string"==typeof d?p.clientID=d:b.error="bad id"},args:{clientID:a}},!0)},connect:function(a,b){var d={status:a};"object"!=typeof b&&(b={key:"Chat.chat",type:"public"});z.callAction({name:"connect",channel:b,group:"Network",eventName:"onConnect",eventObject:{error:"",object:d},main:function(a,b){"login"==a.status&&(w.connected=!0);"relogin"==a.status&&(w.connected=!0)},args:{status:a}},!0)},disconnect:function(a){"object"!=typeof a&&(a={key:"Chat.chat",type:"public"});z.callAction({name:"disconnect",channel:a,group:"Network",eventName:"onDisconnect",eventObject:{error:"",object:{}},main:function(a,d){},args:{}},!0)},connectionStatus:function(a,b){var d={status:a};"object"!==typeof b&&(b={key:"Chat.chat",type:"public"});z.callAction({name:"connectionStatus",channel:b,group:"Network",eventName:"onConnectionStatus",eventObject:{error:"",object:d},main:function(a,b){w.acceptStatus=a.status},args:{status:a}},!0)},assignOperator:function(a,b,d,c){var e={operatorName:a,operatorDescription:b,operatorAvatar:d};"object"!==typeof c&&(c={key:"Chat.chat",type:"public"});z.callAction({name:"assignOperator",channel:c,group:"Network",eventName:"onAssignOperator",eventObject:{error:"",object:e},main:function(a,b){p.operatorName=a.operator;p.operatorDescription=a.description;p.operatorAvatar=a.avatar},args:{operator:a,description:b,avatar:d}},!0)},operatorSignout:function(a){var b={operatorName:p.operatorName};"object"!==typeof a&&(a={key:"Chat.chat",type:"public"});z.callAction({name:"operatorSignout",channel:a,group:"Network",eventName:"onOperatorSignout",eventObject:{error:"",object:b},main:function(a,b){p.operatorName=void 0},args:{}},!0)},noOperator:function(a){var b={operatorName:p.operatorName};"object"!==typeof a&&(a={key:"Chat.chat",type:"public"});z.callAction({name:"noOperator",channel:a,group:"Network",eventName:"onNoOperator",eventObject:{error:"",object:b},main:function(a,b){},args:{}},!0)},receiveMessage:function(a,b){var d={user:p.operatorName,type:"operator",message:a};"object"!=typeof b&&(b={key:"Chat.chat",type:"public"});z.callAction({name:"receiveMessage",channel:b,group:"Network",eventName:"onReceiveMessage",eventObject:{error:"",object:d},main:function(a,b){},args:{msg:a}},!0)},receiveImage:function(a,b){var d={image:a};"object"!=typeof b&&(b={key:"Chat.chat",type:"public"});z.callAction({name:"receiveImage",channel:b,group:"Network",eventName:"onReceiveImage",eventObject:{error:"",object:d},main:function(a,b){},args:{image:a}},!0)},sendMessage:function(a,b){var d={user:p.clientNick,type:"visitor",message:a};"object"!=typeof b&&(b={key:"Chat.chat",type:"public"});z.callAction({name:"sendMessage",channel:b,group:"Network",eventName:"onSendMessage",eventObject:{error:"",object:d},main:function(a,b){""==a.msg?b.error="Empty input string":G.sendMessage(a.msg)},args:{msg:a}},!0)},sendCustomMessage:function(a,b){var d={user:p.clientNick,type:"visitor",customMessage:b,channel:a};"object"!=typeof a&&(a={key:"Chat.chat",type:"public"});z.callAction({name:"sendCustomMessage",channel:a,group:"Network",eventName:"onSendCustomMessage",eventObject:{error:"",object:d},main:function(a,b){"string"!==typeof a.customMsg?b.error="Bad custom message":G.sendCustomMessage(a.channel,a.customMsg)},args:{channel:a,customMsg:b}},!0)},sendTimelineMessage:function(a,b){var d={user:p.clientNick,type:"visitor",customMessage:b,channel:a};"object"!=typeof a&&(a={key:"Chat.chat",type:"public"});z.callAction({name:"sendTimelineMessage",channel:a,group:"Network",eventName:"onSendTimelineMessage",eventObject:{error:"",object:d},main:function(a,b){"string"!==typeof a.customMsg?b.error="Bad custom message":G.sendTimelineMessage(a.channel,a.customMsg)},args:{channel:a,customMsg:b}},!0)},receiveCustomMessage:function(a,b){var d={message:a};"object"!=typeof b&&(b={key:"Chat.chat",type:"public"});z.callAction({name:"receiveCustomMessage",channel:b,group:"Network",eventName:"onReceivingCustomMessage",eventObject:{error:"",object:d},main:function(a,b){},args:{message:a}},!0)},conversationStarted:function(a,b,d,c,e){var f={id:a,status:b,initiated:d,startDate:c};"object"!=typeof e&&(e={key:"Chat.chat",type:"public"});z.callAction({name:"conversationStarted",channel:e,group:"Network",eventName:"onConversationStarted",eventObject:{error:"",object:f},main:function(a,b){"string"!=typeof a.id?b.error="bad conversation format":"string"!=typeof a.status?b.error="bad conversation format":"string"!=typeof a.initiated?b.error="bad conversation format":"string"!=typeof a.startDate&&(b.error="bad conversation format")},args:{id:a,status:b,initiated:d,startDate:c}},!0)},updateConversationStatus:function(a,b,d,c){var e={id:a,status:b,endDate:d};"object"!=typeof c&&(c={key:"Chat.chat",type:"public"});z.callAction({name:"updateConversationStatus",channel:c,group:"Network",eventName:"onConversationStatusUpdated",eventObject:{error:"",object:e},main:function(a,b){"string"!=typeof a.id?b.error="bad conversation format":"string"!=typeof a.status?b.error="bad conversation format":"string"!=typeof a.endDate&&(b.error="bad conversation format")},args:{id:a,status:b,endDate:d}},!0)},closeConversation:function(a){"object"!=typeof a&&(a={key:"Chat.chat",type:"public"});z.callAction({name:"closeConversation",channel:a,group:"Network",eventName:"onClosingConversation",eventObject:{error:"",object:{}},main:function(a,d){G.closeConversation()},args:{}},!0)},emailTranscript:function(a,b){var d={email:a};"object"!=typeof b&&(b={key:"Chat.chat",type:"public"});z.callAction({name:"emailTranscript",channel:b,group:"Network",eventName:"onEmailTranscript",eventObject:{error:"",object:d},main:function(a,b){G.emailTranscript(a.email)},args:{email:a}},!0)},widgetInfo:function(a,b){var d={stage:a};"object"!=typeof b&&(b={key:"Chat.chat",type:"public"});z.callAction({name:"widgetInfo",channel:b,group:"Network",eventName:"onWidgetInfo",eventObject:{error:"",object:d},main:function(a,b){"string"!=typeof a.stage&&(b.error="bad widget info format")},args:{stage:a}},!0)},sendOfflineMessage:function(a,b,d,c,e){var f={name:a,email:b,message:d,phone:c};"object"!=typeof e&&(e={key:"Chat.chat",type:"public"});z.callAction({name:"offlineMessage",channel:e,group:"Network",eventName:"onSendingOfflineMessage",eventObject:{error:"",object:f},main:function(a,b){G.sendOfflineMessage(a.name,a.email,a.message,a.phone)},args:{name:a,email:b,message:d,phone:c}},!0)},initConversation:function(a,b){var d={user:p.clientNick,type:"visitor",message:a};"object"!=typeof b&&(b={key:"Chat.chat",type:"public"});z.callAction({name:"initConversation",channel:b,group:"Network",eventName:"onInitConversation",eventObject:{error:"",object:d},main:function(a,b){""==a.msg?b.error="Empty input string":G.initConversation(a.msg)},args:{msg:a}},!0)},receiveInitConversationStatus:function(a,b){var d={status:a};"object"!==typeof b&&(b={key:"Chat.chat",type:"public"});z.callAction({name:"receiveInitConversation",channel:b,group:"Network",eventName:"onReceivingInitConversation",eventObject:{error:"",object:d},main:function(a,b){},args:{status:a}},!0)},requestServerTime:function(a){var b={channel:a};"object"!==typeof a&&(a={key:"Chat.chat",type:"public"});z.callAction({name:"requestServerTime",channel:a,group:"Network",eventName:"onRequestingServerTime",eventObject:{error:"",object:b},main:function(a,b){G.requestServerTime(a.channel)},args:{channel:a}},!0)},receiveServerTime:function(a,b){var d={channel:a,time:b};"object"!=typeof a&&(a={key:"Chat.chat",type:"public"});z.callAction({name:"receiveServerTime",channel:a,group:"Network",eventName:"onReceivingServerTime",eventObject:{error:"",object:d},main:function(a,b){},args:{channel:a,time:b}},!0)},operatorChangedConnector:function(a,b){"object"!=typeof a&&(a={key:"Chat.chat",type:"public"});z.callAction({name:"operatorChangedConnector",channel:a,group:"Network",eventName:"onOperatorChangedConnector",eventObject:{error:"",object:{}},main:function(a,b){},args:{}},!0)},instanceType:function(a,b){var d={type:a};"object"!==typeof b&&(b={key:"Chat.chat",type:"public"});z.callAction({name:"instanceType",channel:b,group:"Network",eventName:"onInstanceType",eventObject:{error:"",object:d},main:function(a,b){"string"!==typeof a.type&&(b.error="bad info format")},args:{type:a}},!0)},requestVisitorInstances:function(a){var b={channel:a};"object"!==typeof a&&(a={key:"Chat.chat",type:"public"});z.callAction({name:"requestVisitorInstances",channel:a,group:"Network",eventName:"onRequestingVisitorInstances",eventObject:{error:"",object:b},main:function(a,b){G.requestVisitorInstances(a.channel)},args:{channel:a}},!0)},receiveVisitorInstances:function(a,b){var d={channel:a,instances:b};"object"!==typeof a&&(a={key:"Chat.chat",type:"public"});z.callAction({name:"receiveVisitorInstances",channel:a,group:"Network",eventName:"onReceivingVisitorInstances",eventObject:{error:"",object:d},main:function(a,b){},args:{channel:a,instances:b}},!0)},requestOperator:function(a){var b={channel:a};"object"!=typeof a&&(a={key:"Chat.chat",type:"public"});z.callAction({name:"requestOperator",channel:a,group:"Network",eventName:"onRequestOperator",eventObject:{error:"",object:b},main:function(a,b){G.requestOperator()},args:{channel:a}},!0)},updateProfile:function(a,b,d){var c={name:a,value:b};"object"!=typeof d&&(d={key:"Chat.chat",type:"public"});z.callAction({name:"updateProfile",channel:d,group:"Network",eventName:"onUpdateProfile",eventObject:{error:"",object:c},main:function(a,b){G.updateProfile(a.name,a.value)},args:{name:a,value:b}},!0)}},p={parent:this,operatorName:void 0,operatorDescription:"",operatorAvatar:void 0,clientNick:"visitor"+Math.floor(1E4*Math.random()),clientID:"",master:!1,currentInstance:void 0,conversation:void 0,getLocation:function(){return this.parent.widgetLocation},setNick:function(a,b){var d={clientNick:a};"object"!==typeof b&&(b={key:"Chat.chat",type:"public"});z.callAction({name:"setNick",channel:b,group:"Info",eventName:"onSettingNick",eventObject:{error:"",object:d},main:function(a,b){p.clientNick=a.clientNick},args:{clientNick:a}},!0)},setOperatorName:function(a,b){var d={operatorName:a};"object"!==typeof b&&(b={key:"Chat.chat",type:"public"});z.callAction({name:"setOperatorName",channel:b,group:"Info",eventName:"onSettingOperatorName",eventObject:{error:"",object:d},main:function(a,b){"string"!==typeof a.operatorName?b.error="bad name format":""===a.operatorName?b.error="name can't be an empty string":p.operatorName=a.operatorName},args:{operatorName:a}},!0)},setOperatorDescription:function(a,b){var d={operatorDescription:a};"object"!==typeof b&&(b={key:"Chat.chat",type:"public"});z.callAction({name:"setOperatorDescription",channel:b,group:"Info",eventName:"onSettingOperatorDescription",eventObject:{error:"",object:d},main:function(a,b){"string"!==typeof a.operatorDescription?b.error="bad name format":""===a.operatorDescription?b.error="name can't be an empty string":p.operatorDescription=a.operatorDescription},args:{operatorDescription:a}},!0)},setOperatorAvatar:function(a,b){var d={operatorAvatar:a};"object"!==typeof b&&(b={key:"Chat.chat",type:"public"});z.callAction({name:"setOperatorAvatar",channel:b,group:"Info",eventName:"onSettingOperatorAvatar",eventObject:{error:"",object:d},main:function(a,b){"string"!==typeof a.operatorAvatar?b.error="bad name format":p.operatorAvatar=a.operatorAvatar},args:{operatorAvatar:a}},!0)},setClientID:function(a,b){var d={clientID:a};"object"!==typeof b&&(b={key:"Chat.chat",type:"public"});z.callAction({name:"setClientID",channel:b,group:"Info",eventName:"onSettingClientID",eventObject:{error:"",object:d},main:function(a,b){var d=a.clientID;""===d?b.error="bad id":"string"===typeof d?p.clientID=d:b.error="bad id"},args:{clientID:a}},!0)},setMaster:function(a,b){var d={master:a};"object"!==typeof b&&(b={key:"Chat.chat",type:"public"});z.callAction({name:"setMaster",channel:b,group:"Info",eventName:"onSettingMaster",eventObject:{error:"",object:d},main:function(a,b){"boolean"===typeof a.master?p.master=a.master:b.error="bad master value"},args:{master:a}},!0)},setConversation:function(a,b,d,c,e){var f={id:a,status:b,initiated:d,startDate:c};"object"!==typeof e&&(e={key:"Chat.chat",type:"public"});z.callAction({name:"setConversation",channel:e,group:"Info",eventName:"onSettingConversation",eventObject:{error:"",object:f},main:function(a,b){"string"!==typeof a.id?b.error="bad conversation format":"string"!==typeof a.status?b.error="bad conversation format":"string"!==typeof a.initiated?b.error="bad conversation format":"string"!==typeof a.startDate?b.error="bad conversation format":p.conversation=Na.createConversationObject(a.id,a.status,a.initiated,a.startDate)},args:{id:a,status:b,initiated:d,startDate:c}},!0)},updateConversationStatus:function(a,b,d){var c={status:a,endDate:b};"object"!==typeof d&&(d={key:"Chat.chat",type:"public"});z.callAction({name:"updateConversationStatus",channel:d,group:"Info",eventName:"onUpdateConversationStatus",eventObject:{error:"",object:c},main:function(a,b){"string"!==typeof a.status?b.error="bad conversation format":"string"!==typeof a.endDate?b.error="bad conversation format":(p.conversation.status=a.status,p.conversation.endDate=a.endDate)},args:{status:a,endDate:b}},!0)}},t={parent:this,connectingID:"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"===a?b:b&3|8).toString(16)}),ID:null,Instances:{},masterInstance:void 0,count:0,Actions:{},IntanceStorage:{Data:{},store:function(a,b,d){t.IntanceStorage.Data[a]||(t.IntanceStorage.Data[a]={});t.IntanceStorage.Data[a][b]||(t.IntanceStorage.Data[a][b]={});t.IntanceStorage.Data[a][b]=d},get:function(a,b){return t.IntanceStorage.Data[a]&&t.IntanceStorage.Data[a][b]?t.IntanceStorage.Data[a][b]:null},remove:function(a,b){t.IntanceStorage.Data[a]&&t.IntanceStorage.Data[a][b]&&delete t.IntanceStorage.Data[a][b]}},localConnection:void 0,initThisInstance:function(){this.localConnection=new La({key:t.parent.hash,callback:function(a){h(t).trigger(a.key+"."+a.name,[a.value])}})},getInstanceNumber:function(){return this.count},on:function(a){h(this).on(a.key+"."+a.name+"."+a.namespace,a,a.main)},propagate:function(a){this.localConnection.send({value:a})}},H={parent:this,hash:"",stage:"unavailable",getStage:function(){return H.stage},changeStage:function(a,b){var d={stage:a};"object"!=typeof b&&(b={key:"Chat.chat",type:"public"});z.callAction({name:"changeStage",channel:b,group:"Widget",eventName:"onChangingStage",eventObject:{error:"",object:d},main:function(a,b){H.stage=a.stage},args:{stage:a}},!0)}},Na={createConversationObject:function(a,b,d,c,e){return{id:a,status:b,initiated:d,startDate:c,endDate:e}}},W={parent:this,Element:void 0,visible:!1,init:function(){W.Element=h("#"+this.parent.hash)},hide:function(){W.Element.hide();W.visible=!1},show:function(){W.Element.show();W.visible=!0},isVisible:function(){return W.visible}},fa={parent:this,get:function(a){return window[a]?window[a]:null}},Aa={escapeRegExp:function(a){return a.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")},replace:function(a,b){if("string"===typeof a&&"object"===typeof b){for(var d in b)a=a.replace(new RegExp(Aa.escapeRegExp("{%"+d+"%}"),"g"),b[d]);return a}}},ia={parent:this,getType:function(){var a="desktop";!0===ia.parent.isMobile.any&&(!0===ia.parent.isMobile.phone&&(a="mobile"),!0===ia.parent.isMobile.tablet&&(a="tablet"));return a},availabaleForConnection:function(){var a=!0;!1===x.Device.mobile.visibility&&"mobile"===ia.getType()&&(a=!1);return a}},Z={items:[],addItem:function(a){this.items[a.position]=a},getNextAction:function(){for(var a=0;a<this.items.length;a++)
if(this.items[a]&&!this.items[a].activated)return this.items[a];return null},activateNext:function(){var a=this.getNextAction();null!=a&&(a.activated=!0,a.activate())}},Y={init:function(){var a=m.getGeneralValue({key:"Profile",name:"name",type:"permanent"}),b=m.getGeneralValue({key:"Profile",name:"email",type:"permanent"}),d=m.getGeneralValue({key:"Profile",name:"phone",type:"permanent"});a&&(this.name=a);b&&(this.email=b);d&&(this.phone=d)},setValue:function(a,b){this[a]=b;m.setGeneralValue({key:"Profile",name:a,value:b,type:"permanent"})},getValue:function(a){return this[a]?this[a]:(a=m.getGeneralValue({key:"Profile",name:a,type:"permanent"}))?a:null}};this.API={Stages:v,Network:w,Events:y,Info:p,StorageManager:m,Extensions:n,Widget:H,External:fa,InstanceFactory:t};X.installScrollerPlugin=function(a){(function(a){var d,c,e;c={paneClass:"pane",sliderClass:"slider",contentClass:"content",iOSNativeScrolling:!1,preventPageScrolling:!1,disableResize:!1,alwaysVisible:!1,flashDelay:1500,sliderMinHeight:20,sliderMaxHeight:null,doc:document,win:window};var f="Microsoft Internet Explorer"===window.navigator.appName&&/msie 7./i.test(window.navigator.appVersion),g=null;e=function(){var a,b;a=document.createElement("div");b=a.style;b.position="absolute";b.width="100px";b.height="100px";b.overflow="scroll";b.top="-9999px";document.body.appendChild(a);b=a.offsetWidth-a.clientWidth;document.body.removeChild(a);return b};d=function(){function c(d,f){this.el=d;this.options=f;g||(g=e());this.$el=a(this.el);this.doc=a(f.doc);this.win=a(f.win);this.generate();this.createEvents();this.addEvents();this.reset()}
c.prototype.preventScrolling=function(a,b){this.isActive&&("DOMMouseScroll"===a.type?("down"===b&&0<a.originalEvent.detail||"up"===b&&0>a.originalEvent.detail)&&a.preventDefault():"mousewheel"===a.type&&a.originalEvent&&a.originalEvent.wheelDelta&&("down"===b&&0>a.originalEvent.wheelDelta||"up"===b&&0<a.originalEvent.wheelDelta)&&a.preventDefault())};c.prototype.updateScrollValues=function(){var a;a=this.content;this.maxScrollTop=a.scrollHeight-a.clientHeight;this.contentScrollTop=a.scrollTop;this.maxSliderTop=this.paneHeight-this.sliderHeight;this.sliderTop=this.contentScrollTop*this.maxSliderTop/this.maxScrollTop};c.prototype.createEvents=function(){var a=this;this.events={down:function(b){a.isBeingDragged=!0;a.offsetY=b.pageY-a.slider.offset().top;a.pane.addClass("active");a.doc.bind("mousemove",a.events.drag).bind("mouseup",a.events.up);return!1},drag:function(b){a.sliderY=b.pageY-a.$el.offset().top-a.offsetY;a.scroll();a.updateScrollValues();a.contentScrollTop>=a.maxScrollTop?a.$el.trigger("scrollend"):0===a.contentScrollTop&&a.$el.trigger("scrolltop");return!1},up:function(b){a.isBeingDragged=!1;a.pane.removeClass("active");a.doc.unbind("mousemove",a.events.drag).unbind("mouseup",a.events.up);return!1},resize:function(b){a.reset()},panedown:function(b){a.sliderY=(b.offsetY||b.originalEvent.layerY)-.5*a.sliderHeight;a.scroll();a.events.down(b);return!1},scroll:function(b){a.isBeingDragged||(a.updateScrollValues(),a.sliderY=a.sliderTop,a.slider.css({top:a.sliderTop}),null!=b&&(a.contentScrollTop>=a.maxScrollTop?(a.options.preventPageScrolling&&a.preventScrolling(b,"down"),a.$el.trigger("scrollend")):0===a.contentScrollTop&&(a.options.preventPageScrolling&&a.preventScrolling(b,"up"),a.$el.trigger("scrolltop"))))},wheel:function(b){if(null!=b)return a.sliderY+=-b.wheelDeltaY||-b.delta,a.scroll(),!1}}};c.prototype.addEvents=function(){var a;this.removeEvents();a=this.events;this.options.disableResize||this.win.bind("resize",a.resize);this.slider.bind("mousedown",a.down);this.pane.bind("mousedown",a.panedown).bind("mousewheel DOMMouseScroll",a.wheel);this.$content.bind("scroll mousewheel DOMMouseScroll touchmove",a.scroll)};c.prototype.removeEvents=function(){var a;a=this.events;this.win.unbind("resize",a.resize);this.slider.unbind();this.pane.unbind();this.$content.unbind("scroll mousewheel DOMMouseScroll touchmove",a.scroll)};c.prototype.generate=function(){var a,b,c,d,e;c=this.options;d=c.paneClass;e=c.sliderClass;a=c.contentClass;c.pane&&c.slider?this.$el.append(c.pane):this.$el.find(""+d).length||this.$el.find(""+e).length||this.$el.append('\x3cdiv class\x3d"'+d+'"\x3e\x3cdiv class\x3d"'+e+'" /\x3e\x3c/div\x3e');this.$content=c.container?c.container:this.$el.children("."+a);this.$content.attr("tabindex",0);this.content=this.$content[0];this.slider=c.slider?c.slider:this.$el.find("."+e);this.pane=c.pane?c.pane:this.$el.find("."+d);g&&(b="rtl"===this.$el.css("direction")?{left:-g}:{right:-g},this.$el.addClass("has-scrollbar"));c.iOSNativeScrolling&&(b||(b={}),b.WebkitOverflowScrolling="touch");null!=b&&this.$content.css(b);return this};c.prototype.restore=function(){this.stopped=!1;this.pane.show();this.addEvents()};c.prototype.reset=function(){var a,b,c,d,e,q,h;this.$el.find("."+this.options.paneClass).length||this.generate().stop();this.stopped&&this.restore();a=this.content;c=a.style;d=c.overflowY;f&&this.$content.css({height:this.$content.height()});b=a.scrollHeight+g;q=this.pane.outerHeight();h=parseInt(this.pane.css("top"),10);e=parseInt(this.pane.css("bottom"),10);e=q+h+e;h=Math.round(e/b*e);h<this.options.sliderMinHeight?h=this.options.sliderMinHeight:null!=this.options.sliderMaxHeight&&h>this.options.sliderMaxHeight&&(h=this.options.sliderMaxHeight);"scroll"===d&&"scroll"!==c.overflowX&&(h+=g);this.maxSliderTop=e-h;this.contentHeight=b;this.paneHeight=q;this.paneOuterHeight=e;this.sliderHeight=h;this.slider.height(h);this.events.scroll();this.pane.show();this.isActive=!0;a.scrollHeight===a.clientHeight||this.pane.outerHeight(!0)>=a.scrollHeight&&"scroll"!==d?(this.pane.hide(),this.isActive=!1):this.el.clientHeight===a.scrollHeight&&"scroll"===d?this.slider.hide():this.slider.show();this.pane.css({opacity:this.options.alwaysVisible?1:"",visibility:this.options.alwaysVisible?"visible":""});return this};c.prototype.scroll=function(){if(this.isActive)return this.sliderY=Math.max(0,this.sliderY),this.sliderY=Math.min(this.maxSliderTop,this.sliderY),this.$content.scrollTop((this.paneHeight-this.contentHeight+g)*this.sliderY/this.maxSliderTop*-1),this.slider.css({top:this.sliderY}),this};c.prototype.scrollBottom=function(a){if(this.isActive)return this.reset(),this.$content.scrollTop(this.contentHeight-this.$content.height()-a).trigger("mousewheel"),this};c.prototype.scrollTop=function(a){if(this.isActive)return this.reset(),this.$content.scrollTop(+a).trigger("mousewheel"),this};c.prototype.scrollTo=function(c){if(this.isActive)return this.reset(),this.scrollTop(a(c).get(0).offsetTop),this};c.prototype.stop=function(){this.stopped=!0;this.removeEvents();this.pane.hide();return this};c.prototype.flash=function(){var a=this;if(this.isActive)return this.reset(),this.pane.addClass("flashed"),setTimeout(function(){a.pane.removeClass("flashed")},this.options.flashDelay),this};return c}();a.fn.nanoScroller=function(e){return this.each(function(){var f;(f=this.nanoscroller)||(f=a.extend({},c,e),this.nanoscroller=f=new d(this,f));if(e&&"object"===typeof e){a.extend(f.options,e);if(e.scrollBottom)return f.scrollBottom(e.scrollBottom);if(e.scrollTop)return f.scrollTop(e.scrollTop);if(e.scrollTo)return f.scrollTo(e.scrollTo);if("bottom"===e.scroll)return f.scrollBottom(0);if("top"===e.scroll)return f.scrollTop(0);if(e.scroll&&e.scroll instanceof a)return f.scrollTo(e.scroll);if(e.stop)return f.stop();if(e.flash)return f.flash()}
return f.reset()})}})(a)};X.installTimeAgoPlugin=function(a){(function(a){function d(){var d;d=a(this);if(!d.data("timeago")){d.data("timeago",{datetime:f.datetime(d)});var e=a.trim(d.text());!(0<e.length)||f.isTime(d)&&d.attr("title")||d.attr("title",e)}
d=d.data("timeago");isNaN(d.datetime)||a(this).text(c(d.datetime));return this}
function c(a){return f.inWords(e(a))}
function e(a){return(new Date).getTime()-a.getTime()}
a.timeago=function(d){return d instanceof Date?c(d):"string"===typeof d?c(a.timeago.parse(d)):"number"===typeof d?c(new Date(d)):c(a.timeago.datetime(d))};var f=a.timeago;a.extend(a.timeago,{settings:{refreshMillis:6E4,allowFuture:!1,strings:{prefixAgo:null,prefixFromNow:null,suffixAgo:"ago",suffixFromNow:"from now",seconds:"less than a minute",minute:"about a minute",minutes:"%d minutes",hour:"about an hour",hours:"about %d hours",day:"a day",days:"%d days",month:"about a month",months:"%d months",year:"about a year",years:"%d years",wordSeparator:" ",numbers:[]}},inWords:function(c){function d(f,B){return(a.isFunction(f)?f(B,c):f).replace(/%d/i,e.numbers&&e.numbers[B]||B)}
var e=this.settings.strings,f=e.prefixAgo,I=e.suffixAgo;this.settings.allowFuture&&0>c&&(f=e.prefixFromNow,I=e.suffixFromNow);var B=Math.abs(c)/1E3,C=B/60,h=C/60,m=h/24,F=m/365,B=45>B&&d(e.seconds,Math.round(B))||90>B&&d(e.minute,1)||45>C&&d(e.minutes,Math.round(C))||90>C&&d(e.hour,1)||24>h&&d(e.hours,Math.round(h))||42>h&&d(e.day,1)||30>m&&d(e.days,Math.round(m))||45>m&&d(e.month,1)||365>m&&d(e.months,Math.round(m/30))||1.5>F&&d(e.year,1)||d(e.years,Math.round(F));return a.trim([f,B,I].join(void 0===e.wordSeparator?" ":e.wordSeparator))},parse:function(c){c=a.trim(c);c=c.replace(/\.\d+/,"");c=c.replace(/-/,"/").replace(/-/,"/");c=c.replace(/T/," ").replace(/Z/," UTC");c=c.replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2");return new Date(c)},datetime:function(c){c=f.isTime(c)?a(c).attr("datetime"):a(c).attr("title");return f.parse(c)},isTime:function(c){return"time"===a(c).get(0).tagName.toLowerCase()}});a.fn.timeago=function(){var a=this;a.each(d);var b=f.settings;0<b.refreshMillis&&setInterval(function(){a.each(d)},b.refreshMillis);return a};document.createElement("abbr");document.createElement("time")})(a)};X.installCookiePlugin=function(){this.parent.$.cookie=function(a,b,d){if(1<arguments.length&&"[object Object]"!==String(b)){d=X.parent.$.extend({},d);if(null===b||void 0===b)d.expires=-1;if("number"===typeof d.expires){var c=d.expires,e=d.expires=new Date;e.setDate(e.getDate()+c)}
b=String(b);return document.cookie=[encodeURIComponent(a),"\x3d",d.raw?b:encodeURIComponent(b),d.expires?"; expires\x3d"+d.expires.toUTCString():"",d.path?"; path\x3d"+d.path:"",d.domain?"; domain\x3d"+d.domain:"",d.secure?"; secure":""].join("")}
d=b||{};e=d.raw?function(a){return a}:decodeURIComponent;return(c=(new RegExp("(?:^|; )"+encodeURIComponent(a)+"\x3d([^;]*)")).exec(document.cookie))?e(c[1]):null}};X.installAutoSizePlugin=function(a){(function(a){function d(e){this.filter(d.resizableFilterSelector).each(function(){new c(a(this),e)});return this}
function c(c,e){c.data("AutoResizer")&&c.data("AutoResizer").destroy();e=this.config=a.extend({},d.defaults,e);this.el=c;this.nodeName=c[0].nodeName.toLowerCase();this.originalHeight=c.height();this.previousScrollTop=null;this.value=c.val();"original"===e.maxWidth&&(e.maxWidth=c.width());"original"===e.minWidth&&(e.minWidth=c.width());"original"===e.maxHeight&&(e.maxHeight=c.height());"original"===e.minHeight&&(e.minHeight=c.height());"textarea"===this.nodeName&&c.css({resize:"none",overflowY:"hidden"});c.data("AutoResizer",this);this.createClone();this.injectClone();this.bind()}
var e="ar"+ +new Date;d.defaults={onResize:function(){},afterResize:function(){},animate:{duration:0,complete:function(){}},extraSpace:50,minHeight:"original",maxHeight:500,minWidth:"original",maxWidth:500};d.cloneCSSProperties="lineHeight textDecoration letterSpacing fontSize fontFamily fontStyle fontWeight textTransform textAlign direction wordSpacing fontSizeAdjust padding width".split(" ");d.cloneCSSValues={position:"absolute",top:-9999,left:-9999,opacity:0,overflow:"hidden"};d.resizableFilterSelector=["textarea:not(textarea."+e+")","input:not(input[type]),input[type\x3dtext],input[type\x3dpassword]"].join();d.AutoResizer=c;a.fn.autoResize=d;c.prototype={bind:function(){var c=a.proxy(function(){this.check();return!0},this);this.unbind();this.el.bind("keyup.autoResize",c).bind("change.autoResize",c);this.check(null,!0)},unbind:function(){this.el.unbind(".autoResize")},createClone:function(){var c=this.el,g="textarea"===this.nodeName?c.clone():a("\x3cspan/\x3e");this.clone=g;a.each(d.cloneCSSProperties,function(a,b){g[0].style[b]=c.css(b)});g.removeAttr("name").removeAttr("id").addClass(e).attr("tabIndex",-1).css(d.cloneCSSValues);"textarea"===this.nodeName?g.height("auto"):g.width("auto").css({whiteSpace:"nowrap"})},check:function(a,b){var c=this.config,d=this.clone,e=this.el,I=e.val();if("input"===this.nodeName){if(d.text(I),d=d.width(),d=d+c.extraSpace>=c.minWidth?d+c.extraSpace:c.minWidth,I=e.width(),d=Math.min(d,c.maxWidth),d<I&&d>=c.minWidth||d>=c.minWidth&&d<=c.maxWidth)c.onResize.call(e),e.scrollLeft(0),c.animate.complete=c.afterResize,c.animate&&!b?e.stop(1,1).animate({width:d},c.animate):e.width(d)}else d.width(e.width()).height(0).val(I).scrollTop(1E4),d=d[0].scrollTop+c.extraSpace,this.previousScrollTop!==d&&(this.previousScrollTop=d,d>=c.maxHeight?(e.css("overflowY",""),d=c.maxHeight):e.css("overflowY","hidden"),d<c.minHeight&&(d=c.minHeight),c.onResize.call(e),c.animate.complete=c.afterResize,c.animate&&!b?e.stop(1,1).animate({height:d},c.animate):e.height(d))},destroy:function(){this.unbind();this.el.removeData("AutoResizer");this.clone.remove();delete this.el;delete this.clone},injectClone:function(){(d.cloneContainer||(d.cloneContainer=a("\x3carclones/\x3e").appendTo("body"))).append(this.clone)}}})(a)};X.installAttrchangePlugin=function(a){(function(a){function d(){var a=document.createElement("p"),b=!1;if(a.addEventListener)a.addEventListener("DOMAttrModified",function(){b=!0},!1);else if(a.attachEvent)a.attachEvent("onDOMAttrModified",function(){b=!0});else return!1;a.setAttribute("id","target");return b}
function c(c,d){if(c){var e=this.data("attr-old-value");if(0<=d.attributeName.indexOf("style")){e.style||(e.style={});var l=d.attributeName.split(".");d.attributeName=l[0];d.oldValue=e.style[l[1]];d.newValue=l[1]+":"+this.prop("style")[a.camelCase(l[1])];e.style[l[1]]=d.newValue}else d.oldValue=e[d.attributeName],d.newValue=this.attr(d.attributeName),e[d.attributeName]=d.newValue;this.data("attr-old-value",e)}}
var e=window.MutationObserver||window.WebKitMutationObserver;a.fn.attrchange=function(f){var g={trackValues:!1,callback:a.noop};"function"===typeof f?g.callback=f:a.extend(g,f);g.trackValues&&a(this).each(function(c,d){var e={},f;c=0;for(var g=d.attributes,l=g.length;c<l;c++)f=g.item(c),e[f.nodeName]=f.value;a(this).data("attr-old-value",e)});if(e){var q={subtree:!1,attributes:!0,attributeOldValue:g.trackValues},l=new e(function(c){c.forEach(function(c){var d=c.target;g.trackValues&&(c.newValue=a(d).attr(c.attributeName));g.callback.call(d,c)})});return this.each(function(){l.observe(this,q)})}
return d()?this.on("DOMAttrModified",function(a){a.originalEvent&&(a=a.originalEvent);a.attributeName=a.attrName;a.oldValue=a.prevValue;g.callback.call(this,a)}):"onpropertychange"in document.body?this.on("propertychange",function(d){d.attributeName=window.event.propertyName;c.call(a(this),g.trackValues,d);g.callback.call(this,d)}):this}})(a)};X.installMagnetJSPlugin=function(a){(function(a){var d={},c=function(a){var b=a.data("magnet"),c=b.settings,d=c.links,f=c.rules,B={};b.oldValues=B;for(b=0;b<f.length;b++)
for(var c=f[b].attributes,h=0;h<c.length;h++)B[c[h]]={},B[c[h]]=e(a,c[h]);a.attrchange({trackValues:!0,callback:function(b){if("style"===b.attributeName){b=!1;for(var c=[],l={},q=0;q<f.length;q++){var h=f[q],C=h.attributes;c[q]=h.method;for(h=0;h<C.length;h++){var m=e(a,C[h]);B[C[h]]!==m?(b=!0,l[C[h]]=m-B[C[h]],B[C[h]]=m):l[C[h]]=0}}
if(b)
for(q=0;q<c.length;q++)c[q](d,l)}}})},e=function(a,b){var c;switch(b){case"top":c=a.position().top;break;case"left":c=a.position().left;break;case"width":c=a.width();break;case"height":c=a.height()}
return c},f={init:function(e){return this.each(function(){var f=a(this),l=f.data("magnet");l||(a(this).data("magnet",{target:f,version:.1,settings:a.extend(!0,{},d)}),l=f.data("magnet"));e&&a.extend(l.settings,e);c(f)})},destroy:function(){return this.each(function(){var c=a(this);c.data("page");c.removeData("page")})}};a.fn.magnet=function(c){if(f[c])return f[c].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof c&&c)a.error("Method "+
c+" does not exist on jQuery.magnet");else return f.init.apply(this,arguments)}})(a)};X.installLinkifyPlugin=function(a){(function(a,d,c){function e(a,b){this._defaults=f;this.element=a;this.setOptions(b);this.init()}
var f={tagName:"a",newLine:"\n",target:"_blank",linkClass:null,linkClasses:[],linkAttributes:null};e.prototype={constructor:e,init:function(){1===this.element.nodeType?e.linkifyNode.call(this,this.element):this.element=e.linkify.call(this,this.element.toString())},setOptions:function(a){this.settings=e.extendSettings(a,this.settings)},toString:function(){return this.element.toString()}};e.extendSettings=function(a,b){var c;b=b||{};for(c in f)b[c]||(b[c]=f[c]);for(c in a)b[c]=a[c];return b};e.linkMatch=/(\s|[^a-zA-Z0-9.\+_\/"\>\-]|^)(?:([a-zA-Z0-9\+_\-]+(?:\.[a-zA-Z0-9\+_\-]+)*@)?(http:\/\/|https:\/\/|ftp:\/\/)?((?:(?:[a-z0-9][a-z0-9_%\-_+]*\.)+))((?:com|ca|co|edu|gov|net|org|dev|biz|cat|int|pro|tel|mil|aero|asia|coop|info|jobs|mobi|museum|name|post|travel|local|[a-z]{2}))((?::\d{1,5}))?((?:[\/|\?](?:[\-a-zA-Z0-9_%#*&+=~!?,;:.\/]*)*)[\-\/a-zA-Z0-9_%#*&+=~]|\/?)?)([^a-zA-Z0-9\+_\/"\<\-]|$)/g;e.emailLinkMatch=/(<[a-z]+ href=\")(http:\/\/)([a-zA-Z0-9\+_\-]+(?:\.[a-zA-Z0-9\+_\-]+)*@)/g;e.linkify=function(a,b){var c,d,f,B=[];this.constructor===e&&this.settings?(d=this.settings,b&&(d=e.extendSettings(b,d))):d=e.extendSettings(b);f=d.linkClass?d.linkClass.split(/\s+/):[];f.push.apply(f,d.linkClasses);a=a.replace(/</g,"\x26lt;").replace(/(\s)/g,"$1$1");B.push("$1\x3c"+d.tagName,'href\x3d"http://$2$4$5$6$7"');B.push('class\x3d"linkified'+(0<f.length?" "+f.join(" "):"")+'"');d.target&&B.push('target\x3d"'+
d.target+'"');for(c in d.linkAttributes)B.push([c,'\x3d"',d.linkAttributes[c].replace(/\"/g,"\x26quot;").replace(/\$/g,"\x26#36;"),'"'].join(""));return B.push("\x3e$2$3$4$5$6$7\x3c/"+d.tagName+"\x3e$8"),a=a.replace(e.linkMatch,B.join(" ")),a=a.replace(e.emailLinkMatch,"$1mailto:$3"),a=a.replace(/(\s){2}/g,"$1"),a.replace(/\n/g,d.newLine)};e.linkifyNode=function(a){var b,d,f;if(a&&"object"==typeof a&&1===a.nodeType&&"a"!==a.tagName.toLowerCase()&&!/[^\s]linkified[\s$]/.test(a.className)){b=[];f=e._dummyElement||c.createElement("div");for(d=a.firstChild;d;){if(3===d.nodeType){for(;f.firstChild;)f.removeChild(f.firstChild);f.innerHTML=e.linkify.call(this,d.textContent||d.innerText||d.nodeValue);for(b.push.apply(b,f.childNodes);f.firstChild;)f.removeChild(f.firstChild)}else b.push(1===d.nodeType?e.linkifyNode.call(this,d):d);d=d.nextSibling}
for(;a.firstChild;)a.removeChild(a.firstChild);for(d=0;d<b.length;d++)a.appendChild(b[d])}
return a};e._dummyElement=c.createElement("div");a.fn.linkify=function(c){return this.each(function(){var d;(d=a.data(this,"plugin-linkify"))?(d.setOptions(c),d.init()):a.data(this,"plugin-linkify",new e(this,c))})};a.fn.linkify.Constructor=e;a(d).on("load",function(){a("[data-linkify]").each(function(){var c=a(this),d=c.attr("data-linkify"),e={tagName:c.attr("data-linkify-tagname"),newLine:c.attr("data-linkify-newline"),target:c.attr("data-linkify-target"),linkClass:c.attr("data-linkify-linkclass")},f;for(f in e)"undefined"==typeof e[f]&&delete e[f];("this"===d?c:c.find(d)).linkify(e)})});a("body").on("click",".linkified",function(){var c=a(this),e=c.attr("href"),f=/^mailto:/i.test(e),c=c.attr("target");return f?d.location.href=e:d.open(e,c),!1})})(a,window,document)};(function(a){var b=/iPhone/i,d=/iPod/i,c=/iPad/i,e=/(?=.*\bAndroid\b)(?=.*\bMobile\b)/i,f=/Android/i,g=/IEMobile/i,h=/(?=.*\bWindows\b)(?=.*\bARM\b)/i,l=/BlackBerry/i,m=/BB10/i,I=/Opera Mini/i,B=/(?=.*\bFirefox\b)(?=.*\bMobile\b)/i,C=/(?:Nexus 7|BNTV250|Kindle Fire|Silk|GT-P1000)/i,p=function(a){a=a||navigator.userAgent;this.apple={phone:b.test(a),ipod:d.test(a),tablet:c.test(a),device:b.test(a)||d.test(a)||c.test(a)};this.android={phone:e.test(a),tablet:!e.test(a)&&f.test(a),device:e.test(a)||f.test(a)};this.windows={phone:g.test(a),tablet:h.test(a),device:g.test(a)||h.test(a)};this.other={blackberry:l.test(a),blackberry10:m.test(a),opera:I.test(a),firefox:B.test(a),device:l.test(a)||m.test(a)||I.test(a)||B.test(a)};this.seven_inch=C.test(a);this.any=this.apple.device||this.android.device||this.windows.device||this.other.device||this.seven_inch;this.phone=this.apple.phone||this.android.phone||this.windows.phone;this.tablet=this.apple.tablet||this.android.tablet||this.windows.tablet;if("undefined"===typeof window)return this},k=function(){var a=new p;a.Class=p;return a};"undefined"!=typeof module&&module.exports&&"undefined"===typeof window?module.exports=p:"undefined"!=typeof module&&module.exports&&"undefined"!==typeof window?module.exports=k():"function"===typeof define&&define.amd?define("isMobile",[],a.isMobile=k()):a.isMobile=k()})(this);T.prototype.renderRectangle=function(a,b,d,c,e){var f=h("\x3cdiv\x3e\x3c/div\x3e").css({position:"absolute","z-index":b.z});this.analyzeProperties(a,f,b,null,e);f.data("renderer",this);if(b.hasTheme){var g={css:function(a,b){switch(a){case"background.color":this.setBackgroundColor(b)}},setBackgroundColor:function(a){f.css({"background-color":a})}};f.Theme=function(){return g}}
b.hasTheme?c[a].background&&("string"===typeof c[a].background.image&&f.css({"background-image":"none"===c[a].background.image?"none":'url("'+n.Map[this.extension].themeData+c[a].background.image+'")'}),"string"===typeof c[a].background.color&&f.css({"background-color":c[a].background.color})):b.background&&("string"===typeof b.background.image&&f.css({"background-image":"none"===b.background.image?"none":'url("'+n.Map[this.extension].templateData+b.background.image+'")'}),"string"===typeof b.background.color&&f.css({"background-color":b.background.color}));var q;if("object"===typeof b["corner-radius"])
for(q in b["corner-radius"])f.css("border-"+
q+"-radius",b["corner-radius"][q]+"px");"string"===typeof b["box-shadow"]&&f.css("box-shadow",b["box-shadow"]);if("object"===typeof b.border)
if(b.hasTheme)
if(c[a].border)
for(q in b.border)f.css("border-"+q,b.border[q].size+"px "+(b.border[q].style?b.border[q].style:"solid")+" "+c[a].border[q].color);else
for(q in b.border)f.css("border-"+q,b.border[q].size+"px "+(b.border[q].style?b.border[q].style:"solid")+" "+b.border[q].color);else
for(q in b.border)f.css("border-"+q,b.border[q].size+"px "+(b.border[q].style?b.border[q].style:"solid")+" "+b.border[q].color);"string"===typeof b.cursor&&f.css("cursor",b.cursor);f.on("click",function(){var b=h(this).data("renderer");z.callAction({channel:{key:b.extension,type:"public"},name:b.stage+"."+a+".click",group:"Elements."+b.extension,eventName:("InternalWindow"===b.type?"InternalWindow.":"")+b.stage+"."+a+".onClick",eventObject:{error:"",object:{}},main:function(a,b){},args:{}},!0)});return f};T.prototype.renderImage=function(a,b,d,c,e,f){var g=h("\x3cimg\x3e\x3c/img\x3e").css({position:"absolute","z-index":b.z});this.analyzePosition(g,b);g.data("renderer",this);if(b.hasTheme){var q={css:function(a,b){switch(a){case"border.color":this.setBorderColor(b)}},setBorderColor:function(a){g.css({"border-color":a})}};g.Theme=function(){return q}}
b.hasTheme?"string"===typeof d?"string"===typeof e[d][a].src&&g.attr({src:n.Map[c].themeData+e[d][a].src}):"string"===typeof e[a].src&&g.attr({src:"https://printyuk.com/img/avatar_tati.png"}):"string"===typeof b.src&&g.attr({src:"https://printyuk.com/img/chat_printyuk.png"});"string"===typeof b.cursor&&g.css("cursor",b.cursor);b.width&&g.css({width:b.width+"px",overflow:"hidden"});b.height&&g.css({height:b.height+"px",overflow:"hidden"});if("object"===typeof b.border){g.css("border-style","solid");if(b.border.size)g.css("border-width",b.border.width),b.border.color&&g.css("border-color",b.border.color);else
for(l in b.border)b.border[l].width&&g.css("border-"+l+"-width",b.border[l].width),b.border[l].color&&g.css("border-"+l+"-color",b.border[l].color);if(b.hasTheme&&e[a].border)
if(e[a].border.color)g.css("border-color",e[a].border.color);else
for(l in b.border)e[a].border[l].color&&g.css("border-"+l+"-color",+e[a].border[l].color)}
if("object"===typeof b["corner-radius"])
for(var l in b["corner-radius"])g.css("border-"+l+"-radius",b["corner-radius"][l]+"px");g.setDefaultURL=function(){b.hasTheme?"string"===typeof d?"string"===typeof e[d][a].src&&g.attr({src:n.Map[c].themeData+e[d][a].src}):"string"===typeof e[a].src&&g.attr({src:n.Map[c].themeData+e[a].src}):"string"===typeof b.src&&g.attr({src:n.Map[c].templateData+
b.src})};g.setURL=function(a){g.attr({src:a})};g.getURL=function(){return g.attr("src")};g.on("click",function(){var b=h(this).data("renderer"),c={channel:{key:b.extension,type:"public"},name:b.stage+"."+a+".click",eventObject:{error:"",object:{}},main:function(a,b){},args:{}};switch(b.type){case"stage":c.eventName=b.stage+"."+a+".onClick";c.group="Elements."+b.extension;break;case"DragIn":c.eventName="DragIn."+b.extension+"."+b.stage+"."+a+".onClick";c.group="Elements."+b.DragInKey;break;default:c.eventName=b.type+"."+b.stage+"."+a+".onClick",c.group="Elements."+b.extension}
z.callAction(c,!0)});return g};T.prototype.renderLabel=function(a,b,d,c,e,f){var g=h("\x3cdiv\x3e\x3c/div\x3e").css({position:"absolute",padding:"0",margin:"0","line-height":"1",overflow:"hidden","z-index":b.z});b.width&&g.css({width:b.width+"px",overflow:"hidden"});this.analyzeProperties(a,g,b,null,f);var q=h("\x3cspan\x3e\x3c/span\x3e").css({padding:"0",margin:"0","font-family":b["font-family"],"font-size":b["font-size"]+"px","font-weight":b["font-weight"]?b["font-weight"]:"normal","outline-style":"none","line-height":"1.3"});!0===b.locale?q.text(e[a]):q.text(b.text);g.append(q);g.data("renderer",this);if(b.hasTheme){var l={addStyleToCanvas:this.addStyleToCanvas,css:function(a,b){switch(a){case"color":this.setColor(b)}},setColor:function(a){q.css({color:a})}};g.Theme=function(){return l}}
b.hasTheme?"string"===typeof d?"string"===typeof c[d][a].color&&q.css({color:c[d][a].color}):"string"===typeof c[a].color&&q.css({color:c[a].color}):"string"===typeof b.color&&q.css({color:b.color});"string"===typeof b.cursor&&g.css("cursor",b.cursor);"string"===typeof b["text-align"]&&g.css("text-align",b["text-align"]);g.setText=function(a){"string"===typeof a&&q.text(a)};g.getText=function(){return q.text()};g.on("click",function(){var b=h(this).data("renderer"),c={channel:{key:b.extension,type:"public"},name:b.stage+"."+a+".click",eventObject:{error:"",object:{}},main:function(a,b){},args:{}};switch(b.type){case"stage":c.eventName=b.stage+"."+a+".onClick";c.group="Elements."+b.extension;break;case"DragIn":c.eventName="DragIn."+b.extension+"."+b.stage+"."+a+".onClick";c.group="Elements."+b.DragInKey;break;default:c.eventName=b.type+"."+b.stage+"."+a+".onClick",c.group="Elements."+b.extension}
z.callAction(c,!0)});return g};T.prototype.renderConversationArea=function(a,b,d,c){if("on"==x["Chat.chat"].emojione){var e=h("\x3clink\x3e\x3c/link\x3e").attr({href:"https://cdn.jsdelivr.net/emojione/2.2.7/assets/css/emojione.min.css",rel:"stylesheet",type:"text/css"});v.Map["Chat.chat"].MainChat.data("content").contents().find("head").append(e)}
v.Map["Chat.chat"].MainChat.data("content").contents().find("head").append(e);switch(typeof b.height){case"object":for(var f in b.height)(d=x[this.extension][f])&&"number"===typeof b.height[f][d]&&(b.height=b.height[f][d])}
switch(typeof b.y){case"object":for(f in b.y)(d=x[this.extension][f])&&"number"===typeof b.y[f][d]&&(b.y=b.y[f][d])}
var g=h("\x3cdiv\x3e\x3c/div\x3e").css({position:"absolute",overflow:"hidden","z-index":b.z});this.analyzeProperties(a,g,b);var q=v.Map[this.extension][this.stage].data("content").contents().get(0);q&&this.addStyleToCanvas(q,[".visitorBubble {float:right; margin-right:25px; position: relative; max-width:70%; border-radius:5px; margin-top:5px; margin-bottom:10px; background-color: "+c[a][b.template].visitor.background.color+"; border:1px solid "+c[a][b.template].visitor.border.color+"; position: relative; }",'.visitorBubble:after, .visitorBubble:before { left: 100%; top: 16px; border: solid transparent; content: " "; height: 0; width: 0; position: absolute; pointer-events: none; }',".visitorBubble:after {border-left-color: "+c[a][b.template].visitor.background.color+"; border-width: 10px 0 0 10px; margin-top: -10px; }",".visitorBubble:before { border-left-color: "+c[a][b.template].visitor.border.color+"; border-width: 13px 0 0 12px; margin-top: -12px; }",".operatorBubble {float:left; position: relative; max-width:70%; border-radius:5px; margin-top:5px; margin-bottom:10px; background-color: "+c[a][b.template].operator.background.color+"; border:1px solid "+c[a][b.template].operator.border.color+"; position: relative; }",'.operatorBubble:after, .operatorBubble:before { right: 100%; top: 16px; border: solid transparent; content: " "; height: 0; width: 0; position: absolute; pointer-events: none; }',".operatorBubble:after { border-bottom-color: "+c[a][b.template].operator.background.color+"; border-width: 0px 0px 6px 10px; margin-top: -10px; }",".operatorBubble:before { border-bottom-color: "+c[a][b.template].operator.border.color+"; border-width:  0px 0px 9px 12px; margin-top: -12px; }",".systemBubble {border-radius:5px; margin-top:5px; margin-bottom:10px; margin-right:20px; background-color: "+
c[a][b.template].system.background.color+"; border:1px solid "+c[a][b.template].system.border.color+"; position: relative; }",".sk-three-bounce {margin: 0px auto;width: 100px;text-align: center;}",".sk-three-bounce .sk-child {width: 8px;height: 8px;background-color: #e25644;border-radius: 100%;display: inline-block;-webkit-animation: sk-three-bounce 1.4s ease-in-out 0s infinite both;animation: sk-three-bounce 1.4s ease-in-out 0s infinite both;}",".sk-three-bounce .sk-bounce1 {-webkit-animation-delay: -0.32s;animation-delay: -0.32s;}",".sk-three-bounce .sk-bounce2 {-webkit-animation-delay: -0.16s;animation-delay: -0.16s;}","@-webkit-keyframes sk-three-bounce {0%, 80%, 100% {-webkit-transform: scale(0);transform: scale(0);}40% {-webkit-transform: scale(0.75);transform: scale(0.75);}}","@keyframes sk-three-bounce {0%, 80%, 100% {-webkit-transform: scale(0);transform: scale(0);}40% {-webkit-transform: scale(0.75);transform: scale(0.75);}}"]);if(b.hasTheme){var l={addStyleToCanvas:this.addStyleToCanvas,css:function(a,b){switch(a){case"background.color":this.setBackgroundColor(b);break;case"bubble.operator.background.color":this.setOperatorBackgroundColor(b);break;case"bubble.operator.border.color":this.setOperatorBorderColor(b);break;case"bubble.operator.name.color":this.setOperatorNameColor(b);break;case"bubble.operator.message.color":this.setOperatorMessageColor(b);break;case"bubble.visitor.background.color":this.setVisitorBackgroundColor(b);break;case"bubble.visitor.border.color":this.setVisitorBorderColor(b);break;case"bubble.visitor.name.color":this.setVisitorNameColor(b);break;case"bubble.visitor.message.color":this.setVisitorMessageColor(b);break;case"scrollbar.color":this.setScrollbarColor(b)}},setBackgroundColor:function(a){g.css({"background-color":a})},setOperatorBackgroundColor:function(a){this.addStyleToCanvas(q,[".operatorBubble {background-color: "+a+"; }",".operatorBubble:after { border-bottom-color: "+a+"; }"])},setOperatorBorderColor:function(a){this.addStyleToCanvas(q,[".operatorBubble {border:1px solid "+a+"; }",".operatorBubble:before { border-bottom-color: "+
a+";}"])},setOperatorNameColor:function(a){g.find(".operatorName").css("color",a)},setOperatorMessageColor:function(a){g.find(".operatorMessage").css("color",a)},setVisitorBackgroundColor:function(a){this.addStyleToCanvas(q,[".visitorBubble { background-color: "+a+";  }",".visitorBubble:after {border-left-color: "+a+"; }"])},setVisitorBorderColor:function(a){this.addStyleToCanvas(q,[".visitorBubble {border:1px solid "+a+"; }",".visitorBubble:before { border-left-color: "+a+";}"])},setVisitorNameColor:function(a){g.find(".visitorName").css("color",a)},setVisitorMessageColor:function(a){g.find(".visitorMessage").css("color",a)},setScrollbarColor:function(a){g.slider.css("background-color",a)}};g.Theme=function(){return l}}
g.init=function(){var b=h("\x3cdiv\x3e\x3c/div\x3e").css({position:"absolute",overflow:"scroll","overflow-x":"hidden",top:0,right:0,bottom:0,left:0,height:g.height()+"px"});this.append(b);this.data("content",b);g.magnet({links:[b],rules:[{attributes:["height"],method:function(a,b){a[0].width(a[0].width()+b.width);a[0].height(a[0].height()+
b.height);g.nanoScroller()}}]});var d=h("\x3cdiv\x3e\x3c!-- --\x3e\x3c/div\x3e").css({height:"5px",clear:"both"});b.append(d);d=h("\x3cdiv\x3e\x3c/div\x3e").css({width:"8px","background-color":c[a].scrollbar?c[a].scrollbar.color:"#b4b4b4",position:"relative",margin:"0 1px","border-radius":"3px"});g.slider=d;var e=h("\x3cdiv\x3e\x3c/div\x3e").css({"background-color":"#ffffff",bottom:0,position:"absolute",right:0,top:0,width:"12px"});e.append(d);var f=this.data("renderer"),f=v.Map[f.extension][f.stage].data("content");this.nanoScroller({container:b,slider:d,pane:e,win:f.get(0).contentWindow,doc:f.get(0).contentWindow.document})};g.data("renderer",this);var m;b.hasTheme?c[a].background&&("string"===typeof c[a].background.image?g.css({"background-image":'url("'+n.Map[this.extension].themeData+c[a].background.image+'")'}):"string"===typeof c[a].background.color&&g.css({"background-color":c[a].background.color})):b.background&&("string"===typeof b.background.image?g.css({"background-image":'url("'+n.Map[this.extension].themeData+
b.background.image+'")'}):"string"===typeof b.background.color&&g.css({"background-color":b.background.color}));if("object"===typeof b.border)
if(b.hasTheme)
if(c[a].border)
for(m in b.border)g.css("border-"+m,b.border[m].size+"px solid "+c[a].border[m].color);else
for(m in b.border)g.css("border-"+m,b.border[m].size+"px solid "+b.border[m].color);else
for(m in b.border)g.css("border-"+m,b.border[m].size+"px solid "+b.border[m].color);g.lines=[];g.timeLines=[];g.parent=this;g.addLine=function(c,d){if("visitor"==c.type||"operator"==c.type||"system"==c.type)
if(c.message=c.message.trim(),c.message||d){var e=c.message.split("\n");if(1<e.length)
for(var f=0;f<e.length;f++)this.addLine({type:c.type,name:c.name,message:e[f]?e[f]:"\x26nbsp;",time:c.time,operatorAvatar:c.operatorAvatar,image:c.image},!0);else{var f=this.data("content"),e=this.data("renderer"),l=!0,q=!1;0<this.lines.length&&(this.lines[this.lines.length-1].type===c.type?l=!1:q=!0);this.lines.push(c);q&&(q=h("\x3cdiv\x3e\x3c!-- --\x3e\x3c/div\x3e").css({height:"5px",clear:"both"}),f.append(q));if(l){if("on"===x["Chat.chat"].operator_avatar&&"operator"===c.type){var q=h("\x3cdiv\x3e\x3c/div\x3e").css({width:"40px",height:"40px","float":"left","margin-top":"10px","margin-left":"10px","margin-right":"2px"}),m=h("\x3cimg\x3e\x3c/img\x3e").css({width:"40px",height:"40px","border-radius":"20px"}).attr({alt:c.name,src:c.operatorAvatar});q.append(m);f.append(q)}
q=h("\x3cdiv\x3e\x3c/div\x3e").css({"padding-bottom":"7px","margin-left":"10px","padding-top":"5px","animation-duration":".5s"}).addClass(c.type+"Bubble");q.addClass("animated fadeIn");f.userContainer=q;f.append(f.userContainer)}
q=h("\x3cdiv\x3e\x3c/div\x3e").css({"margin-left":"11px","margin-right":"11px","line-height":"1.2","word-wrap":"break-word","animation-duration":".5s"}).addClass("animated fadeIn");f.userContainer.append(q);l&&(f=h("\x3cspan\x3e\x3c/span\x3e").css({color:e.theme[a][b.template][c.type].name.color,"font-family":e.theme[a][b.template][c.type].name["font-family"],"font-size":e.theme[a][b.template][c.type].name["font-size"]+"px","font-weight":"bold","line-height":"1.2"}).addClass("operator"===c.type?"operatorName":"visitor"===c.type?"visitorName":"").text(c.name?c.name+": ":""),q.append(f));!0===c.image?(e=h("\x3ca\x3e\x3c/a\x3e").attr({href:"http:"+c.message,target:"_blank"}).addClass("operator"===c.type?"operatorMessage":"visitor"===c.type?"visitorMessage":""),f=h("\x3cimg\x3e").attr({src:c.message}).css({"max-width":"100%",height:"auto","border-radius":"5px",border:"2px solid white","box-sizing":"border-box"}).on("load",function(){g.nanoScroller();g.nanoScroller({scroll:"bottom"})}),e.append(f)):(e=h("\x3cspan\x3e\x3c/span\x3e").css({color:e.theme[a][b.template][c.type].message.color,"font-family":e.theme[a][b.template][c.type].message["font-family"],"font-size":e.theme[a][b.template][c.type].message["font-size"]+"px","line-height":"1.2"}).addClass("operator"===c.type?"operatorMessage":"visitor"===c.type?"visitorMessage":""),"on"==x["Chat.chat"].emojione?/^(?: |\ud83c[\udf00-\udfff]|\ud83d[\udc00-\ude4f]|\ud83d[\ude80-\udeff]|\ud83e[\udd10-\uddc0]|[\u2600-\u26fe])*$/g.test(c.message)?(e.html(emojione.unicodeToImage(c.message)),e.find(".emojione").css({"vertical-align":"top",height:"50px"})):e.html(emojione.unicodeToImage(c.message)):e.text(c.message));q.append(e);"on"===x["Chat.chat"].linkify_urls&&e.linkify({tagName:"a",target:"_blank",newLine:"\n",linkClass:null,linkAttributes:{style:"color:#442AE0; text-decoration:none;"}});this.nanoScroller();this.nanoScroller({scroll:"bottom"})}}};g.addLines=function(a){for(var b=0;b<a.length;b++)this.addLine(a[b])};g.deleteLines=function(){this.lines=[];this.data("content").empty();this.nanoScroller()};g.deleteLastLine=function(a){0<this.lines.length&&this.lines[this.lines.length-1].type==a&&this.lines.splice(-1,1)};g.addCustomLine=function(a){if(this.customRenderers[a.type]){this.lines.push(a);var b=this.data("content"),c=h("\x3cdiv\x3e\x3c!-- --\x3e\x3c/div\x3e").css({height:"5px",clear:"both"});a.separator=c;b.append(c);this.customRenderers[a.type](a,this);this.nanoScroller();this.nanoScroller({scroll:"bottom"})}};g.registerCustomLine=function(a,b){this.customRenderers||(this.customRenderers={});this.customRenderers[a]=b};return g};T.prototype.renderInputArea=function(a,b,d,c){var e=h("\x3ctextarea\x3e\x3c/textarea\x3e").css({position:"absolute","box-sizing":"border-box",resize:"none",outline:"none",margin:"0px",padding:"0px","font-family":b["font-family"],"font-size":b["font-size"]+"px","font-weight":b["font-weight"]?b["font-weight"]:"normal","z-index":b.z});this.analyzeProperties(a,e,b);b.border||e.css({border:"none"});"string"===typeof b.text&&e.val(b.text);"string"===typeof d?"string"===typeof c[d][a].color&&e.css({color:c[d][a].color}):"string"===typeof c[a].color&&e.css({color:c[a].color});!0===b["auto-resize"]&&(e.autoResize("destroy"),e.autoResize({maxHeight:3*b.height,minHeight:b.height,extraSpace:0,onResize:function(){},afterResize:function(){}}));e.getValue=function(){return this.val()};e.setValue=function(a){"string"===typeof a&&this.val(a)};e.setPlaceholder=function(a){"string"===typeof a&&this.attr("placeholder",a)};d="click";if("undefined"!=typeof u){var f=1==u.parent.isMobile.phone||1==u.parent.isMobile.tablet;d=f?"touchend":"click"}
e.data("renderer",this);if(!0===b.onEnter)e.on("keypress",function(b){if(13===b.which){b.preventDefault();b=h(this).data("renderer");var c=h(this).val();z.callAction({channel:{key:b.extension,type:"public"},name:b.stage+"."+a+".enter",group:"Elements."+b.extension,eventName:b.stage+"."+a+".onEnter",eventObject:{error:"",object:{value:c}},main:function(a,b){"string"!==typeof a.value&&(b.error="Bad name format")},args:{value:c}},!0);f&&h(this).blur()}});e.on(d,function(b){b=h(this).data("renderer");z.callAction({channel:{key:b.extension,type:"public"},name:b.stage+"."+a+".click",group:"Elements."+b.extension,eventName:b.stage+"."+a+".onClick",eventObject:{error:"",object:{}},main:function(a,b){},args:{}},!0)});return e};T.prototype.renderSymbol=function(a,b,d,c,e){var f=null;d&&(f=v.Map[d][this.stage].data("template"));d=h("\x3cdiv\x3e\x3c/div\x3e").css({position:"absolute","text-align":"center","user-select":"none","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","z-index":b.z});this.analyzeProperties(a,d,b,f,e);d.data("renderer",this);var g=h("\x3ci\x3e\x3c/i\x3e").addClass(b["class"]);d.append(g);b.height&&g.css("line-height",b.height+"px");b.hasTheme?c[a].color&&g.css({color:c[a].color}):b.color&&g.css({color:b.color});if(b.hasTheme){var q={css:function(a,b){switch(a){case"color":this.setColor(b)}},setColor:function(a){g.css({color:a})}};d.Theme=function(){return q}}"string"===typeof b.cursor&&d.css("cursor",b.cursor);"number"===typeof b.size&&g.css("font-size",b.size);b="click";"undefined"!=typeof u&&(b=1==u.parent.isMobile.phone||1==u.parent.isMobile.tablet?"touchend":"click");d.on(b,function(b){"SendButton"!=a&&b.preventDefault();b=h(this).data("renderer");var c={channel:{key:b.extension,type:"public"},name:b.stage+"."+a+".click",eventObject:{error:"",object:{}},main:function(a,b){},args:{}};switch(b.type){case"stage":c.eventName=b.stage+"."+a+".onClick";c.group="Elements."+b.extension;break;case"DragIn":c.eventName="DragIn."+b.extension+"."+b.stage+"."+a+".onClick";c.group="Elements."+b.DragInKey;break;default:c.eventName=b.type+"."+b.stage+"."+a+".onClick",c.group="Elements."+b.extension}
z.callAction(c,!0)});return d};T.prototype.renderStyleFiles=function(a,b,d){for(var c=/{local}/g,e=0;e<a.length;e++){a[e]=a[e].replace(c,n.Map[d].templateData+"files/");var f=b.createElement("link");f.setAttribute("href",a[e]);f.setAttribute("rel","stylesheet");f.setAttribute("type","text/css");b.head.appendChild(f)}};T.prototype.renderInputText=function(a,b,d,c){var e=h("\x3cinput\x3e\x3c/input\x3e").css({position:"absolute","box-sizing":"border-box","font-family":b["font-family"],"font-size":b["font-size"]+"px","font-weight":b["font-weight"]?b["font-weight"]:"normal","z-index":b.z}).attr({type:"text"});this.analyzeProperties(a,e,b);b.border||e.css({border:"none"});e.data("renderer",this);"string"===typeof b.text&&e.val(b.text);b.hasTheme?"string"===typeof d?"string"===typeof c[d][a].color&&e.css({color:c[d][a].color}):"string"===typeof c[a].color&&e.css({color:c[a].color}):"string"===typeof b.color&&e.css({color:b.color});e.getValue=function(){return this.val()};e.setValue=function(a){"string"===typeof a&&this.val(a)};e.setPlaceholder=function(a){"string"===typeof a&&this.attr("placeholder",a)};e.on("keypress",function(b){if(13===b.which){b.preventDefault();b=h(this).data("renderer");var c=h(this).val();z.callAction({channel:{key:b.extension,type:"public"},name:b.stage+"."+a+".enter",group:"Elements."+b.extension,eventName:b.stage+"."+a+".onEnter",eventObject:{error:"",object:{value:c}},main:function(a,b){"string"!==typeof a.value&&(b.error="Bad name format")},args:{value:c}},!0)}});b="click";"undefined"!=typeof u&&(b=1==u.parent.isMobile.phone||1==u.parent.isMobile.tablet?"touchstart":"click");e.on(b,function(b){b=h(this).data("renderer");z.callAction({channel:{key:b.extension,type:"public"},name:b.stage+"."+a+".click",group:"Elements."+b.extension,eventName:b.stage+"."+a+".onClick",eventObject:{error:"",object:{}},main:function(a,b){},args:{}},!0)});return e};T.prototype.renderButton=function(a,b,d,c,e){var f=h("\x3cdiv\x3e\x3c/div\x3e").css({position:"absolute",padding:"string"===typeof b.padding?b.padding:"3px 8px",margin:"0","border-radius":"string"===typeof b["border-radius"]?b["border-radius"]:"0px","z-index":b.z});this.analyzePosition(f,b);var g=h("\x3cdiv\x3e\x3c/div\x3e").css({padding:"0",margin:"0","font-family":b["font-family"],"font-size":b["font-size"]+"px","font-weight":"normal","outline-style":"none","line-height":"1"});!0===b.locale?g.text(e[a]):g.text(b.text);f.append(g);f.data("renderer",this);if(b.hasTheme){var q={addStyleToCanvas:this.addStyleToCanvas,css:function(a,b){switch(a){case"background.color":this.setBackgroundColor(b);break;case"border.color":this.setOperatorBackgroundColor(b)}},setBackgroundColor:function(a){f.css({"background-color":a})},setBorderColor:function(a){f.css({"border-color":a})}};f.Theme=function(){return q}}
b.hasTheme?"string"===typeof d?("string"===typeof c[d][a].color&&g.css({color:c[d][a].color}),"object"===typeof c[d][a].background&&f.css({"background-color":c[d][a].background.color}),"object"===typeof c[d][a].border&&f.css({border:"1px solid "+c[d][a].border.color})):("string"===typeof c[a].color&&g.css({color:c[a].color}),"object"===typeof c[a].background&&f.css({"background-color":c[a].background.color}),"object"===typeof c[a].border&&f.css({border:c[a].border.color})):("string"===typeof b.color&&g.css({color:b.color}),"object"===typeof b.background&&f.css({color:b.background.color}),"object"===typeof b.border&&f.css({border:"1px solid "+b.border.color}));"string"===typeof b.cursor&&f.css("cursor",b.cursor);b="click";"undefined"!=typeof u&&(b=1==u.parent.isMobile.phone||1==u.parent.isMobile.tablet?"touchstart":"click");f.on(b,function(){var b=h(this).data("renderer"),c={channel:{key:b.extension,type:"public"},name:b.stage+"."+a+".click",eventObject:{error:"",object:{}},main:function(a,b){},args:{}};switch(b.type){case"stage":c.eventName=b.stage+"."+a+".onClick";c.group="Elements."+b.extension;break;case"DragIn":c.eventName="DragIn."+b.extension+"."+b.stage+"."+a+".onClick";c.group="Elements."+b.DragInKey;break;default:c.eventName=b.type+"."+b.stage+"."+a+".onClick",c.group="Elements."+b.extension}
z.callAction(c,!0)});return f};T.prototype.renderOptionsArea=function(a,b,d){var c=null;d&&(c=v.Map[this.extension][this.stage].data("template"));d=h("\x3cdiv\x3e\x3c/div\x3e").css({position:"absolute",overflow:"hidden",width:b.width+"px",height:b.height+"px","z-index":b.z});this.analyzePosition(d,b,b,c);d.init=function(a){var c=h("\x3cdiv\x3e\x3c/div\x3e").css({position:"absolute",overflow:"scroll","overflow-x":"hidden",top:0,right:0,bottom:0,left:0,height:b.height+"px"});this.append(c);this.data("content",c);var d=h("\x3cdiv\x3e\x3c/div\x3e").css({width:"8px","background-color":"#ffffff",position:"relative",margin:"0 1px","-moz-border-radius":"3px","-webkit-border-radius":"3px","border-radius":"3px",border:"1px solid #828282"}),e=h("\x3cdiv\x3e\x3c/div\x3e").css({"background-color":"#e4e4e4",bottom:0,position:"absolute",right:0,top:0,width:"12px","border-left":"1px solid #bababa"});e.append(d);var m=this.data("renderer");a=a?a:v.Map[m.extension][m.stage];void 0===a&&(a=v.currentStage);a=a.data("content");this.nanoScroller({container:c,slider:d,pane:e,win:a.get(0).contentWindow,doc:a.get(0).contentWindow.document})};d.data("renderer",this);var e;if(b.hasTheme){if(this.theme[a].background&&("string"===typeof this.theme[a].background.image?d.css({"background-image":'url("'+n.Map[this.extension].themeData+this.theme[a].background.image+'")'}):"string"===typeof this.theme[a].background.color&&d.css({"background-color":this.theme[a].background.color})),"object"===typeof this.theme[a].border)
for(e in this.theme[a].border)d.css("border-"+e,this.theme[a].border[e].size+"px solid "+this.theme[a].border[e].color)}else if(b.background&&("string"===typeof b.background.image?d.css({"background-image":'url("'+
n.Map[this.extension].themeData+conversationArea.background.image+'")'}):"string"===typeof b.background.color&&d.css({"background-color":b.background.color})),"object"===typeof b.border)
for(e in b.border)d.css("border-"+e,b.border[e].size+"px solid "+b.border[e].color);d.options=[];d.parent=this;d.addOption=function(b){var c=this.data("content"),d=this.data("renderer"),e=h("\x3cdiv\x3e\x3c/div\x3e").css({"margin-left":"5px","margin-right":"5px","padding-top":"2px","padding-bottom":"2px","background-color":d.theme[a].option.background.color,cursor:"pointer"}),m=h("\x3cspan\x3e\x3c/span\x3e").css({"font-family":"Arial","font-size":"11px","margin-left":"5px","line-height":"1","vertical-align":"middle",color:d.theme[a].option.title.color}).text(b.title);e.append(m);e.on("mouseover",function(){m.css({color:d.theme[a].option.title["over-color"]})});e.on("mouseout",function(){m.css({color:d.theme[a].option.title.color})});e.on("click",function(){E.CreatedInternalWindows[d.extension][d.stage]&&E.CreatedInternalWindows[d.extension][d.stage].hideWindow();b.onClick()});c.append(e);this.nanoScroller()};return d};T.prototype.renderComponent=function(a,b,d,c,e){c=h("\x3cdiv\x3e\x3c/div\x3e").css({position:"absolute","z-index":b.z,overflow:"hidden"});this.analyzeProperties(a,c,b);c.data("renderer",this);for(var f in b.components){var g;switch(b.components[f].type){case"label":g=this.renderLabel(f,b.components[f],null,this.theme,this.language,!0);c.append(g);break;case"symbol":g=this.renderSymbol(f,b.components[f],null,this.theme,!0);c.append(g);break;case"rectangle":g=this.renderRectangle(f,b.components[f],null,this.theme,!0);c.append(g);break;case"image":g=this.renderImage(f,b.components[f],null,d,this.theme,!0),c.append(g)}
this.inter.elements[f]&&this.inter.elements[f].type===b.components[f].type&&(k.Map[this.extension][this.stage][f]=g);b.components[f].hasTheme&&"object"===typeof ThemableElements&&(ThemableElements[f]={info:b.components[f],rendered:g})}"string"===typeof b.cursor&&c.css("cursor",b.cursor);"string"===typeof b["box-shadow"]&&c.css("box-shadow",b["box-shadow"]);var q;if("object"===typeof b["corner-radius"])
for(q in b["corner-radius"])c.css("border-"+q+"-radius",b["corner-radius"][q]+"px");b="click";"undefined"!=typeof u&&(b=1==u.parent.isMobile.phone||1==u.parent.isMobile.tablet?"touchstart":"click");c.on(b,function(b){b.preventDefault();b=h(this).data("renderer");z.callAction({channel:{key:b.extension,type:"public"},name:b.stage+"."+a+".click",group:"Elements."+b.extension,eventName:b.stage+"."+a+".onClick",eventObject:{error:"",object:{}},main:function(a,b){},args:{}},!0)});return c};H.hash=this.hash;va={code:"id",name:"Indonesian",templates:{"Chat.chat":{Stages:{MainChat:{OptionsButton:"Pilihan"},OfflineChat:{Title:"Layanan kami tidak tersedia",UsernameLabel:"Nama",EmailLabel:"Email",PhoneLabel:"Nomor telepon",MessageLabel:"Pesan:",SendButton:"Kirim"}},InternalWindow:{ChangeName:{NameLabel:"Nama:",SendButton:"Ubah nama"},OfflineMessageSuccess:{InfoLabel:"Pesan berhasil terkirim"},OfflineMessageError:{InfoLabel:"Terjadi kesalahan"}}}},extensions:{"Chat.chat":{ChangeName:"Ubah nama",ClearConversation:"Hapus percakapan",CloseConversation:"Tutup percakapan",SaveConversation:"Simpan percakapan",System:"Sistem",ConversationClosed:"Percakapan ditutup",NameChanged:"Nama Anda berubah menjadi {%name%}",OperatorJoined:"{%operator%} bergabung dalam percakapan",TypeAMessage:"Ketik pesan",UploadLimit:"Ukuran file maksimum yang diizinkan: 4MB"}}};var r="Chat.chat",ka="2.0.0",la="//www.hubtalk.com/market/templates/Chat/chat/Flat/version/1.0.0/data/",ma="//www.hubtalk.com/storage/0fa60be2933eb4f0c9bcd0c0d3196c60/templates/Chat/chat/Flat/themes/a56d7c2038dd2ae8652e1c091d2c5ac7/1.0.0/data/",na=function(){function a(){if(1==u.parent.isMobile.phone||1==u.parent.isMobile.tablet)"OfflineChat"==v.currentStageName||"MainChat"==v.currentStageName?u.container.get(0).style.setProperty("bottom","0px","important"):u.container.get(0).style.setProperty("bottom","0px","")}
var b=this.key,d=this.language,c,e=function(){k.Map["Chat.chat"].MainChat.ConversationArea.registerCustomLine("upload",function(a,b){var d=b.data("content");c=h("\x3cdiv\x3e\x3c/div\x3e").css({margin:"10px 25px 20px 10px","animation-duration":".5s","word-wrap":"break-word","background-color":"floralwhite","border-radius":"5px",border:"1px solid #ffe1a4","box-sizing":"border-box","text-align":"center"}).addClass("animated fadeIn");c.append(h("\x3ci\x3e\x3c/i\x3e").addClass("fa fa-cloud-upload").attr({"aria-hidden":"true"}).css({color:"lightseagreen","font-size":"30px","line-height":"40px"}));d.append(c)});var a=v.Map[b].MainChat.data("content").contents().find("body"),e=h("\x3cinput\x3e").attr({type:"file",accept:"image/*"}).hide().on("change",function(){var a=this.files;0<a.length&&(a=a[0],4E6>=a.size?(k.Map["Chat.chat"].MainChat.ConversationArea.addCustomLine({type:"upload",time:Math.round((new Date).getTime()/1E3)}),A.sendBinary(a)):n.Map[b].api.addConversationLine("system",d.extensions[b].System,d.extensions[b].UploadLimit,""))});a.append(e);return e}();(function(){var a=k.Map[b].MainChat.ConversationArea;a.on("drop",function(a){var c=/image.*/;a.preventDefault();var e=[];a=a.originalEvent.dataTransfer;if(a.items)
for(var f=0;f<a.items.length;f++){if("file"==a.items[f].kind){var g=a.items[f].getAsFile();g.type.match(c)&&(e[f]=g)}}else
for(f=0;f<a.files.length;f++)a.files[f].type.match(c)&&(e[f]=a.files[f]);0<e.length&&(c=e[0],4E6>=c.size?(k.Map["Chat.chat"].MainChat.ConversationArea.addCustomLine({type:"upload",time:Math.round((new Date).getTime()/1E3)}),A.sendBinary(c)):n.Map[b].api.addConversationLine("system",d.extensions[b].System,d.extensions[b].UploadLimit,""))});a.on("dragover",function(a){a.preventDefault()});a.on("dragleave",function(a){})})();if(d.dir&&"rtl"==d.dir)
for(var f in v.Map[b])v.Map[b][f].data("content").contents().find("html").attr("dir","rtl");n.Map[b].api.setWriteAreaPlaceholder(d.extensions[b].TypeAMessage);h("body").attr("style");(f=m.getGeneralValue({key:b,name:"ContainerVisibility",type:"session"}))?("visible"===f&&W.show(),"hidden"===f&&W.hide()):W.hide();if(f=m.getGeneralValue({key:b,name:"CurrentStage",type:"session"}))f=JSON.parse(f),v.changeStage({stage:f.stage,key:f.key});(f=m.getGeneralValue({key:b,name:"ClientID",type:"permanent"}))&&p.setClientID(f);f=m.getGeneralValue({key:b,name:"WidgetStage",type:"session"});var g=m.getGeneralValue({key:b,name:"ClientNick",type:"permanent"});g?p.setNick(g):m.setGeneralValue({key:b,name:"ClientNick",value:p.clientNick,type:"permanent"});(g=m.getGeneralValue({key:b,name:"OperatorName",type:"session"}))&&p.setOperatorName(g);(g=m.getGeneralValue({key:b,name:"OperatorDescription",type:"session"}))&&p.setOperatorDescription(g);(g=m.getGeneralValue({key:b,name:"OperatorAvatar",type:"session"}))&&(""===g?p.setOperatorAvatar(""):p.setOperatorAvatar(g));(g=m.getGeneralValue({key:b,name:"ConversationLog",type:"permanent"}))&&k.Map[b].MainChat.ConversationArea.addLines(JSON.parse(g));m.getGeneralValue({key:b,name:"ConversationLogLastUpdate",type:"session"})||(k.Map[b].MainChat.ConversationArea.deleteLines(),m.deleteGeneralValue({key:b,name:"ConversationLog",type:"permanent"}),m.deleteGeneralValue({key:b,name:"ConversationLogLastUpdate",type:"session"}),t.propagate({key:b,name:"ClearConversation",value:""}),m.setGeneralValue({key:b,name:"ConversationLogLastUpdate",type:"session",value:"true"}));if(g=m.getGeneralValue({key:b,name:"Conversation",type:"session"}))g=JSON.parse(g),p.setConversation(g.id,g.status,g.initiated,g.startDate);E.createInternalWindow(b,"Options","MainChat");k.Map[b].InternalWindow.Options.OptionsMenu.addOption({title:d.extensions[b].ChangeName,onClick:function(){E.createInternalWindow(b,"ChangeName","MainChat").show()}});k.Map[b].InternalWindow.Options.OptionsMenu.addOption({title:d.extensions[b].ClearConversation,onClick:function(){k.Map[b].MainChat.ConversationArea.deleteLines();m.deleteGeneralValue({key:b,name:"ConversationLog",type:"permanent"});m.deleteGeneralValue({key:b,name:"ConversationLogLastUpdate",type:"session"});t.propagate({key:b,name:"ClearConversation",value:""})}});k.Map[b].InternalWindow.Options.OptionsMenu.addOption({title:d.extensions[b].CloseConversation,onClick:function(){p.master&&w.closeConversation();t.propagate({key:b,name:"CloseConversation",value:""})}});k.Map[b].InternalWindow.Options.OptionsMenu.addOption({title:d.extensions[b].SaveConversation,onClick:function(){k.Map["Chat.chat"].MainChat.ConversationArea.addCustomLine({type:"email_transcript",time:Math.round((new Date).getTime()/1E3)})}});var q=1==u.parent.isMobile.phone||1==u.parent.isMobile.tablet,l=q?"touchend":"click",L=n.Map["Chat.chat"].language.templates["Chat.chat"].Stages.OfflineChat.EmailLabel,I=n.Map["Chat.chat"].language.templates["Chat.chat"].InternalWindow.OfflineMessageError.InfoLabel;k.Map["Chat.chat"].MainChat.ConversationArea.registerCustomLine("email_transcript",function(a,c){var d=c.data("content");emailElement=h("\x3cdiv\x3e\x3c/div\x3e").css({margin:"10px 25px 20px 10px",padding:"10px","animation-duration":".5s","word-wrap":"break-word","background-color":"floralwhite","border-radius":"5px",border:"1px solid #ffe1a4","box-sizing":"border-box"}).addClass("animated fadeIn");var e=h("\x3cinput\x3e").css({display:"block",padding:"5px","font-size":"14px","font-family":"open sans","line-height":"18px",width:"100%","border-radius":"5px",border:"2px solid forestgreen","box-sizing":"border-box","box-shadow":"none"}).attr({placeholder:L,type:"email"}),f=h('\x3cdiv\x3e\x3ci class\x3d"fa fa-envelope-o" aria-hidden\x3d"true"\x3e\x3c/i\x3e\x3c/div\x3e').css({margin:"5px 0px 0px 0px",padding:"5px 10px","background-color":"forestgreen","border-radius":"7px","box-sizing":"border-box","float":"right",color:"lightyellow",cursor:"pointer"}).on(l,function(a){a.preventDefault();q&&setTimeout(function(){e.blur()},1E3);m.text("");a=!1;var c=e.val();(a=!/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(c))?m.text(I):(p.master&&w.emailTranscript(c),t.propagate({key:b,name:"EmailTranscript",value:c}),e.remove(),g.remove(),m.remove(),f.remove(),emailElement.append(k),setTimeout(function(){emailElement.remove()},2E3))}),g=h("\x3cdiv\x3e\x3ci class\x3d'fa fa-times' aria-hidden\x3d'true'\x3e\x3c/i\x3e\x3c/div\x3e").css({margin:"5px 0px 0px 10px",padding:"5px 10px","background-color":"tomato","border-radius":"7px","box-sizing":"border-box","float":"right",color:"lightyellow",cursor:"pointer"}).on(l,function(a){a.preventDefault();q&&setTimeout(function(){e.blur()},1E3);emailElement.remove()}),m=h("\x3cdiv\x3e\x3c/div\x3e").css({"font-size":"12px","font-family":"open sans",color:"tomato"}),k=h("\x3cdiv\x3e\x3ci class\x3d'fa fa-check' aria-hidden\x3d'true'\x3e\x3c/i\x3e\x3c/div\x3e").css({"border-radius":"7px","box-sizing":"border-box",color:"forestgreen","font-size":"40px","text-align":"center"}).addClass("animated fadeIn");emailElement.append(e);emailElement.append(g);emailElement.append(f);emailElement.append(h("\x3cdiv\x3e\x3c/div\x3e").css("clear","both"));emailElement.append(m);d.append(emailElement)});y.connect({eventAction:"MainChat.WriteArea.onEnter",channel:{key:b,type:"public"},when:"after",group:"Elements."+b,namespace:"addNewLine",main:function(a){""===a.error&&(a=n.Map[b].api.getWriteAreaValue().trim(),""!==a&&(n.Map[b].api.setWriteAreaValue(""),n.Map[b].api.addConversationLine("visitor",p.clientNick,a,""),p.master&&("available"===H.getStage()&&w.sendMessage(a),"available_conversation"===H.getStage()&&w.initConversation(a)),t.propagate({key:b,name:"SendMessage",value:a})))}});y.connect({eventAction:"MainChat.SendButton.onClick",channel:{key:b,type:"public"},when:"after",group:"Elements."+b,namespace:"addNewLine",main:function(a){a=n.Map[b].api.getWriteAreaValue().trim();""!==a&&(n.Map[b].api.setWriteAreaValue(""),n.Map[b].api.addConversationLine("visitor",p.clientNick,a,""),p.master&&("available"===H.getStage()&&w.sendMessage(a),"available_conversation"===H.getStage()&&w.initConversation(a)),t.propagate({key:b,name:"SendMessage",value:a}),1!=u.parent.isMobile.phone&&1!=u.parent.isMobile.tablet||setTimeout(function(){k.Map[b].MainChat.WriteArea.blur()},1E3))}});y.connect({eventAction:"MainChat.OptionsButton.onClick",channel:{key:b,type:"public"},when:"after",group:"Elements."+b,namespace:"showOptions",main:function(a){E.CreatedInternalWindows[b].Options.show()}});y.connect({eventAction:"MainChat.UploadButton.onClick",channel:{key:b,type:"public"},when:"after",group:"Elements."+b,namespace:"showOptions",main:function(a){e.click()}});y.connect({eventAction:"OfflineChat.SendButton.onClick",channel:{key:b,type:"public"},when:"after",group:"Elements."+b,namespace:"sendOfflineMessage",main:function(){var a=k.Map[b].OfflineChat.UsernameInput.getValue(),c=k.Map[b].OfflineChat.EmailInput.getValue(),d=k.Map[b].OfflineChat.MessageInput.getValue(),e=!1;/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(c)||(e=!0);if(""===a||""===c||""===d)e=!0;e?E.createInternalWindow(b,"OfflineMessageError","OfflineChat").show():(w.sendOfflineMessage(a,c,d),Y.setValue("name",a),Y.setValue("email",c),w.changeNick(a),w.updateProfile("name",a),w.updateProfile("email",c),t.propagate({key:b,name:"ChangeNick",value:a}),k.Map[b].OfflineChat.MessageInput.setValue(""),E.createInternalWindow(b,"OfflineMessageSuccess","OfflineChat").show())}});y.connect({eventAction:"InternalWindow.ChangeName.SendButton.onClick",channel:{key:b,type:"public"},when:"after",group:"Elements."+b,namespace:"changeName",main:function(a){a=k.Map[b].InternalWindow.ChangeName.NameInput.getValue();""!==a&&p.clientNick!==a&&(!0===p.master&&w.changeNick(a),n.Map[b].api.addConversationLine("system",d.extensions[b].System,Aa.replace(d.extensions[b].NameChanged,{name:a}),""),m.setGeneralValue({key:b,name:"ConversationLog",value:JSON.stringify(k.Map[b].MainChat.ConversationArea.lines,null,0),type:"permanent"}),m.setGeneralValue({key:b,name:"ClientNick",value:a,type:"permanent"}),t.propagate({key:b,name:"ChangeNick",value:a}),E.CreatedInternalWindows[b].ChangeName.destroyWindow())}});y.connect({eventAction:"onConnect",channel:{key:b,type:"public"},when:"after",group:"Network",namespace:"connect",main:function(a){""===a.error&&("login"===a.object.status&&(this.connectionMethod=a.object.status,t.propagate({key:b,name:"Connection",value:a.object.status})),"relogin"===a.object.status&&(this.connectionMethod=a.object.status,t.propagate({key:b,name:"Connection",value:a.object.status})))}});y.connect({eventAction:"onConnectionStatus",channel:{key:b,type:"public"},when:"after",group:"Network",namespace:"connectionStatus",main:function(a){""===a.error&&("accepted"===a.object.status&&(w.acceptStatus=a.object.status,t.propagate({key:b,name:"ConnectionStatus",value:a.object.status})),"declined"===a.object.status&&(w.acceptStatus=a.object.status,t.propagate({key:b,name:"ConnectionStatus",value:a.object.status})))}});y.connect({eventAction:"onDisconnect",channel:{key:b,type:"public"},when:"after",group:"Network",namespace:"connect",main:function(a){""===a.error&&(w.connectionMethod="disconnected",m.deleteGeneralValue({key:b,name:"OperatorName",type:"session"}),m.deleteGeneralValue({key:b,name:"OperatorDescription",type:"session"}),m.deleteGeneralValue({key:b,name:"OperatorAvatar",type:"session"}),H.changeStage("unavailable"),W.hide())}});y.connect({eventAction:"onInstanceType",channel:{key:b,type:"public"},when:"after",group:"Network",namespace:"connectionStatus",main:function(a){""===a.error&&"master"===a.object.type&&p.setMaster(!0)}});y.connect({eventAction:"onWidgetInfo",channel:{key:b,type:"public"},when:"after",group:"Network",namespace:"widgetInfo",main:function(a){""===a.error&&(m.setGeneralValue({key:b,name:"WidgetStage",value:a.object.stage,type:"session"}),H.changeStage(a.object.stage),t.propagate({key:b,name:"WidgetStage",value:a.object.stage}))}});y.connect({eventAction:"onReceivingClientID",channel:{key:b,type:"public"},when:"after",group:"Network",namespace:"receiveClientID",main:function(a){""===a.error&&(p.setClientID(a.object.clientID),t.propagate({key:b,name:"ClientID",value:a.object.clientID}))}});y.connect({eventAction:"onSendMessage",channel:{key:b,type:"public"},when:"after",group:"Network",namespace:"sendMessageToConversation",main:function(a){m.setGeneralValue({key:b,name:"ConversationLog",value:JSON.stringify(k.Map[b].MainChat.ConversationArea.lines,null,0),type:"permanent"})}});y.connect({eventAction:"onInitConversation",channel:{key:b,type:"public"},when:"after",group:"Network",namespace:"sendMessageToConversation",main:function(a){m.setGeneralValue({key:b,name:"ConversationLog",value:JSON.stringify(k.Map[b].MainChat.ConversationArea.lines,null,0),type:"permanent"})}});y.connect({eventAction:"onReceiveMessage",channel:{key:b,type:"public"},group:"Network",when:"after",namespace:"receiveMessageToConversation",main:function(a){n.Map[b].api.addConversationLine(a.object.type,a.object.user,a.object.message,n.Map[b].api.getOperatorAvatar());m.setGeneralValue({key:b,name:"ConversationLog",value:JSON.stringify(k.Map[b].MainChat.ConversationArea.lines,null,0),type:"permanent"});t.propagate({key:b,name:"ReceiveMessage",value:a.object.message})}});y.connect({eventAction:"onReceiveImage",channel:{key:b,type:"public"},group:"Network",when:"after",namespace:"receiveImageToConversation",main:function(a){a=a.object.image;"g"===a.ftype&&(n.Map[b].api.addConversationLine("visitor",p.clientNick,a.image,null,!0),c&&c.remove());"o"===a.ftype&&n.Map[b].api.addConversationLine("operator",p.operatorName,a.image,n.Map[b].api.getOperatorAvatar(),!0);m.setGeneralValue({key:b,name:"ConversationLog",value:JSON.stringify(k.Map[b].MainChat.ConversationArea.lines,null,0),type:"permanent"});t.propagate({key:b,name:"ReceiveImage",value:a})}});y.connect({eventAction:"onNoOperator",channel:{key:b,type:"public"},when:"after",group:"Network",namespace:"noOperator",main:function(a){""===a.error&&(m.deleteGeneralValue({key:b,name:"OperatorName",type:"session"}),m.deleteGeneralValue({key:b,name:"OperatorDescription",type:"session"}),m.deleteGeneralValue({key:b,name:"OperatorAvatar",type:"session"}),p.setOperatorName(void 0),p.setOperatorDescription(""),p.setOperatorAvatar(void 0),t.propagate({key:b,name:"NoOperator",value:""}))}});y.connect({eventAction:"onOperatorSignout",channel:{key:b,type:"public"},when:"after",group:"Network",namespace:"operatorSignout",main:function(a){""===a.error&&(m.deleteGeneralValue({key:b,name:"OperatorName",type:"session"}),m.deleteGeneralValue({key:b,name:"OperatorDescription",type:"session"}),m.deleteGeneralValue({key:b,name:"OperatorAvatar",type:"session"}),p.setOperatorName(void 0),p.setOperatorDescription(""),p.setOperatorAvatar(void 0),t.propagate({key:b,name:"OperatorSignout",value:""}))}});y.connect({eventAction:"onAssignOperator",channel:{key:b,type:"public"},when:"after",group:"Network",namespace:"assignOperator",main:function(a){""===a.error&&(m.setGeneralValue({key:b,name:"OperatorName",value:a.object.operatorName,type:"session"}),m.setGeneralValue({key:b,name:"OperatorDescription",value:a.object.operatorDescription,type:"session"}),m.setGeneralValue({key:b,name:"OperatorAvatar",value:a.object.operatorDescription,type:"session"}),p.setOperatorName(a.object.operatorName),p.setOperatorDescription(a.object.operatorDescription),""===a.object.operatorAvatar?p.setOperatorAvatar(""):p.setOperatorAvatar(a.object.operatorAvatar+"/avatar_100.png?n\x3d"+Math.random()),t.propagate({key:b,name:"AssignOperator",value:JSON.stringify({name:a.object.operatorName,description:a.object.operatorDescription,avatar:a.object.operatorAvatar})}))}});y.connect({eventAction:"onConversationStarted",channel:{key:b,type:"public"},when:"after",group:"Network",namespace:"conversationStarted",main:function(a){if(""===a.error){var c=JSON.stringify(a.object,null,0);m.setGeneralValue({key:b,name:"Conversation",value:c,type:"session"});p.setConversation(a.object.id,a.object.status,a.object.initiated,a.object.startDate);t.propagate({key:b,name:"ConversationStarted",value:c})}}});y.connect({eventAction:"onConversationStatusUpdated",channel:{key:b,type:"public"},when:"after",group:"Network",namespace:"updateConversationStatus",main:function(a){if(""===a.error){var c=JSON.stringify(p.conversation,null,0);m.setGeneralValue({key:b,name:"Conversation",value:c,type:"session"});p.updateConversationStatus(a.object.status,a.object.endDate);t.propagate({key:b,name:"UpdateConversationStatus",value:JSON.stringify(a.object,null,0)})}}});y.connect({eventAction:"onChangingStage",channel:{key:b,type:"public"},when:"after",group:"Widget",namespace:"changeStage",main:function(c){if(""===c.error){if("manual"===c.object.stage){if("off"===x[b].offline_message){W.hide();m.setGeneralValue({key:b,name:"ContainerVisibility",value:"hidden",type:"session"});t.propagate({key:b,name:"ChangeContainerVisibility",value:"hidden"});return}
W.show();m.setGeneralValue({key:b,name:"ContainerVisibility",value:"visible",type:"session"});t.propagate({key:b,name:"ChangeContainerVisibility",value:"visible"});Priority.canExecute("Stages.changeStage")&&(v.changeStage({stage:"OfflineChat",key:b}),t.propagate({key:b,name:"ChatStage",value:"offline"}))}"available"===c.object.stage&&(W.show(),m.setGeneralValue({key:b,name:"ContainerVisibility",value:"visible",type:"session"}),t.propagate({key:b,name:"ChangeContainerVisibility",value:"visible"}),Priority.canExecute("Stages.changeStage")&&(v.changeStage({stage:"MainChat",key:b}),t.propagate({key:b,name:"ChatStage",value:"online"})));"available_conversation"===c.object.stage&&(W.show(),m.setGeneralValue({key:b,name:"ContainerVisibility",value:"visible",type:"session"}),t.propagate({key:b,name:"ChangeContainerVisibility",value:"visible"}),Priority.canExecute("Stages.changeStage")&&(v.changeStage({stage:"MainChat",key:b}),t.propagate({key:b,name:"ChatStage",value:"online"})));a()}}});y.connect({eventAction:"onSettingClientID",channel:{key:b,type:"public"},when:"after",group:"Info",namespace:"setClientID",main:function(a){""===a.error&&m.setGeneralValue({key:b,name:"ClientID",value:a.object.clientID,type:"permanent"})}});y.connect({eventAction:"onSettingOperatorName",channel:{key:b,type:"public"},when:"after",group:"Info",namespace:"setOperatorName",main:function(a){""===a.error?a.object.operatorName?n.Map[b].api.setOperatorName(a.object.operatorName):n.Map[b].api.setOperatorName(""):n.Map[b].api.setOperatorName("")}});y.connect({eventAction:"onSettingOperatorDescription",channel:{key:b,type:"public"},when:"after",group:"Info",namespace:"setOperatorDescription",main:function(a){""===a.error?a.object.operatorDescription?n.Map[b].api.setOperatorDescription(a.object.operatorDescription):n.Map[b].api.setOperatorDescription(""):n.Map[b].api.setOperatorDescription("")}});y.connect({eventAction:"onSettingOperatorAvatar",channel:{key:b,type:"public"},when:"after",group:"Info",namespace:"setOperatorAvatar",main:function(a){""===a.error?""===a.object.operatorAvatar?n.Map[b].api.setOperatorAvatar(""):n.Map[b].api.setOperatorAvatar(a.object.operatorAvatar):n.Map[b].api.setOperatorAvatar("")}});y.connect({eventAction:"onSettingNick",channel:{key:b,type:"public"},when:"after",group:"Info",namespace:"setNick",main:function(a){""===a.error&&m.setGeneralValue({key:b,name:"ClientNick",value:a.object.clientNick,type:"permanent"})}});y.connect({eventAction:"onUpdateConversationStatus",channel:{key:b,type:"public"},when:"after",group:"Info",namespace:"updateConversationStatus",main:function(a){""===a.error&&"ended"===a.object.status&&n.Map[b].api.addConversationLine("system",d.extensions[b].System,d.extensions[b].ConversationClosed,"")}});y.connect({eventAction:"onChange",channel:{key:b,type:"public"},when:"after",group:"Stages",namespace:"basic",main:function(c){if(""===c.error){if("OfflineChat"==c.object.stage){var d=Y.getValue("name"),e=Y.getValue("email");d&&k.Map[b].OfflineChat.UsernameInput.setValue(d);e&&k.Map[b].OfflineChat.EmailInput.setValue(e)}
m.setGeneralValue({key:b,name:"CurrentStage",value:JSON.stringify(c.object,null,0),type:"session"});a()}}});t.on({name:"ClientID",key:b,namespace:"ClientID",main:function(a,b){p.setClientID(b)}});t.on({name:"ReceiveMessage",key:b,namespace:"ReceiveMessage",main:function(a,c){n.Map[b].api.addConversationLine("operator",p.operatorName,c,n.Map[b].api.getOperatorAvatar())}});t.on({name:"ReceiveImage",key:b,namespace:"ReceiveImage",main:function(a,c){"g"===c.ftype&&n.Map[b].api.addConversationLine("visitor",p.clientNick,c.image,n.Map[b].api.getOperatorAvatar(),!0);"o"===c.ftype&&n.Map[b].api.addConversationLine("operator",p.operatorName,c.image,n.Map[b].api.getOperatorAvatar(),!0)}});t.on({name:"SendMessage",key:b,namespace:"SendMessageAction",main:function(a,c){n.Map[b].api.addConversationLine("visitor",p.clientNick,c,"");p.master&&("available"===H.getStage()&&w.sendMessage(c),"available_conversation"===H.getStage()&&w.initConversation(c))}});t.on({name:"AssignOperator",key:b,namespace:"AssignOperator",main:function(a,b){var c=JSON.parse(b);p.setOperatorName(c.name);p.setOperatorDescription(c.description);""===c.avatar?p.setOperatorAvatar(""):p.setOperatorAvatar(c.avatar+"/avatar_100.png?n\x3d"+Math.random())}});t.on({name:"OperatorSignout",key:b,namespace:"OperatorSignout",main:function(a){p.setOperatorName(void 0);p.setOperatorDescription("");p.setOperatorAvatar("")}});t.on({name:"NoOperator",key:b,namespace:"NoOperator",main:function(a){p.setOperatorName(void 0)}});t.on({name:"ChangeNick",key:b,namespace:"ChangeNick",main:function(a,c){!0===p.master&&w.changeNick(c);n.Map[b].api.addConversationLine("system",d.extensions[b].System,Aa.replace(d.extensions[b].NameChanged,{name:c}),"");m.setGeneralValue({key:b,name:"ConversationLog",value:JSON.stringify(k.Map[b].MainChat.ConversationArea.lines,null,0),type:"permanent"});p.setNick(c)}});t.on({name:"ClearConversation",key:b,namespace:"ClearConversation",main:function(a){k.Map[b].MainChat.ConversationArea.deleteLines();m.deleteGeneralValue({key:b,name:"ConversationLog",type:"permanent"})}});t.on({name:"CloseConversation",key:b,namespace:"CloseConversation",main:function(a){p.master&&w.closeConversation()}});t.on({name:"ChatStage",key:b,namespace:"ChatStage",main:function(a,c){"online"===c&&v.changeStage({stage:"MainChat",key:b});"offline"===c&&v.changeStage({stage:"OfflineChat",key:b})}});t.on({name:"ConversationStarted",key:b,namespace:"ConversationStarted",main:function(a,b){var c=JSON.parse(b);p.setConversation(c.id,c.status,c.initiated,c.startDate)}});t.on({name:"UpdateConversationStatus",key:b,namespace:"UpdateConversationStatus",main:function(a,b){var c=JSON.parse(b);p.updateConversationStatus(c.status,c.endDate)}});t.on({name:"ChangeContainerVisibility",key:b,namespace:"ChangeContainerVisibility",main:function(a,c){"visible"===c&&(W.show(),m.setGeneralValue({key:b,name:"ContainerVisibility",value:"visible",type:"session"}));"hidden"===c&&(W.hide(),m.setGeneralValue({key:b,name:"ContainerVisibility",value:"hidden",type:"session"}))}});t.on({name:"WidgetStage",key:b,namespace:"WidgetStage",main:function(a,b){H.changeStage(b)}});t.on({name:"EmailTranscript",key:b,namespace:"EmailTranscript",main:function(a,b){p.master&&w.emailTranscript(b)}});a();f&&H.changeStage(f)},J=[];J.push({extension:"Chat.chat",stageName:"MainChat",template:{canvas:{width:340,height:450,panel:!0,resize:{width:{min:280,max:480},height:{min:350,max:650}},offset:{width:10,height:10,"top-left":{x:5,y:5},"top-right":{x:5,y:5},"bottom-left":{x:5,y:5},"bottom-right":{x:5,y:5}},magnet:{MainContainer:["width","height"],Header:["width"],OperatorInfo:["width"],OperatorName:["width"],OperatorDescription:["width"],BottomArea:["width"],WriteArea:["width"],WriteAreaContour:["width"],ConversationArea:["width","height"]}},styles:{files:["//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css","//cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css"]},elements:{MainContainer:{type:"rectangle",x:0,y:0,width:340,height:450,z:1,"corner-radius":{"top-left":5,"top-right":5},"box-shadow":"0px 0px 3px 2px rgba(0, 0, 0, 0.1)"},Header:{type:"rectangle",x:0,y:0,width:340,height:26,"corner-radius":{"top-left":5,"top-right":5},z:2,hasTheme:!0},OperatorInfo:{type:"rectangle",x:0,y:26,width:340,height:50,z:3,hasTheme:!0,render:{operator_info:{on:!0,off:!1}}},OperatorAvatar:{type:"image",x:10,y:4,width:75,height:75,"corner-radius":{"top-left":38,"top-right":38,"bottom-left":38,"bottom-right":38},border:{left:{width:1},right:{width:1},top:{width:1},bottom:{width:1}},z:13,hasTheme:!0,render:{operator_info:{on:!0,off:!1}}},OperatorName:{type:"label",x:99,y:31,width:215,height:20,z:4,"font-family":"Open Sans,Verdana,Arial,sans-serif","font-size":15,"font-weight":"bold",text:"",hasTheme:!0,render:{operator_info:{on:!0,off:!1}}},OperatorDescription:{type:"label",x:99,y:50,width:215,height:20,z:5,"font-family":"Open Sans,Verdana,Arial,sans-serif","font-size":13,text:"",hasTheme:!0,render:{operator_info:{on:!0,off:!1}}},ConversationArea:{type:"conversationArea",x:0,y:{operator_info:{on:76,off:26}},width:340,height:{operator_info:{on:298,off:348}},z:6,template:"bubble",hasTheme:!0},BottomArea:{type:"rectangle",x:0,y:0,width:340,height:77,orientation:"bottom-left",background:{color:"#f3f3f3"},z:7},WriteAreaContour:{type:"rectangle",x:8,y:24,width:322,height:43,orientation:"bottom-left",background:{color:"#ffffff"},"corner-radius":{"top-left":3,"bottom-left":3,"top-right":3,"bottom-right":3},border:{left:{size:1,color:"#d0d0d0"},top:{size:1,color:"#d0d0d0"},bottom:{size:1,color:"#d0d0d0"},right:{size:1,color:"#d0d0d0"}},z:8},WriteArea:{type:"inputArea",x:14,y:30,orientation:"bottom-left",width:312,height:34,text:"","font-family":"Open Sans,Verdana,Arial,sans-serif","font-size":13,"auto-resize":!0,onEnter:!0,magnet:{WriteAreaContour:["height"],BottomArea:["height"]},z:9,hasTheme:!0},OptionsSign:{type:"symbol",x:14,y:2,z:10,"class":"fa fa-gear",size:14,orientation:"bottom-left",cursor:"pointer",hasTheme:!0},OptionsButton:{type:"label",x:28,y:4,z:11,orientation:"bottom-left",cursor:"pointer","font-family":"Verdana,Arial,sans-serif","font-size":12,locale:!0,hasTheme:!0},UploadButton:{type:"symbol",x:85,y:3,z:13,"class":"fa fa-paperclip",size:16,orientation:"bottom-right",cursor:"pointer",hasTheme:!1,color:"rgb(100, 100, 100)"}}},templateMobile:{canvas:{offset:{width:0,height:0,"top-left":{x:0,y:0},"top-right":{x:0,y:0},"bottom-left":{x:0,y:0},"bottom-right":{x:0,y:0}}},settings:{size:{width:"document.width",height:"document.height"}},elements:{MainContainer:{"box-shadow":"none"},Header:{"corner-radius":{"top-left":0,"top-right":0}},SendButton:{type:"symbol",x:10,y:26,z:12,width:40,height:40,"class":"fa fa-paper-plane",size:26,orientation:"bottom-right",cursor:"pointer",hasTheme:!0},WriteArea:{"font-size":13,width:280}}},templateName:"Flat",theme:{name:"green",version:"1.0.0",Header:{background:{color:"#007aff"}},OperatorInfo:{background:{color:"#d8e5ff"}},OperatorAvatar:{src:"no_operator.png",border:{color:"#007aff"}},OperatorName:{color:"#000000"},OperatorDescription:{color:"#000000"},OptionsSign:{color:"#646464"},OptionsButton:{color:"#646464"},WriteArea:{color:"#000000"},ConversationArea:{background:{color:"#ffffff"},bubble:{operator:{name:{color:"#000000","font-family":"Open Sans,Arial,sans-serif","font-size":13},message:{color:"#000000","font-family":"Open Sans,Arial,sans-serif","font-size":13},background:{color:"#e3f1ff"},border:{color:"#d8e5ff"}},visitor:{name:{color:"#000000","font-family":"Open Sans,Arial,sans-serif","font-size":13},message:{color:"#000000","font-family":"Open Sans,Arial,sans-serif","font-size":13},background:{color:"#f0fbfe"},border:{color:"#def7ff"}},system:{name:{color:"#209e07","font-family":"Open Sans,Arial,sans-serif","font-size":13},message:{color:"#2e2e2e","font-family":"Open Sans,Arial,sans-serif","font-size":13},background:{color:"#fbfde3"},border:{color:"#e2e2e2"}},time:{color:"#05750a","font-family":"Open Sans,Arial,sans-serif","font-size":10}}},SendButton:{color:"#0192c8"}},themeMobile:{name:"green",version:"1.0.0",Header:{background:{color:"#007aff"}},OperatorInfo:{background:{color:"#d8e5ff"}},OperatorAvatar:{src:"no_operator.png",border:{color:"#007aff"}},OperatorName:{color:"#000000"},OperatorDescription:{color:"#000000"},OptionsSign:{color:"#646464"},OptionsButton:{color:"#646464"},WriteArea:{color:"#000000"},ConversationArea:{background:{color:"#ffffff"},bubble:{operator:{name:{color:"#000000","font-family":"Open Sans,Arial,sans-serif","font-size":13},message:{color:"#000000","font-family":"Open Sans,Arial,sans-serif","font-size":13},background:{color:"#e3f1ff"},border:{color:"#d8e5ff"}},visitor:{name:{color:"#000000","font-family":"Open Sans,Arial,sans-serif","font-size":13},message:{color:"#000000","font-family":"Open Sans,Arial,sans-serif","font-size":13},background:{color:"#f0fbfe"},border:{color:"#def7ff"}},system:{name:{color:"#209e07","font-family":"Open Sans,Arial,sans-serif","font-size":13},message:{color:"#2e2e2e","font-family":"Open Sans,Arial,sans-serif","font-size":13},background:{color:"#fbfde3"},border:{color:"#e2e2e2"}},time:{color:"#05750a","font-family":"Open Sans,Arial,sans-serif","font-size":10}}},SendButton:{color:"#007aff"}},templateConfig:{app_key:"Chat",extension_key:"chat","interface":"1.0.0",themes:{Red:{name:"Red",version:"1.0.0"},GreenDark:{name:"Green (Dark)",version:"1.0.0"},Gray:{name:"Gray",version:"1.0.0"},Blue:{name:"Blue",version:"1.0.0"},Orange:{name:"Orange",version:"1.0.0"},Purple:{name:"Purple",version:"1.0.0"},Violet:{name:"Violet",version:"1.0.0"},GreenLight:{name:"Green (Light)",version:"1.0.0"},BlueDark:{name:"Blue (Dark)",version:"1.0.0"}},DefaultTheme:"Blue",mobile:"clone",devices:["desktop","mobile"],theme_generator:!0},elements:{elements:{OptionsButton:{type:"label"},SendButton:{type:"symbol"},WriteArea:{type:"inputArea"},WriteAreaContour:{type:"rectangle"},ConversationArea:{type:"conversationArea"},OperatorName:{type:"label"},OperatorDescription:{type:"label"},OperatorAvatar:{type:"image"},UploadButton:{type:"symbol"},OptionsSign:{type:"symbol"},BottomArea:{type:"rectangle"}}}});J.push({extension:"Chat.chat",stageName:"OfflineChat",template:{canvas:{width:340,height:450,panel:!0,resize:{width:{min:280,max:480},height:{min:350,max:650}},offset:{width:10,height:10,"top-left":{x:5,y:5},"top-right":{x:5,y:5},"bottom-left":{x:5,y:5},"bottom-right":{x:5,y:5}},magnet:{MainContainer:["width","height"],Header:["width"],BackgroundContainer:["width","height"],UsernameContour:["width"],UsernameInput:["width"],EmailContour:["width"],EmailInput:["width"],MessageContour:["width","height"],MessageInput:["width","height"]}},styles:{files:["//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css"]},elements:{MainContainer:{type:"rectangle",x:0,y:0,width:340,height:450,z:1,"corner-radius":{"top-left":5,"top-right":5},"box-shadow":"0px 0px 3px 2px rgba(0, 0, 0, 0.1)"},Header:{type:"rectangle",x:0,y:0,width:340,height:26,"corner-radius":{"top-left":5,"top-right":5},z:2,hasTheme:!0},BackgroundContainer:{type:"rectangle",x:0,y:26,width:340,height:424,background:{color:"#FFFFFF"},z:3,hasTheme:!1},UsernameLabel:{x:20,y:38,z:4,width:298,type:"label","font-family":"Open Sans,Verdana,Arial,sans-serif","font-size":16,locale:!0,hasTheme:!0},UsernameContour:{type:"rectangle",x:20,y:60,width:298,height:30,"corner-radius":{"top-left":5,"top-right":5,"bottom-left":5,"bottom-right":5},border:{left:{size:1,color:"#bababa"},right:{size:1,color:"#bababa"},bottom:{size:1,color:"#bababa"},top:{size:1,color:"#bababa"}},background:{color:"#FFFFFF"},z:5},UsernameInput:{type:"inputText",x:22,y:62,width:294,height:26,text:"","font-family":"Open Sans,Verdana,Arial,sans-serif","font-size":16,z:6,hasTheme:!0},EmailLabel:{x:20,y:98,z:7,width:298,type:"label","font-family":"Open Sans,Verdana,Arial,sans-serif","font-size":16,locale:!0,hasTheme:!0},EmailContour:{type:"rectangle",x:20,y:120,width:298,height:30,"corner-radius":{"top-left":5,"top-right":5,"bottom-left":5,"bottom-right":5},border:{left:{size:1,color:"#bababa"},right:{size:1,color:"#bababa"},bottom:{size:1,color:"#bababa"},top:{size:1,color:"#bababa"}},background:{color:"#FFFFFF"},z:8},EmailInput:{type:"inputText",x:22,y:122,width:294,height:26,text:"","font-family":"Open Sans,Verdana,Arial,sans-serif","font-size":16,z:9,hasTheme:!0},MessageLabel:{x:20,y:160,z:10,width:298,type:"label","font-family":"Open Sans,Verdana,Arial,sans-serif","font-size":16,locale:!0,hasTheme:!0},MessageContour:{type:"rectangle",x:20,y:182,width:298,height:210,"corner-radius":{"top-left":5,"top-right":5,"bottom-left":5,"bottom-right":5},border:{left:{size:1,color:"#bababa"},right:{size:1,color:"#bababa"},bottom:{size:1,color:"#bababa"},top:{size:1,color:"#bababa"}},background:{color:"#FFFFFF"},z:11},MessageInput:{type:"inputArea",x:30,y:192,width:278,height:190,text:"","font-family":"Open Sans,Verdana,Arial,sans-serif","font-size":14,z:12,hasTheme:!0},SendButton:{type:"button",x:12,y:12,z:13,cursor:"pointer",orientation:"bottom-right","font-family":"Open Sans","font-size":14,"text-align":"center",locale:!0,padding:"6px 12px","border-radius":"5px",hasTheme:!0}}},templateMobile:{canvas:{offset:{width:0,height:0,"top-left":{x:0,y:0},"top-right":{x:0,y:0},"bottom-left":{x:0,y:0},"bottom-right":{x:0,y:0}}},settings:{size:{width:"document.width",height:"document.height"}},elements:{MainContainer:{"box-shadow":"none"},Header:{"corner-radius":{"top-left":0,"top-right":0}}}},templateName:"Flat",theme:{name:"green",version:"1.0.0",Header:{background:{color:"#007aff"}},SendButton:{color:"#ffffff",background:{color:"#007aff"},border:{color:"#0192c8"}},Title:{color:"white"},UsernameLabel:{color:"black"},UsernameInput:{color:"#000000"},EmailLabel:{color:"black"},EmailInput:{color:"#000000"},MessageLabel:{color:"black"},MessageInput:{color:"#000000"}},themeMobile:{name:"green",version:"1.0.0",Header:{background:{color:"#007aff"}},SendButton:{color:"#ffffff",background:{color:"#007aff"},border:{color:"#0192c8"}},Title:{color:"white"},UsernameLabel:{color:"black"},UsernameInput:{color:"#000000"},EmailLabel:{color:"black"},EmailInput:{color:"#000000"},MessageLabel:{color:"black"},MessageInput:{color:"#000000"}},templateConfig:{app_key:"Chat",extension_key:"chat","interface":"1.0.0",themes:{Red:{name:"Red",version:"1.0.0"},GreenDark:{name:"Green (Dark)",version:"1.0.0"},Gray:{name:"Gray",version:"1.0.0"},Blue:{name:"Blue",version:"1.0.0"},Orange:{name:"Orange",version:"1.0.0"},Purple:{name:"Purple",version:"1.0.0"},Violet:{name:"Violet",version:"1.0.0"},GreenLight:{name:"Green (Light)",version:"1.0.0"},BlueDark:{name:"Blue (Dark)",version:"1.0.0"}},DefaultTheme:"Blue",mobile:"clone",devices:["desktop","mobile"],theme_generator:!0},elements:{elements:{Title:{type:"label"},UsernameInput:{type:"inputText"},EmailInput:{type:"inputText"},MessageInput:{type:"inputArea"},SendButton:{type:"component"}}}});E.InternalWindows["Chat.chat"]={extension:"Chat.chat",template:{ChangeName:{title:"Change your name",width:230,height:60,orientation:"middle",modal:!0,onClose:"destroy",elements:{NameLabel:{x:8,y:9,z:1,type:"label",color:"#000000","font-family":"Arial","font-size":12,locale:!0},NameContour:{x:59,y:9,width:151,height:16,z:2,type:"rectangle",border:{left:{size:1,color:"#bababa"},right:{size:1,color:"#bababa"},top:{size:1,color:"#bababa"},bottom:{size:1,color:"#bababa"}}},NameInput:{x:60,y:10,width:149,height:14,z:3,type:"inputText",color:"#000000"},SendButton:{type:"button",x:20,y:6,orientation:"bottom-right","font-family":"Arial","font-size":11,"text-align":"center",cursor:"pointer",locale:!0,hasTheme:!0,z:4}},closeButton:{type:"symbol","class":"fa fa-times",size:12}},Options:{width:208,height:100,x:0,y:25,orientation:"bottom-left",onClose:"hide",elements:{OptionsMenu:{type:"optionsArea",x:0,y:0,z:1,width:210,height:100,hasTheme:!0}},closeButton:{type:"symbol","class":"fa fa-times",size:12}},OfflineMessageSuccess:{width:230,height:50,orientation:"middle",modal:!0,onClose:"destroy",elements:{InfoLabel:{type:"label",x:40,y:10,width:180,height:36,z:1,"font-family":"Arial","font-size":12,locale:!0,hasTheme:!0},Icon:{type:"symbol","class":"fa fa-check-circle",size:26,x:10,y:4,z:2,hasTheme:!0}},closeButton:{type:"symbol","class":"fa fa-times",size:12}},OfflineMessageError:{width:230,height:50,orientation:"middle",modal:!0,onClose:"destroy",elements:{InfoLabel:{type:"label",x:40,y:10,width:180,height:36,z:1,"font-family":"Arial","font-size":12,locale:!0,hasTheme:!0},Icon:{type:"symbol","class":"fa fa-exclamation-triangle",size:26,x:10,y:4,z:2,hasTheme:!0}},closeButton:{type:"symbol","class":"fa fa-times",size:12}}},templateName:"Flat",theme:{name:"Blue",version:"1.0.0",window:{Header:{background:{color:"#e6e6e6"},border:{left:{color:"#e6e6e6"},right:{color:"#e6e6e6"},bottom:{color:"#e6e6e6"},top:{color:"#e6e6e6"}}},CloseButton:{color:"#464646"},Content:{background:{color:"#f3f3f3"},border:{left:{color:"#f3f3f3"},right:{color:"#f3f3f3"},bottom:{color:"#f3f3f3"}}}},content:{ChangeName:{SendButton:{color:"#454545",background:{color:"#e8e8e8"},border:{color:"#d5d5d5"}},closeButton:{color:"#464646"}},Options:{OptionsMenu:{background:{color:"#f3f3f3"},option:{background:{color:"#f3f3f3"},title:{color:"#464646","over-color":"#000000"}}},closeButton:{color:"#464646"}},OfflineMessageSuccess:{InfoLabel:{color:"#5d750d"},Icon:{color:"#5d750d"},closeButton:{color:"#464646"}},OfflineMessageError:{InfoLabel:{color:"#c1292a"},Icon:{color:"#c1292a"},closeButton:{color:"#464646"}}}},elements:{ChangeName:{modal:!0,elements:{NameInput:{type:"inputText"},ChangeNameButton:{type:"image"}}},Options:{elements:{OptionsMenu:{type:"optionsArea"}}},OfflineMessageError:{elements:[]},OfflineMessageSuccess:{elements:[]}},language:va};var K=[],Ba={Methods:[{method:"Stages.changeStage",status:"unblocked"}]},oa={addConversationLine:function(a,b,d,c,e){k.Map[this.key].MainChat.ConversationArea.addLine({type:a,name:b,message:d,time:Math.round((new Date).getTime()/1E3),operatorAvatar:c,image:e})},setWriteAreaValue:function(a){k.Map[this.key].MainChat.WriteArea.setValue(a)},getWriteAreaValue:function(){return k.Map[this.key].MainChat.WriteArea.getValue()},setOperatorName:function(a){k.Map[this.key].MainChat.OperatorName&&k.Map[this.key].MainChat.OperatorName.setText(a)},setOperatorDescription:function(a){k.Map[this.key].MainChat.OperatorDescription&&k.Map[this.key].MainChat.OperatorDescription.setText(a)},setOperatorAvatar:function(a){k.Map[this.key].MainChat.OperatorAvatar&&(""===a?k.Map[this.key].MainChat.OperatorAvatar.setDefaultURL():k.Map[this.key].MainChat.OperatorAvatar.setURL(a))},getOperatorAvatar:function(){return k.Map[this.key].MainChat.OperatorAvatar?k.Map[this.key].MainChat.OperatorAvatar.getURL():p.operatorAvatar&&""!==p.operatorAvatar?p.operatorAvatar:p.getLocation()+"img/operators/no_operator_100.png"},setWriteAreaPlaceholder:function(a){k.Map[this.key].MainChat.WriteArea.setPlaceholder(a)}};x["Chat.chat"]={};x["Chat.chat"].visitor_name="visitor";x["Chat.chat"].offline_message="on";x["Chat.chat"].linkify_urls="on";x["Chat.chat"].operator_info="on";x["Chat.chat"].operator_avatar="on";x["Chat.chat"].emojione="on";var M={},O={};n.Map[r]={parent:this,name:r,key:r,version:ka,templateData:la,themeData:ma,stages:J,dragin:K,uiSettings:M,uiMobileSettings:O,extension_position:Ba,elements:{},renderTemplate:function(){v.Map[this.name]={};k.Map[this.name]={};k.Map[this.name].InternalWindow={};k.Map[this.name].DragIn={};E.CreatedInternalWindows[this.name]={};if(this.extension_position)
for(var a in this.extension_position.Methods)Priority.setExecutePriority(this.key,this.extension_position.Methods[a]);for(a=0;a<this.stages.length;a++){var b={},d=null,c=null,e;e=this.language?this.language.templates[this.stages[a].extension]?this.language.templates[this.stages[a].extension].Stages[this.stages[a].stageName]:null:null;d=this.uiSettings[this.stages[a].stageName]?this.uiSettings[this.stages[a].stageName]:null;c=this.uiMobileSettings[this.stages[a].stageName]?this.uiMobileSettings[this.stages[a].stageName]:null;b["default"]=d;b.mobile=c;this.parent.isMobile.phone&&(this.stages[a].templateMobile&&(d=this.stages[a].template,c=this.stages[a].templateMobile,"clone"===this.stages[a].templateConfig.mobile&&(this.stages[a].template=h.extend(!0,d,c)),"separate"===this.stages[a].templateConfig.mobile&&(this.stages[a].template=c)),this.stages[a].themeMobile&&(d=this.stages[a].theme,c=this.stages[a].themeMobile,"clone"===this.stages[a].templateConfig.mobile&&(this.stages[a].theme=h.extend(!0,d,c)),"separate"===this.stages[a].templateConfig.mobile&&(this.stages[a].theme=c)));u.createRenderer(this.stages[a].extension,this.stages[a].stageName,this.stages[a].template,this.stages[a].templateName,this.stages[a].theme,b,this.stages[a].elements,null,e)}
return this.stages.length},renderDragInTemplate:function(){for(var a=0;a<this.dragin.length;a++){k.Map[this.key].DragIn[this.dragin[a].extension]={};for(var b in this.dragin[a].template){var d={},c=null,e=null,c=this.uiSettings[this.dragin[a].template[b]]?this.uiSettings[this.dragin[a].template[b]]:null,e=this.uiMobileSettings[this.dragin[a].template[b]]?this.uiMobileSettings[this.dragin[a].template[b]]:null;d["default"]=c;d.mobile=e;if(this.parent.isMobile.phone&&this.dragin[a].themeMobile){if(this.dragin[a].themeMobile[b])var f=this.dragin[a].theme[b];c=this.dragin[a].themeMobile[b];"clone"===this.dragin[a].templateConfig.mobile&&(this.dragin[a].theme[b]=h.extend(!0,f,c));"separate"===this.dragin[a].templateConfig.mobile&&(this.dragin[a].theme[b]=c)}
u.createRenderer(this.dragin[a].extension,b,this.dragin[a].template[b],this.dragin[a].templateName,this.dragin[a].theme[b],d,this.dragin[a].elements[b],"DragIn").DragInKey=this.key}}
return this.dragin.length},main:na,api:oa};n.Map[r].language=va;var r="BasicInfo.basic_info",ka="1.3.0",ma=la="",na=function(){var a=this.key,b=Ca.getResolution(),d=Ca.getDevicePixelRatio(),c=ia.getType(),e=m.getGeneralValue({key:a,name:"Referrer",type:"session"});e||(e=Ia.getReferrer(),m.setGeneralValue({key:a,name:"Referrer",value:e,type:"session"}));var f=m.getGeneralValue({key:a,name:"VisitTime",type:"session"}),g=!1,h=(new UAParser).getResult();y.connect({eventAction:"onSettingMaster",channel:{key:a,type:"public"},when:"after",group:"Info",namespace:"setMaster",main:function(b){""===b.error&&p.master&&(f||w.requestServerTime({key:a,type:"private"}))}});y.connect({eventAction:"onAssignOperator",channel:{key:a,type:"public"},when:"after",group:"Network",namespace:"assignOperator",main:function(l){""===l.error&&(w.sendCustomMessage({key:a,type:"private"},JSON.stringify([{action:"OS",elements:{OS:h.os?h.os.name+" "+h.os.version:"Unknown OS"}},{action:"Browser",elements:{Browser:h.browser?h.browser.name+" "+h.browser.version:"Unknown browser"}},{action:"Resolution",elements:{Resolution:b.width+"x"+b.height}},{action:"Device Pixel Ratio",elements:{"Device Pixel Ratio":d}},{action:"Referrer",elements:{Referrer:e}},{action:"Device",elements:{Device:"desktop"===c?c:h.device.type?h.device.type:"Unknown Device"}},{action:"Vendor",elements:{Vendor:h.device.vendor?h.device.vendor+" "+h.device.model:"-"}}])),f&&w.sendCustomMessage({key:a,type:"private"},f+""),g=!0)}});y.connect({eventAction:"onReceivingServerTime",channel:{key:a,type:"public"},when:"after",group:"Network",namespace:"receivingServerTime",main:function(b){""===b.error&&(f=b.object.time,m.setGeneralValue({key:a,name:"VisitTime",value:f,type:"session"}),g&&w.sendCustomMessage({key:a,type:"private"},f+""))}});y.connect({eventAction:"onOperatorChangedConnector",channel:{key:a,type:"public"},when:"after",group:"Network",namespace:"changedConnector",main:function(l){""===l.error&&p.master&&g&&f&&(w.sendCustomMessage({key:a,type:"private"},JSON.stringify([{action:"OS",elements:{OS:h.os?h.os.name+" "+h.os.version:"Unknown OS"}},{action:"Browser",elements:{Browser:h.browser?h.browser.name+" "+h.browser.version:"Unknown browser"}},{action:"Resolution",elements:{Resolution:b.width+"x"+b.height}},{action:"Device Pixel Ratio",elements:{"Device Pixel Ratio":d}},{action:"Referrer",elements:{Referrer:e}},{action:"Device",elements:{Device:"desktop"===c?c:h.device.type?h.device.type:"Unknown Device"}},{action:"Vendor",elements:{Vendor:h.device.vendor?h.device.vendor+" "+
h.device.model:"-"}}])),w.sendCustomMessage({key:a,type:"private"},f+""))}})},Ca={init:function(){},getResolution:function(){return{width:window.screen.width,height:window.screen.height}},getDevicePixelRatio:function(){return window.devicePixelRatio?window.devicePixelRatio:1},pageVisibility:function(){function a(){}
var b,d;"undefined"!==typeof document.hidden?(b="hidden",d="visibilitychange"):"undefined"!==typeof document.mozHidden?(b="mozHidden",d="mozvisibilitychange"):"undefined"!==typeof document.msHidden?(b="msHidden",d="msvisibilitychange"):"undefined"!==typeof document.webkitHidden&&(b="webkitHidden",d="webkitvisibilitychange");if("undefined"!==typeof document.addEventListener&&"undefined"!==typeof document[b]&&(document.addEventListener(d,a,!1),document.visibilityState))return document.visibilityState}};N.Map.SystemInfo=Ca;var Ia={init:function(){},getReferrer:function(){return document.referrer?document.referrer:""},getCurrentURL:function(){return document.URL},getCurrentPageTitle:function(){return document.title?document.title:""}};N.Map.BrowsingInfo=Ia;(function(a,b){var d={extend:function(a,b){for(var c in b)-1!=="browser cpu device engine os".indexOf(c)&&0===b[c].length%2&&(a[c]=b[c].concat(a[c]));return a},has:function(a,b){return"string"===typeof a?-1!==b.toLowerCase().indexOf(a.toLowerCase()):!1},lowerize:function(a){return a.toLowerCase()},major:function(a){return"string"===typeof a?a.split(".")[0]:b}},c=function(){for(var a,c=0,d,e,f,g,h,l,m=arguments;c<m.length&&!h;){var q=m[c],k=m[c+1];if("undefined"===typeof a)
for(f in a={},k)g=k[f],"object"===typeof g?a[g[0]]=b:a[g]=b;for(d=e=0;d<q.length&&!h;)
if(h=q[d++].exec(this.getUA()))
for(f=0;f<k.length;f++)l=h[++e],g=k[f],"object"===typeof g&&0<g.length?2==g.length?a[g[0]]="function"==typeof g[1]?g[1].call(this,l):g[1]:3==g.length?a[g[0]]="function"!==typeof g[1]||g[1].exec&&g[1].test?l?l.replace(g[1],g[2]):b:l?g[1].call(this,l,g[2]):b:4==g.length&&(a[g[0]]=l?g[3].call(this,l.replace(g[1],g[2])):b):a[g]=l?l:b;c+=2}
return a},e=function(a,c){for(var e in c)
if("object"===typeof c[e]&&0<c[e].length)
for(var f=0;f<c[e].length;f++){if(d.has(c[e][f],a))return"?"===e?b:e}else if(d.has(c[e],a))return"?"===e?b:e;return a},f={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2E3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},g={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],["name","version"],[/\s(opr)\/([\w\.]+)/i],[["name","Opera"],"version"],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium)\/([\w\.-]+)/i],["name","version"],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[["name","IE"],"version"],[/(edge)\/((\d+)?[\w\.]+)/i],["name","version"],[/(yabrowser)\/([\w\.]+)/i],[["name","Yandex"],"version"],[/(comodo_dragon)\/([\w\.]+)/i],[["name",/_/g," "],"version"],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i,/(qqbrowser)[\/\s]?([\w\.]+)/i],["name","version"],[/(uc\s?browser)[\/\s]?([\w\.]+)/i,/ucweb.+(ucbrowser)[\/\s]?([\w\.]+)/i,/JUC.+(ucweb)[\/\s]?([\w\.]+)/i],[["name","UCBrowser"],"version"],[/(dolfin)\/([\w\.]+)/i],[["name","Dolphin"],"version"],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[["name","Chrome"],"version"],[/XiaoMi\/MiuiBrowser\/([\w\.]+)/i],["version",["name","MIUI Browser"]],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)/i],["version",["name","Android Browser"]],[/FBAV\/([\w\.]+);/i],["version",["name","Facebook"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],["version",["name","Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],["version","name"],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],["name",["version",e,{"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],["name","version"],[/(navigator|netscape)\/([\w\.-]+)/i],[["name","Netscape"],"version"],[/fxios\/([\w\.-]+)/i],["version",["name","Firefox"]],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]+)*/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],["name","version"]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[["architecture","amd64"]],[/(ia32(?=;))/i],[["architecture",d.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[["architecture","ia32"]],[/windows\s(ce|mobile);\sppc;/i],[["architecture","arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[["architecture",/ower/,"",d.lowerize]],[/(sun4\w)[;\)]/i],[["architecture","sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+;))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[["architecture",d.lowerize]]],device:[[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],["model","vendor",["type","tablet"]],[/applecoremedia\/[\w\.]+ \((ipad)/],["model",["vendor","Apple"],["type","tablet"]],[/(apple\s{0,1}tv)/i],[["model","Apple TV"],["vendor","Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],["vendor","model",["type","tablet"]],[/(kf[A-z]+)\sbuild\/[\w\.]+.*silk\//i],["model",["vendor","Amazon"],["type","tablet"]],[/(sd|kf)[0349hijorstuw]+\sbuild\/[\w\.]+.*silk\//i],[["model",e,{"Fire Phone":["SD","KF"]}],["vendor","Amazon"],["type","mobile"]],[/\((ip[honed|\s\w*]+);.+(apple)/i],["model","vendor",["type","mobile"]],[/\((ip[honed|\s\w*]+);/i],["model",["vendor","Apple"],["type","mobile"]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|huawei|meizu|motorola|polytron)[\s_-]?([\w-]+)*/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],["vendor","model",["type","mobile"]],[/\(bb10;\s(\w+)/i],["model",["vendor","BlackBerry"],["type","mobile"]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7)/i],["model",["vendor","Asus"],["type","tablet"]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[["vendor","Sony"],["model","Xperia Tablet"],["type","tablet"]],[/(?:sony)?(?:(?:(?:c|d)\d{4})|(?:so[-l].+))\sbuild\//i],[["vendor","Sony"],["model","Xperia Phone"],["type","mobile"]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],["vendor","model",["type","console"]],[/android.+;\s(shield)\sbuild/i],["model",["vendor","Nvidia"],["type","console"]],[/(playstation\s[34portablevi]+)/i],["model",["vendor","Sony"],["type","console"]],[/(sprint\s(\w+))/i],[["vendor",e,{HTC:"APA",Sprint:"Sprint"}],["model",e,{"Evo Shift 4G":"7373KT"}],["type","mobile"]],[/(lenovo)\s?(S(?:5000|6000)+(?:[-][\w+]))/i],["vendor","model",["type","tablet"]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w+)*/i,/(alcatel|geeksphone|huawei|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]+)*/i],["vendor",["model",/_/g," "],["type","mobile"]],[/(nexus\s9)/i],["model",["vendor","HTC"],["type","tablet"]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],["model",["vendor","Microsoft"],["type","console"]],[/(kin\.[onetw]{3})/i],[["model",/\./g," "],["vendor","Microsoft"],["type","mobile"]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?(:?\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w+)*/i,/(XT\d{3,4}) build\//i,/(nexus\s[6])/i],["model",["vendor","Motorola"],["type","mobile"]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],["model",["vendor","Motorola"],["type","tablet"]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n8000|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[["vendor","Samsung"],"model",["type","tablet"]],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-n900))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)*/i,/sec-((sgh\w+))/i],[["vendor","Samsung"],"model",["type","mobile"]],[/(samsung);smarttv/i],["vendor","model",["type","smarttv"]],[/\(dtv[\);].+(aquos)/i],["model",["vendor","Sharp"],["type","smarttv"]],[/sie-(\w+)*/i],["model",["vendor","Siemens"],["type","mobile"]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]+)*/i],[["vendor","Nokia"],"model",["type","mobile"]],[/android\s3\.[\s\w;-]{10}(a\d{3})/i],["model",["vendor","Acer"],["type","tablet"]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[["vendor","LG"],"model",["type","tablet"]],[/(lg) netcast\.tv/i],["vendor","model",["type","smarttv"]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w+)*/i],["model",["vendor","LG"],["type","mobile"]],[/android.+(ideatab[a-z0-9\-\s]+)/i],["model",["vendor","Lenovo"],["type","tablet"]],[/linux;.+((jolla));/i],["vendor","model",["type","mobile"]],[/((pebble))app\/[\d\.]+\s/i],["vendor","model",["type","wearable"]],[/android.+;\s(glass)\s\d/i],["model",["vendor","Google"],["type","wearable"]],[/android.+(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:one|one[\s_]plus)?[\s_]*(?:\d\w)?)\s+build/i],[["model",/_/g," "],["vendor","Xiaomi"],["type","mobile"]],[/(mobile|tablet);.+rv\:.+gecko\//i],[["type",d.lowerize],"vendor","model"]],engine:[[/windows.+\sedge\/([\w\.]+)/i],["version",["name","EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],["name","version"],[/rv\:([\w\.]+).*(gecko)/i],["version","name"]],os:[[/microsoft\s(windows)\s(vista|xp)/i],["name","version"],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],["name",["version",e,f]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[["name","Windows"],["version",e,f]],[/\((bb)(10);/i],[["name","BlackBerry"],"version"],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],["name","version"],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[["name","Symbian"],"version"],[/\((series40);/i],["name"],[/mozilla.+\(mobile;.+gecko.+firefox/i],[["name","Firefox OS"],"version"],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],["name","version"],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[["name","Chromium OS"],"version"],[/(sunos)\s?([\w\.]+\d)*/i],[["name","Solaris"],"version"],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],["name","version"],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[["name","iOS"],["version",/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i,/(macintosh|mac(?=_powerpc)\s)/i],[["name","Mac OS"],["version",/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]+)*/i],["name","version"]]},h=function(b,e){if(!(this instanceof h))return(new h(b,e)).getResult();var f=b||(a&&a.navigator&&a.navigator.userAgent?a.navigator.userAgent:""),l=e?d.extend(g,e):g;this.getBrowser=function(){var a=c.apply(this,l.browser);a.major=d.major(a.version);return a};this.getCPU=function(){return c.apply(this,l.cpu)};this.getDevice=function(){return c.apply(this,l.device)};this.getEngine=function(){return c.apply(this,l.engine)};this.getOS=function(){return c.apply(this,l.os)};this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}};this.getUA=function(){return f};this.setUA=function(a){f=a;return this};this.setUA(f);return this};h.VERSION="0.7.9";h.BROWSER={NAME:"name",MAJOR:"major",VERSION:"version"};h.CPU={ARCHITECTURE:"architecture"};h.DEVICE={MODEL:"model",VENDOR:"vendor",TYPE:"type",CONSOLE:"console",MOBILE:"mobile",SMARTTV:"smarttv",TABLET:"tablet",WEARABLE:"wearable",EMBEDDED:"embedded"};h.ENGINE={NAME:"name",VERSION:"version"};h.OS={NAME:"name",VERSION:"version"};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=h),exports.UAParser=h):"function"===typeof define&&define.amd?define(function(){return h}):a.UAParser=h;var l=a.jQuery||a.Zepto;if("undefined"!==typeof l){var m=new h;l.ua=m.getResult();l.ua.get=function(){return m.getUA()};l.ua.set=function(a){m.setUA(a);a=m.getResult();for(var b in a)l.ua[b]=a[b]}}})("object"===typeof window?window:this);N.Map.UAParser=UAParser;var sa={init:function(){},getCurrentTime:function(){return(new Date).getTime()}};N.Map.Time=sa;J=[];K=[];M={};O={};n.Map[r]={parent:this,name:r,key:r,version:ka,templateData:la,themeData:ma,stages:J,dragin:K,uiSettings:M,uiMobileSettings:O,extension_position:null,elements:{},renderTemplate:function(){v.Map[this.name]={};k.Map[this.name]={};k.Map[this.name].InternalWindow={};k.Map[this.name].DragIn={};E.CreatedInternalWindows[this.name]={};if(this.extension_position)
for(var a in this.extension_position.Methods)Priority.setExecutePriority(this.key,this.extension_position.Methods[a]);for(a=0;a<this.stages.length;a++){var b={},d=null,c=null,e;e=this.language?this.language.templates[this.stages[a].extension]?this.language.templates[this.stages[a].extension].Stages[this.stages[a].stageName]:null:null;d=this.uiSettings[this.stages[a].stageName]?this.uiSettings[this.stages[a].stageName]:null;c=this.uiMobileSettings[this.stages[a].stageName]?this.uiMobileSettings[this.stages[a].stageName]:null;b["default"]=d;b.mobile=c;this.parent.isMobile.phone&&(this.stages[a].templateMobile&&(d=this.stages[a].template,c=this.stages[a].templateMobile,"clone"===this.stages[a].templateConfig.mobile&&(this.stages[a].template=h.extend(!0,d,c)),"separate"===this.stages[a].templateConfig.mobile&&(this.stages[a].template=c)),this.stages[a].themeMobile&&(d=this.stages[a].theme,c=this.stages[a].themeMobile,"clone"===this.stages[a].templateConfig.mobile&&(this.stages[a].theme=h.extend(!0,d,c)),"separate"===this.stages[a].templateConfig.mobile&&(this.stages[a].theme=c)));u.createRenderer(this.stages[a].extension,this.stages[a].stageName,this.stages[a].template,this.stages[a].templateName,this.stages[a].theme,b,this.stages[a].elements,null,e)}
return this.stages.length},renderDragInTemplate:function(){for(var a=0;a<this.dragin.length;a++){k.Map[this.key].DragIn[this.dragin[a].extension]={};for(var b in this.dragin[a].template){var d={},c=null,e=null,c=this.uiSettings[this.dragin[a].template[b]]?this.uiSettings[this.dragin[a].template[b]]:null,e=this.uiMobileSettings[this.dragin[a].template[b]]?this.uiMobileSettings[this.dragin[a].template[b]]:null;d["default"]=c;d.mobile=e;if(this.parent.isMobile.phone&&this.dragin[a].themeMobile){if(this.dragin[a].themeMobile[b])var f=this.dragin[a].theme[b];c=this.dragin[a].themeMobile[b];"clone"===this.dragin[a].templateConfig.mobile&&(this.dragin[a].theme[b]=h.extend(!0,f,c));"separate"===this.dragin[a].templateConfig.mobile&&(this.dragin[a].theme[b]=c)}
u.createRenderer(this.dragin[a].extension,b,this.dragin[a].template[b],this.dragin[a].templateName,this.dragin[a].theme[b],d,this.dragin[a].elements[b],"DragIn").DragInKey=this.key}}
return this.dragin.length},main:na,api:void 0};n.Map[r].language=null;r="Box.box";ka="1.5.0";la="//www.hubtalk.com/market/templates/Box/box/Flat/version/1.0.0/data/";ma="//www.hubtalk.com/storage/0fa60be2933eb4f0c9bcd0c0d3196c60/templates/Box/box/Flat/themes/1c41a90bae201fa29801e0b289445e16/1.0.0/data/";na=function(){function a(a){var b=document.getElementsByTagName("body")[0],c;for(c in a)b.style[c]=a[c]}
function b(a){var b=document.getElementsByTagName("body")[0],c;for(c in a)b.style[c]=null}
function d(a){if(E&&"OnlineBox"==v.currentStageName){var b=v.Map[l].OnlineBox.data("content").contents().find("body");if(ba)ba.text(K),a||ba.addClass("animated infinite bounce");else{var c=h("\x3cdiv\x3e\x3c/div\x3e").css({position:"absolute",left:Q.offset.width/2+"px",bottom:Q.height-5+"px",padding:"5px 10px","background-color":H,"border-radius":"10px","box-sizing":"border-box","font-family":"Open Sans,Verdana,Arial,sans-serif","font-size":"12px","box-shadow":"0px 0px 3px 2px rgba(0, 0, 0, 0.1)",color:"white",cursor:"pointer","z-index":100}).text(K);c.on("click",function(){e()});a||c.addClass("animated infinite bounce");b.append(c);ba=c}
q(20);m.setGeneralValue({key:l,name:"BadgeCount",type:"session",value:K})}}
function c(a){if(E&&"OnlineBox"==v.currentStageName){var b=v.Map[l].OnlineBox.data("content").contents().find("body"),c=Q.width;u.parent.isMobile.phone&&(c=200);d();if(ea)ea.text(a),G.css({top:ea.outerHeight()+ta.outerHeight()+
10+10+5+"px"});else{var g=h("\x3cdiv\x3e\x3c/div\x3e").css({position:"absolute",top:"5px","box-sizing":"border-box","font-size":"20px",color:"dimgrey",cursor:"pointer",width:"14px",height:"15px","background-color":"white","line-height":"18px","border-radius":"50%"}).addClass("fa fa-times-circle"),R=u.parent.position.info.origin;"tl"==R||"bl"==R?g.css("right",Q.offset.width/2+"px"):g.css("left",Q.offset.width/2+"px");b.append(g);R=h("\x3cdiv\x3e\x3c/div\x3e").css({position:"absolute",left:Q.offset.width/2+"px",top:"30px",padding:"10px","background-color":"Cornsilk","border-radius":"20px 20px 20px 0px","box-sizing":"border-box","font-family":"Open Sans,Verdana,Arial,sans-serif","font-size":"14px","box-shadow":"0px 0px 3px 2px rgba(0, 0, 0, 0.1)",cursor:"pointer",width:c+"px"}).text(a);R.addClass("animated fadeIn");b.append(R);c=h("\x3cdiv\x3e\x3c/div\x3e").css({position:"absolute",left:Q.offset.width/2+"px",top:R.outerHeight()+g.outerHeight()+10+10+5+"px",padding:"10px","background-color":"whitesmoke",color:"dimgrey","border-radius":"5px","box-sizing":"border-box","font-family":"Open Sans,Verdana,Arial,sans-serif","font-size":"14px","text-overflow":"ellipsis","white-space":"nowrap",overflow:"hidden","box-shadow":"0px 0px 3px 2px rgba(0, 0, 0, 0.1)",cursor:"pointer",width:c+"px"}).text(n.Map["Chat.chat"].language.extensions["Chat.chat"].TypeAMessage);c.addClass("animated fadeIn");b.append(c);R.on("click",function(){e()});c.on("click",function(){e()});g.on("click",function(){f();q(20);t.propagate({name:"CloseBubbleMessage",key:l,value:""})});ea=R;G=c;ta=g}
m.setGeneralValue({key:l,name:"BubbleMessage",type:"session",value:a});q(60)}}
function e(){n.Map["Box.box"].api.openBox()}
function f(){E&&(ea&&(ea.remove(),G.remove(),ta.remove()),ba&&ba.removeClass("animated infinite bounce"),ta=G=ea=null,m.deleteGeneralValue({key:l,name:"BubbleMessage",type:"session"}))}
function g(){E&&ba&&(ba.remove(),K=0,ba=null,m.deleteGeneralValue({key:l,name:"BadgeCount",type:"session"}))}
function q(a){E&&(u.parent.isMobile.phone&&(ya=ea?parseInt(200+
Q.offset.width):parseInt(Q.width+Q.offset.width)),a=(ea?ea.outerHeight():0)+(G?G.outerHeight():0)+J+a,v.Map[l].OnlineBox.width(ya),v.Map[l].OnlineBox.height(a),u.container.width(ya),u.container.height(a),u.parent.isMobile.phone&&ba&&(ea?(a='k.Map[l].OnlineBox.MainContainer.position()',ba.css("left",a.left+"px")):ba.css("left","5px")))}
var l=this.key,r=n.Map["Chat.chat"].language;if(r.dir&&"rtl"==r.dir)
for(var I in v.Map[l])v.Map[l][I].data("content").contents().find("html").attr("dir","rtl");var B=1==u.parent.isMobile.phone||1==u.parent.isMobile.tablet,C=h("body").attr("style"),z=0,A={position:"fixed",overflow:"hidden","-webkit-text-size-adjust":"100%","min-width":"100%","min-height":"100%",margin:"0px"},F=function(){var a=document.querySelector('meta[name\x3d"viewport"]');return a&&a.getAttribute("content")}(),U=m.getGeneralValue({key:l,name:"IsBoxOpened",type:"session"});"true"===U?(Priority.changeMethodStatus(l,"Stages.changeStage","unblocked"),m.setGeneralValue({key:l,name:"IsBoxOpened",value:"true",type:"session"}),U=!0):(m.setGeneralValue({key:l,name:"IsBoxOpened",value:"false",type:"session"}),U=!1);r="on"==x[l].bubble_message?!0:!1;I="on"==x[l].bubble_message_mob?!0:!1;var E=1==B?I:r,H=x[l].badge_color?x[l].badge_color:"tomato",Q=v.Map[l].OnlineBox.data("template").canvas.rendered,ya=parseInt(Q.width+Q.offset.width),J=parseInt(Q.height+Q.offset.height),K=0,ea=null,G=null,ba=null,ta=null;if(u.parent.isMobile.phone){r={};switch(u.parent.position.info.origin){case"tl":r={top:Q.offset["top-left"].y+"px",left:Q.offset["top-left"].x+"px"};break;case"tr":r={top:Q.offset["top-right"].y+"px",right:Q.offset["top-right"].x+"px"};break;case"bl":r={bottom:Q.offset["bottom-left"].y+"px",left:Q.offset["bottom-left"].x+"px"};break;case"br":r={bottom:Q.offset["bottom-right"].y+"px",right:Q.offset["bottom-right"].x+"px"};break;default:r={bottom:Q.offset["bottom-right"].y+"px",right:Q.offset["bottom-right"].x+"px"}}}
y.connect({eventAction:"onChangingStage",channel:{key:l,type:"public"},when:"after",group:"Widget",namespace:"changeStage",main:function(a){""===a.error&&("manual"===a.object.stage&&!1===U&&(f(),g(),q(0),v.changeStage({stage:"OfflineBox",key:l}),t.propagate({name:"CloseBox",key:l,value:"offline"})),"available"===a.object.stage&&!1===U&&(v.changeStage({stage:"OnlineBox",key:l}),t.propagate({name:"CloseBox",key:l,value:"online"})),"available_conversation"===a.object.stage&&!1===U&&(v.changeStage({stage:"OnlineBox",key:l}),t.propagate({name:"CloseBox",key:l,value:"online"})),"unavailable"===a.object.stage&&B&&(F?h("meta[name\x3dviewport]").attr("content",F):h("meta[name\x3dviewport]").attr("content",""),b(A),C&&h("body").attr("style",C)))}});y.connect({eventAction:"OnlineBox.MainContainer.onClick",channel:{key:l,type:"public"},when:"after",group:"Elements."+l,namespace:"setClientID",main:function(a){n.Map[l].api.openBox()}});y.connect({eventAction:"OfflineBox.MainContainer.onClick",channel:{key:l,type:"public"},when:"after",group:"Elements."+l,namespace:"setClientID",main:function(a){n.Map[l].api.openBox()}});y.connect({eventAction:"DragIn.Chat.chat.MainChat.MinimizeButton.onClick",channel:{key:l,type:"public"},when:"after",group:"Elements."+l,namespace:"closeBox",main:function(a){n.Map[l].api.closeBox()}});y.connect({eventAction:"DragIn.Chat.chat.OfflineChat.MinimizeButton.onClick",channel:{key:l,type:"public"},when:"after",group:"Elements."+l,namespace:"closeBox",main:function(a){n.Map[l].api.closeBox()}});y.connect({eventAction:"onReceiveMessage",channel:{key:l,type:"public"},group:"Network",when:"after",namespace:"openBox",main:function(a){E?U||(K++,c(a.object.message),t.propagate({name:"BubbleMessage",key:l,value:a.object.message+":"+K})):(n.Map[l].api.openBox(),U=!0)}});y.connect({eventAction:"onAssignOperator",channel:{key:l,type:"public"},group:"Network",when:"after",namespace:"onAssignOperator",main:function(a){p.master&&w.sendCustomMessage({key:l,type:"private"},!0===U?"opened":"closed")}});t.on({name:"OpenBox",key:l,namespace:"OpenBox",main:function(b,c){B&&(1==document.documentElement.clientWidth/window.innerWidth&&(F?h("meta[name\x3dviewport]").attr("content","width\x3ddevice-width, initial-scale\x3d1.0, maximum-scale\x3d1.0, user-scalable\x3dno"):h("head").append(h("meta").attr({name:"viewport",content:"width\x3ddevice-width, initial-scale\x3d1.0, maximum-scale\x3d1.0, user-scalable\x3dno"}))),a(A));f();g();q(0);"online"===c&&(U=!0,m.setGeneralValue({key:l,name:"IsBoxOpened",value:"true",type:"session"}),v.changeStage({stage:"MainChat",key:"Chat.chat"}));"offline"===c&&(U=!0,m.setGeneralValue({key:l,name:"IsBoxOpened",value:"true",type:"session"}),v.changeStage({stage:"OfflineChat",key:"Chat.chat"}));p.master&&w.sendCustomMessage({key:l,type:"private"},"opened")}});t.on({name:"CloseBox",key:l,namespace:"CloseBox",main:function(a,c){B&&(F?h("meta[name\x3dviewport]").attr("content",F):h("meta[name\x3dviewport]").attr("content",""),b(A),C&&h("body").attr("style",C));"online"===c&&(v.changeStage({stage:"OnlineBox",key:l}),U=!1,m.setGeneralValue({key:l,name:"IsBoxOpened",value:"false",type:"session"}));"offline"===c&&(v.changeStage({stage:"OfflineBox",key:l}),U=!1,m.setGeneralValue({key:l,name:"IsBoxOpened",value:"false",type:"session"}));p.master&&w.sendCustomMessage({key:l,type:"private"},"closed")}});y.connect({eventAction:"onOpeningBox",channel:{key:l,type:"public"},when:"before",group:l,namespace:"onOpeningBox",main:function(b){U||(B&&(z=h(document).scrollTop(),1==document.documentElement.clientWidth/window.innerWidth&&(F?h("meta[name\x3dviewport]").attr("content","width\x3ddevice-width, initial-scale\x3d1.0, maximum-scale\x3d1.0, user-scalable\x3dno"):h("head").append(h("meta").attr({name:"viewport",content:"width\x3ddevice-width, initial-scale\x3d1.0, maximum-scale\x3d1.0, user-scalable\x3dno"}))),a(A)),Priority.changeMethodStatus(l,"Stages.changeStage","unblocked"),f(),g(),q(0))}});y.connect({eventAction:"onOpeningBox",channel:{key:l,type:"public"},when:"after",group:l,namespace:"onOpeningBox",main:function(a){U=!0;p.master&&w.sendCustomMessage({key:l,type:"private"},"opened")}});y.connect({eventAction:"onClosingBox",channel:{key:l,type:"public"},when:"before",group:l,namespace:"onClosingBox",main:function(a){B&&(F?h("meta[name\x3dviewport]").attr("content",F):h("meta[name\x3dviewport]").attr("content",""),b(A),C&&h("body").attr("style",C),h(document).scrollTop(z));Priority.changeMethodStatus(l,"Stages.changeStage","blocked")}});y.connect({eventAction:"onClosingBox",channel:{key:l,type:"public"},when:"after",group:l,namespace:"onClosingBox",main:function(a){U=!1;p.master&&w.sendCustomMessage({key:l,type:"private"},"closed")}});y.connect({eventAction:"onReceivingCustomMessage",channel:{key:l,type:"public"},when:"after",group:"Network",namespace:"onReceivingCustomMessage",main:function(a,b){""===a.error&&("open"===a.object.message.message?(U=!0,n.Map[l].api.openBox()):(U=!1,n.Map[l].api.closeBox()))}});y.connect({eventAction:"onOperatorChangedConnector",channel:{key:l,type:"public"},when:"after",group:"Network",namespace:"changedConnector",main:function(a){""===a.error&&p.master&&w.sendCustomMessage({key:l,type:"private"},!0===U?"opened":"closed")}});y.connect({eventAction:"onChange",channel:{key:l,type:"public"},when:"after",group:"Stages",namespace:"showBubble",main:function(a){if(""===a.error&&"Box.box"==a.object.key&&"OnlineBox"==a.object.stage){a=m.getGeneralValue({key:l,name:"BubbleMessage",type:"session"});var b=m.getGeneralValue({key:l,name:"BadgeCount",type:"session"});b&&(K=parseInt(b));a?c(a):b&&d(!0)}}});t.on({name:"BubbleMessage",key:l,namespace:"BubbleMessage",main:function(a,b){var d=b.split(":");2>d.length||(K=parseInt(d[1]),c(d[0]))}});t.on({name:"CloseBubbleMessage",key:l,namespace:"CloseBubbleMessage",main:function(a,b){f();q(20)}});"off"!==x[l].offline_message?(r=m.getGeneralValue({key:"Chat.chat",name:"CurrentStage",type:"session"}))&&!1===U&&(r=JSON.parse(r),v.changeStage({stage:r.stage,key:r.key})):"visible"!==m.getGeneralValue({key:l,name:"ContainerVisibility",type:"session"})&&W.hide();U?B&&(1==document.documentElement.clientWidth/window.innerWidth&&(F?h("meta[name\x3dviewport]").attr("content","width\x3ddevice-width, initial-scale\x3d1.0, maximum-scale\x3d1.0, user-scalable\x3dno"):h("head").append(h("meta").attr({name:"viewport",content:"width\x3ddevice-width, initial-scale\x3d1.0, maximum-scale\x3d1.0, user-scalable\x3dno"}))),a(A)):B&&(F?h("meta[name\x3dviewport]").attr("content",F):h("meta[name\x3dviewport]").attr("content",""),b(A),C&&h("body").attr("style",C))};J=[];J.push({extension:"Box.box",stageName:"OnlineBox",template:{canvas:{width:313,height:100,panel:!0,resize:{width:{min:160,max:480}},offset:{width:10,height:5,"top-left":{x:5,y:5},"top-right":{x:5,y:5},"bottom-left":{x:5,y:0},"bottom-right":{x:5,y:0}},magnet:{MainContainer:["width"],Container:["width"],Title:["width"]}},styles:{files:["https://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css","https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css"]},elements:{MainContainer:{type:"image",x:0,y:0,width:313,height:100,cursor:"pointer",src:"https://printyuk-x44smwyfipu9v4i4jtz.netdna-ssl.com/themes/default/img/chat_printyuk.png",z:1,hasTheme:!1}}},templateMobile:{canvas:{width:313,height:100,panel:!0,magnet:{MainContainer:"",Container:["width"],Title:["width"]},offset:{width:10,height:10,"top-left":{x:5,y:5},"top-right":{x:5,y:5},"bottom-left":{x:5,y:5},"bottom-right":{x:5,y:5}}},styles:{files:["https://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css","https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css"]},elements:{MainContainer:{type:"image",x:0,y:0,width:313,height:100,cursor:"pointer",src:"https://printyuk-x44smwyfipu9v4i4jtz.netdna-ssl.com/themes/default/img/chat_printyuk.png",z:1,hasTheme:!1}}},templateName:"Flat",theme:{name:"printyuk",version:"1.0.0",Container:{background:{color:"#007aff",}},Title:{color:"white"},IconBackground:{background:{color:"#006de2"}},Icon:{color:"white"}},themeMobile:{name:"printyuk",version:"1.0.0",Container:{background:{color:"#007aff"}},Title:{color:"white"},IconBackground:{background:{color:"#006de2"}},Icon:{color:"white"}},templateConfig:{app_key:"Box",extension_key:"box","interface":"1.0.0",themes:{Red:{name:"Red",version:"1.0.0"},GreenDark:{name:"Green (Dark)",version:"1.0.0"},Gray:{name:"Gray",version:"1.0.0"},Blue:{name:"Blue",version:"1.0.0"},Orange:{name:"Orange",version:"1.0.0"},Purple:{name:"Purple",version:"1.0.0"},Violet:{name:"Violet",version:"1.0.0"},GreenLight:{name:"Green (Light)",version:"1.0.0"},BlueDark:{name:"Blue (Dark)",version:"1.0.0"}},mobile:"clone",devices:["desktop","mobile"],DefaultTheme:"Blue",theme_generator:!0},elements:{elements:{MainContainer:{type:"component"},Title:{type:"label"}}}});J.push({extension:"Box.box",stageName:"OfflineBox",template:{canvas:{width:313,height:100,panel:!0,resize:{width:{min:160,max:480}},offset:{width:10,height:5,"top-left":{x:5,y:5},"top-right":{x:5,y:5},"bottom-left":{x:5,y:0},"bottom-right":{x:5,y:0}},magnet:{MainContainer:["width"],Container:["width"],Title:["width"]}},styles:{files:["https://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css"]},elements:{MainContainer:{type:"image",x:0,y:0,width:313,height:100,cursor:"pointer",src:"https://printyuk-x44smwyfipu9v4i4jtz.netdna-ssl.com/themes/default/img/chat_printyuk.png",z:1,hasTheme:!1}}},templateMobile:{canvas:{width:313,height:100,panel:!0,magnet:{MainContainer:["width"],Container:["width"],Title:["width"]},offset:{width:10,height:10,"top-left":{x:5,y:5},"top-right":{x:5,y:5},"bottom-left":{x:5,y:5},"bottom-right":{x:5,y:5}}},styles:{files:["https://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css"]},elements:{MainContainer:{type:"image",x:0,y:0,width:313,height:100,cursor:"pointer",src:"https://printyuk-x44smwyfipu9v4i4jtz.netdna-ssl.com/themes/default/img/chat_printyuk.png",z:1,hasTheme:!1}}},templateName:"Flat",theme:{name:"printyuk",version:"1.0.0",Container:{background:{color:"#007aff"}},Title:{color:"white"},IconBackground:{background:{color:"#006de2"}},Icon:{color:"white"}},themeMobile:{name:"printyuk",version:"1.0.0",Container:{background:{color:"#007aff"}},Title:{color:"white"},IconBackground:{background:{color:"#006de2"}},Icon:{color:"white"}},templateConfig:{app_key:"Box",extension_key:"box","interface":"1.0.0",themes:{Red:{name:"Red",version:"1.0.0"},GreenDark:{name:"Green (Dark)",version:"1.0.0"},Gray:{name:"Gray",version:"1.0.0"},Blue:{name:"Blue",version:"1.0.0"},Orange:{name:"Orange",version:"1.0.0"},Purple:{name:"Purple",version:"1.0.0"},Violet:{name:"Violet",version:"1.0.0"},GreenLight:{name:"Green (Light)",version:"1.0.0"},BlueDark:{name:"Blue (Dark)",version:"1.0.0"}},mobile:"clone",devices:["desktop","mobile"],DefaultTheme:"Blue",theme_generator:!0},elements:{elements:{MainContainer:{type:"component"},Title:{type:"label"}}}});K=[];K.push({extension:"Chat.chat",template:{MainChat:{elements:{MinimizeButton:{x:15,y:2,z:13,type:"symbol","class":"fa fa-angle-down",size:24,cursor:"pointer",orientation:"top-right",hasTheme:!0,width:24,height:24}}},OfflineChat:{elements:{MinimizeButton:{x:15,y:2,z:13,type:"symbol","class":"fa fa-angle-down",size:24,cursor:"pointer",orientation:"top-right",hasTheme:!0,width:24,height:24}}}},templateName:"Flat",theme:{MainChat:{MinimizeButton:{color:"white"}},OfflineChat:{MinimizeButton:{color:"white"}}},themeMobile:null,templateConfig:{app_key:"Box",extension_key:"box","interface":"1.0.0",themes:{Red:{name:"Red",version:"1.0.0"},GreenDark:{name:"Green (Dark)",version:"1.0.0"},Gray:{name:"Gray",version:"1.0.0"},Blue:{name:"Blue",version:"1.0.0"},Orange:{name:"Orange",version:"1.0.0"},Purple:{name:"Purple",version:"1.0.0"},Violet:{name:"Violet",version:"1.0.0"},GreenLight:{name:"Green (Light)",version:"1.0.0"},BlueDark:{name:"Blue (Dark)",version:"1.0.0"}},mobile:"clone",devices:["desktop","mobile"],DefaultTheme:"Blue",theme_generator:!0},elements:{MainChat:{elements:{MinimizeButton:{type:"symbol"}}},OfflineChat:{elements:{MinimizeButton:{type:"image"}}}}});Ba={Methods:[{method:"Stages.changeStage",status:"blocked"}]};oa={openBox:function(){z.callAction({name:"openBox",channel:{key:"Box.box",type:"public"},group:"Box.box",eventName:"onOpeningBox",eventObject:{error:"",object:{}},main:function(a,b){if("false"===m.getGeneralValue({key:"Box.box",name:"IsBoxOpened",type:"session"}))switch(m.setGeneralValue({key:"Box.box",name:"IsBoxOpened",value:"true",type:"session"}),H.getStage()){case"available":v.changeStage({stage:"MainChat",key:"Chat.chat"});t.propagate({name:"OpenBox",key:"Box.box",value:"online"});break;case"manual":v.changeStage({stage:"OfflineChat",key:"Chat.chat"});t.propagate({name:"OpenBox",key:"Box.box",value:"offline"});break;case"available_conversation":v.changeStage({stage:"MainChat",key:"Chat.chat"}),t.propagate({name:"OpenBox",key:"Box.box",value:"online"})}},args:{}},!0)},closeBox:function(){z.callAction({name:"closeBox",channel:{key:"Box.box",type:"public"},group:"Box.box",eventName:"onClosingBox",eventObject:{error:"",object:{}},main:function(a,b){if("true"===m.getGeneralValue({key:"Box.box",name:"IsBoxOpened",type:"session"}))switch(m.setGeneralValue({key:"Box.box",name:"IsBoxOpened",value:"false",type:"session"}),H.getStage()){case"available":v.changeStage({stage:"OnlineBox",key:"Box.box"});t.propagate({name:"CloseBox",key:"Box.box",value:"online"});break;case"manual":v.changeStage({stage:"OfflineBox",key:"Box.box"});t.propagate({name:"CloseBox",key:"Box.box",value:"offline"});break;case"available_conversation":v.changeStage({stage:"OnlineBox",key:"Box.box"}),t.propagate({name:"CloseBox",key:"Box.box",value:"online"})}},args:{}},!0)},isBoxOpen:function(){return m.getGeneralValue({key:"Box.box",name:"IsBoxOpened",type:"session"})}};x["Box.box"]={};x["Box.box"].online_intro="Berbincanglah dengan kami";x["Box.box"].offline_intro="Tinggalkan pesan";x["Box.box"].bubble_message="on";x["Box.box"].bubble_message_mob="on";x["Box.box"].badge_color="#FA8072";M={};O={};n.Map[r]={parent:this,name:r,key:r,version:ka,templateData:la,themeData:ma,stages:J,dragin:K,uiSettings:M,uiMobileSettings:O,extension_position:Ba,elements:{},renderTemplate:function(){v.Map[this.name]={};k.Map[this.name]={};k.Map[this.name].InternalWindow={};k.Map[this.name].DragIn={};E.CreatedInternalWindows[this.name]={};if(this.extension_position)
for(var a in this.extension_position.Methods)Priority.setExecutePriority(this.key,this.extension_position.Methods[a]);for(a=0;a<this.stages.length;a++){var b={},d=null,c=null,e;e=this.language?this.language.templates[this.stages[a].extension]?this.language.templates[this.stages[a].extension].Stages[this.stages[a].stageName]:null:null;d=this.uiSettings[this.stages[a].stageName]?this.uiSettings[this.stages[a].stageName]:null;c=this.uiMobileSettings[this.stages[a].stageName]?this.uiMobileSettings[this.stages[a].stageName]:null;b["default"]=d;b.mobile=c;this.parent.isMobile.phone&&(this.stages[a].templateMobile&&(d=this.stages[a].template,c=this.stages[a].templateMobile,"clone"===this.stages[a].templateConfig.mobile&&(this.stages[a].template=h.extend(!0,d,c)),"separate"===this.stages[a].templateConfig.mobile&&(this.stages[a].template=c)),this.stages[a].themeMobile&&(d=this.stages[a].theme,c=this.stages[a].themeMobile,"clone"===this.stages[a].templateConfig.mobile&&(this.stages[a].theme=h.extend(!0,d,c)),"separate"===this.stages[a].templateConfig.mobile&&(this.stages[a].theme=c)));u.createRenderer(this.stages[a].extension,this.stages[a].stageName,this.stages[a].template,this.stages[a].templateName,this.stages[a].theme,b,this.stages[a].elements,null,e)}
return this.stages.length},renderDragInTemplate:function(){for(var a=0;a<this.dragin.length;a++){k.Map[this.key].DragIn[this.dragin[a].extension]={};for(var b in this.dragin[a].template){var d={},c=null,e=null,c=this.uiSettings[this.dragin[a].template[b]]?this.uiSettings[this.dragin[a].template[b]]:null,e=this.uiMobileSettings[this.dragin[a].template[b]]?this.uiMobileSettings[this.dragin[a].template[b]]:null;d["default"]=c;d.mobile=e;if(this.parent.isMobile.phone&&this.dragin[a].themeMobile){if(this.dragin[a].themeMobile[b])var f=this.dragin[a].theme[b];c=this.dragin[a].themeMobile[b];"clone"===this.dragin[a].templateConfig.mobile&&(this.dragin[a].theme[b]=h.extend(!0,f,c));"separate"===this.dragin[a].templateConfig.mobile&&(this.dragin[a].theme[b]=c)}
u.createRenderer(this.dragin[a].extension,b,this.dragin[a].template[b],this.dragin[a].templateName,this.dragin[a].theme[b],d,this.dragin[a].elements[b],"DragIn").DragInKey=this.key}}
return this.dragin.length},main:na,api:oa};n.Map[r].language=null;var r="BrowsedPages.CurrentPages",S={title:"",url:"",visibility:"",isInit:!1,visibilityChangeMethods:[],init:function(){S.title=document.title;S.url=window.location.href;document.visibilityState&&(S.visibility=document.visibilityState);!1===S.isInit&&(S.isInit=!0,document.addEventListener("visibilitychange",function(){S.visibility=document.visibilityState;for(var a in S.visibilityChangeMethods)S.visibilityChangeMethods[a]()},!1))},visibilityChange:function(a){S.visibilityChangeMethods.push(a)}};N.Map.PageInfo=S;J=[];K=[];M={};O={};n.Map[r]={parent:this,name:r,key:r,version:"1.0.0",templateData:"",themeData:"",stages:J,dragin:K,uiSettings:M,uiMobileSettings:O,extension_position:null,elements:{},renderTemplate:function(){v.Map[this.name]={};k.Map[this.name]={};k.Map[this.name].InternalWindow={};k.Map[this.name].DragIn={};E.CreatedInternalWindows[this.name]={};if(this.extension_position)
for(var a in this.extension_position.Methods)Priority.setExecutePriority(this.key,this.extension_position.Methods[a]);for(a=0;a<this.stages.length;a++){var b={},d=null,c=null,e;e=this.language?this.language.templates[this.stages[a].extension]?this.language.templates[this.stages[a].extension].Stages[this.stages[a].stageName]:null:null;d=this.uiSettings[this.stages[a].stageName]?this.uiSettings[this.stages[a].stageName]:null;c=this.uiMobileSettings[this.stages[a].stageName]?this.uiMobileSettings[this.stages[a].stageName]:null;b["default"]=d;b.mobile=c;this.parent.isMobile.phone&&(this.stages[a].templateMobile&&(d=this.stages[a].template,c=this.stages[a].templateMobile,"clone"===this.stages[a].templateConfig.mobile&&(this.stages[a].template=h.extend(!0,d,c)),"separate"===this.stages[a].templateConfig.mobile&&(this.stages[a].template=c)),this.stages[a].themeMobile&&(d=this.stages[a].theme,c=this.stages[a].themeMobile,"clone"===this.stages[a].templateConfig.mobile&&(this.stages[a].theme=h.extend(!0,d,c)),"separate"===this.stages[a].templateConfig.mobile&&(this.stages[a].theme=c)));u.createRenderer(this.stages[a].extension,this.stages[a].stageName,this.stages[a].template,this.stages[a].templateName,this.stages[a].theme,b,this.stages[a].elements,null,e)}
return this.stages.length},renderDragInTemplate:function(){for(var a=0;a<this.dragin.length;a++){k.Map[this.key].DragIn[this.dragin[a].extension]={};for(var b in this.dragin[a].template){var d={},c=null,e=null,c=this.uiSettings[this.dragin[a].template[b]]?this.uiSettings[this.dragin[a].template[b]]:null,e=this.uiMobileSettings[this.dragin[a].template[b]]?this.uiMobileSettings[this.dragin[a].template[b]]:null;d["default"]=c;d.mobile=e;if(this.parent.isMobile.phone&&this.dragin[a].themeMobile){if(this.dragin[a].themeMobile[b])var f=this.dragin[a].theme[b];c=this.dragin[a].themeMobile[b];"clone"===this.dragin[a].templateConfig.mobile&&(this.dragin[a].theme[b]=h.extend(!0,f,c));"separate"===this.dragin[a].templateConfig.mobile&&(this.dragin[a].theme[b]=c)}
u.createRenderer(this.dragin[a].extension,b,this.dragin[a].template[b],this.dragin[a].templateName,this.dragin[a].theme[b],d,this.dragin[a].elements[b],"DragIn").DragInKey=this.key}}
return this.dragin.length},main:function(){var a=this.key,b=S.title,d=S.url,c=S.visibility,e=function(b){var c=m.getGeneralValue({key:a,name:"CurrentPage",type:"session"}),c=c?JSON.parse(c):{};c[b.instanceID]={title:b.title,url:b.url,visibility:b.visibility,instanceID:b.instanceID};m.setGeneralValue({key:a,name:"CurrentPage",type:"session",value:JSON.stringify(c)})};t.on({name:"CurrentPage",key:a,namespace:"CurrentPage",main:function(b,c){if(p.master){c=JSON.parse(c);e(c);var d=m.getGeneralValue({key:a,name:"CurrentPage",type:"session"});d&&w.sendCustomMessage({key:a,type:"private"},d)}}});y.connect({eventAction:"onInstanceType",channel:{key:a,type:"public"},when:"after",group:"Network",namespace:"connectionStatus",main:function(e){""===e.error&&(1!=u.parent.isMobile.phone&&1!=u.parent.isMobile.tablet||m.deleteGeneralValue({key:a,name:"CurrentPage",type:"session"}),t.propagate({name:"CurrentPage",key:a,value:JSON.stringify({title:b,url:d,visibility:c,instanceID:t.ID})}))}});y.connect({eventAction:"onSettingMaster",channel:{key:a,type:"public"},when:"after",group:"Info",namespace:"setMaster",main:function(f){""===f.error&&p.master&&(e({title:b,url:d,visibility:c,instanceID:t.ID}),(f=m.getGeneralValue({key:a,name:"CurrentPage",type:"session"}))&&w.sendCustomMessage({key:a,type:"private"},f))}});y.connect({eventAction:"onAssignOperator",channel:{key:a,type:"public"},group:"Network",when:"after",namespace:"onAssignOperator",main:function(b){p.master&&(b=m.getGeneralValue({key:a,name:"CurrentPage",type:"session"}))&&w.sendCustomMessage({key:a,type:"private"},b)}});y.connect({eventAction:"onOperatorChangedConnector",channel:{key:a,type:"public"},when:"after",group:"Network",namespace:"changedConnector",main:function(b){""===b.error&&p.master&&(b=m.getGeneralValue({key:a,name:"CurrentPage",type:"session"}))&&w.sendCustomMessage({key:a,type:"private"},b)}});window.onbeforeunload=function(b){p.master?f(t.ID):t.ID&&t.propagate({name:"DeleteCurrentPage",key:a,value:t.ID})};t.on({name:"DeleteCurrentPage",key:a,namespace:"DeleteCurrentPage",main:function(b,c){if(p.master){f(c);var d=m.getGeneralValue({key:a,name:"CurrentPage",type:"session"});d&&w.sendCustomMessage({key:a,type:"private"},d)}}});var f=function(b){var c=m.getGeneralValue({key:a,name:"CurrentPage",type:"session"}),c=c?JSON.parse(c):{};delete c[b];m.setGeneralValue({key:a,name:"CurrentPage",type:"session",value:JSON.stringify(c)})}},api:void 0};n.Map[r].language=null;r="ContactForm.ContactForm";J=[];K=[];x["ContactForm.ContactForm"]={};x["ContactForm.ContactForm"].informative_message="off";x["ContactForm.ContactForm"].message="While waiting for a reply you can leave us your contact information to speed up the process";x["ContactForm.ContactForm"].email="on";x["ContactForm.ContactForm"].name="on";x["ContactForm.ContactForm"].phone="off";M={};O={};n.Map[r]={parent:this,name:r,key:r,version:"1.0.0",templateData:"",themeData:"",stages:J,dragin:K,uiSettings:M,uiMobileSettings:O,extension_position:null,elements:{},renderTemplate:function(){v.Map[this.name]={};k.Map[this.name]={};k.Map[this.name].InternalWindow={};k.Map[this.name].DragIn={};E.CreatedInternalWindows[this.name]={};if(this.extension_position)
for(var a in this.extension_position.Methods)Priority.setExecutePriority(this.key,this.extension_position.Methods[a]);for(a=0;a<this.stages.length;a++){var b={},d=null,c=null,e;e=this.language?this.language.templates[this.stages[a].extension]?this.language.templates[this.stages[a].extension].Stages[this.stages[a].stageName]:null:null;d=this.uiSettings[this.stages[a].stageName]?this.uiSettings[this.stages[a].stageName]:null;c=this.uiMobileSettings[this.stages[a].stageName]?this.uiMobileSettings[this.stages[a].stageName]:null;b["default"]=d;b.mobile=c;this.parent.isMobile.phone&&(this.stages[a].templateMobile&&(d=this.stages[a].template,c=this.stages[a].templateMobile,"clone"===this.stages[a].templateConfig.mobile&&(this.stages[a].template=h.extend(!0,d,c)),"separate"===this.stages[a].templateConfig.mobile&&(this.stages[a].template=c)),this.stages[a].themeMobile&&(d=this.stages[a].theme,c=this.stages[a].themeMobile,"clone"===this.stages[a].templateConfig.mobile&&(this.stages[a].theme=h.extend(!0,d,c)),"separate"===this.stages[a].templateConfig.mobile&&(this.stages[a].theme=c)));u.createRenderer(this.stages[a].extension,this.stages[a].stageName,this.stages[a].template,this.stages[a].templateName,this.stages[a].theme,b,this.stages[a].elements,null,e)}
return this.stages.length},renderDragInTemplate:function(){for(var a=0;a<this.dragin.length;a++){k.Map[this.key].DragIn[this.dragin[a].extension]={};for(var b in this.dragin[a].template){var d={},c=null,e=null,c=this.uiSettings[this.dragin[a].template[b]]?this.uiSettings[this.dragin[a].template[b]]:null,e=this.uiMobileSettings[this.dragin[a].template[b]]?this.uiMobileSettings[this.dragin[a].template[b]]:null;d["default"]=c;d.mobile=e;if(this.parent.isMobile.phone&&this.dragin[a].themeMobile){if(this.dragin[a].themeMobile[b])var f=this.dragin[a].theme[b];c=this.dragin[a].themeMobile[b];"clone"===this.dragin[a].templateConfig.mobile&&(this.dragin[a].theme[b]=h.extend(!0,f,c));"separate"===this.dragin[a].templateConfig.mobile&&(this.dragin[a].theme[b]=c)}
u.createRenderer(this.dragin[a].extension,b,this.dragin[a].template[b],this.dragin[a].templateName,this.dragin[a].theme[b],d,this.dragin[a].elements[b],"DragIn").DragInKey=this.key}}
return this.dragin.length},main:function(){var a=this.key,b=x[a].informative_message,d=x[a].message,c=x[a].email,e=x[a].name,f=x[a].phone,g=n.Map["Chat.chat"].language.templates["Chat.chat"].Stages.OfflineChat.UsernameLabel,q=n.Map["Chat.chat"].language.templates["Chat.chat"].Stages.OfflineChat.EmailLabel,l=n.Map["Chat.chat"].language.templates["Chat.chat"].Stages.OfflineChat.PhoneLabel,v=n.Map["Chat.chat"].language.templates["Chat.chat"].InternalWindow.OfflineMessageError.InfoLabel,I=1==u.parent.isMobile.phone||1==u.parent.isMobile.tablet,B=I?"touchend":"click",C=m.getGeneralValue({key:a,name:"contactFormActivated",type:"session"}),r=!1,z,F,A;k.Map["Chat.chat"].MainChat.ConversationArea.registerCustomLine("email_request",function(b,c){var d=c.data("content");z=h("\x3cdiv\x3e\x3c/div\x3e").css({margin:"10px 25px 20px 10px",padding:"10px","animation-duration":".5s","word-wrap":"break-word","background-color":"floralwhite","border-radius":"5px",border:"1px solid #ffe1a4","box-sizing":"border-box"}).addClass("animated fadeIn");var e=h("\x3cinput\x3e").css({display:"block",padding:"5px","font-size":"14px","font-family":"open sans","line-height":"18px",width:"100%","border-radius":"5px",border:"2px solid forestgreen","box-sizing":"border-box","box-shadow":"none"}).attr({placeholder:q,type:"email"}),f=h("\x3cdiv\x3e\x3ci class\x3d'fa fa-check' aria-hidden\x3d'true'\x3e\x3c/i\x3e\x3c/div\x3e").css({margin:"5px 0px 0px 0px",padding:"5px 10px","background-color":"forestgreen","border-radius":"7px","box-sizing":"border-box","float":"right",color:"lightyellow",cursor:"pointer"}).on(B,function(b){b.preventDefault();I&&setTimeout(function(){e.blur()},1E3);l.text("");b=!1;var c=e.val();(b=!/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(c))?l.text(v):(Y.setValue("email",c),!0===p.master&&w.updateProfile("email",c),e.remove(),g.remove(),l.remove(),f.remove(),z.append(k),r=!1,t.propagate({key:a,name:"ContactForm",value:JSON.stringify({action:"success",element:"email",value:c})}),setTimeout(function(){z.remove();Z.activateNext()},2E3))}),g=h("\x3cdiv\x3e\x3ci class\x3d'fa fa-times' aria-hidden\x3d'true'\x3e\x3c/i\x3e\x3c/div\x3e").css({margin:"5px 0px 0px 10px",padding:"5px 10px","background-color":"tomato","border-radius":"7px","box-sizing":"border-box","float":"right",color:"lightyellow",cursor:"pointer"}).on(B,function(b){b.preventDefault();I&&setTimeout(function(){e.blur()},1E3);r=!1;C="no";m.setGeneralValue({key:a,name:"contactFormActivated",value:"no",type:"session"});t.propagate({key:a,name:"ContactForm",value:JSON.stringify({action:"cancel",element:"email"})});z.remove()}),l=h("\x3cdiv\x3e\x3c/div\x3e").css({"font-size":"12px","font-family":"open sans",color:"tomato"}),k=h("\x3cdiv\x3e\x3ci class\x3d'fa fa-check' aria-hidden\x3d'true'\x3e\x3c/i\x3e\x3c/div\x3e").css({"border-radius":"7px","box-sizing":"border-box",color:"forestgreen","font-size":"40px","text-align":"center"}).addClass("animated fadeIn");z.append(e);z.append(g);z.append(f);z.append(h("\x3cdiv\x3e\x3c/div\x3e").css("clear","both"));z.append(l);d.append(z)});k.Map["Chat.chat"].MainChat.ConversationArea.registerCustomLine("name_request",function(b,c){var d=c.data("content");F=h("\x3cdiv\x3e\x3c/div\x3e").css({margin:"10px 25px 20px 10px",padding:"10px","animation-duration":".5s","word-wrap":"break-word","background-color":"floralwhite","border-radius":"5px",border:"1px solid #ffe1a4","box-sizing":"border-box"}).addClass("animated fadeIn");var e=h("\x3cinput\x3e").css({display:"block",padding:"5px","font-size":"14px","font-family":"open sans","line-height":"18px",width:"100%","border-radius":"5px",border:"2px solid forestgreen","box-sizing":"border-box"}).attr({placeholder:g,type:"text"}),f=h("\x3cdiv\x3e\x3ci class\x3d'fa fa-check' aria-hidden\x3d'true'\x3e\x3c/i\x3e\x3c/div\x3e").css({margin:"5px 0px 0px 0px",padding:"5px 10px","background-color":"forestgreen","border-radius":"7px","box-sizing":"border-box","float":"right",color:"lightyellow",cursor:"pointer"}).on(B,function(b){b.preventDefault();I&&setTimeout(function(){e.blur()},1E3);q.text("");b=!1;var c=e.val();""==c.trim()&&(b=!0);b?q.text(v):(Y.setValue("name",c),!0===p.master&&(w.changeNick(c),w.updateProfile("name",c)),t.propagate({key:"Chat.chat",name:"ChangeNick",value:c}),e.remove(),l.remove(),q.remove(),f.remove(),F.append(k),r=!1,t.propagate({key:a,name:"ContactForm",value:JSON.stringify({action:"success",element:"name",value:c})}),setTimeout(function(){F.remove();Z.activateNext()},2E3))}),l=h("\x3cdiv\x3e\x3ci class\x3d'fa fa-times' aria-hidden\x3d'true'\x3e\x3c/i\x3e\x3c/div\x3e").css({margin:"5px 0px 0px 10px",padding:"5px 10px","background-color":"tomato","border-radius":"7px","box-sizing":"border-box","float":"right",color:"lightyellow",cursor:"pointer"}).on(B,function(b){b.preventDefault();I&&setTimeout(function(){e.blur()},1E3);r=!1;C="no";m.setGeneralValue({key:a,name:"contactFormActivated",value:"no",type:"session"});t.propagate({key:a,name:"ContactForm",value:JSON.stringify({action:"cancel",element:"name"})});F.remove()}),q=h("\x3cdiv\x3e\x3c/div\x3e").css({"font-size":"12px","font-family":"open sans",color:"tomato"}),k=h("\x3cdiv\x3e\x3ci class\x3d'fa fa-check' aria-hidden\x3d'true'\x3e\x3c/i\x3e\x3c/div\x3e").css({"border-radius":"7px","box-sizing":"border-box",color:"forestgreen","font-size":"40px","text-align":"center"}).addClass("animated fadeIn");F.append(e);F.append(l);F.append(f);F.append(h("\x3cdiv\x3e\x3c/div\x3e").css("clear","both"));F.append(q);d.append(F)});k.Map["Chat.chat"].MainChat.ConversationArea.registerCustomLine("phone_request",function(b,c){var d=c.data("content");A=h("\x3cdiv\x3e\x3c/div\x3e").css({margin:"10px 25px 20px 10px",padding:"10px","animation-duration":".5s","word-wrap":"break-word","background-color":"floralwhite","border-radius":"5px",border:"1px solid #ffe1a4","box-sizing":"border-box"}).addClass("animated fadeIn");var e=h("\x3cinput\x3e").css({display:"block",padding:"5px","font-size":"14px","font-family":"open sans","line-height":"18px",width:"100%","border-radius":"5px",border:"2px solid forestgreen","box-sizing":"border-box"}).attr({placeholder:l,type:"text"}),f=h("\x3cdiv\x3e\x3ci class\x3d'fa fa-check' aria-hidden\x3d'true'\x3e\x3c/i\x3e\x3c/div\x3e").css({margin:"5px 0px 0px 0px",padding:"5px 10px","background-color":"forestgreen","border-radius":"7px","box-sizing":"border-box","float":"right",color:"lightyellow",cursor:"pointer"}).on(B,function(b){b.preventDefault();I&&setTimeout(function(){e.blur()},1E3);q.text("");b=!1;var c=e.val();""==c.trim()&&(b=!0);b?q.text(v):(Y.setValue("phone",c),!0===p.master&&w.updateProfile("phone",c),e.remove(),g.remove(),q.remove(),f.remove(),A.append(k),r=!1,t.propagate({key:a,name:"ContactForm",value:JSON.stringify({action:"success",element:"phone",value:c})}),setTimeout(function(){A.remove();Z.activateNext()},2E3))}),g=h("\x3cdiv\x3e\x3ci class\x3d'fa fa-times' aria-hidden\x3d'true'\x3e\x3c/i\x3e\x3c/div\x3e").css({margin:"5px 0px 0px 10px",padding:"5px 10px","background-color":"tomato","border-radius":"7px","box-sizing":"border-box","float":"right",color:"lightyellow",cursor:"pointer"}).on(B,function(b){b.preventDefault();I&&setTimeout(function(){e.blur()},1E3);r=!1;C="no";m.setGeneralValue({key:a,name:"contactFormActivated",value:"no",type:"session"});t.propagate({key:a,name:"ContactForm",value:JSON.stringify({action:"cancel",element:"phone"})});A.remove()}),q=h("\x3cdiv\x3e\x3c/div\x3e").css({"font-size":"12px","font-family":"open sans",color:"tomato"}),k=h("\x3cdiv\x3e\x3ci class\x3d'fa fa-check' aria-hidden\x3d'true'\x3e\x3c/i\x3e\x3c/div\x3e").css({"border-radius":"7px","box-sizing":"border-box",color:"forestgreen","font-size":"40px","text-align":"center"}).addClass("animated fadeIn");A.append(e);A.append(g);A.append(f);A.append(h("\x3cdiv\x3e\x3c/div\x3e").css("clear","both"));A.append(q);d.append(A)});"on"==c&&(Y.getValue("email")||Z.addItem({name:"email_request",position:1,activated:!1,activate:function(){Y.getValue("email")?Z.activateNext():r||(r=!0,k.Map["Chat.chat"].MainChat.ConversationArea.addCustomLine({type:"email_request",time:Math.round((new Date).getTime()/1E3)}))}}));"on"==e&&(Y.getValue("name")||Z.addItem({name:"name_request",position:2,activated:!1,activate:function(){r||(Y.getValue("name")?Z.activateNext():(r=!0,k.Map["Chat.chat"].MainChat.ConversationArea.addCustomLine({type:"name_request",time:Math.round((new Date).getTime()/1E3)})))}}));"on"==f&&(Y.getValue("phone")||Z.addItem({name:"phone_request",position:3,activated:!1,activate:function(){Y.getValue("phone")?Z.activateNext():r||(r=!0,k.Map["Chat.chat"].MainChat.ConversationArea.addCustomLine({type:"phone_request",time:Math.round((new Date).getTime()/1E3)}))}}));y.connect({eventAction:"onConversationStarted",channel:{key:a,type:"public"},when:"after",group:"Network",namespace:"conversationStarted",main:function(c){""!==c.error||C&&"yes"!=C||(C="yes",m.setGeneralValue({key:a,name:"contactFormActivated",value:"yes",type:"session"}),setTimeout(function(){"on"!=b||"yes"==m.getGeneralValue({key:a,name:"message",type:"session"})||"available"!==H.getStage()&&"available_conversation"!==H.getStage()||(m.setGeneralValue({key:a,name:"message",type:"session",value:"yes"}),w.receiveMessage(d));Z.activateNext();t.propagate({key:a,name:"ContactForm",value:JSON.stringify({action:"activate"})})},2E3))}});t.on({name:"ContactForm",key:a,namespace:"activateNext",main:function(a,b){var c=JSON.parse(b);"activate"==c.action&&Z.activateNext();if("cancel"==c.action)switch(r=!1,C="no",c.element){case"email":z.remove();break;case"name":F.remove();break;case"phone":A.remove()}
if("success"==c.action){r=!1;switch(c.element){case"email":z.remove();break;case"name":F.remove();break;case"phone":A.remove()}!0===p.master&&w.updateProfile(c.element,c.value);Z.activateNext()}}});"yes"==C&&setTimeout(function(){Z.activateNext();t.propagate({key:a,name:"ContactForm",value:JSON.stringify({action:"activate"})})},2E3)},api:void 0};n.Map[r].language=null;var r="FirstMessage.FirstMessage",aa={init:function(){},schedule:function(a,b,d){return!0===d?setInterval(a,b):setTimeout(a,b)},stopSchedule:function(a,b){return!0===b?clearInterval(a):clearTimeout(a)}};N.Map.Timer=aa;J=[];K=[];oa={trigger:function(){z.callAction({name:"trigger",channel:{key:"FirstMessage.FirstMessage",type:"public"},group:"FirstMessage.FirstMessage",eventName:"onTrigger",eventObject:{error:"",object:{}},main:function(a,b){},args:{}},!0)}};x["FirstMessage.FirstMessage"]={};x["FirstMessage.FirstMessage"].message="Hai, ada yang bisa kami bantu?";x["FirstMessage.FirstMessage"].time="10";M={};O={};n.Map[r]={parent:this,name:r,key:r,version:"1.0.0",templateData:"",themeData:"",stages:J,dragin:K,uiSettings:M,uiMobileSettings:O,extension_position:null,elements:{},renderTemplate:function(){v.Map[this.name]={};k.Map[this.name]={};k.Map[this.name].InternalWindow={};k.Map[this.name].DragIn={};E.CreatedInternalWindows[this.name]={};if(this.extension_position)
for(var a in this.extension_position.Methods)Priority.setExecutePriority(this.key,this.extension_position.Methods[a]);for(a=0;a<this.stages.length;a++){var b={},d=null,c=null,e;e=this.language?this.language.templates[this.stages[a].extension]?this.language.templates[this.stages[a].extension].Stages[this.stages[a].stageName]:null:null;d=this.uiSettings[this.stages[a].stageName]?this.uiSettings[this.stages[a].stageName]:null;c=this.uiMobileSettings[this.stages[a].stageName]?this.uiMobileSettings[this.stages[a].stageName]:null;b["default"]=d;b.mobile=c;this.parent.isMobile.phone&&(this.stages[a].templateMobile&&(d=this.stages[a].template,c=this.stages[a].templateMobile,"clone"===this.stages[a].templateConfig.mobile&&(this.stages[a].template=h.extend(!0,d,c)),"separate"===this.stages[a].templateConfig.mobile&&(this.stages[a].template=c)),this.stages[a].themeMobile&&(d=this.stages[a].theme,c=this.stages[a].themeMobile,"clone"===this.stages[a].templateConfig.mobile&&(this.stages[a].theme=h.extend(!0,d,c)),"separate"===this.stages[a].templateConfig.mobile&&(this.stages[a].theme=c)));u.createRenderer(this.stages[a].extension,this.stages[a].stageName,this.stages[a].template,this.stages[a].templateName,this.stages[a].theme,b,this.stages[a].elements,null,e)}
return this.stages.length},renderDragInTemplate:function(){for(var a=0;a<this.dragin.length;a++){k.Map[this.key].DragIn[this.dragin[a].extension]={};for(var b in this.dragin[a].template){var d={},c=null,e=null,c=this.uiSettings[this.dragin[a].template[b]]?this.uiSettings[this.dragin[a].template[b]]:null,e=this.uiMobileSettings[this.dragin[a].template[b]]?this.uiMobileSettings[this.dragin[a].template[b]]:null;d["default"]=c;d.mobile=e;if(this.parent.isMobile.phone&&this.dragin[a].themeMobile){if(this.dragin[a].themeMobile[b])var f=this.dragin[a].theme[b];c=this.dragin[a].themeMobile[b];"clone"===this.dragin[a].templateConfig.mobile&&(this.dragin[a].theme[b]=h.extend(!0,f,c));"separate"===this.dragin[a].templateConfig.mobile&&(this.dragin[a].theme[b]=c)}
u.createRenderer(this.dragin[a].extension,b,this.dragin[a].template[b],this.dragin[a].templateName,this.dragin[a].theme[b],d,this.dragin[a].elements[b],"DragIn").DragInKey=this.key}}
return this.dragin.length},main:function(){function a(){var a=m.getGeneralValue({key:b,name:"firstMessageSent",type:"session"});"yes"!=a&&aa.schedule(function(){a=m.getGeneralValue({key:b,name:"firstMessageSent",type:"session"});"yes"==a||"available"!==H.getStage()&&"available_conversation"!==H.getStage()||(a=m.setGeneralValue({key:b,name:"firstMessageSent",type:"session",value:"yes"}),w.receiveMessage(d))},c)}
var b=this.key;Date.now||(Date.now=function(){return(new Date).getTime()});var d=x[b].message,c=1E3*x[b].time;y.connect({eventAction:"onChangingStage",channel:{key:b,type:"public"},when:"after",group:"Widget",namespace:"changeStage",main:function(b){""===b.error&&("available"===b.object.stage&&a(),"available_conversation"===b.object.stage&&a())}});"available"===H.getStage()&&a();"available_conversation"===H.getStage()&&a()},api:oa};n.Map[r].language=null;var r="IdleVisitor.idle_visitor",Da={events:{},init:function(){(function(a){var b={init:function(b){var c=!1,e,f=a.extend({},{idle:6E4,events:"mousemove keypress mousedown",onIdle:function(){},onActive:function(){},keepTracking:!1},b),g=function(a){return(a.keepTracking?setInterval:setTimeout)(function(){c=!0;a.onIdle.call()},a.idle)};return this.each(function(){e||(e=g(f));a(this).on(f.events,function(a){a=e;c&&(f.onActive.call(),c=!1);(f.keepTracking?clearInterval:clearTimeout)(a);e=g(f)})})},destroy:function(){}};a.fn.idle=function(a){if(b[a])return b[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"===typeof a||!a)return b.init.apply(this,arguments)}})(h)},start:function(a,b,d){h(document).ready(function(){h("body,#"+H.hash+" iframe:first-child").contents().idle({onIdle:function(){"function"==typeof b&&b()},onActive:function(){"function"==typeof d&&d()},idle:a,keepTracking:!0})})}};N.Map.Idle=Da;N.Map.Time=sa;J=[];K=[];oa={goIdle:function(){z.callAction({name:"goIdle",channel:{key:"IdleVisitor.idle_visitor",type:"public"},group:"IdleVisitor.idle_visitor",eventName:"onIdle",eventObject:{error:"",object:{}},main:function(a,b){},args:{}},!0)},goActive:function(){z.callAction({name:"goActive",channel:{key:"IdleVisitor.idle_visitor",type:"public"},group:"IdleVisitor.idle_visitor",eventName:"onActive",eventObject:{error:"",object:{}},main:function(a,b){},args:{}},!0)}};x["IdleVisitor.idle_visitor"]={};x["IdleVisitor.idle_visitor"].timeout="30";M={};O={};n.Map[r]={parent:this,name:r,key:r,version:"1.3.0",templateData:"",themeData:"",stages:J,dragin:K,uiSettings:M,uiMobileSettings:O,extension_position:null,elements:{},renderTemplate:function(){v.Map[this.name]={};k.Map[this.name]={};k.Map[this.name].InternalWindow={};k.Map[this.name].DragIn={};E.CreatedInternalWindows[this.name]={};if(this.extension_position)
for(var a in this.extension_position.Methods)Priority.setExecutePriority(this.key,this.extension_position.Methods[a]);for(a=0;a<this.stages.length;a++){var b={},d=null,c=null,e;e=this.language?this.language.templates[this.stages[a].extension]?this.language.templates[this.stages[a].extension].Stages[this.stages[a].stageName]:null:null;d=this.uiSettings[this.stages[a].stageName]?this.uiSettings[this.stages[a].stageName]:null;c=this.uiMobileSettings[this.stages[a].stageName]?this.uiMobileSettings[this.stages[a].stageName]:null;b["default"]=d;b.mobile=c;this.parent.isMobile.phone&&(this.stages[a].templateMobile&&(d=this.stages[a].template,c=this.stages[a].templateMobile,"clone"===this.stages[a].templateConfig.mobile&&(this.stages[a].template=h.extend(!0,d,c)),"separate"===this.stages[a].templateConfig.mobile&&(this.stages[a].template=c)),this.stages[a].themeMobile&&(d=this.stages[a].theme,c=this.stages[a].themeMobile,"clone"===this.stages[a].templateConfig.mobile&&(this.stages[a].theme=h.extend(!0,d,c)),"separate"===this.stages[a].templateConfig.mobile&&(this.stages[a].theme=c)));u.createRenderer(this.stages[a].extension,this.stages[a].stageName,this.stages[a].template,this.stages[a].templateName,this.stages[a].theme,b,this.stages[a].elements,null,e)}
return this.stages.length},renderDragInTemplate:function(){for(var a=0;a<this.dragin.length;a++){k.Map[this.key].DragIn[this.dragin[a].extension]={};for(var b in this.dragin[a].template){var d={},c=null,e=null,c=this.uiSettings[this.dragin[a].template[b]]?this.uiSettings[this.dragin[a].template[b]]:null,e=this.uiMobileSettings[this.dragin[a].template[b]]?this.uiMobileSettings[this.dragin[a].template[b]]:null;d["default"]=c;d.mobile=e;if(this.parent.isMobile.phone&&this.dragin[a].themeMobile){if(this.dragin[a].themeMobile[b])var f=this.dragin[a].theme[b];c=this.dragin[a].themeMobile[b];"clone"===this.dragin[a].templateConfig.mobile&&(this.dragin[a].theme[b]=h.extend(!0,f,c));"separate"===this.dragin[a].templateConfig.mobile&&(this.dragin[a].theme[b]=c)}
u.createRenderer(this.dragin[a].extension,b,this.dragin[a].template[b],this.dragin[a].templateName,this.dragin[a].theme[b],d,this.dragin[a].elements[b],"DragIn").DragInKey=this.key}}
return this.dragin.length},main:function(){var a=this.key;Da.start(1E3*x[a].timeout,n.Map[a].api.goIdle,n.Map[a].api.goActive);var b="active",d;m.deleteGeneralValue({key:a,name:"IdleTime",type:"session"});var c=m.getGeneralValue({key:a,name:"TimeDifference",type:"session"});m.setGeneralValue({key:a,name:"IdleStatus",type:"session",value:"active"});y.connect({eventAction:"onSettingMaster",channel:{key:a,type:"public"},when:"after",group:"Info",namespace:"setMaster",main:function(b){""===b.error&&p.master&&(c||w.requestServerTime({key:a,type:"private"}))}});y.connect({eventAction:"onReceivingVisitorInstances",channel:{key:a,type:"private"},when:"after",group:"Network",namespace:"onReceivingVisitorInstances",main:function(c){if(""===c.error&&!0===p.master){var f=!1,g;for(g in c.object.instances){var h=m.getGeneralValue({key:a,name:"IdleStatus"+g,type:"session"});h&&"active"!==h||(f=!0);!1===f?(b="idle",h=m.getGeneralValue({key:a,name:"TimeDifference",type:"session"}),d=m.getGeneralValue({key:a,name:"IdleTime",type:"session"}),d||(d=sa.getCurrentTime()+parseInt(h),m.setGeneralValue({key:a,name:"IdleTime",value:d,type:"session"})),m.setGeneralValue({key:a,name:"IdleStatus",type:"session",value:"idle"}),w.sendCustomMessage({key:a,type:"private"},JSON.stringify({status:b,time:d}))):(b="active",m.setGeneralValue({key:a,name:"IdleStatus",type:"session",value:"active"}),w.sendCustomMessage({key:a,type:"private"},JSON.stringify({status:b})))}
var f=m.searchStorage({key:a,name:"IdleStatus",type:"session"}),l;for(l in f)f=l.substr((H.hash+a+"IdleStatus").length),""!==f&&(c.object.instances[f]||m.deleteGeneralValue({key:a,name:"IdleStatus"+f,type:"session"}))}}});y.connect({eventAction:"onIdle",channel:{key:a,type:"public"},when:"after",group:a,namespace:"onIdle",main:function(b){"idle"!==m.getGeneralValue({key:a,name:"IdleStatus",type:"session"})&&(m.setGeneralValue({key:a,name:"IdleStatus"+t.ID,value:"idle",type:"session"}),b=m.getGeneralValue({key:a,name:"TimeDifference",type:"session"}),d=sa.getCurrentTime()+
parseInt(b),m.setGeneralValue({key:a,name:"IdleTime",value:d,type:"session"}),!0===p.master&&w.requestVisitorInstances({key:a,type:"private"}),t.propagate({name:"ChangeIdleStatus",key:a,value:"idle"}))}});y.connect({eventAction:"onActive",channel:{key:a,type:"public"},when:"after",group:a,namespace:"onActive",main:function(c){m.setGeneralValue({key:a,name:"IdleStatus"+t.ID,value:"active",type:"session"});m.setGeneralValue({key:a,name:"IdleStatus",type:"session",value:"active"});b="active";!0===p.master&&(m.setGeneralValue({key:a,name:"IdleStatus",type:"session",value:"active"}),w.sendCustomMessage({key:a,type:"private"},JSON.stringify({status:b})));t.propagate({key:a,name:"ChangeIdleStatus",value:"active"})}});t.on({name:"ChangeIdleStatus",key:a,namespace:"ChangeIdleStatus",main:function(b,c){!0===p.master&&("idle"===c?w.requestVisitorInstances({key:a,type:"private"}):(m.deleteGeneralValue({key:a,name:"IdleTime",type:"session"}),d=null,w.sendCustomMessage({key:a,type:"private"},JSON.stringify({status:"active"}))))}});y.connect({eventAction:"onAssignOperator",channel:{key:a,type:"public"},group:"Network",when:"after",namespace:"onAssignOperator",main:function(c){p.master&&("idle"===b?d&&w.sendCustomMessage({key:a,type:"private"},JSON.stringify({status:b,time:d})):w.sendCustomMessage({key:a,type:"private"},JSON.stringify({status:b})))}});y.connect({eventAction:"onReceivingServerTime",channel:{key:a,type:"public"},when:"after",group:"Network",namespace:"receivingServerTime",main:function(b){""===b.error&&(c=b.object.time-
sa.getCurrentTime(),m.setGeneralValue({key:a,name:"TimeDifference",value:c,type:"session"}))}});y.connect({eventAction:"onOperatorChangedConnector",channel:{key:a,type:"public"},when:"after",group:"Network",namespace:"changedConnector",main:function(c){""===c.error&&p.master&&("idle"===b?d&&w.sendCustomMessage({key:a,type:"private"},JSON.stringify({status:b,time:d})):w.sendCustomMessage({key:a,type:"private"},JSON.stringify({status:b})))}});t.propagate({key:a,name:"ChangeIdleStatus",value:"active"})},api:oa};n.Map[r].language=null;var r="MessageNotifier.MessageNotifier",ka="1.1.0",ma=la="",na=function(){var a=this.key,b,d=0,c=x[a].badge,e=x[a].title,f=x[a].title_message,g=x[a].sound;if("on"===c)var h=new Favico({animation:"slide"});if("on"===e)var l=new Ea(f,{animationPattern:[{type:"new",delay:1E3},{type:"original",delay:1E3}],animationLoop:0});var m=function(){"on"===c&&h.badge(d)},k=function(){"on"===e&&(0===d?l.stop(!0):l.start())},p=function(){"hidden"===S.visibility&&(m(),k())};S.visibilityChange(function(c){if(void 0===c||null===c)c=S.visibility;"visible"===c&&(void 0!==b&&null!==b&&aa.stopSchedule(b),d=0,m(),k());t.propagate({name:"MessageNotificationVisibility",key:a,value:S.visibility})});var u=!1;n.Map["IdleVisitor.idle_visitor"]?Da.start(3E4,function(){u=!0},function(){u=!1}):u=!0;y.connect({eventAction:"onReceiveMessage",channel:{key:a,type:"public"},group:"Network",when:"after",namespace:"receiveMessageToConversation",main:function(c){u&&"on"===g&&qa.playNewMessageSound();"hidden"===S.visibility&&(d++,void 0!==b&&null!==b&&aa.stopSchedule(b),b=aa.schedule(p,1E3),t.propagate({name:"MessageReceived",key:a,value:S.visibility}))}});t.on({name:"MessageReceived",key:a,namespace:"MessageReceived",main:function(c,e){"visible"===e?(d=0,m(),k(),void 0!==b&&null!==b&&aa.stopSchedule(b)):"hidden"===S.visibility&&(d++,void 0!==b&&null!==b&&aa.stopSchedule(b),b=aa.schedule(p,1E3));t.propagate({name:"MessageNotificationVisibility",key:a,value:S.visibility})}});t.on({name:"MessageNotificationVisibility",key:a,namespace:"MessageNotificationVisibility",main:function(a,c){"visible"===c&&(void 0!==b&&null!==b&&aa.stopSchedule(b),d=0,m(),k())}})},qa={init:function(){if("Audio"in window){var a=new Audio;a.canPlayType&&a.canPlayType('audio/ogg; codecs\x3d"vorbis"').replace(/no/,"")?qa.NEW_MESSAGE_SOUND=new Audio(wa+"sound/widget_new_message.ogg"):a.canPlayType&&a.canPlayType("audio/mpeg;").replace(/no/,"")?qa.NEW_MESSAGE_SOUND=new Audio(wa+"sound/widget_new_message.mp3"):a.canPlayType&&a.canPlayType('audio/mp4; codecs\x3d"mp4a.40.2"').replace(/no/,"")&&(qa.NEW_MESSAGE_SOUND=new Audio(wa+"sound/widget_new_message.m4a"))}},playNewMessageSound:function(){qa.NEW_MESSAGE_SOUND.play()}};N.Map.SoundManager=qa;N.Map.Timer=aa;N.Map.PageInfo=S;(function(){var a=function(a){var d,c,e,f;function g(a){if(a.paused||a.ended||A)return!1;try{r.clearRect(0,0,t,n),r.drawImage(a,0,0,t,n)}catch(b){}
K=setTimeout(function(){g(a)},P.duration);N.setIcon(u)}
function h(a){a=a.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(a,b,c,d){return b+b+c+c+d+d});return(a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a))?{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:!1}
function l(a,b){var c={},d;for(d in a)c[d]=a[d];for(d in b)c[d]=b[d];return c}
a=a?a:{};var m={bgColor:"#d00",textColor:"#fff",fontFamily:"sans-serif",fontStyle:"bold",type:"circle",position:"down",animation:"slide",elementId:!1,dataUrl:!1,win:window},k,p,n,t,u,r,v,w,x,z,y,A,E,K,G;f=e=c=d=void 0;d="undefined"!=typeof InstallTrigger;c=!!window.chrome;e=!!window.opera||0<=navigator.userAgent.indexOf("Opera");Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor");f=c||d||e;var H=[];y=function(){};w=A=!1;var J={ready:function(){w=!0;J.reset();y()},reset:function(){w&&(H=[],z=x=!1,r.clearRect(0,0,t,n),r.drawImage(v,0,0,t,n),N.setIcon(u),window.clearTimeout(E),window.clearTimeout(K))},start:function(){if(w&&!z&&0<H.length){z=!0;var a=function(){"type animation bgColor textColor fontFamily fontStyle".split(" ").forEach(function(a){a in H[0].options&&(k[a]=H[0].options[a])});P.run(H[0].options,function(){x=H[0];z=!1;0<H.length&&(H.shift(),J.start())},!1)};x?P.run(x.options,function(){a()},!0):a()}}},M={},O=function(a){a.n="number"===typeof a.n?Math.abs(a.n|0):a.n;a.x*=t;a.y*=n;a.w*=t;a.h*=n;a.len=(""+a.n).length;return a};M.circle=function(a){a=O(a);var b=!1;2===a.len?(a.x-=.4*a.w,a.w*=1.4,b=!0):3<=a.len&&(a.x-=.65*a.w,a.w*=1.65,b=!0);r.clearRect(0,0,t,n);r.drawImage(v,0,0,t,n);r.beginPath();r.font=k.fontStyle+" "+Math.floor(a.h*(99<a.n?.85:1))+"px "+k.fontFamily;r.textAlign="center";b?(r.moveTo(a.x+a.w/2,a.y),r.lineTo(a.x+a.w-a.h/2,a.y),r.quadraticCurveTo(a.x+a.w,a.y,a.x+a.w,a.y+a.h/2),r.lineTo(a.x+a.w,a.y+a.h-a.h/2),r.quadraticCurveTo(a.x+a.w,a.y+a.h,a.x+a.w-a.h/2,a.y+a.h),r.lineTo(a.x+a.h/2,a.y+a.h),r.quadraticCurveTo(a.x,a.y+a.h,a.x,a.y+a.h-a.h/2),r.lineTo(a.x,a.y+a.h/2),r.quadraticCurveTo(a.x,a.y,a.x+a.h/2,a.y)):r.arc(a.x+a.w/2,a.y+a.h/2,a.h/2,0,2*Math.PI);r.fillStyle="rgba("+k.bgColor.r+","+k.bgColor.g+","+k.bgColor.b+","+a.o+")";r.fill();r.closePath();r.beginPath();r.stroke();r.fillStyle="rgba("+k.textColor.r+","+k.textColor.g+","+k.textColor.b+","+
a.o+")";"number"===typeof a.n&&999<a.n?r.fillText((9999<a.n?9:Math.floor(a.n/1E3))+"k+",Math.floor(a.x+a.w/2),Math.floor(a.y+a.h-.2*a.h)):r.fillText(a.n,Math.floor(a.x+a.w/2),Math.floor(a.y+a.h-.15*a.h));r.closePath()};M.rectangle=function(a){a=O(a);2===a.len?(a.x-=.4*a.w,a.w*=1.4):3<=a.len&&(a.x-=.65*a.w,a.w*=1.65);r.clearRect(0,0,t,n);r.drawImage(v,0,0,t,n);r.beginPath();r.font=k.fontStyle+" "+Math.floor(a.h*(99<a.n?.9:1))+"px "+k.fontFamily;r.textAlign="center";r.fillStyle="rgba("+k.bgColor.r+","+k.bgColor.g+","+k.bgColor.b+","+a.o+")";r.fillRect(a.x,a.y,a.w,a.h);r.fillStyle="rgba("+k.textColor.r+","+k.textColor.g+","+k.textColor.b+","+a.o+")";"number"===typeof a.n&&999<a.n?r.fillText((9999<a.n?9:Math.floor(a.n/1E3))+"k+",Math.floor(a.x+a.w/2),Math.floor(a.y+a.h-.2*a.h)):r.fillText(a.n,Math.floor(a.x+a.w/2),Math.floor(a.y+a.h-.15*a.h));r.closePath()};var N={getIcon:function(){var a=!1;if(k.element)a=k.element;else if(k.elementId)a=G.getElementById(k.elementId),a.setAttribute("href",a.getAttribute("src"));else{a:{for(var a=G.getElementsByTagName("head")[0].getElementsByTagName("link"),b=a.length-1;0<=b;b--)
if(/(^|\s)icon(\s|$)/i.test(a[b].getAttribute("rel"))){a=a[b];break a}
a=!1}!1===a&&(a=G.createElement("link"),a.setAttribute("rel","icon"),G.getElementsByTagName("head")[0].appendChild(a))}
a.setAttribute("type","image/png");return a},setIcon:function(a){a=a.toDataURL("image/png");k.dataUrl&&k.dataUrl(a);if(k.element)k.element.setAttribute("href",a),k.element.setAttribute("src",a);else if(k.elementId){var b=G.getElementById(k.elementId);b.setAttribute("href",a);b.setAttribute("src",a)}else d||e?(b=p,p=G.createElement("link"),e&&p.setAttribute("rel","icon"),p.setAttribute("rel","icon"),p.setAttribute("type","image/png"),G.getElementsByTagName("head")[0].appendChild(p),p.setAttribute("href",a),b.parentNode&&b.parentNode.removeChild(b)):p.setAttribute("href",a)}},P={duration:40,types:{}};P.types.fade=[{x:.4,y:.4,w:.6,h:.6,o:0},{x:.4,y:.4,w:.6,h:.6,o:.1},{x:.4,y:.4,w:.6,h:.6,o:.2},{x:.4,y:.4,w:.6,h:.6,o:.3},{x:.4,y:.4,w:.6,h:.6,o:.4},{x:.4,y:.4,w:.6,h:.6,o:.5},{x:.4,y:.4,w:.6,h:.6,o:.6},{x:.4,y:.4,w:.6,h:.6,o:.7},{x:.4,y:.4,w:.6,h:.6,o:.8},{x:.4,y:.4,w:.6,h:.6,o:.9},{x:.4,y:.4,w:.6,h:.6,o:1}];P.types.none=[{x:.4,y:.4,w:.6,h:.6,o:1}];P.types.pop=[{x:1,y:1,w:0,h:0,o:1},{x:.9,y:.9,w:.1,h:.1,o:1},{x:.8,y:.8,w:.2,h:.2,o:1},{x:.7,y:.7,w:.3,h:.3,o:1},{x:.6,y:.6,w:.4,h:.4,o:1},{x:.5,y:.5,w:.5,h:.5,o:1},{x:.4,y:.4,w:.6,h:.6,o:1}];P.types.popFade=[{x:.75,y:.75,w:0,h:0,o:0},{x:.65,y:.65,w:.1,h:.1,o:.2},{x:.6,y:.6,w:.2,h:.2,o:.4},{x:.55,y:.55,w:.3,h:.3,o:.6},{x:.5,y:.5,w:.4,h:.4,o:.8},{x:.45,y:.45,w:.5,h:.5,o:.9},{x:.4,y:.4,w:.6,h:.6,o:1}];P.types.slide=[{x:.4,y:1,w:.6,h:.6,o:1},{x:.4,y:.9,w:.6,h:.6,o:1},{x:.4,y:.9,w:.6,h:.6,o:1},{x:.4,y:.8,w:.6,h:.6,o:1},{x:.4,y:.7,w:.6,h:.6,o:1},{x:.4,y:.6,w:.6,h:.6,o:1},{x:.4,y:.5,w:.6,h:.6,o:1},{x:.4,y:.4,w:.6,h:.6,o:1}];P.run=function(a,b,c,d){var e=P.types[G.hidden||G.msHidden||G.webkitHidden||G.mozHidden?"none":k.animation];d=!0===c?"undefined"!==typeof d?d:e.length-
1:"undefined"!==typeof d?d:0;b=b?b:function(){};d<e.length&&0<=d?(M[k.type](l(a,e[d])),E=setTimeout(function(){d=c?d-1:d+1;P.run(a,b,c,d)},P.duration),N.setIcon(u)):b()};(function(){k=l(m,a);k.bgColor=h(k.bgColor);k.textColor=h(k.textColor);k.position=k.position.toLowerCase();k.animation=P.types[""+k.animation]?k.animation:m.animation;G=k.win.document;var c=-1<k.position.indexOf("up"),d=-1<k.position.indexOf("left");if(c||d)
for(var e in P.types)
for(var f=0;f<P.types[e].length;f++){var g=P.types[e][f];c&&(g.y=.6>g.y?g.y-.4:g.y-2*g.y+(1-g.w));d&&(g.x=.6>g.x?g.x-.4:g.x-2*g.x+(1-g.h));P.types[e][f]=g}
k.type=M[""+k.type]?k.type:m.type;p=N.getIcon();u=document.createElement("canvas");v=document.createElement("img");p.hasAttribute("href")?(v.setAttribute("crossOrigin","anonymous"),v.onload=function(){n=0<v.height?v.height:32;t=0<v.width?v.width:32;u.height=n;u.width=t;r=u.getContext("2d");J.ready()},v.setAttribute("src",p.getAttribute("href"))):(v.onload=function(){t=n=32;v.height=n;v.width=t;u.height=n;u.width=t;r=u.getContext("2d");J.ready()},v.setAttribute("src",""))})();return{badge:function(a,b){b=("string"===typeof b?{animation:b}:b)||{};y=function(){try{if("number"===typeof a?0<a:""!==a){var c={type:"badge",options:{n:a}};"animation"in b&&P.types[""+b.animation]&&(c.options.animation=""+b.animation);"type"in b&&M[""+b.type]&&(c.options.type=""+b.type);["bgColor","textColor"].forEach(function(a){a in b&&(c.options[a]=h(b[a]))});["fontStyle","fontFamily"].forEach(function(a){a in b&&(c.options[a]=b[a])});H.push(c);if(100<H.length)throw Error("Too many badges requests in queue.");J.start()}else J.reset()}catch(d){throw Error("Error setting badge. Message: "+d.message);}};w&&y()},video:function(a){y=function(){try{"stop"===a?(A=!0,J.reset(),A=!1):a.addEventListener("play",function(){g(this)},!1)}catch(b){throw Error("Error setting video. Message: "+b.message);}};w&&y()},image:function(a){y=function(){try{var b=a.width,c=a.height,d=document.createElement("img"),e=b/t<c/n?b/t:c/n;d.setAttribute("crossOrigin","anonymous");d.onload=function(){r.clearRect(0,0,t,n);r.drawImage(d,0,0,t,n);N.setIcon(u)};d.setAttribute("src",a.getAttribute("src"));d.height=c/e;d.width=b/e}catch(f){throw Error("Error setting image. Message: "+f.message);}};w&&y()},webcam:function(a){window.URL&&window.URL.createObjectURL||(window.URL=window.URL||{},window.URL.createObjectURL=function(a){return a});if(f){var b=!1;navigator.getUserMedia=navigator.getUserMedia||navigator.oGetUserMedia||navigator.msGetUserMedia||navigator.mozGetUserMedia||navigator.webkitGetUserMedia;y=function(){try{"stop"===a?(A=!0,J.reset(),A=!1):(b=document.createElement("video"),b.width=t,b.height=n,navigator.getUserMedia({video:!0,audio:!1},function(a){b.src=URL.createObjectURL(a);b.play();g(b)},function(){}))}catch(c){throw Error("Error setting webcam. Message: "+c.message);}};w&&y()}},reset:J.reset,browser:{supported:f}}};"undefined"!==typeof define&&define.amd?define([],function(){return a}):"undefined"!==typeof module&&module.exports?module.exports=a:this.Favico=a})();N.Map.Favico=Favico;N.Map.TitleAnimator=Ea;J=[];K=[];x["MessageNotifier.MessageNotifier"]={};x["MessageNotifier.MessageNotifier"].badge="on";x["MessageNotifier.MessageNotifier"].title="on";x["MessageNotifier.MessageNotifier"].title_message="New Message";x["MessageNotifier.MessageNotifier"].sound="on";M={};O={};n.Map[r]={parent:this,name:r,key:r,version:ka,templateData:la,themeData:ma,stages:J,dragin:K,uiSettings:M,uiMobileSettings:O,extension_position:null,elements:{},renderTemplate:function(){v.Map[this.name]={};k.Map[this.name]={};k.Map[this.name].InternalWindow={};k.Map[this.name].DragIn={};E.CreatedInternalWindows[this.name]={};if(this.extension_position)
for(var a in this.extension_position.Methods)Priority.setExecutePriority(this.key,this.extension_position.Methods[a]);for(a=0;a<this.stages.length;a++){var b={},d=null,c=null,e;e=this.language?this.language.templates[this.stages[a].extension]?this.language.templates[this.stages[a].extension].Stages[this.stages[a].stageName]:null:null;d=this.uiSettings[this.stages[a].stageName]?this.uiSettings[this.stages[a].stageName]:null;c=this.uiMobileSettings[this.stages[a].stageName]?this.uiMobileSettings[this.stages[a].stageName]:null;b["default"]=d;b.mobile=c;this.parent.isMobile.phone&&(this.stages[a].templateMobile&&(d=this.stages[a].template,c=this.stages[a].templateMobile,"clone"===this.stages[a].templateConfig.mobile&&(this.stages[a].template=h.extend(!0,d,c)),"separate"===this.stages[a].templateConfig.mobile&&(this.stages[a].template=c)),this.stages[a].themeMobile&&(d=this.stages[a].theme,c=this.stages[a].themeMobile,"clone"===this.stages[a].templateConfig.mobile&&(this.stages[a].theme=h.extend(!0,d,c)),"separate"===this.stages[a].templateConfig.mobile&&(this.stages[a].theme=c)));u.createRenderer(this.stages[a].extension,this.stages[a].stageName,this.stages[a].template,this.stages[a].templateName,this.stages[a].theme,b,this.stages[a].elements,null,e)}
return this.stages.length},renderDragInTemplate:function(){for(var a=0;a<this.dragin.length;a++){k.Map[this.key].DragIn[this.dragin[a].extension]={};for(var b in this.dragin[a].template){var d={},c=null,e=null,c=this.uiSettings[this.dragin[a].template[b]]?this.uiSettings[this.dragin[a].template[b]]:null,e=this.uiMobileSettings[this.dragin[a].template[b]]?this.uiMobileSettings[this.dragin[a].template[b]]:null;d["default"]=c;d.mobile=e;if(this.parent.isMobile.phone&&this.dragin[a].themeMobile){if(this.dragin[a].themeMobile[b])var f=this.dragin[a].theme[b];c=this.dragin[a].themeMobile[b];"clone"===this.dragin[a].templateConfig.mobile&&(this.dragin[a].theme[b]=h.extend(!0,f,c));"separate"===this.dragin[a].templateConfig.mobile&&(this.dragin[a].theme[b]=c)}
u.createRenderer(this.dragin[a].extension,b,this.dragin[a].template[b],this.dragin[a].templateName,this.dragin[a].theme[b],d,this.dragin[a].elements[b],"DragIn").DragInKey=this.key}}
return this.dragin.length},main:na,api:void 0};n.Map[r].language=null;r="Prestashop.CurrentCart";N.Map.Timer=aa;var ga={init:function(){},request:function(a,b){h.ajax(a,b)}};N.Map.HttpRequest=ga;J=[];K=[];x["Prestashop.CurrentCart"]={};x["Prestashop.CurrentCart"].current_cart_trigger="on";x["Prestashop.CurrentCart"].items_number="1";x["Prestashop.CurrentCart"].auto_assign="on";x["Prestashop.CurrentCart"].send_message="off";x["Prestashop.CurrentCart"].message="Let me know if you have any questions about your order";x["Prestashop.CurrentCart"].delay="10";M={};O={};n.Map[r]={parent:this,name:r,key:r,version:"1.0.0",templateData:"",themeData:"",stages:J,dragin:K,uiSettings:M,uiMobileSettings:O,extension_position:null,elements:{},renderTemplate:function(){v.Map[this.name]={};k.Map[this.name]={};k.Map[this.name].InternalWindow={};k.Map[this.name].DragIn={};E.CreatedInternalWindows[this.name]={};if(this.extension_position)
for(var a in this.extension_position.Methods)Priority.setExecutePriority(this.key,this.extension_position.Methods[a]);for(a=0;a<this.stages.length;a++){var b={},d=null,c=null,e;e=this.language?this.language.templates[this.stages[a].extension]?this.language.templates[this.stages[a].extension].Stages[this.stages[a].stageName]:null:null;d=this.uiSettings[this.stages[a].stageName]?this.uiSettings[this.stages[a].stageName]:null;c=this.uiMobileSettings[this.stages[a].stageName]?this.uiMobileSettings[this.stages[a].stageName]:null;b["default"]=d;b.mobile=c;this.parent.isMobile.phone&&(this.stages[a].templateMobile&&(d=this.stages[a].template,c=this.stages[a].templateMobile,"clone"===this.stages[a].templateConfig.mobile&&(this.stages[a].template=h.extend(!0,d,c)),"separate"===this.stages[a].templateConfig.mobile&&(this.stages[a].template=c)),this.stages[a].themeMobile&&(d=this.stages[a].theme,c=this.stages[a].themeMobile,"clone"===this.stages[a].templateConfig.mobile&&(this.stages[a].theme=h.extend(!0,d,c)),"separate"===this.stages[a].templateConfig.mobile&&(this.stages[a].theme=c)));u.createRenderer(this.stages[a].extension,this.stages[a].stageName,this.stages[a].template,this.stages[a].templateName,this.stages[a].theme,b,this.stages[a].elements,null,e)}
return this.stages.length},renderDragInTemplate:function(){for(var a=0;a<this.dragin.length;a++){k.Map[this.key].DragIn[this.dragin[a].extension]={};for(var b in this.dragin[a].template){var d={},c=null,e=null,c=this.uiSettings[this.dragin[a].template[b]]?this.uiSettings[this.dragin[a].template[b]]:null,e=this.uiMobileSettings[this.dragin[a].template[b]]?this.uiMobileSettings[this.dragin[a].template[b]]:null;d["default"]=c;d.mobile=e;if(this.parent.isMobile.phone&&this.dragin[a].themeMobile){if(this.dragin[a].themeMobile[b])var f=this.dragin[a].theme[b];c=this.dragin[a].themeMobile[b];"clone"===this.dragin[a].templateConfig.mobile&&(this.dragin[a].theme[b]=h.extend(!0,f,c));"separate"===this.dragin[a].templateConfig.mobile&&(this.dragin[a].theme[b]=c)}
u.createRenderer(this.dragin[a].extension,b,this.dragin[a].template[b],this.dragin[a].templateName,this.dragin[a].theme[b],d,this.dragin[a].elements[b],"DragIn").DragInKey=this.key}}
return this.dragin.length},main:function(){function a(){if("on"==g){var a=m.getGeneralValue({key:b,name:"currentCartTriggerSent",type:"session"});"yes"!=a&&aa.schedule(function(){a=m.getGeneralValue({key:b,name:"currentCartTriggerSent",type:"session"});"yes"==a||"available"!==H.getStage()&&"available_conversation"!==H.getStage()||(a=m.setGeneralValue({key:b,name:"currentCartTriggerSent",type:"session",value:"yes"}),"on"==g&&w.receiveMessage(h))},e)}}
var b=this.key,d=x[b].current_cart_trigger,c=parseInt(x[b].items_number),e=1E3*parseInt(x[b].delay),f=x[b].auto_assign,g=x[b].send_message,h=x[b].message,l=m.getGeneralValue({key:b,name:"currentCartTemp",type:"session"});l||(l="");var k=fa.get("baseDir");if(!k){var n=fa.get("prestashop");n&&n.urls&&(k=n.urls.base_url)}
aa.schedule(function(){("available"===H.getStage()||"available_conversation"===H.getStage())&&k&&p.master&&ga.request(k+"?fc\x3dmodule\x26module\x3dhubtalk\x26controller\x3dcart",{dataType:"json",cache:!1,success:function(e){var g=e.cart;"on"==d&&g.length>=c&&("available"===H.getStage()||"available_conversation"===H.getStage())&&("on"==f&&(p.operatorName||w.requestOperator(),p.operatorName&&l!=JSON.stringify(g)&&(w.sendTimelineMessage({key:b,type:"private"},JSON.stringify(g)),l=JSON.stringify(g),m.setGeneralValue({key:b,name:"currentCartTemp",type:"session",value:l}))),a());w.sendCustomMessage({key:b,type:"private"},JSON.stringify(e.cart));t.propagate({name:"CartUpdated",key:b,value:JSON.stringify(e.cart)})}})},1E4,!0);t.on({name:"CartUpdated",key:b,namespace:"CartUpdated",main:function(a,c){p.master&&(JSON.parse(c),w.sendCustomMessage({key:b,type:"private"},c))}})},api:void 0};n.Map[r].language=null;r="Prestashop.LoggedInCustomer";N.Map.HttpRequest=ga;J=[];K=[];M={};O={};n.Map[r]={parent:this,name:r,key:r,version:"1.0.0",templateData:"",themeData:"",stages:J,dragin:K,uiSettings:M,uiMobileSettings:O,extension_position:null,elements:{},renderTemplate:function(){v.Map[this.name]={};k.Map[this.name]={};k.Map[this.name].InternalWindow={};k.Map[this.name].DragIn={};E.CreatedInternalWindows[this.name]={};if(this.extension_position)
for(var a in this.extension_position.Methods)Priority.setExecutePriority(this.key,this.extension_position.Methods[a]);for(a=0;a<this.stages.length;a++){var b={},d=null,c=null,e;e=this.language?this.language.templates[this.stages[a].extension]?this.language.templates[this.stages[a].extension].Stages[this.stages[a].stageName]:null:null;d=this.uiSettings[this.stages[a].stageName]?this.uiSettings[this.stages[a].stageName]:null;c=this.uiMobileSettings[this.stages[a].stageName]?this.uiMobileSettings[this.stages[a].stageName]:null;b["default"]=d;b.mobile=c;this.parent.isMobile.phone&&(this.stages[a].templateMobile&&(d=this.stages[a].template,c=this.stages[a].templateMobile,"clone"===this.stages[a].templateConfig.mobile&&(this.stages[a].template=h.extend(!0,d,c)),"separate"===this.stages[a].templateConfig.mobile&&(this.stages[a].template=c)),this.stages[a].themeMobile&&(d=this.stages[a].theme,c=this.stages[a].themeMobile,"clone"===this.stages[a].templateConfig.mobile&&(this.stages[a].theme=h.extend(!0,d,c)),"separate"===this.stages[a].templateConfig.mobile&&(this.stages[a].theme=c)));u.createRenderer(this.stages[a].extension,this.stages[a].stageName,this.stages[a].template,this.stages[a].templateName,this.stages[a].theme,b,this.stages[a].elements,null,e)}
return this.stages.length},renderDragInTemplate:function(){for(var a=0;a<this.dragin.length;a++){k.Map[this.key].DragIn[this.dragin[a].extension]={};for(var b in this.dragin[a].template){var d={},c=null,e=null,c=this.uiSettings[this.dragin[a].template[b]]?this.uiSettings[this.dragin[a].template[b]]:null,e=this.uiMobileSettings[this.dragin[a].template[b]]?this.uiMobileSettings[this.dragin[a].template[b]]:null;d["default"]=c;d.mobile=e;if(this.parent.isMobile.phone&&this.dragin[a].themeMobile){if(this.dragin[a].themeMobile[b])var f=this.dragin[a].theme[b];c=this.dragin[a].themeMobile[b];"clone"===this.dragin[a].templateConfig.mobile&&(this.dragin[a].theme[b]=h.extend(!0,f,c));"separate"===this.dragin[a].templateConfig.mobile&&(this.dragin[a].theme[b]=c)}
u.createRenderer(this.dragin[a].extension,b,this.dragin[a].template[b],this.dragin[a].templateName,this.dragin[a].theme[b],d,this.dragin[a].elements[b],"DragIn").DragInKey=this.key}}
return this.dragin.length},main:function(){function a(){p.operatorName&&d&&p.master&&ga.request(d+"?fc\x3dmodule\x26module\x3dhubtalk\x26controller\x3dcustomer",{dataType:"json",cache:!1,success:function(a){""!==a.name&&(w.changeNick(a.name),m.setGeneralValue({key:b,name:"nickHasChanged",value:"yes",type:"session"}),m.setGeneralValue("nickHasChanged","yes"))}})}
var b=this.key,d=fa.get("baseDir");if(!d){var c=fa.get("prestashop");c&&c.urls&&(d=c.urls.base_url)}
var e=m.getGeneralValue({key:b,name:"nickHasChanged",type:"session"});y.connect({eventAction:"onAssignOperator",channel:{key:b,type:"public"},group:"Network",when:"after",namespace:"onAssignOperator",main:function(b){p.master&&"yes"!==e&&a()}});y.connect({eventAction:"onOperatorChangedConnector",channel:{key:b,type:"public"},when:"after",group:"Network",namespace:"changedConnector",main:function(b){""===b.error&&a()}})},api:void 0};n.Map[r].language=null;r="Prestashop.OrdersHistory";N.Map.HttpRequest=ga;J=[];K=[];M={};O={};n.Map[r]={parent:this,name:r,key:r,version:"1.0.0",templateData:"",themeData:"",stages:J,dragin:K,uiSettings:M,uiMobileSettings:O,extension_position:null,elements:{},renderTemplate:function(){v.Map[this.name]={};k.Map[this.name]={};k.Map[this.name].InternalWindow={};k.Map[this.name].DragIn={};E.CreatedInternalWindows[this.name]={};if(this.extension_position)
for(var a in this.extension_position.Methods)Priority.setExecutePriority(this.key,this.extension_position.Methods[a]);for(a=0;a<this.stages.length;a++){var b={},d=null,c=null,e;e=this.language?this.language.templates[this.stages[a].extension]?this.language.templates[this.stages[a].extension].Stages[this.stages[a].stageName]:null:null;d=this.uiSettings[this.stages[a].stageName]?this.uiSettings[this.stages[a].stageName]:null;c=this.uiMobileSettings[this.stages[a].stageName]?this.uiMobileSettings[this.stages[a].stageName]:null;b["default"]=d;b.mobile=c;this.parent.isMobile.phone&&(this.stages[a].templateMobile&&(d=this.stages[a].template,c=this.stages[a].templateMobile,"clone"===this.stages[a].templateConfig.mobile&&(this.stages[a].template=h.extend(!0,d,c)),"separate"===this.stages[a].templateConfig.mobile&&(this.stages[a].template=c)),this.stages[a].themeMobile&&(d=this.stages[a].theme,c=this.stages[a].themeMobile,"clone"===this.stages[a].templateConfig.mobile&&(this.stages[a].theme=h.extend(!0,d,c)),"separate"===this.stages[a].templateConfig.mobile&&(this.stages[a].theme=c)));u.createRenderer(this.stages[a].extension,this.stages[a].stageName,this.stages[a].template,this.stages[a].templateName,this.stages[a].theme,b,this.stages[a].elements,null,e)}
return this.stages.length},renderDragInTemplate:function(){for(var a=0;a<this.dragin.length;a++){k.Map[this.key].DragIn[this.dragin[a].extension]={};for(var b in this.dragin[a].template){var d={},c=null,e=null,c=this.uiSettings[this.dragin[a].template[b]]?this.uiSettings[this.dragin[a].template[b]]:null,e=this.uiMobileSettings[this.dragin[a].template[b]]?this.uiMobileSettings[this.dragin[a].template[b]]:null;d["default"]=c;d.mobile=e;if(this.parent.isMobile.phone&&this.dragin[a].themeMobile){if(this.dragin[a].themeMobile[b])var f=this.dragin[a].theme[b];c=this.dragin[a].themeMobile[b];"clone"===this.dragin[a].templateConfig.mobile&&(this.dragin[a].theme[b]=h.extend(!0,f,c));"separate"===this.dragin[a].templateConfig.mobile&&(this.dragin[a].theme[b]=c)}
u.createRenderer(this.dragin[a].extension,b,this.dragin[a].template[b],this.dragin[a].templateName,this.dragin[a].theme[b],d,this.dragin[a].elements[b],"DragIn").DragInKey=this.key}}
return this.dragin.length},main:function(){function a(){p.operatorName&&d&&p.master&&ga.request(d+"?fc\x3dmodule\x26module\x3dhubtalk\x26controller\x3dorderslog",{dataType:"json",cache:!1,success:function(a){w.sendCustomMessage({key:b,type:"private"},JSON.stringify(a))}})}
var b=this.key,d=fa.get("baseDir");if(!d){var c=fa.get("prestashop");c&&c.urls&&(d=c.urls.base_url)}
y.connect({eventAction:"onAssignOperator",channel:{key:b,type:"public"},group:"Network",when:"after",namespace:"onAssignOperator",main:function(b){p.master&&a()}});y.connect({eventAction:"onOperatorChangedConnector",channel:{key:b,type:"public"},when:"after",group:"Network",namespace:"changedConnector",main:function(b){""===b.error&&a()}})},api:void 0};n.Map[r].language=null;r="Prestashop.ProductManager";N.Map.HttpRequest=ga;J=[];K=[];M={};O={};n.Map[r]={parent:this,name:r,key:r,version:"1.0.0",templateData:"",themeData:"",stages:J,dragin:K,uiSettings:M,uiMobileSettings:O,extension_position:null,elements:{},renderTemplate:function(){v.Map[this.name]={};k.Map[this.name]={};k.Map[this.name].InternalWindow={};k.Map[this.name].DragIn={};E.CreatedInternalWindows[this.name]={};if(this.extension_position)
for(var a in this.extension_position.Methods)Priority.setExecutePriority(this.key,this.extension_position.Methods[a]);for(a=0;a<this.stages.length;a++){var b={},d=null,c=null,e;e=this.language?this.language.templates[this.stages[a].extension]?this.language.templates[this.stages[a].extension].Stages[this.stages[a].stageName]:null:null;d=this.uiSettings[this.stages[a].stageName]?this.uiSettings[this.stages[a].stageName]:null;c=this.uiMobileSettings[this.stages[a].stageName]?this.uiMobileSettings[this.stages[a].stageName]:null;b["default"]=d;b.mobile=c;this.parent.isMobile.phone&&(this.stages[a].templateMobile&&(d=this.stages[a].template,c=this.stages[a].templateMobile,"clone"===this.stages[a].templateConfig.mobile&&(this.stages[a].template=h.extend(!0,d,c)),"separate"===this.stages[a].templateConfig.mobile&&(this.stages[a].template=c)),this.stages[a].themeMobile&&(d=this.stages[a].theme,c=this.stages[a].themeMobile,"clone"===this.stages[a].templateConfig.mobile&&(this.stages[a].theme=h.extend(!0,d,c)),"separate"===this.stages[a].templateConfig.mobile&&(this.stages[a].theme=c)));u.createRenderer(this.stages[a].extension,this.stages[a].stageName,this.stages[a].template,this.stages[a].templateName,this.stages[a].theme,b,this.stages[a].elements,null,e)}
return this.stages.length},renderDragInTemplate:function(){for(var a=0;a<this.dragin.length;a++){k.Map[this.key].DragIn[this.dragin[a].extension]={};for(var b in this.dragin[a].template){var d={},c=null,e=null,c=this.uiSettings[this.dragin[a].template[b]]?this.uiSettings[this.dragin[a].template[b]]:null,e=this.uiMobileSettings[this.dragin[a].template[b]]?this.uiMobileSettings[this.dragin[a].template[b]]:null;d["default"]=c;d.mobile=e;if(this.parent.isMobile.phone&&this.dragin[a].themeMobile){if(this.dragin[a].themeMobile[b])var f=this.dragin[a].theme[b];c=this.dragin[a].themeMobile[b];"clone"===this.dragin[a].templateConfig.mobile&&(this.dragin[a].theme[b]=h.extend(!0,f,c));"separate"===this.dragin[a].templateConfig.mobile&&(this.dragin[a].theme[b]=c)}
u.createRenderer(this.dragin[a].extension,b,this.dragin[a].template[b],this.dragin[a].templateName,this.dragin[a].theme[b],d,this.dragin[a].elements[b],"DragIn").DragInKey=this.key}}
return this.dragin.length},main:function(){function a(a){p.operatorName&&d&&p.master&&ga.request(d+"?fc\x3dmodule\x26module\x3dhubtalk\x26controller\x3dsearch",{dataType:"json",cache:!1,type:"POST",data:{q:a},success:function(a){w.sendCustomMessage({key:b,type:"private"},JSON.stringify(a))}})}
var b=this.key,d=fa.get("baseDir");if(!d){var c=fa.get("prestashop");c&&c.urls&&(d=c.urls.base_url)}
y.connect({eventAction:"onReceivingCustomMessage",channel:{key:b,type:"private"},when:"after",group:"Network",namespace:"searchItem",main:function(b,c){""===b.error&&a(b.object.message.message)}})},api:void 0};n.Map[r].language=null;r="Prestashop.ViewedProducts";N.Map.HttpRequest=ga;J=[];K=[];M={};O={};n.Map[r]={parent:this,name:r,key:r,version:"1.0.0",templateData:"",themeData:"",stages:J,dragin:K,uiSettings:M,uiMobileSettings:O,extension_position:null,elements:{},renderTemplate:function(){v.Map[this.name]={};k.Map[this.name]={};k.Map[this.name].InternalWindow={};k.Map[this.name].DragIn={};E.CreatedInternalWindows[this.name]={};if(this.extension_position)
for(var a in this.extension_position.Methods)Priority.setExecutePriority(this.key,this.extension_position.Methods[a]);for(a=0;a<this.stages.length;a++){var b={},d=null,c=null,e;e=this.language?this.language.templates[this.stages[a].extension]?this.language.templates[this.stages[a].extension].Stages[this.stages[a].stageName]:null:null;d=this.uiSettings[this.stages[a].stageName]?this.uiSettings[this.stages[a].stageName]:null;c=this.uiMobileSettings[this.stages[a].stageName]?this.uiMobileSettings[this.stages[a].stageName]:null;b["default"]=d;b.mobile=c;this.parent.isMobile.phone&&(this.stages[a].templateMobile&&(d=this.stages[a].template,c=this.stages[a].templateMobile,"clone"===this.stages[a].templateConfig.mobile&&(this.stages[a].template=h.extend(!0,d,c)),"separate"===this.stages[a].templateConfig.mobile&&(this.stages[a].template=c)),this.stages[a].themeMobile&&(d=this.stages[a].theme,c=this.stages[a].themeMobile,"clone"===this.stages[a].templateConfig.mobile&&(this.stages[a].theme=h.extend(!0,d,c)),"separate"===this.stages[a].templateConfig.mobile&&(this.stages[a].theme=c)));u.createRenderer(this.stages[a].extension,this.stages[a].stageName,this.stages[a].template,this.stages[a].templateName,this.stages[a].theme,b,this.stages[a].elements,null,e)}
return this.stages.length},renderDragInTemplate:function(){for(var a=0;a<this.dragin.length;a++){k.Map[this.key].DragIn[this.dragin[a].extension]={};for(var b in this.dragin[a].template){var d={},c=null,e=null,c=this.uiSettings[this.dragin[a].template[b]]?this.uiSettings[this.dragin[a].template[b]]:null,e=this.uiMobileSettings[this.dragin[a].template[b]]?this.uiMobileSettings[this.dragin[a].template[b]]:null;d["default"]=c;d.mobile=e;if(this.parent.isMobile.phone&&this.dragin[a].themeMobile){if(this.dragin[a].themeMobile[b])var f=this.dragin[a].theme[b];c=this.dragin[a].themeMobile[b];"clone"===this.dragin[a].templateConfig.mobile&&(this.dragin[a].theme[b]=h.extend(!0,f,c));"separate"===this.dragin[a].templateConfig.mobile&&(this.dragin[a].theme[b]=c)}
u.createRenderer(this.dragin[a].extension,b,this.dragin[a].template[b],this.dragin[a].templateName,this.dragin[a].theme[b],d,this.dragin[a].elements[b],"DragIn").DragInKey=this.key}}
return this.dragin.length},main:function(){function a(a){d&&ga.request(d+"?fc\x3dmodule\x26module\x3dhubtalk\x26controller\x3dproduct",{dataType:"json",cache:!1,type:"POST",data:{p_id:a},success:function(a){try{"object"==typeof a&&(a.url=window.location.href),f=JSON.parse(m.getGeneralValue({type:"permanent",key:b,name:"products_map"})),f.last_update=Date.now(),f.map.push(a),m.setGeneralValue({type:"permanent",key:b,name:"products_map",value:JSON.stringify(f)})}catch(c){}}})}
Date.now||(Date.now=function(){return(new Date).getTime()});var b=this.key,d=fa.get("baseDir");if(!d){var c=fa.get("prestashop");c&&c.urls&&(d=c.urls.base_url)}
var e=h("#product_page_product_id").val(),f=m.getGeneralValue({type:"permanent",key:b,name:"products_map"});f?(c=JSON.parse(f),c.last_update&&864E5<Date.now()-c.last_update&&m.setGeneralValue({type:"permanent",key:b,name:"products_map",value:JSON.stringify({last_update:Date.now(),map:[]})})):(m.setGeneralValue({type:"permanent",key:b,name:"products_map",value:JSON.stringify({last_update:Date.now(),map:[]})}),f=m.getGeneralValue({type:"permanent",key:b,name:"products_map"}));e&&a(e);setInterval(function(){try{var c=e;(e=h("#product_page_product_id").val())&&e!=c&&a(e);if(p.operatorName&&p.master){var d=m.getGeneralValue({type:"permanent",key:b,name:"products_map"});if(d!=f){f=d;var k=JSON.parse(d);w.sendCustomMessage({key:b,type:"private"},JSON.stringify(k.map))}}}catch(n){}},3E3);y.connect({eventAction:"onAssignOperator",channel:{key:b,type:"public"},group:"Network",when:"after",namespace:"onAssignOperator",main:function(a){p.master&&(a=m.getGeneralValue({type:"permanent",key:b,name:"products_map"}),a=JSON.parse(a),w.sendCustomMessage({key:b,type:"private"},JSON.stringify(a.map)))}});y.connect({eventAction:"onOperatorChangedConnector",channel:{key:b,type:"public"},when:"after",group:"Network",namespace:"changedConnector",main:function(a){""===a.error&&p.master&&(a=m.getGeneralValue({type:"permanent",key:b,name:"products_map"}),a=JSON.parse(a),w.sendCustomMessage({key:b,type:"private"},JSON.stringify(a.map)))}})},api:void 0};n.Map[r].language=null;za.init();ca.applyJQuery();x["Chat.chat"]&&x["Chat.chat"].visitor_name&&(p.clientNick=x["Chat.chat"].visitor_name+Math.floor(1E4*Math.random()))}
var w23ef3ab515dc2928d4f66183a6d09a0c="object"===typeof w23ef3ab515dc2928d4f66183a6d09a0c?new fw23ef3ab515dc2928d4f66183a6d09a0c(w23ef3ab515dc2928d4f66183a6d09a0c.config):new fw23ef3ab515dc2928d4f66183a6d09a0c;w23ef3ab515dc2928d4f66183a6d09a0c.run();;jQuery(document).ready(function(){for(var a=document.getElementsByTagName("script"),b="",c=0;c<a.length;c++)a[c].src&&a[c].src.match(/initslider-1\.js/i)&&(b=a[c].src.substr(0,a[c].src.lastIndexOf("/")+1));jQuery("#amazingslider-1").amazingslider({jsfolder:b,width:980,height:400,skinsfoldername:"",loadimageondemand:!1,isresponsive:!1,autoplayvideo:!1,pauseonmouseover:!1,addmargin:!0,randomplay:!1,slideinterval:1e4,enabletouchswipe:!0,transitiononfirstslide:!1,loop:0,autoplay:!0,navplayvideoimage:"../../img/play-32-32-0.png",navpreviewheight:60,timerheight:0,shownumbering:!1,skin:"Classic",addgooglefonts:!0,navshowplaypause:!0,navshowplayvideo:!0,navshowplaypausestandalonemarginx:8,navshowplaypausestandalonemarginy:8,navbuttonradius:0,navthumbnavigationarrowimageheight:32,navmarginy:16,showshadow:!1,navfeaturedarrowimagewidth:16,navpreviewwidth:120,googlefonts:"Inder",textpositionmarginright:24,bordercolor:"#ffffff",navthumbnavigationarrowimagewidth:32,navthumbtitlehovercss:"text-decoration:underline;",navcolor:"#999999",arrowwidth:32,texteffecteasing:"easeOutCubic",texteffect:"fade",navspacing:8,playvideoimage:"../../img/playvideo-64-64-0.png",ribbonimage:"../../img/ribbon_topleft-0.png",navwidth:24,showribbon:!1,arrowimage:"../../img/arrows-32-32-0.png",timeropacity:.6,navthumbnavigationarrowimage:"../../img/carouselarrows-32-32-0.png",navshowplaypausestandalone:!1,navpreviewbordercolor:"#ffffff",ribbonposition:"topleft",navthumbdescriptioncss:"display:block;position:relative;padding:2px 4px;text-align:left;font:normal 12px Arial,Helvetica,sans-serif;color:#333;",arrowstyle:"mouseover",navthumbtitleheight:20,textpositionmargintop:24,navswitchonmouseover:!1,navarrowimage:"../../img/navarrows-28-28-0.png",arrowtop:50,textstyle:"static",playvideoimageheight:64,navfonthighlightcolor:"#666666",showbackgroundimage:!1,navpreviewborder:4,navopacity:.8,shadowcolor:"#aaaaaa",navbuttonshowbgimage:!0,navbuttonbgimage:"../../img/navbuttonbgimage-28-28-0.png",textbgcss:"display:block; position:absolute; top:0px; left:0px; width:100%; height:100%; background-color:#333333; opacity:0.6; filter:alpha(opacity=60);",navdirection:"horizontal",navborder:4,bottomshadowimagewidth:110,showtimer:!1,navradius:0,navshowpreview:!0,navpreviewarrowheight:8,navmarginx:16,navfeaturedarrowimage:"../../img/featuredarrow-16-8-0.png",navfeaturedarrowimageheight:8,navstyle:"none",textpositionmarginleft:24,descriptioncss:"display:block; position:relative; margin-top:4px; font:14px Inder,Arial,Tahoma,Helvetica,sans-serif; color:#fff;",navplaypauseimage:"../../img/navplaypause-28-28-0.png",backgroundimagetop:-10,timercolor:"#fff",numberingformat:"%NUM/%TOTAL ",navfontsize:12,navhighlightcolor:"#333333",navimage:"../../img/bullet-24-24-0.png",navheight:24,navshowplaypausestandaloneautohide:!1,navbuttoncolor:"#999999",navshowarrow:!0,navshowfeaturedarrow:!1,titlecss:"display:block; position:relative; font:16px Inder,Arial,Tahoma,Helvetica,sans-serif; color:#fff;",navshowplaypausestandaloneposition:"bottomright",shadowsize:5,arrowhideonmouseleave:1e3,navshowplaypausestandalonewidth:28,navshowplaypausestandaloneheight:28,backgroundimagewidth:120,textautohide:!0,navthumbtitlewidth:120,navpreviewposition:"top",playvideoimagewidth:64,arrowheight:32,arrowmargin:8,texteffectduration:1e3,bottomshadowimage:"../../img/bottomshadow-110-95-0.png",border:0,timerposition:"bottom",navfontcolor:"#333333",navthumbnavigationstyle:"arrow",borderradius:0,navbuttonhighlightcolor:"#333333",textpositionstatic:"bottom",navthumbstyle:"imageonly",textcss:"display:block; padding:12px; text-align:left;",navbordercolor:"#ffffff",navpreviewarrowimage:"../../img/previewarrow-16-8-0.png",showbottomshadow:!1,textpositionmarginstatic:0,backgroundimage:"",navposition:"bottom",navpreviewarrowwidth:16,bottomshadowimagetop:95,textpositiondynamic:"bottomleft",navshowbuttons:!1,navthumbtitlecss:"display:block;position:relative;padding:2px 4px;text-align:left;font:bold 14px Arial,Helvetica,sans-serif;color:#333;",textpositionmarginbottom:24,ribbonmarginy:0,ribbonmarginx:0,threed:{checked:!0,bgcolor:"#222222",perspective:1e3,slicecount:5,duration:1500,easing:"easeOutCubic",fallback:"slice",scatter:5,perspectiveorigin:"right"},transition:"threed"})});/*!
* jQuery Cycle2; version: 2.1.6 build: 20141007
* http://jquery.malsup.com/cycle2/
* Copyright (c) 2014 M. Alsup; Dual licensed: MIT/GPL
*/
!function(a){"use strict";function b(a){return(a||"").toLowerCase()}var c="2.1.6";a.fn.cycle=function(c){var d;return 0!==this.length||a.isReady?this.each(function(){var d,e,f,g,h=a(this),i=a.fn.cycle.log;if(!h.data("cycle.opts")){(h.data("cycle-log")===!1||c&&c.log===!1||e&&e.log===!1)&&(i=a.noop),i("--c2 init--"),d=h.data();for(var j in d)d.hasOwnProperty(j)&&/^cycle[A-Z]+/.test(j)&&(g=d[j],f=j.match(/^cycle(.*)/)[1].replace(/^[A-Z]/,b),i(f+":",g,"("+typeof g+")"),d[f]=g);e=a.extend({},a.fn.cycle.defaults,d,c||{}),e.timeoutId=0,e.paused=e.paused||!1,e.container=h,e._maxZ=e.maxZ,e.API=a.extend({_container:h},a.fn.cycle.API),e.API.log=i,e.API.trigger=function(a,b){return e.container.trigger(a,b),e.API},h.data("cycle.opts",e),h.data("cycle.API",e.API),e.API.trigger("cycle-bootstrap",[e,e.API]),e.API.addInitialSlides(),e.API.preInitSlideshow(),e.slides.length&&e.API.initSlideshow()}}):(d={s:this.selector,c:this.context},a.fn.cycle.log("requeuing slideshow (dom not ready)"),a(function(){a(d.s,d.c).cycle(c)}),this)},a.fn.cycle.API={opts:function(){return this._container.data("cycle.opts")},addInitialSlides:function(){var b=this.opts(),c=b.slides;b.slideCount=0,b.slides=a(),c=c.jquery?c:b.container.find(c),b.random&&c.sort(function(){return Math.random()-.5}),b.API.add(c)},preInitSlideshow:function(){var b=this.opts();b.API.trigger("cycle-pre-initialize",[b]);var c=a.fn.cycle.transitions[b.fx];c&&a.isFunction(c.preInit)&&c.preInit(b),b._preInitialized=!0},postInitSlideshow:function(){var b=this.opts();b.API.trigger("cycle-post-initialize",[b]);var c=a.fn.cycle.transitions[b.fx];c&&a.isFunction(c.postInit)&&c.postInit(b)},initSlideshow:function(){var b,c=this.opts(),d=c.container;c.API.calcFirstSlide(),"static"==c.container.css("position")&&c.container.css("position","relative"),a(c.slides[c.currSlide]).css({opacity:1,display:"block",visibility:"visible"}),c.API.stackSlides(c.slides[c.currSlide],c.slides[c.nextSlide],!c.reverse),c.pauseOnHover&&(c.pauseOnHover!==!0&&(d=a(c.pauseOnHover)),d.hover(function(){c.API.pause(!0)},function(){c.API.resume(!0)})),c.timeout&&(b=c.API.getSlideOpts(c.currSlide),c.API.queueTransition(b,b.timeout+c.delay)),c._initialized=!0,c.API.updateView(!0),c.API.trigger("cycle-initialized",[c]),c.API.postInitSlideshow()},pause:function(b){var c=this.opts(),d=c.API.getSlideOpts(),e=c.hoverPaused||c.paused;b?c.hoverPaused=!0:c.paused=!0,e||(c.container.addClass("cycle-paused"),c.API.trigger("cycle-paused",[c]).log("cycle-paused"),d.timeout&&(clearTimeout(c.timeoutId),c.timeoutId=0,c._remainingTimeout-=a.now()-c._lastQueue,(c._remainingTimeout<0||isNaN(c._remainingTimeout))&&(c._remainingTimeout=void 0)))},resume:function(a){var b=this.opts(),c=!b.hoverPaused&&!b.paused;a?b.hoverPaused=!1:b.paused=!1,c||(b.container.removeClass("cycle-paused"),0===b.slides.filter(":animated").length&&b.API.queueTransition(b.API.getSlideOpts(),b._remainingTimeout),b.API.trigger("cycle-resumed",[b,b._remainingTimeout]).log("cycle-resumed"))},add:function(b,c){var d,e=this.opts(),f=e.slideCount,g=!1;"string"==a.type(b)&&(b=a.trim(b)),a(b).each(function(){var b,d=a(this);c?e.container.prepend(d):e.container.append(d),e.slideCount++,b=e.API.buildSlideOpts(d),e.slides=c?a(d).add(e.slides):e.slides.add(d),e.API.initSlide(b,d,--e._maxZ),d.data("cycle.opts",b),e.API.trigger("cycle-slide-added",[e,b,d])}),e.API.updateView(!0),g=e._preInitialized&&2>f&&e.slideCount>=1,g&&(e._initialized?e.timeout&&(d=e.slides.length,e.nextSlide=e.reverse?d-1:1,e.timeoutId||e.API.queueTransition(e)):e.API.initSlideshow())},calcFirstSlide:function(){var a,b=this.opts();a=parseInt(b.startingSlide||0,10),(a>=b.slides.length||0>a)&&(a=0),b.currSlide=a,b.reverse?(b.nextSlide=a-1,b.nextSlide<0&&(b.nextSlide=b.slides.length-1)):(b.nextSlide=a+1,b.nextSlide==b.slides.length&&(b.nextSlide=0))},calcNextSlide:function(){var a,b=this.opts();b.reverse?(a=b.nextSlide-1<0,b.nextSlide=a?b.slideCount-1:b.nextSlide-1,b.currSlide=a?0:b.nextSlide+1):(a=b.nextSlide+1==b.slides.length,b.nextSlide=a?0:b.nextSlide+1,b.currSlide=a?b.slides.length-1:b.nextSlide-1)},calcTx:function(b,c){var d,e=b;return e._tempFx?d=a.fn.cycle.transitions[e._tempFx]:c&&e.manualFx&&(d=a.fn.cycle.transitions[e.manualFx]),d||(d=a.fn.cycle.transitions[e.fx]),e._tempFx=null,this.opts()._tempFx=null,d||(d=a.fn.cycle.transitions.fade,e.API.log('Transition "'+e.fx+'" not found.  Using fade.')),d},prepareTx:function(a,b){var c,d,e,f,g,h=this.opts();return h.slideCount<2?void(h.timeoutId=0):(!a||h.busy&&!h.manualTrump||(h.API.stopTransition(),h.busy=!1,clearTimeout(h.timeoutId),h.timeoutId=0),void(h.busy||(0!==h.timeoutId||a)&&(d=h.slides[h.currSlide],e=h.slides[h.nextSlide],f=h.API.getSlideOpts(h.nextSlide),g=h.API.calcTx(f,a),h._tx=g,a&&void 0!==f.manualSpeed&&(f.speed=f.manualSpeed),h.nextSlide!=h.currSlide&&(a||!h.paused&&!h.hoverPaused&&h.timeout)?(h.API.trigger("cycle-before",[f,d,e,b]),g.before&&g.before(f,d,e,b),c=function(){h.busy=!1,h.container.data("cycle.opts")&&(g.after&&g.after(f,d,e,b),h.API.trigger("cycle-after",[f,d,e,b]),h.API.queueTransition(f),h.API.updateView(!0))},h.busy=!0,g.transition?g.transition(f,d,e,b,c):h.API.doTransition(f,d,e,b,c),h.API.calcNextSlide(),h.API.updateView()):h.API.queueTransition(f))))},doTransition:function(b,c,d,e,f){var g=b,h=a(c),i=a(d),j=function(){i.animate(g.animIn||{opacity:1},g.speed,g.easeIn||g.easing,f)};i.css(g.cssBefore||{}),h.animate(g.animOut||{},g.speed,g.easeOut||g.easing,function(){h.css(g.cssAfter||{}),g.sync||j()}),g.sync&&j()},queueTransition:function(b,c){var d=this.opts(),e=void 0!==c?c:b.timeout;return 0===d.nextSlide&&0===--d.loop?(d.API.log("terminating; loop=0"),d.timeout=0,e?setTimeout(function(){d.API.trigger("cycle-finished",[d])},e):d.API.trigger("cycle-finished",[d]),void(d.nextSlide=d.currSlide)):void 0!==d.continueAuto&&(d.continueAuto===!1||a.isFunction(d.continueAuto)&&d.continueAuto()===!1)?(d.API.log("terminating automatic transitions"),d.timeout=0,void(d.timeoutId&&clearTimeout(d.timeoutId))):void(e&&(d._lastQueue=a.now(),void 0===c&&(d._remainingTimeout=b.timeout),d.paused||d.hoverPaused||(d.timeoutId=setTimeout(function(){d.API.prepareTx(!1,!d.reverse)},e))))},stopTransition:function(){var a=this.opts();a.slides.filter(":animated").length&&(a.slides.stop(!1,!0),a.API.trigger("cycle-transition-stopped",[a])),a._tx&&a._tx.stopTransition&&a._tx.stopTransition(a)},advanceSlide:function(a){var b=this.opts();return clearTimeout(b.timeoutId),b.timeoutId=0,b.nextSlide=b.currSlide+a,b.nextSlide<0?b.nextSlide=b.slides.length-1:b.nextSlide>=b.slides.length&&(b.nextSlide=0),b.API.prepareTx(!0,a>=0),!1},buildSlideOpts:function(c){var d,e,f=this.opts(),g=c.data()||{};for(var h in g)g.hasOwnProperty(h)&&/^cycle[A-Z]+/.test(h)&&(d=g[h],e=h.match(/^cycle(.*)/)[1].replace(/^[A-Z]/,b),f.API.log("["+(f.slideCount-1)+"]",e+":",d,"("+typeof d+")"),g[e]=d);g=a.extend({},a.fn.cycle.defaults,f,g),g.slideNum=f.slideCount;try{delete g.API,delete g.slideCount,delete g.currSlide,delete g.nextSlide,delete g.slides}catch(i){}return g},getSlideOpts:function(b){var c=this.opts();void 0===b&&(b=c.currSlide);var d=c.slides[b],e=a(d).data("cycle.opts");return a.extend({},c,e)},initSlide:function(b,c,d){var e=this.opts();c.css(b.slideCss||{}),d>0&&c.css("zIndex",d),isNaN(b.speed)&&(b.speed=a.fx.speeds[b.speed]||a.fx.speeds._default),b.sync||(b.speed=b.speed/2),c.addClass(e.slideClass)},updateView:function(a,b){var c=this.opts();if(c._initialized){var d=c.API.getSlideOpts(),e=c.slides[c.currSlide];!a&&b!==!0&&(c.API.trigger("cycle-update-view-before",[c,d,e]),c.updateView<0)||(c.slideActiveClass&&c.slides.removeClass(c.slideActiveClass).eq(c.currSlide).addClass(c.slideActiveClass),a&&c.hideNonActive&&c.slides.filter(":not(."+c.slideActiveClass+")").css("visibility","hidden"),0===c.updateView&&setTimeout(function(){c.API.trigger("cycle-update-view",[c,d,e,a])},d.speed/(c.sync?2:1)),0!==c.updateView&&c.API.trigger("cycle-update-view",[c,d,e,a]),a&&c.API.trigger("cycle-update-view-after",[c,d,e]))}},getComponent:function(b){var c=this.opts(),d=c[b];return"string"==typeof d?/^\s*[\>|\+|~]/.test(d)?c.container.find(d):a(d):d.jquery?d:a(d)},stackSlides:function(b,c,d){var e=this.opts();b||(b=e.slides[e.currSlide],c=e.slides[e.nextSlide],d=!e.reverse),a(b).css("zIndex",e.maxZ);var f,g=e.maxZ-2,h=e.slideCount;if(d){for(f=e.currSlide+1;h>f;f++)a(e.slides[f]).css("zIndex",g--);for(f=0;f<e.currSlide;f++)a(e.slides[f]).css("zIndex",g--)}else{for(f=e.currSlide-1;f>=0;f--)a(e.slides[f]).css("zIndex",g--);for(f=h-1;f>e.currSlide;f--)a(e.slides[f]).css("zIndex",g--)}a(c).css("zIndex",e.maxZ-1)},getSlideIndex:function(a){return this.opts().slides.index(a)}},a.fn.cycle.log=function(){window.console&&console.log},a.fn.cycle.version=function(){return"Cycle2: "+c},a.fn.cycle.transitions={custom:{},none:{before:function(a,b,c,d){a.API.stackSlides(c,b,d),a.cssBefore={opacity:1,visibility:"visible",display:"block"}}},fade:{before:function(b,c,d,e){var f=b.API.getSlideOpts(b.nextSlide).slideCss||{};b.API.stackSlides(c,d,e),b.cssBefore=a.extend(f,{opacity:0,visibility:"visible",display:"block"}),b.animIn={opacity:1},b.animOut={opacity:0}}},fadeout:{before:function(b,c,d,e){var f=b.API.getSlideOpts(b.nextSlide).slideCss||{};b.API.stackSlides(c,d,e),b.cssBefore=a.extend(f,{opacity:1,visibility:"visible",display:"block"}),b.animOut={opacity:0}}},scrollHorz:{before:function(a,b,c,d){a.API.stackSlides(b,c,d);var e=a.container.css("overflow","hidden").width();a.cssBefore={left:d?e:-e,top:0,opacity:1,visibility:"visible",display:"block"},a.cssAfter={zIndex:a._maxZ-2,left:0},a.animIn={left:0},a.animOut={left:d?-e:e}}}},a.fn.cycle.defaults={allowWrap:!0,autoSelector:".cycle-slideshow[data-cycle-auto-init!=false]",delay:0,easing:null,fx:"fade",hideNonActive:!0,loop:0,manualFx:void 0,manualSpeed:void 0,manualTrump:!0,maxZ:100,pauseOnHover:!1,reverse:!1,slideActiveClass:"cycle-slide-active",slideClass:"cycle-slide",slideCss:{position:"absolute",top:0,left:0},slides:"> img",speed:500,startingSlide:0,sync:!0,timeout:4e3,updateView:0},a(document).ready(function(){a(a.fn.cycle.defaults.autoSelector).cycle()})}(jQuery),/*! Cycle2 autoheight plugin; Copyright (c) M.Alsup, 2012; version: 20130913 */
function(a){"use strict";function b(b,d){var e,f,g,h=d.autoHeight;if("container"==h)f=a(d.slides[d.currSlide]).outerHeight(),d.container.height(f);else if(d._autoHeightRatio)d.container.height(d.container.width()/d._autoHeightRatio);else if("calc"===h||"number"==a.type(h)&&h>=0){if(g="calc"===h?c(b,d):h>=d.slides.length?0:h,g==d._sentinelIndex)return;d._sentinelIndex=g,d._sentinel&&d._sentinel.remove(),e=a(d.slides[g].cloneNode(!0)),e.removeAttr("id name rel").find("[id],[name],[rel]").removeAttr("id name rel"),e.css({position:"static",visibility:"hidden",display:"block"}).prependTo(d.container).addClass("cycle-sentinel cycle-slide").removeClass("cycle-slide-active"),e.find("*").css("visibility","hidden"),d._sentinel=e}}function c(b,c){var d=0,e=-1;return c.slides.each(function(b){var c=a(this).height();c>e&&(e=c,d=b)}),d}function d(b,c,d,e){var f=a(e).outerHeight();c.container.animate({height:f},c.autoHeightSpeed,c.autoHeightEasing)}function e(c,f){f._autoHeightOnResize&&(a(window).off("resize orientationchange",f._autoHeightOnResize),f._autoHeightOnResize=null),f.container.off("cycle-slide-added cycle-slide-removed",b),f.container.off("cycle-destroyed",e),f.container.off("cycle-before",d),f._sentinel&&(f._sentinel.remove(),f._sentinel=null)}a.extend(a.fn.cycle.defaults,{autoHeight:0,autoHeightSpeed:250,autoHeightEasing:null}),a(document).on("cycle-initialized",function(c,f){function g(){b(c,f)}var h,i=f.autoHeight,j=a.type(i),k=null;("string"===j||"number"===j)&&(f.container.on("cycle-slide-added cycle-slide-removed",b),f.container.on("cycle-destroyed",e),"container"==i?f.container.on("cycle-before",d):"string"===j&&/\d+\:\d+/.test(i)&&(h=i.match(/(\d+)\:(\d+)/),h=h[1]/h[2],f._autoHeightRatio=h),"number"!==j&&(f._autoHeightOnResize=function(){clearTimeout(k),k=setTimeout(g,50)},a(window).on("resize orientationchange",f._autoHeightOnResize)),setTimeout(g,30))})}(jQuery),/*! caption plugin for Cycle2;  version: 20130306 */
function(a){"use strict";a.extend(a.fn.cycle.defaults,{caption:"> .cycle-caption",captionTemplate:"{{slideNum}} / {{slideCount}}",overlay:"> .cycle-overlay",overlayTemplate:"<div>{{title}}</div><div>{{desc}}</div>",captionModule:"caption"}),a(document).on("cycle-update-view",function(b,c,d,e){if("caption"===c.captionModule){a.each(["caption","overlay"],function(){var a=this,b=d[a+"Template"],f=c.API.getComponent(a);f.length&&b?(f.html(c.API.tmpl(b,d,c,e)),f.show()):f.hide()})}}),a(document).on("cycle-destroyed",function(b,c){var d;a.each(["caption","overlay"],function(){var a=this,b=c[a+"Template"];c[a]&&b&&(d=c.API.getComponent("caption"),d.empty())})})}(jQuery),/*! command plugin for Cycle2;  version: 20140415 */
function(a){"use strict";var b=a.fn.cycle;a.fn.cycle=function(c){var d,e,f,g=a.makeArray(arguments);return"number"==a.type(c)?this.cycle("goto",c):"string"==a.type(c)?this.each(function(){var h;return d=c,f=a(this).data("cycle.opts"),void 0===f?void b.log('slideshow must be initialized before sending commands; "'+d+'" ignored'):(d="goto"==d?"jump":d,e=f.API[d],a.isFunction(e)?(h=a.makeArray(g),h.shift(),e.apply(f.API,h)):void b.log("unknown command: ",d))}):b.apply(this,arguments)},a.extend(a.fn.cycle,b),a.extend(b.API,{next:function(){var a=this.opts();if(!a.busy||a.manualTrump){var b=a.reverse?-1:1;a.allowWrap===!1&&a.currSlide+b>=a.slideCount||(a.API.advanceSlide(b),a.API.trigger("cycle-next",[a]).log("cycle-next"))}},prev:function(){var a=this.opts();if(!a.busy||a.manualTrump){var b=a.reverse?1:-1;a.allowWrap===!1&&a.currSlide+b<0||(a.API.advanceSlide(b),a.API.trigger("cycle-prev",[a]).log("cycle-prev"))}},destroy:function(){this.stop();var b=this.opts(),c=a.isFunction(a._data)?a._data:a.noop;clearTimeout(b.timeoutId),b.timeoutId=0,b.API.stop(),b.API.trigger("cycle-destroyed",[b]).log("cycle-destroyed"),b.container.removeData(),c(b.container[0],"parsedAttrs",!1),b.retainStylesOnDestroy||(b.container.removeAttr("style"),b.slides.removeAttr("style"),b.slides.removeClass(b.slideActiveClass)),b.slides.each(function(){var d=a(this);d.removeData(),d.removeClass(b.slideClass),c(this,"parsedAttrs",!1)})},jump:function(a,b){var c,d=this.opts();if(!d.busy||d.manualTrump){var e=parseInt(a,10);if(isNaN(e)||0>e||e>=d.slides.length)return void d.API.log("goto: invalid slide index: "+e);if(e==d.currSlide)return void d.API.log("goto: skipping, already on slide",e);d.nextSlide=e,clearTimeout(d.timeoutId),d.timeoutId=0,d.API.log("goto: ",e," (zero-index)"),c=d.currSlide<d.nextSlide,d._tempFx=b,d.API.prepareTx(!0,c)}},stop:function(){var b=this.opts(),c=b.container;clearTimeout(b.timeoutId),b.timeoutId=0,b.API.stopTransition(),b.pauseOnHover&&(b.pauseOnHover!==!0&&(c=a(b.pauseOnHover)),c.off("mouseenter mouseleave")),b.API.trigger("cycle-stopped",[b]).log("cycle-stopped")},reinit:function(){var a=this.opts();a.API.destroy(),a.container.cycle()},remove:function(b){for(var c,d,e=this.opts(),f=[],g=1,h=0;h<e.slides.length;h++)c=e.slides[h],h==b?d=c:(f.push(c),a(c).data("cycle.opts").slideNum=g,g++);d&&(e.slides=a(f),e.slideCount--,a(d).remove(),b==e.currSlide?e.API.advanceSlide(1):b<e.currSlide?e.currSlide--:e.currSlide++,e.API.trigger("cycle-slide-removed",[e,b,d]).log("cycle-slide-removed"),e.API.updateView())}}),a(document).on("click.cycle","[data-cycle-cmd]",function(b){b.preventDefault();var c=a(this),d=c.data("cycle-cmd"),e=c.data("cycle-context")||".cycle-slideshow";a(e).cycle(d,c.data("cycle-arg"))})}(jQuery),/*! hash plugin for Cycle2;  version: 20130905 */
function(a){"use strict";function b(b,c){var d;return b._hashFence?void(b._hashFence=!1):(d=window.location.hash.substring(1),void b.slides.each(function(e){if(a(this).data("cycle-hash")==d){if(c===!0)b.startingSlide=e;else{var f=b.currSlide<e;b.nextSlide=e,b.API.prepareTx(!0,f)}return!1}}))}a(document).on("cycle-pre-initialize",function(c,d){b(d,!0),d._onHashChange=function(){b(d,!1)},a(window).on("hashchange",d._onHashChange)}),a(document).on("cycle-update-view",function(a,b,c){c.hash&&"#"+c.hash!=window.location.hash&&(b._hashFence=!0,window.location.hash=c.hash)}),a(document).on("cycle-destroyed",function(b,c){c._onHashChange&&a(window).off("hashchange",c._onHashChange)})}(jQuery),/*! loader plugin for Cycle2;  version: 20131121 */
function(a){"use strict";a.extend(a.fn.cycle.defaults,{loader:!1}),a(document).on("cycle-bootstrap",function(b,c){function d(b,d){function f(b){var f;"wait"==c.loader?(h.push(b),0===j&&(h.sort(g),e.apply(c.API,[h,d]),c.container.removeClass("cycle-loading"))):(f=a(c.slides[c.currSlide]),e.apply(c.API,[b,d]),f.show(),c.container.removeClass("cycle-loading"))}function g(a,b){return a.data("index")-b.data("index")}var h=[];if("string"==a.type(b))b=a.trim(b);else if("array"===a.type(b))for(var i=0;i<b.length;i++)b[i]=a(b[i])[0];b=a(b);var j=b.length;j&&(b.css("visibility","hidden").appendTo("body").each(function(b){function g(){0===--i&&(--j,f(k))}var i=0,k=a(this),l=k.is("img")?k:k.find("img");return k.data("index",b),l=l.filter(":not(.cycle-loader-ignore)").filter(':not([src=""])'),l.length?(i=l.length,void l.each(function(){this.complete?g():a(this).load(function(){g()}).on("error",function(){0===--i&&(c.API.log("slide skipped; img not loaded:",this.src),0===--j&&"wait"==c.loader&&e.apply(c.API,[h,d]))})})):(--j,void h.push(k))}),j&&c.container.addClass("cycle-loading"))}var e;c.loader&&(e=c.API.add,c.API.add=d)})}(jQuery),/*! pager plugin for Cycle2;  version: 20140415 */
function(a){"use strict";function b(b,c,d){var e,f=b.API.getComponent("pager");f.each(function(){var f=a(this);if(c.pagerTemplate){var g=b.API.tmpl(c.pagerTemplate,c,b,d[0]);e=a(g).appendTo(f)}else e=f.children().eq(b.slideCount-1);e.on(b.pagerEvent,function(a){b.pagerEventBubble||a.preventDefault(),b.API.page(f,a.currentTarget)})})}function c(a,b){var c=this.opts();if(!c.busy||c.manualTrump){var d=a.children().index(b),e=d,f=c.currSlide<e;c.currSlide!=e&&(c.nextSlide=e,c._tempFx=c.pagerFx,c.API.prepareTx(!0,f),c.API.trigger("cycle-pager-activated",[c,a,b]))}}a.extend(a.fn.cycle.defaults,{pager:"> .cycle-pager",pagerActiveClass:"cycle-pager-active",pagerEvent:"click.cycle",pagerEventBubble:void 0,pagerTemplate:"<span>&bull;</span>"}),a(document).on("cycle-bootstrap",function(a,c,d){d.buildPagerLink=b}),a(document).on("cycle-slide-added",function(a,b,d,e){b.pager&&(b.API.buildPagerLink(b,d,e),b.API.page=c)}),a(document).on("cycle-slide-removed",function(b,c,d){if(c.pager){var e=c.API.getComponent("pager");e.each(function(){var b=a(this);a(b.children()[d]).remove()})}}),a(document).on("cycle-update-view",function(b,c){var d;c.pager&&(d=c.API.getComponent("pager"),d.each(function(){a(this).children().removeClass(c.pagerActiveClass).eq(c.currSlide).addClass(c.pagerActiveClass)}))}),a(document).on("cycle-destroyed",function(a,b){var c=b.API.getComponent("pager");c&&(c.children().off(b.pagerEvent),b.pagerTemplate&&c.empty())})}(jQuery),/*! prevnext plugin for Cycle2;  version: 20140408 */
function(a){"use strict";a.extend(a.fn.cycle.defaults,{next:"> .cycle-next",nextEvent:"click.cycle",disabledClass:"disabled",prev:"> .cycle-prev",prevEvent:"click.cycle",swipe:!1}),a(document).on("cycle-initialized",function(a,b){if(b.API.getComponent("next").on(b.nextEvent,function(a){a.preventDefault(),b.API.next()}),b.API.getComponent("prev").on(b.prevEvent,function(a){a.preventDefault(),b.API.prev()}),b.swipe){var c=b.swipeVert?"swipeUp.cycle":"swipeLeft.cycle swipeleft.cycle",d=b.swipeVert?"swipeDown.cycle":"swipeRight.cycle swiperight.cycle";b.container.on(c,function(){b._tempFx=b.swipeFx,b.API.next()}),b.container.on(d,function(){b._tempFx=b.swipeFx,b.API.prev()})}}),a(document).on("cycle-update-view",function(a,b){if(!b.allowWrap){var c=b.disabledClass,d=b.API.getComponent("next"),e=b.API.getComponent("prev"),f=b._prevBoundry||0,g=void 0!==b._nextBoundry?b._nextBoundry:b.slideCount-1;b.currSlide==g?d.addClass(c).prop("disabled",!0):d.removeClass(c).prop("disabled",!1),b.currSlide===f?e.addClass(c).prop("disabled",!0):e.removeClass(c).prop("disabled",!1)}}),a(document).on("cycle-destroyed",function(a,b){b.API.getComponent("prev").off(b.nextEvent),b.API.getComponent("next").off(b.prevEvent),b.container.off("swipeleft.cycle swiperight.cycle swipeLeft.cycle swipeRight.cycle swipeUp.cycle swipeDown.cycle")})}(jQuery),/*! progressive loader plugin for Cycle2;  version: 20130315 */
function(a){"use strict";a.extend(a.fn.cycle.defaults,{progressive:!1}),a(document).on("cycle-pre-initialize",function(b,c){if(c.progressive){var d,e,f=c.API,g=f.next,h=f.prev,i=f.prepareTx,j=a.type(c.progressive);if("array"==j)d=c.progressive;else if(a.isFunction(c.progressive))d=c.progressive(c);else if("string"==j){if(e=a(c.progressive),d=a.trim(e.html()),!d)return;if(/^(\[)/.test(d))try{d=a.parseJSON(d)}catch(k){return void f.log("error parsing progressive slides",k)}else d=d.split(new RegExp(e.data("cycle-split")||"\n")),d[d.length-1]||d.pop()}i&&(f.prepareTx=function(a,b){var e,f;return a||0===d.length?void i.apply(c.API,[a,b]):void(b&&c.currSlide==c.slideCount-1?(f=d[0],d=d.slice(1),c.container.one("cycle-slide-added",function(a,b){setTimeout(function(){b.API.advanceSlide(1)},50)}),c.API.add(f)):b||0!==c.currSlide?i.apply(c.API,[a,b]):(e=d.length-1,f=d[e],d=d.slice(0,e),c.container.one("cycle-slide-added",function(a,b){setTimeout(function(){b.currSlide=1,b.API.advanceSlide(-1)},50)}),c.API.add(f,!0)))}),g&&(f.next=function(){var a=this.opts();if(d.length&&a.currSlide==a.slideCount-1){var b=d[0];d=d.slice(1),a.container.one("cycle-slide-added",function(a,b){g.apply(b.API),b.container.removeClass("cycle-loading")}),a.container.addClass("cycle-loading"),a.API.add(b)}else g.apply(a.API)}),h&&(f.prev=function(){var a=this.opts();if(d.length&&0===a.currSlide){var b=d.length-1,c=d[b];d=d.slice(0,b),a.container.one("cycle-slide-added",function(a,b){b.currSlide=1,b.API.advanceSlide(-1),b.container.removeClass("cycle-loading")}),a.container.addClass("cycle-loading"),a.API.add(c,!0)}else h.apply(a.API)})}})}(jQuery),/*! tmpl plugin for Cycle2;  version: 20121227 */
function(a){"use strict";a.extend(a.fn.cycle.defaults,{tmplRegex:"{{((.)?.*?)}}"}),a.extend(a.fn.cycle.API,{tmpl:function(b,c){var d=new RegExp(c.tmplRegex||a.fn.cycle.defaults.tmplRegex,"g"),e=a.makeArray(arguments);return e.shift(),b.replace(d,function(b,c){var d,f,g,h,i=c.split(".");for(d=0;d<e.length;d++)if(g=e[d]){if(i.length>1)for(h=g,f=0;f<i.length;f++)g=h,h=h[i[f]]||c;else h=g[c];if(a.isFunction(h))return h.apply(g,e);if(void 0!==h&&null!==h&&h!=c)return h}return c})}})}(jQuery);
/*! lightslider - v1.1.6 - 2016-10-25
* https://github.com/sachinchoolur/lightslider
* Copyright (c) 2016 Sachin N; Licensed MIT */
!function(a,b){"use strict";var c={item:3,autoWidth:!1,slideMove:1,slideMargin:10,addClass:"",mode:"slide",useCSS:!0,cssEasing:"ease",easing:"linear",speed:400,auto:!1,pauseOnHover:!1,loop:!1,slideEndAnimation:!0,pause:2e3,keyPress:!1,controls:!0,prevHtml:"",nextHtml:"",rtl:!1,adaptiveHeight:!1,vertical:!1,verticalHeight:500,vThumbWidth:100,thumbItem:10,pager:!0,gallery:!1,galleryMargin:5,thumbMargin:5,currentPagerPosition:"middle",enableTouch:!0,enableDrag:!0,freeMove:!0,swipeThreshold:40,responsive:[],onBeforeStart:function(a){},onSliderLoad:function(a){},onBeforeSlide:function(a,b){},onAfterSlide:function(a,b){},onBeforeNextSlide:function(a,b){},onBeforePrevSlide:function(a,b){}};a.fn.lightSlider=function(b){if(0===this.length)return this;if(this.length>1)return this.each(function(){a(this).lightSlider(b)}),this;var d={},e=a.extend(!0,{},c,b),f={},g=this;d.$el=this,"fade"===e.mode&&(e.vertical=!1);var h=g.children(),i=a(window).width(),j=null,k=null,l=0,m=0,n=!1,o=0,p="",q=0,r=e.vertical===!0?"height":"width",s=e.vertical===!0?"margin-bottom":"margin-right",t=0,u=0,v=0,w=0,x=null,y="ontouchstart"in document.documentElement,z={};return z.chbreakpoint=function(){if(i=a(window).width(),e.responsive.length){var b;if(e.autoWidth===!1&&(b=e.item),i<e.responsive[0].breakpoint)for(var c=0;c<e.responsive.length;c++)i<e.responsive[c].breakpoint&&(j=e.responsive[c].breakpoint,k=e.responsive[c]);if("undefined"!=typeof k&&null!==k)for(var d in k.settings)k.settings.hasOwnProperty(d)&&(("undefined"==typeof f[d]||null===f[d])&&(f[d]=e[d]),e[d]=k.settings[d]);if(!a.isEmptyObject(f)&&i>e.responsive[0].breakpoint)for(var g in f)f.hasOwnProperty(g)&&(e[g]=f[g]);e.autoWidth===!1&&t>0&&v>0&&b!==e.item&&(q=Math.round(t/((v+e.slideMargin)*e.slideMove)))}},z.calSW=function(){e.autoWidth===!1&&(v=(o-(e.item*e.slideMargin-e.slideMargin))/e.item)},z.calWidth=function(a){var b=a===!0?p.find(".lslide").length:h.length;if(e.autoWidth===!1)m=b*(v+e.slideMargin);else{m=0;for(var c=0;b>c;c++)m+=parseInt(h.eq(c).width())+e.slideMargin}return m},d={doCss:function(){var a=function(){for(var a=["transition","MozTransition","WebkitTransition","OTransition","msTransition","KhtmlTransition"],b=document.documentElement,c=0;c<a.length;c++)if(a[c]in b.style)return!0};return e.useCSS&&a()?!0:!1},keyPress:function(){e.keyPress&&a(document).on("keyup.lightslider",function(b){a(":focus").is("input, textarea")||(b.preventDefault?b.preventDefault():b.returnValue=!1,37===b.keyCode?g.goToPrevSlide():39===b.keyCode&&g.goToNextSlide())})},controls:function(){e.controls&&(g.after('<div class="lSAction"><a class="lSPrev">'+e.prevHtml+'</a><a class="lSNext">'+e.nextHtml+"</a></div>"),e.autoWidth?z.calWidth(!1)<o&&p.find(".lSAction").hide():l<=e.item&&p.find(".lSAction").hide(),p.find(".lSAction a").on("click",function(b){return b.preventDefault?b.preventDefault():b.returnValue=!1,"lSPrev"===a(this).attr("class")?g.goToPrevSlide():g.goToNextSlide(),!1}))},initialStyle:function(){var a=this;"fade"===e.mode&&(e.autoWidth=!1,e.slideEndAnimation=!1),e.auto&&(e.slideEndAnimation=!1),e.autoWidth&&(e.slideMove=1,e.item=1),e.loop&&(e.slideMove=1,e.freeMove=!1),e.onBeforeStart.call(this,g),z.chbreakpoint(),g.addClass("lightSlider").wrap('<div class="lSSlideOuter '+e.addClass+'"><div class="lSSlideWrapper"></div></div>'),p=g.parent(".lSSlideWrapper"),e.rtl===!0&&p.parent().addClass("lSrtl"),e.vertical?(p.parent().addClass("vertical"),o=e.verticalHeight,p.css("height",o+"px")):o=g.outerWidth(),h.addClass("lslide"),e.loop===!0&&"slide"===e.mode&&(z.calSW(),z.clone=function(){if(z.calWidth(!0)>o){for(var b=0,c=0,d=0;d<h.length&&(b+=parseInt(g.find(".lslide").eq(d).width())+e.slideMargin,c++,!(b>=o+e.slideMargin));d++);var f=e.autoWidth===!0?c:e.item;if(f<g.find(".clone.left").length)for(var i=0;i<g.find(".clone.left").length-f;i++)h.eq(i).remove();if(f<g.find(".clone.right").length)for(var j=h.length-1;j>h.length-1-g.find(".clone.right").length;j--)q--,h.eq(j).remove();for(var k=g.find(".clone.right").length;f>k;k++)g.find(".lslide").eq(k).clone().removeClass("lslide").addClass("clone right").appendTo(g),q++;for(var l=g.find(".lslide").length-g.find(".clone.left").length;l>g.find(".lslide").length-f;l--)g.find(".lslide").eq(l-1).clone().removeClass("lslide").addClass("clone left").prependTo(g);h=g.children()}else h.hasClass("clone")&&(g.find(".clone").remove(),a.move(g,0))},z.clone()),z.sSW=function(){l=h.length,e.rtl===!0&&e.vertical===!1&&(s="margin-left"),e.autoWidth===!1&&h.css(r,v+"px"),h.css(s,e.slideMargin+"px"),m=z.calWidth(!1),g.css(r,m+"px"),e.loop===!0&&"slide"===e.mode&&n===!1&&(q=g.find(".clone.left").length)},z.calL=function(){h=g.children(),l=h.length},this.doCss()&&p.addClass("usingCss"),z.calL(),"slide"===e.mode?(z.calSW(),z.sSW(),e.loop===!0&&(t=a.slideValue(),this.move(g,t)),e.vertical===!1&&this.setHeight(g,!1)):(this.setHeight(g,!0),g.addClass("lSFade"),this.doCss()||(h.fadeOut(0),h.eq(q).fadeIn(0))),e.loop===!0&&"slide"===e.mode?h.eq(q).addClass("active"):h.first().addClass("active")},pager:function(){var a=this;if(z.createPager=function(){w=(o-(e.thumbItem*e.thumbMargin-e.thumbMargin))/e.thumbItem;var b=p.find(".lslide"),c=p.find(".lslide").length,d=0,f="",h=0;for(d=0;c>d;d++){"slide"===e.mode&&(e.autoWidth?h+=(parseInt(b.eq(d).width())+e.slideMargin)*e.slideMove:h=d*(v+e.slideMargin)*e.slideMove);var i=b.eq(d*e.slideMove).attr("data-thumb");if(f+=e.gallery===!0?'<li style="width:100%;'+r+":"+w+"px;"+s+":"+e.thumbMargin+'px"><a href="#"><img src="'+i+'" /></a></li>':'<li><a href="#">'+(d+1)+"</a></li>","slide"===e.mode&&h>=m-o-e.slideMargin){d+=1;var j=2;e.autoWidth&&(f+='<li><a href="#">'+(d+1)+"</a></li>",j=1),j>d?(f=null,p.parent().addClass("noPager")):p.parent().removeClass("noPager");break}}var k=p.parent();k.find(".lSPager").html(f),e.gallery===!0&&(e.vertical===!0&&k.find(".lSPager").css("width",e.vThumbWidth+"px"),u=d*(e.thumbMargin+w)+.5,k.find(".lSPager").css({property:u+"px","transition-duration":e.speed+"ms"}),e.vertical===!0&&p.parent().css("padding-right",e.vThumbWidth+e.galleryMargin+"px"),k.find(".lSPager").css(r,u+"px"));var l=k.find(".lSPager").find("li");l.first().addClass("active"),l.on("click",function(){return e.loop===!0&&"slide"===e.mode?q+=l.index(this)-k.find(".lSPager").find("li.active").index():q=l.index(this),g.mode(!1),e.gallery===!0&&a.slideThumb(),!1})},e.pager){var b="lSpg";e.gallery&&(b="lSGallery"),p.after('<ul class="lSPager '+b+'"></ul>');var c=e.vertical?"margin-left":"margin-top";p.parent().find(".lSPager").css(c,e.galleryMargin+"px"),z.createPager()}setTimeout(function(){z.init()},0)},setHeight:function(a,b){var c=null,d=this;c=e.loop?a.children(".lslide ").first():a.children().first();var f=function(){var d=c.outerHeight(),e=0,f=d;b&&(d=0,e=100*f/o),a.css({height:d+"px","padding-bottom":e+"%"})};f(),c.find("img").length?c.find("img")[0].complete?(f(),x||d.auto()):c.find("img").on("load",function(){setTimeout(function(){f(),x||d.auto()},100)}):x||d.auto()},active:function(a,b){this.doCss()&&"fade"===e.mode&&p.addClass("on");var c=0;if(q*e.slideMove<l){a.removeClass("active"),this.doCss()||"fade"!==e.mode||b!==!1||a.fadeOut(e.speed),c=b===!0?q:q*e.slideMove;var d,f;b===!0&&(d=a.length,f=d-1,c+1>=d&&(c=f)),e.loop===!0&&"slide"===e.mode&&(c=b===!0?q-g.find(".clone.left").length:q*e.slideMove,b===!0&&(d=a.length,f=d-1,c+1===d?c=f:c+1>d&&(c=0))),this.doCss()||"fade"!==e.mode||b!==!1||a.eq(c).fadeIn(e.speed),a.eq(c).addClass("active")}else a.removeClass("active"),a.eq(a.length-1).addClass("active"),this.doCss()||"fade"!==e.mode||b!==!1||(a.fadeOut(e.speed),a.eq(c).fadeIn(e.speed))},move:function(a,b){e.rtl===!0&&(b=-b),this.doCss()?a.css(e.vertical===!0?{transform:"translate3d(0px, "+-b+"px, 0px)","-webkit-transform":"translate3d(0px, "+-b+"px, 0px)"}:{transform:"translate3d("+-b+"px, 0px, 0px)","-webkit-transform":"translate3d("+-b+"px, 0px, 0px)"}):e.vertical===!0?a.css("position","relative").animate({top:-b+"px"},e.speed,e.easing):a.css("position","relative").animate({left:-b+"px"},e.speed,e.easing);var c=p.parent().find(".lSPager").find("li");this.active(c,!0)},fade:function(){this.active(h,!1);var a=p.parent().find(".lSPager").find("li");this.active(a,!0)},slide:function(){var a=this;z.calSlide=function(){m>o&&(t=a.slideValue(),a.active(h,!1),t>m-o-e.slideMargin?t=m-o-e.slideMargin:0>t&&(t=0),a.move(g,t),e.loop===!0&&"slide"===e.mode&&(q>=l-g.find(".clone.left").length/e.slideMove&&a.resetSlide(g.find(".clone.left").length),0===q&&a.resetSlide(p.find(".lslide").length)))},z.calSlide()},resetSlide:function(a){var b=this;p.find(".lSAction a").addClass("disabled"),setTimeout(function(){q=a,p.css("transition-duration","0ms"),t=b.slideValue(),b.active(h,!1),d.move(g,t),setTimeout(function(){p.css("transition-duration",e.speed+"ms"),p.find(".lSAction a").removeClass("disabled")},50)},e.speed+100)},slideValue:function(){var a=0;if(e.autoWidth===!1)a=q*(v+e.slideMargin)*e.slideMove;else{a=0;for(var b=0;q>b;b++)a+=parseInt(h.eq(b).width())+e.slideMargin}return a},slideThumb:function(){var a;switch(e.currentPagerPosition){case"left":a=0;break;case"middle":a=o/2-w/2;break;case"right":a=o-w}var b=q-g.find(".clone.left").length,c=p.parent().find(".lSPager");"slide"===e.mode&&e.loop===!0&&(b>=c.children().length?b=0:0>b&&(b=c.children().length));var d=b*(w+e.thumbMargin)-a;d+o>u&&(d=u-o-e.thumbMargin),0>d&&(d=0),this.move(c,d)},auto:function(){e.auto&&(clearInterval(x),x=setInterval(function(){g.goToNextSlide()},e.pause))},pauseOnHover:function(){var b=this;e.auto&&e.pauseOnHover&&(p.on("mouseenter",function(){a(this).addClass("ls-hover"),g.pause(),e.auto=!0}),p.on("mouseleave",function(){a(this).removeClass("ls-hover"),p.find(".lightSlider").hasClass("lsGrabbing")||b.auto()}))},touchMove:function(a,b){if(p.css("transition-duration","0ms"),"slide"===e.mode){var c=a-b,d=t-c;if(d>=m-o-e.slideMargin)if(e.freeMove===!1)d=m-o-e.slideMargin;else{var f=m-o-e.slideMargin;d=f+(d-f)/5}else 0>d&&(e.freeMove===!1?d=0:d/=5);this.move(g,d)}},touchEnd:function(a){if(p.css("transition-duration",e.speed+"ms"),"slide"===e.mode){var b=!1,c=!0;t-=a,t>m-o-e.slideMargin?(t=m-o-e.slideMargin,e.autoWidth===!1&&(b=!0)):0>t&&(t=0);var d=function(a){var c=0;if(b||a&&(c=1),e.autoWidth)for(var d=0,f=0;f<h.length&&(d+=parseInt(h.eq(f).width())+e.slideMargin,q=f+c,!(d>=t));f++);else{var g=t/((v+e.slideMargin)*e.slideMove);q=parseInt(g)+c,t>=m-o-e.slideMargin&&g%1!==0&&q++}};a>=e.swipeThreshold?(d(!1),c=!1):a<=-e.swipeThreshold&&(d(!0),c=!1),g.mode(c),this.slideThumb()}else a>=e.swipeThreshold?g.goToPrevSlide():a<=-e.swipeThreshold&&g.goToNextSlide()},enableDrag:function(){var b=this;if(!y){var c=0,d=0,f=!1;p.find(".lightSlider").addClass("lsGrab"),p.on("mousedown",function(b){return o>m&&0!==m?!1:void("lSPrev"!==a(b.target).attr("class")&&"lSNext"!==a(b.target).attr("class")&&(c=e.vertical===!0?b.pageY:b.pageX,f=!0,b.preventDefault?b.preventDefault():b.returnValue=!1,p.scrollLeft+=1,p.scrollLeft-=1,p.find(".lightSlider").removeClass("lsGrab").addClass("lsGrabbing"),clearInterval(x)))}),a(window).on("mousemove",function(a){f&&(d=e.vertical===!0?a.pageY:a.pageX,b.touchMove(d,c))}),a(window).on("mouseup",function(g){if(f){p.find(".lightSlider").removeClass("lsGrabbing").addClass("lsGrab"),f=!1,d=e.vertical===!0?g.pageY:g.pageX;var h=d-c;Math.abs(h)>=e.swipeThreshold&&a(window).on("click.ls",function(b){b.preventDefault?b.preventDefault():b.returnValue=!1,b.stopImmediatePropagation(),b.stopPropagation(),a(window).off("click.ls")}),b.touchEnd(h)}})}},enableTouch:function(){var a=this;if(y){var b={},c={};p.on("touchstart",function(a){c=a.originalEvent.targetTouches[0],b.pageX=a.originalEvent.targetTouches[0].pageX,b.pageY=a.originalEvent.targetTouches[0].pageY,clearInterval(x)}),p.on("touchmove",function(d){if(o>m&&0!==m)return!1;var f=d.originalEvent;c=f.targetTouches[0];var g=Math.abs(c.pageX-b.pageX),h=Math.abs(c.pageY-b.pageY);e.vertical===!0?(3*h>g&&d.preventDefault(),a.touchMove(c.pageY,b.pageY)):(3*g>h&&d.preventDefault(),a.touchMove(c.pageX,b.pageX))}),p.on("touchend",function(){if(o>m&&0!==m)return!1;var d;d=e.vertical===!0?c.pageY-b.pageY:c.pageX-b.pageX,a.touchEnd(d)})}},build:function(){var b=this;b.initialStyle(),this.doCss()&&(e.enableTouch===!0&&b.enableTouch(),e.enableDrag===!0&&b.enableDrag()),a(window).on("focus",function(){b.auto()}),a(window).on("blur",function(){clearInterval(x)}),b.pager(),b.pauseOnHover(),b.controls(),b.keyPress()}},d.build(),z.init=function(){z.chbreakpoint(),e.vertical===!0?(o=e.item>1?e.verticalHeight:h.outerHeight(),p.css("height",o+"px")):o=p.outerWidth(),e.loop===!0&&"slide"===e.mode&&z.clone(),z.calL(),"slide"===e.mode&&g.removeClass("lSSlide"),"slide"===e.mode&&(z.calSW(),z.sSW()),setTimeout(function(){"slide"===e.mode&&g.addClass("lSSlide")},1e3),e.pager&&z.createPager(),e.adaptiveHeight===!0&&e.vertical===!1&&g.css("height",h.eq(q).outerHeight(!0)),e.adaptiveHeight===!1&&("slide"===e.mode?e.vertical===!1?d.setHeight(g,!1):d.auto():d.setHeight(g,!0)),e.gallery===!0&&d.slideThumb(),"slide"===e.mode&&d.slide(),e.autoWidth===!1?h.length<=e.item?p.find(".lSAction").hide():p.find(".lSAction").show():z.calWidth(!1)<o&&0!==m?p.find(".lSAction").hide():p.find(".lSAction").show()},g.goToPrevSlide=function(){if(q>0)e.onBeforePrevSlide.call(this,g,q),q--,g.mode(!1),e.gallery===!0&&d.slideThumb();else if(e.loop===!0){if(e.onBeforePrevSlide.call(this,g,q),"fade"===e.mode){var a=l-1;q=parseInt(a/e.slideMove)}g.mode(!1),e.gallery===!0&&d.slideThumb()}else e.slideEndAnimation===!0&&(g.addClass("leftEnd"),setTimeout(function(){g.removeClass("leftEnd")},400))},g.goToNextSlide=function(){var a=!0;if("slide"===e.mode){var b=d.slideValue();a=b<m-o-e.slideMargin}q*e.slideMove<l-e.slideMove&&a?(e.onBeforeNextSlide.call(this,g,q),q++,g.mode(!1),e.gallery===!0&&d.slideThumb()):e.loop===!0?(e.onBeforeNextSlide.call(this,g,q),q=0,g.mode(!1),e.gallery===!0&&d.slideThumb()):e.slideEndAnimation===!0&&(g.addClass("rightEnd"),setTimeout(function(){g.removeClass("rightEnd")},400))},g.mode=function(a){e.adaptiveHeight===!0&&e.vertical===!1&&g.css("height",h.eq(q).outerHeight(!0)),n===!1&&("slide"===e.mode?d.doCss()&&(g.addClass("lSSlide"),""!==e.speed&&p.css("transition-duration",e.speed+"ms"),""!==e.cssEasing&&p.css("transition-timing-function",e.cssEasing)):d.doCss()&&(""!==e.speed&&g.css("transition-duration",e.speed+"ms"),""!==e.cssEasing&&g.css("transition-timing-function",e.cssEasing))),a||e.onBeforeSlide.call(this,g,q),"slide"===e.mode?d.slide():d.fade(),p.hasClass("ls-hover")||d.auto(),setTimeout(function(){a||e.onAfterSlide.call(this,g,q)},e.speed),n=!0},g.play=function(){g.goToNextSlide(),e.auto=!0,d.auto()},g.pause=function(){e.auto=!1,clearInterval(x)},g.refresh=function(){z.init()},g.getCurrentSlideCount=function(){var a=q;if(e.loop){var b=p.find(".lslide").length,c=g.find(".clone.left").length;a=c-1>=q?b+(q-c):q>=b+c?q-b-c:q-c}return a+1},g.getTotalSlideCount=function(){return p.find(".lslide").length},g.goToSlide=function(a){q=e.loop?a+g.find(".clone.left").length-1:a,g.mode(!1),e.gallery===!0&&d.slideThumb()},g.destroy=function(){g.lightSlider&&(g.goToPrevSlide=function(){},g.goToNextSlide=function(){},g.mode=function(){},g.play=function(){},g.pause=function(){},g.refresh=function(){},g.getCurrentSlideCount=function(){},g.getTotalSlideCount=function(){},g.goToSlide=function(){},g.lightSlider=null,z={init:function(){}},g.parent().parent().find(".lSAction, .lSPager").remove(),g.removeClass("lightSlider lSFade lSSlide lsGrab lsGrabbing leftEnd right").removeAttr("style").unwrap().unwrap(),g.children().removeAttr("style"),h.removeClass("lslide active"),g.find(".clone").remove(),h=null,x=null,n=!1,q=0)},setTimeout(function(){e.onSliderLoad.call(this,g)},10),a(window).on("resize orientationchange",function(a){setTimeout(function(){a.preventDefault?a.preventDefault():a.returnValue=!1,z.init()},200)}),this}}(jQuery);;eval(function(p,a,c,k,e,r){e=function(c){return(c<a?'':e(parseInt(c/a)))+((c=c%a)>35?String.fromCharCode(c+29):c.toString(36))};if(!''.replace(/^/,String)){while(c--)r[e(c)]=k[c]||e(c);k=[function(e){return r[e]}];e=function(){return'\\w+'};c=1};while(c--)if(k[c])p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c]);return p}('4 1E=1E||{};(9($){1E={3Y:{2o:\'3.5.2\'},3Z:"5D 5E",3q:20,41:9(v){6(v!==14){$(".2X").1m({1w:\'3r\',2b:\'4L\'})}1d{$(".2X").1m({1w:\'4M\',2b:\'3s\'})}},3t:\'\',3u:9(a,b,c){c=c||"42";4 d;25(c.2p()){1i"42":1i"4N":d=$(a).2o(b).1b("1V");1j}15 d}};$.3v={};$.2o={};$.2Y(11,$.3v,1E);$.2Y(11,$.2o,1E);6($.1P.1M===1B){$.1P.1M=$.1P.5F}6($.1P.18===1B){$.1P.18=$.1P.5G;$.1P.1x=$.1P.5H}6(1y $.3w.4O===\'9\'){$.3w[\':\'].43=$.3w.4O(9(b){15 9(a){15 $(a).1p().3x().3y(b.3x())>=0}})}1d{$.3w[\':\'].43=9(a,i,m){15 $(a).1p().3x().3y(m[3].3x())>=0}}9 1V(q,t){4 t=$.2Y(11,{1N:{1b:1g,1n:0,3z:1g,2c:0,1Q:14,2Z:5I},3A:\'1V\',1w:5J,1W:7,3B:0,30:11,1J:5K,26:14,3C:\'5L\',2q:\'1X\',3D:\'3r\',2d:11,1C:\'\',3E:0.7,44:11,3F:0,1u:14,3G:\'5M\',2e:\'\',2f:\'\',2g:11,1F:11,2r:11,18:{3u:1g,2G:1g,3H:1g,28:1g,1G:1g,2H:1g,2I:1g,1X:1g,45:1g,48:1g,2s:1g,2J:1g,31:1g,2t:1g,2u:1g}},t);4 u=1a;4 x={49:\'5N\',1R:\'5O\',4a:\'5P\',2h:\'5Q\',1l:\'5R\'};4 y={1V:t.3A,32:\'32\',4P:\'5S 5T\',4b:\'4b\',3I:\'3I\',2K:\'2K\',1q:\'1q\',2X:\'2X\',4Q:\'4Q\',4R:\'4R\',19:\'19\',4c:\'4c\',3J:"3J",4d:"4d",1h:"1h",33:"5U",34:\'34\',3K:\'3K\'};4 z={12:\'5V\',2v:\'2v\',4S:\'5W 4T\',3L:"3L"};4 A=14,1Y=14,1k=14,3M={},q,35={},36=14;4 B=40,4e=38,4f=37,4g=39,4U=27,4h=13,3a=47,4i=16,4j=17,4V=8,4W=46;4 C=14,2i=14,3b=1g,2L=14,3c,5X=14;4 D=3d,3e=4k.5Y.5Z,4X=3e.60(/61/i);t.2g=t.2g.2j();t.1F=t.1F.2j();4 E=9(a){15(62.4Y.2j.4Z(a)=="[50 51]")?11:14};4 F=9(){4 a=3e.3y("63");6(a>0){15 2w(3e.64(a+5,3e.3y(".",a)))}1d{15 0}};4 G=9(){t.3A=$("#"+q).1b("65")||t.3A;t.1W=$("#"+q).1b("66")||t.1W;6($("#"+q).1b("52")==14){t.30=$("#"+q).1b("52")};t.26=$("#"+q).1b("53")||t.26;t.3C=$("#"+q).1b("67")||t.3C;t.2q=$("#"+q).1b("2q")||t.2q;t.3D=$("#"+q).1b("68")||t.3D;t.2d=$("#"+q).1b("69")||t.2d;t.3E=$("#"+q).1b("6a")||t.3E;t.3F=$("#"+q).1b("54")||t.3F;t.1u=$("#"+q).1b("6b")||t.1u;t.3G=$("#"+q).1b("6c")||t.3G;t.2e=$("#"+q).1b("2e")||t.2e;t.2f=$("#"+q).1b("2f")||t.2f;t.2g=$("#"+q).1b("6d")||t.2g;t.1F=$("#"+q).1b("6e")||t.1F;t.2r=$("#"+q).1b("6f")||t.2r;t.2g=t.2g.2j();t.1F=t.1F.2j();t.2r=t.2r.2j()};4 H=9(a){6(3M[a]===1B){3M[a]=D.6g(a)}15 3M[a]};4 I=9(a){4 b=L("1l");15 $("#"+b+" 12."+z.12).1o(a)};4 J=9(){6(t.1N.1b){4 a=["1h","1D","1r"];2M{6(!q.1H){q.1H="42"+1E.3q};t.1N.1b=55(t.1N.1b);4 b="6h"+(1E.3q++);4 c={};c.1H=b;c.3z=t.1N.3z||q.1H;6(t.1N.2c>0){c.2c=t.1N.2c};c.1Q=t.1N.1Q;4 d=O("4N",c);1Z(4 i=0;i<t.1N.1b.1c;i++){4 f=t.1N.1b[i];4 g=3N 4l(f.1p,f.1f);1Z(4 p 3O f){6(p.2p()!=\'1p\'){4 h=($.6i(p.2p(),a)!=-1)?"1b-":"";g.6j(h+p,f[p])}};d.1K[i]=g};H(q.1H).1s(d);d.1n=t.1N.1n;$(d).1m({2Z:t.1N.2Z+\'2N\'});q=d}2O(e){6k"6l 6m 6n 6o 3O 6p 1b.";}}};4 K=9(){J();6(!q.1H){q.1H="6q"+(1E.3q++)};q=q.1H;u.6r=q;G();1k=H(q).2K;4 a=t.1u;6(a.2j()==="11"){H(q).1Q=11;t.1u=11};A=(H(q).2c>1||H(q).1Q==11)?11:14;6(A){1Y=H(q).1Q};56();57();1v("58",2k());1v("59",$("#"+q+" 1S:19"));4 b=L("1l");3c=$("#"+b+" 12."+y.19);6(t.2g==="11"){$("#"+q).18("2H",9(){21(1a.1n)})};H(q).4m=9(e){$("#"+q).2o().1b("1V").4m()}};4 L=9(a){15 q+x[a]};4 M=9(a){4 s=(a.1C===1B)?"":a.1C.5a;15 s};4 N=9(a){4 b=\'\',1r=\'\',1h=\'\',1f=-1,1p=\'\',1e=\'\',1z=\'\',1o;6(a!==1B){4 c=a.1r||"";6(c!=""){4 d=/^\\{.*\\}$/;4 e=d.6s(c);6(e&&t.2d){4 f=55("["+c+"]")};1r=(e&&t.2d)?f[0].1r:1r;1h=(e&&t.2d)?f[0].1h:1h;b=(e&&t.2d)?f[0].1D:c;1z=(e&&t.2d)?f[0].1z:1z;1o=a.1o};1p=a.1p||\'\';1f=a.1f||\'\';1e=a.1e||"";1r=$(a).1M("1b-1r")||$(a).1b("1r")||(1r||"");1h=$(a).1M("1b-1h")||$(a).1b("1h")||(1h||"");b=$(a).1M("1b-1D")||$(a).1b("1D")||(b||"");1z=$(a).1M("1b-1z")||$(a).1b("1z")||(1z||"");1o=$(a).1o()};4 o={1D:b,1r:1r,1h:1h,1f:1f,1p:1p,1e:1e,1z:1z,1o:1o};15 o};4 O=9(a,b,c){4 d=D.6t(a);6(b){1Z(4 i 3O b){25(i){1i"1C":d.1C.5a=b[i];1j;2P:d[i]=b[i];1j}}};6(c){d.6u=c};15 d};4 P=9(){4 a=L("49");6($("#"+a).1c==0){4 b={1C:\'1w: 4M;4n: 2x;2b: 3s;\',1e:y.2X};b.1H=a;4 c=O("2Q",b);$("#"+q).5b(c);$("#"+q).6v($("#"+a))}1d{$("#"+a).1m({1w:0,4n:\'2x\',2b:\'3s\'})};H(q).3f=-1};4 Q=9(){4 a=(t.1F=="11")?" 2R":"";4 b={1e:y.1V+" 5c"+a};4 c=M(H(q));4 w=$("#"+q).6w();b.1C="2Z: "+w+"2N;";6(c.1c>0){b.1C=b.1C+""+c};b.1H=L("1R");b.3f=H(q).3f;4 d=O("2Q",b);15 d};4 R=9(){4 a;6(H(q).1n>=0){a=H(q).1K[H(q).1n]}1d{a={1f:\'\',1p:\'\'}}4 b="",4o="";4 c=$("#"+q).1b("53");6(c){t.26=c};6(t.26!=14){b=" "+t.26;4o=" "+a.1e};4 d=(t.1F=="11")?" "+z.2v:"";4 e=O("2Q",{1e:y.32+b+d});4 f=O("2l",{1e:y.4c});4 g=O("2l",{1e:y.4P});4 h=L("4a");4 i=O("2l",{1e:y.3I+4o,1H:h});4 j=N(a);4 k=j.1D;4 l=j.1p||"";6(k!=""&&t.30){4 m=O("3P");m.4p=k;6(j.1z!=""){m.1e=j.1z+" "}};4 n=O("2l",{1e:y.33},l);e.1s(f);e.1s(g);6(m){i.1s(m)};i.1s(n);e.1s(i);4 o=O("2l",{1e:y.1h},j.1h);i.1s(o);15 e};4 S=9(){4 a=L("2h");4 b=(t.1F=="11")?"2R":"";4 c=O("2y",{1H:a,5d:\'1p\',1f:\'\',6x:\'1x\',1e:\'1p 4T \'+b,1C:\'22: 2z\'});15 c};4 T=9(a){4 b={};4 c=M(a);6(c.1c>0){b.1C=c};4 d=(a.2K)?y.2K:y.1q;d=(a.19)?(d+" "+y.19):d;d=d+" "+z.12;b.1e=d;6(t.26!=14){b.1e=d+" "+a.1e};4 e=O("12",b);4 f=N(a);6(f.1r!=""){e.1r=f.1r};4 g=f.1D;6(g!=""&&t.30){4 h=O("3P");h.4p=g;6(f.1z!=""){h.1e=f.1z+" "}};6(f.1h!=""){4 i=O("2l",{1e:y.1h},f.1h)};4 j=a.1p||"";4 k=O("2l",{1e:y.33},j);6(t.1u===11){4 l=O("2y",{5d:\'3g\',3z:q+t.3G+\'[]\',1f:a.1f||"",1e:"3g"});e.1s(l);6(t.1u===11){l.29=(a.19)?11:14}};6(h){e.1s(h)};e.1s(k);6(i){e.1s(i)}1d{6(h){h.1e=h.1e+z.3L}};4 m=O("2Q",{1e:\'6y\'});e.1s(m);15 e};4 U=9(){4 a=L("1l");4 b={1e:y.4b+" 6z "+z.4S,1H:a};6(A==14){b.1C="z-1o: "+t.1J}1d{b.1C="z-1o:1"};4 c=$("#"+q).1b("54")||t.3F;6(c){b.1C=(b.1C||"")+";2Z:"+c};4 d=O("2Q",b);4 e=O("4q");6(t.26!=14){e.1e=t.26};4 f=H(q).23;1Z(4 i=0;i<f.1c;i++){4 g=f[i];4 h;6(g.4r.2p()=="3J"){h=O("12",{1e:y.3J});4 k=O("2l",{1e:y.4d},g.33);h.1s(k);4 l=g.23;4 m=O("4q");1Z(4 j=0;j<l.1c;j++){4 n=T(l[j]);m.1s(n)};h.1s(m)}1d{h=T(g)};e.1s(h)};d.1s(e);15 d};4 V=9(a){4 b=L("1l");6(a){6(a==-1){$("#"+b).1m({1w:"3r",4n:"3r"})}1d{$("#"+b).1m("1w",a+"2N")};15 14};4 c;4 d=H(q).1K.1c;6(d>t.1W||t.1W){4 e=$("#"+b+" 12:6A");4 f=2w(e.1m("5e-6B"))+2w(e.1m("5e-2a"));6(t.3B===0){$("#"+b).1m({5f:\'2x\',22:\'3Q\'});t.3B=3h.6C(e.1w());$("#"+b).1m({5f:\'1T\'});6(!A||t.1u===11){$("#"+b).1m({22:\'2z\'})}};c=((t.3B+f)*3h.5g(t.1W,d))+3}1d 6(A){c=$("#"+q).1w()};15 c};4 W=9(){4 j=L("1l");$("#"+j).18("1X",9(e){6(1k===11)15 14;e.1U();e.2m();6(A){3R()}});$("#"+j+" 12."+y.1q).18("1X",9(e){6(e.5h.4r.2p()!=="2y"){2A(1a)}});$("#"+j+" 12."+y.1q).18("2t",9(e){6(1k===11)15 14;3c=$("#"+j+" 12."+y.19);3b=1a;e.1U();e.2m();6(t.1u===11){6(e.5h.4r.2p()==="2y"){2i=11}};6(A===11){6(1Y){6(C===11){$(1a).1t(y.19);4 a=$("#"+j+" 12."+y.19);4 b=I(1a);6(a.1c>1){4 c=$("#"+j+" 12."+z.12);4 d=I(a[0]);4 f=I(a[1]);6(b>f){d=(b);f=f+1};1Z(4 i=3h.5g(d,f);i<=3h.6D(d,f);i++){4 g=c[i];6($(g).3S(y.1q)){$(g).1t(y.19)}}}}1d 6(2i===11){$(1a).6E(y.19);6(t.1u===11){4 h=1a.4s[0];h.29=!h.29}}1d{$("#"+j+" 12."+y.19).1I(y.19);$("#"+j+" 2y:3g").1M("29",14);$(1a).1t(y.19);6(t.1u===11){1a.4s[0].29=11}}}1d{$("#"+j+" 12."+y.19).1I(y.19);$(1a).1t(y.19)}}1d{$("#"+j+" 12."+y.19).1I(y.19);$(1a).1t(y.19)}});$("#"+j+" 12."+y.1q).18("3i",9(e){6(1k===11)15 14;e.1U();e.2m();6(3b!=1g){6(1Y){$(1a).1t(y.19);6(t.1u===11){1a.4s[0].29=11}}}});$("#"+j+" 12."+y.1q).18("2s",9(e){6(1k===11)15 14;$(1a).1t(y.34)});$("#"+j+" 12."+y.1q).18("2J",9(e){6(1k===11)15 14;$("#"+j+" 12."+y.34).1I(y.34)});$("#"+j+" 12."+y.1q).18("2u",9(e){6(1k===11)15 14;e.1U();e.2m();6(t.1u===11){2i=14};4 a=$("#"+j+" 12."+y.19).1c;2L=(3c.1c!=a||a==0)?11:14;3j();3k();3R();3b=1g});6(t.44==14){$("#"+j+" 12."+z.12).18("1X",9(e){6(1k===11)15 14;2B(1a,"1X")});$("#"+j+" 12."+z.12).18("3i",9(e){6(1k===11)15 14;2B(1a,"3i")});$("#"+j+" 12."+z.12).18("2s",9(e){6(1k===11)15 14;2B(1a,"2s")});$("#"+j+" 12."+z.12).18("2J",9(e){6(1k===11)15 14;2B(1a,"2J")});$("#"+j+" 12."+z.12).18("2t",9(e){6(1k===11)15 14;2B(1a,"2t")});$("#"+j+" 12."+z.12).18("2u",9(e){6(1k===11)15 14;2B(1a,"2u")})}};4 X=9(){4 a=L("1l");$("#"+a).1x("1X");$("#"+a+" 12."+y.1q).1x("3i");$("#"+a+" 12."+y.1q).1x("1X");$("#"+a+" 12."+y.1q).1x("2s");$("#"+a+" 12."+y.1q).1x("2J");$("#"+a+" 12."+y.1q).1x("2t");$("#"+a+" 12."+y.1q).1x("2u")};4 Y=9(a,b,c){$("#"+a).1x(b,c);$("#"+a).4t(b);$("#"+a).18(b,c)};4 Z=9(){4 a=L("1R");4 b=L("2h");4 c=L("1l");$("#"+a).18(t.2q,9(e){6(1k===11)15 14;1O(t.2q);e.1U();e.2m();3T(e)});$("#"+a).18("2S",9(e){4 k=e.6F;6(!36&&(k==4h||k==4e||k==B||k==4f||k==4g||(k>=3a&&!A))){3T(e);6(k>=3a){4u()}1d{e.1U();e.6G()}}});$("#"+a).18("31",4v);$("#"+a).18("2I",4w);$("#"+b).18("2I",9(e){Y(a,"31",4v)});W();$("#"+a).18("45",5i);$("#"+a).18("48",5j);$("#"+a).18("3i",5k);$("#"+a).18("6H",5l);$("#"+a).18("2t",5m);$("#"+a).18("2u",5n)};4 4v=9(e){1O("31")};4 4w=9(e){1O("2I")};4 3U=9(){4 a=L("1R");4 b=L("1l");6(A===11&&t.1u===14){$("#"+a+" ."+y.32).3l();$("#"+b).1m({22:\'3Q\',2b:\'4L\'})}1d{6(t.1u===14){1Y=14};$("#"+a+" ."+y.32).2C();$("#"+b).1m({22:\'2z\',2b:\'3s\'});4 c=$("#"+b+" 12."+y.19)[0];$("#"+b+" 12."+y.19).1I(y.19);4 d=I($(c).1t(y.19));21(d)};V(V())};4 4x=9(){4 a=L("1R");4 b=(1k==11)?t.3E:1;6(1k===11){$("#"+a).1t(y.3K)}1d{$("#"+a).1I(y.3K)}};4 5o=9(){4 a=L("2h");6(t.2r=="11"){$("#"+a).18("2T",5p)};3U();4x()};4 57=9(){4 a=Q();4 b=R();a.1s(b);4 c=S();a.1s(c);4 d=U();a.1s(d);$("#"+q).5b(a);P();5o();Z();4 e=L("1l");6(t.2e!=\'\'){$("#"+e).2e(t.2e)};6(t.2f!=\'\'){$("#"+e).2f(t.2f)};6(1y t.18.3u=="9"){t.18.3u.24(u,1A)}};4 4y=9(b){4 c=L("1l");$("#"+c+" 12."+z.12).1I(y.19);6(t.1u===11){$("#"+c+" 12."+z.12+" 2y.3g").1M("29",14)};6(E(b)===11){1Z(4 i=0;i<b.1c;i++){4z(b[i])}}1d{4z(b)};9 4z(a){$($("#"+c+" 12."+z.12)[a]).1t(y.19);6(t.1u===11){$($("#"+c+" 12."+z.12)[a]).3m("2y.3g").1M("29","29")}}};4 4A=9(a,b){4 c=L("1l");4 d=a||$("#"+c+" 12."+y.19);1Z(4 i=0;i<d.1c;i++){4 e=(b===11)?d[i]:I(d[i]);H(q).1K[e].19="19"};21(d)};4 3j=9(){4 a=L("1l");4 b=$("#"+a+" 12."+y.19);6(1Y&&(C||2i)||2L){H(q).1n=-1};4 c;6(b.1c==0){c=-1}1d 6(b.1c>1){4A(b)}1d{c=I($("#"+a+" 12."+y.19))};6((H(q).1n!=c||2L)&&b.1c<=1){2L=14;4 e=3n("2H");H(q).1n=c;21(c);6(1y t.18.2H=="9"){4 d=2k();t.18.2H(d.1b,d.1L)};$("#"+q).4t("2H")}};4 21=9(a,b){6(a!==1B){4 c,1f,2D;6(a==-1){c=-1;1f="";2D="";2E(-1)}1d{6(1y a!="50"){4 d=H(q).1K[a];H(q).1n=a;c=a;1f=N(d);2D=(a>=0)?H(q).1K[a].1p:"";2E(1B,1f);1f=1f.1f}1d{c=(b&&b.1o)||H(q).1n;1f=(b&&b.1f)||H(q).1f;2D=(b&&b.1p)||H(q).1K[H(q).1n].1p||"";2E(c)}};1v("1n",c);1v("1f",1f);1v("2D",2D);1v("23",H(q).23);1v("58",2k());1v("59",$("#"+q+" 1S:19"))}};4 3n=9(a){4 b={2U:14,2V:14,2n:14};4 c=$("#"+q);2M{6(c.1M("18"+a)!==1g){b.2n=11;b.2U=11}}2O(e){}4 d;6(1y $.5q=="9"){d=$.5q(c[0],"4B")}1d{d=c.1b("4B")};6(d&&d[a]){b.2n=11;b.2V=11};15 b};4 3R=9(){3k();$("5r").18("1X",2A);$(3d).18("2S",4C);$(3d).18("2T",4D)};4 3k=9(){$("5r").1x("1X",2A);$(3d).1x("2S",4C);$(3d).1x("2T",4D)};4 5p=9(e){6(e.2W<3a&&e.2W!=4V&&e.2W!=4W){15 14};4 a=L("1l");4 b=L("2h");4 c=H(b).1f;6(c.1c==0){$("#"+a+" 12:2x").2C();V(V())}1d{$("#"+a+" 12").3l();4 d=$("#"+a+" 12:43(\'"+c+"\')").2C();6($("#"+a+" 12:1T").1c<=t.1W){V(-1)};6(d.1c>0&&!A||!1Y){$("#"+a+" ."+y.19).1I(y.19);$(d[0]).1t(y.19)}};6(!A){3o()}};4 4u=9(){6(t.2r=="11"){4 a=L("1R");4 b=L("2h");6($("#"+b+":2x").1c>0&&2i==14){$("#"+b+":2x").2C().6I("");Y(a,"2I",4w);H(b).31()}}};4 5s=9(){4 a=L("2h");6($("#"+a+":1T").1c>0){$("#"+a+":1T").3l();H(a).2I()}};4 4C=9(a){4 b=L("2h");4 c=L("1l");25(a.2W){1i B:1i 4g:a.1U();a.2m();5t();1j;1i 4e:1i 4f:a.1U();a.2m();5u();1j;1i 4U:1i 4h:a.1U();a.2m();2A();4 d=$("#"+c+" 12."+y.19).1c;2L=(3c.1c!=d||d==0)?11:14;3j();3k();3b=1g;1j;1i 4i:C=11;1j;1i 4j:2i=11;1j;2P:6(a.2W>=3a&&A===14){4u()};1j};6(1k===11)15 14;1O("2S")};4 4D=9(a){25(a.2W){1i 4i:C=14;1j;1i 4j:2i=14;1j};6(1k===11)15 14;1O("2T")};4 5i=9(a){6(1k===11)15 14;1O("45")};4 5j=9(a){6(1k===11)15 14;1O("48")};4 5k=9(a){6(1k===11)15 14;a.1U();1O("2s")};4 5l=9(a){6(1k===11)15 14;a.1U();1O("2J")};4 5m=9(a){6(1k===11)15 14;1O("2t")};4 5n=9(a){6(1k===11)15 14;1O("2u")};4 3V=9(a,b){4 c={2U:14,2V:14,2n:14};6($(a).1M("18"+b)!=1B){c.2n=11;c.2U=11};4 d=$(a).1b("4B");6(d&&d[b]){c.2n=11;c.2V=11};15 c};4 2B=9(a,b){6(t.44==14){4 c=H(q).1K[I(a)];6(3V(c,b).2n===11){6(3V(c,b).2U===11){c["18"+b]()};6(3V(c,b).2V===11){25(b){1i"2S":1i"2T":1j;2P:$(c).4t(b);1j}};15 14}}};4 1O=9(a){6(1y t.18[a]=="9"){t.18[a].24(1a,1A)};6(3n(a).2n===11){6(3n(a).2U===11){H(q)["18"+a]()}1d 6(3n(a).2V===11){25(a){1i"2S":1i"2T":1j;2P:$("#"+q).6J(a);1j}};15 14}};4 3W=9(a){4 b=L("1l");a=(a!==1B)?a:$("#"+b+" 12."+y.19);6(a.1c>0){4 c=2w(($(a).2b().2a));4 d=2w($("#"+b).1w());6(c>d){4 e=c+$("#"+b).3p()-(d/2);$("#"+b).5v({3p:e},5w)}}};4 5t=9(){4 b=L("1l");4 c=$("#"+b+" 12:1T."+z.12);4 d=$("#"+b+" 12:1T."+y.19);d=(d.1c==0)?c[0]:d;4 e=$("#"+b+" 12:1T."+z.12).1o(d);6((e<c.1c-1)){e=4E(e);6(e<c.1c){6(!C||!A||!1Y){$("#"+b+" ."+y.19).1I(y.19)};$(c[e]).1t(y.19);2E(e);6(A==11){3j()};3W($(c[e]))};6(!A){3o()}};9 4E(a){a=a+1;6(a>c.1c){15 a};6($(c[a]).3S(y.1q)===11){15 a};15 a=4E(a)}};4 5u=9(){4 b=L("1l");4 c=$("#"+b+" 12:1T."+y.19);4 d=$("#"+b+" 12:1T."+z.12);4 e=$("#"+b+" 12:1T."+z.12).1o(c[0]);6(e>=0){e=4F(e);6(e>=0){6(!C||!A||!1Y){$("#"+b+" ."+y.19).1I(y.19)};$(d[e]).1t(y.19);2E(e);6(A==11){3j()};6(2w(($(d[e]).2b().2a+$(d[e]).1w()))<=0){4 f=($("#"+b).3p()-$("#"+b).1w())-$(d[e]).1w();$("#"+b).5v({3p:f},5w)}};6(!A){3o()}};9 4F(a){a=a-1;6(a<0){15 a};6($(d[a]).3S(y.1q)===11){15 a};15 a=4F(a)}};4 3o=9(){4 a=L("1R");4 b=L("1l");4 c=$("#"+a).5x();4 d=$("#"+a).1w();4 e=$(4k).1w();4 f=$(4k).3p();4 g=$("#"+b).1w();4 h=$("#"+a).1w();4 i=t.3D.2p();6(((e+f)<3h.6K(g+d+c.2a)||i==\'6L\')&&i!=\'6M\'){h=g;$("#"+b).1m({2a:"-"+h+"2N",22:\'3Q\',1J:t.1J});6(t.1F=="11"){$("#"+a).1I("2R 2v").1t("3X")};4 h=$("#"+b).5x().2a;6(h<-10){$("#"+b).1m({2a:(2w($("#"+b).1m("2a"))-h+20+f)+"2N",1J:t.1J});6(t.1F=="11"){$("#"+a).1I("3X 2v").1t("2R")}}}1d{$("#"+b).1m({2a:h+"2N",1J:t.1J});6(t.1F=="11"){$("#"+a).1I("2R 3X").1t("2v")}};6(4X){6(F()<=7){$(\'2Q.5c\').1m("1J",t.1J-10);$("#"+a).1m("1J",t.1J+5)}}};4 3T=9(e){6(1k===11)15 14;4 a=L("1R");4 b=L("1l");6(!36){36=11;6(1E.3t!=\'\'){$("#"+1E.3t).1m({22:"2z"})};1E.3t=b;$("#"+b+" 12:2x").2C();3o();4 c=t.3C;6(c==""||c=="2z"){$("#"+b).1m({22:"3Q"});3W();6(1y t.18.2G=="9"){4 d=2k();t.18.2G(d.1b,d.1L)}}1d{$("#"+b)[c]("6N",9(){3W();6(1y t.18.2G=="9"){4 d=2k();t.18.2G(d.1b,d.1L)}})};3R()}1d{6(t.2q!==\'2s\'){2A()}}};4 2A=9(e){36=14;4 a=L("1R");4 b=L("1l");6(A===14||t.1u===11){$("#"+b).1m({22:"2z"});6(t.1F=="11"){$("#"+a).1I("2v 3X").1t("2R")}};3k();6(1y t.18.3H=="9"){4 d=2k();t.18.3H(d.1b,d.1L)};5s();V(V());$("#"+b).1m({1J:1});2E(H(q).1n)};4 56=9(){2M{35=$.2Y(11,{},H(q));1Z(4 i 3O 35){6(1y 35[i]!="9"){u[i]=35[i]}}}2O(e){};u.2D=(H(q).1n>=0)?H(q).1K[H(q).1n].1p:"";u.3Y=1E.3Y.2o;u.3Z=1E.3Z};4 4G=9(a){6(a!=1g&&1y a!="1B"){4 b=L("1l");4 c=N(a);4 d=$("#"+b+" 12."+z.12+":4H("+(a.1o)+")");15{1b:c,1L:d,1S:a,1o:a.1o}};15 1g};4 2k=9(){4 a=L("1l");4 b=H(q);4 c,1L,1S,1o;6(b.1n==-1){c=1g;1L=1g;1S=1g;1o=-1}1d{1L=$("#"+a+" 12."+y.19);6(1L.1c>1){4 d=[],4I=[],6O=[];1Z(4 i=0;i<1L.1c;i++){4 e=I(1L[i]);d.5y(e);4I.5y(b.1K[e])};c=d;1S=4I;1o=d}1d{1S=b.1K[b.1n];c=N(1S);1o=b.1n}};15{1b:c,1L:1L,1o:1o,1S:1S}};4 2E=9(a,b){4 c=L("4a");4 d={};6(a==-1){d.1p="&6P;";d.1e="";d.1h="";d.1D=""}1d 6(1y a!="1B"){4 e=H(q).1K[a];d=N(e)}1d{d=b};$("#"+c).3m("."+y.33).4J(d.1p);H(c).1e=y.3I+" "+d.1e;6(d.1h!=""){$("#"+c).3m("."+y.1h).4J(d.1h).2C()}1d{$("#"+c).3m("."+y.1h).4J("").3l()};4 f=$("#"+c).3m("3P");6(f.1c>0){$(f).1G()};6(d.1D!=""&&t.30){f=O("3P",{4p:d.1D});$("#"+c).2f(f);6(d.1z!=""){f.1e=d.1z+" "};6(d.1h==""){f.1e=f.1e+z.3L}}};4 1v=9(p,v){u[p]=v};4 4K=9(a,b,i){4 c=L("1l");4 d=14;25(a){1i"28":4 e=T(b||H(q).1K[i]);4 f;6(1A.1c==3){f=i}1d{f=$("#"+c+" 12."+z.12).1c-1};6(f<0||!f){$("#"+c+" 4q").2e(e)}1d{4 g=$("#"+c+" 12."+z.12)[f];$(g).6Q(e)};X();W();6(t.18.28!=1g){t.18.28.24(1a,1A)};1j;1i"1G":d=$($("#"+c+" 12."+z.12)[i]).3S(y.19);$("#"+c+" 12."+z.12+":4H("+i+")").1G();4 h=$("#"+c+" 12."+y.1q);6(d==11){6(h.1c>0){$(h[0]).1t(y.19);4 j=$("#"+c+" 12."+z.12).1o(h[0]);21(j)}};6(h.1c==0){21(-1)};6($("#"+c+" 12."+z.12).1c<t.1W&&!A){V(-1)};6(t.18.1G!=1g){t.18.1G.24(1a,1A)};1j}};1a.6R=9(){4 a=1A[0];51.4Y.6S.4Z(1A);25(a){1i"28":u.28.24(1a,1A);1j;1i"1G":u.1G.24(1a,1A);1j;2P:2M{H(q)[a].24(H(q),1A)}2O(e){};1j}};1a.28=9(){4 a,1f,1r,1D,1h;4 b=1A[0];6(1y b=="6T"){a=b;1f=a;2F=3N 4l(a,1f)}1d{a=b.1p||\'\';1f=b.1f||a;1r=b.1r||\'\';1D=b.1D||\'\';1h=b.1h||\'\';2F=3N 4l(a,1f);$(2F).1b("1h",1h);$(2F).1b("1D",1D);$(2F).1b("1r",1r)};1A[0]=2F;H(q).28.24(H(q),1A);1v("23",H(q)["23"]);1v("1c",H(q).1c);4K("28",2F,1A[1])};1a.1G=9(i){H(q).1G(i);1v("23",H(q)["23"]);1v("1c",H(q).1c);4K("1G",1B,i)};1a.5z=9(a,b){6(1y a=="1B"||1y b=="1B")15 14;a=a.2j();2M{1v(a,b)}2O(e){};25(a){1i"2c":H(q)[a]=b;6(b==0){H(q).1Q=14};A=(H(q).2c>1||H(q).1Q==11)?11:14;3U();1j;1i"1Q":H(q)[a]=b;A=(H(q).2c>1||H(q).1Q==11)?11:14;1Y=H(q).1Q;3U();1v(a,b);1j;1i"2K":H(q)[a]=b;1k=b;4x();1j;1i"1n":1i"1f":6(a=="1n"&&E(b)===11){$("#"+q+" 1S").1M("19",14);4A(b,11);4y(b)}1d{H(q)[a]=b;4y(H(q).1n);21(H(q).1n)};1j;1i"1c":4 c=L("1l");6(b<H(q).1c){H(q)[a]=b;6(b==0){$("#"+c+" 12."+z.12).1G();21(-1)}1d{$("#"+c+" 12."+z.12+":6U("+(b-1)+")").1G();6($("#"+c+" 12."+y.19).1c==0){$("#"+c+" 12."+y.1q+":4H(0)").1t(y.19)}};1v(a,b);1v("23",H(q)["23"])};1j;1i"1H":1j;2P:2M{H(q)[a]=b;1v(a,b)}2O(e){};1j}};1a.6V=9(a){15 u[a]||H(q)[a]};1a.1T=9(a){4 b=L("1R");6(a===11){$("#"+b).2C()}1d 6(a===14){$("#"+b).3l()}1d{15($("#"+b).1m("22")=="2z")?14:11}};1a.41=9(v){1E.41(v)};1a.3H=9(){2A()};1a.2G=9(){3T()};1a.5A=9(r){6(1y r=="1B"||r==0){15 14};t.1W=r;V(V())};1a.1W=1a.5A;1a.18=9(a,b){$("#"+q).18(a,b)};1a.1x=9(a,b){$("#"+q).1x(a,b)};1a.6W=1a.18;1a.6X=9(){15 2k()};1a.5B=9(){4 a=H(q).5B.24(H(q),1A);15 4G(a)};1a.5C=9(){4 a=H(q).5C.24(H(q),1A);15 4G(a)};1a.6Y=9(a){1a.5z("1f",a)};1a.6Z=9(){4 a=L("49");4 b=L("1R");$("#"+b+", #"+b+" *").1x();H(q).3f=H(b).3f;$("#"+b).1G();$("#"+q).70().71($("#"+q));$("#"+q).1b("1V",1g)};1a.4m=9(){21(H(q).1n)};K()};$.1P.2Y({3v:9(b){15 1a.72(9(){6(!$(1a).1b(\'1V\')){4 a=3N 1V(1a,b);$(1a).1b(\'1V\',a)}})}});$.1P.2o=$.1P.3v})(73);',62,438,'||||var||if|||function||||||||||||||||||||||||||||||||||||||||||||||||||||||true|li||false|return|||on|selected|this|data|length|else|className|value|null|description|case|break|isDisabled|postChildID|css|selectedIndex|index|text|enabled|title|appendChild|addClass|enableCheckbox|cy|height|off|typeof|imagecss|arguments|undefined|style|image|msBeautify|roundedCorner|remove|id|removeClass|zIndex|options|ui|prop|byJson|cn|fn|multiple|postID|option|visible|preventDefault|dd|visibleRows|click|isMultiple|for||bW|display|children|apply|switch|useSprite||add|checked|top|position|size|jsonTitle|append|prepend|reverseMode|postTitleTextID|controlHolded|toString|cw|span|stopPropagation|hasEvent|msDropdown|toLowerCase|event|enableAutoFilter|mouseover|mousedown|mouseup|borderRadiusTp|parseInt|hidden|input|none|ct|cm|show|selectedText|cx|opt|open|change|blur|mouseout|disabled|forcedTrigger|try|px|catch|default|div|borderRadius|keydown|keyup|byElement|byJQuery|keyCode|ddOutOfVision|extend|width|showIcon|focus|ddTitle|label|hover|orginial|isOpen||||ALPHABETS_START|lastTarget|oldSelected|document|ua|tabIndex|checkbox|Math|mouseenter|bV|bZ|hide|find|bX|cr|scrollTop|counter|auto|absolute|oldDiv|create|msDropDown|expr|toUpperCase|indexOf|name|mainCSS|rowHeight|animStyle|openDirection|disabledOpacity|childWidth|checkboxNameSuffix|close|ddTitleText|optgroup|disabledAll|fnone|cacheElement|new|in|img|block|bY|hasClass|cs|bP|cl|co|borderRadiusBtm|version|author||debug|dropdown|Contains|disabledOptionEvents|dblclick|||mousemove|postElementHolder|postTitleID|ddChild|divider|optgroupTitle|UP_ARROW|LEFT_ARROW|RIGHT_ARROW|ENTER|SHIFT|CONTROL|window|Option|refresh|overflow|selectedClass|src|ul|nodeName|childNodes|trigger|cb|bN|bO|bQ|bT|updateNow|bU|events|cd|ce|getNext|getPrev|cv|eq|op|html|cz|relative|0px|select|createPseudo|arrow|borderTop|noBorderTop|ddChildMore|shadow|ESCAPE|BACKSPACE|DELETE|isIE|prototype|call|object|Array|showicon|usesprite|childwidth|eval|cu|bS|uiData|selectedOptions|cssText|after|ddcommon|type|padding|visibility|min|target|cf|cg|ch|ci|cj|ck|bR|ca|_data|body|cc|cp|cq|animate|500|offset|push|set|showRows|namedItem|item|Marghoob|Suleman|attr|bind|unbind|250|120|9999|slideDown|_mscheck|_msddHolder|_msdd|_title|_titleText|_child|ddArrow|arrowoff|ddlabel|_msddli_|border|isCreated|navigator|userAgent|match|msie|Object|MSIE|substring|maincss|visiblerows|animstyle|opendirection|jsontitle|disabledopacity|enablecheckbox|checkboxnamesuffix|reversemode|roundedcorner|enableautofilter|getElementById|msdropdown|inArray|setAttribute|throw|There|is|an|error|json|msdrpdd|element|test|createElement|innerHTML|appendTo|outerWidth|autocomplete|clear|ddchild_|first|bottom|ceil|max|toggleClass|which|stopImmediatePropagation|mouseleave|val|triggerHandler|floor|alwaysup|alwaysdown|fast|ind|nbsp|before|act|shift|string|gt|get|addMyEvent|getData|setIndexByValue|destroy|parent|replaceWith|each|jQuery'.split('|'),0,{}));/*!
 * smartbanner.js v1.6.0 <https://github.com/ain/smartbanner.js>
 * Copyright © 2017 Ain Tohvri, contributors. Licensed under GPL-3.0.
 */
(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var Bakery=function(){function Bakery(){_classCallCheck(this,Bakery)}_createClass(Bakery,null,[{key:"getCookieExpiresString",value:function getCookieExpiresString(hideTtl){var now=new Date;var expireTime=new Date(now.getTime()+hideTtl);return"expires="+expireTime.toGMTString()+";"}},{key:"bake",value:function bake(hideTtl){document.cookie="smartbanner_exited=1; "+(hideTtl?Bakery.getCookieExpiresString(hideTtl):"")}},{key:"unbake",value:function unbake(){document.cookie="smartbanner_exited=; expires=Thu, 01 Jan 1970 00:00:01 GMT;"}},{key:"baked",get:function get(){var value=document.cookie.replace(/(?:(?:^|.*;\s*)smartbanner_exited\s*\=\s*([^;]*).*$)|^.*$/,"$1");return value==="1"}}]);return Bakery}();exports.default=Bakery},{}],2:[function(require,module,exports){(function(global){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var Detector=function(){function Detector(){_classCallCheck(this,Detector)}_createClass(Detector,null,[{key:"platform",value:function platform(){if(/iPhone|iPad|iPod/i.test(window.navigator.userAgent)){return"ios"}else if(/Android/i.test(window.navigator.userAgent)){return"android"}}},{key:"userAgentMatchesRegex",value:function userAgentMatchesRegex(regexString){return new RegExp(regexString).test(window.navigator.userAgent)}},{key:"jQueryMobilePage",value:function jQueryMobilePage(){return typeof global.$!=="undefined"&&global.$.mobile!=="undefined"&&document.querySelector(".ui-page")!==null}},{key:"wrapperElement",value:function wrapperElement(){var selector=Detector.jQueryMobilePage()?".ui-page":"html";return document.querySelectorAll(selector)}}]);return Detector}();exports.default=Detector}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],3:[function(require,module,exports){"use strict";var _smartbanner=require("./smartbanner.js");var _smartbanner2=_interopRequireDefault(_smartbanner);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var smartbanner=void 0;window.addEventListener("load",function(){smartbanner=new _smartbanner2.default;smartbanner.publish()})},{"./smartbanner.js":7}],4:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();require("./polyfills/array/from.js");require("./polyfills/array/includes.js");function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function valid(name){return name.indexOf("smartbanner:")!==-1&&name.split(":")[1].length>0}function convertToCamelCase(name){var parts=name.split("-");parts.map(function(part,index){if(index>0){parts[index]=part.charAt(0).toUpperCase()+part.substring(1)}});return parts.join("")}var OptionParser=function(){function OptionParser(){_classCallCheck(this,OptionParser)}_createClass(OptionParser,[{key:"parse",value:function parse(){var metas=document.getElementsByTagName("meta");var options={};var optionName=null;Array.from(metas).forEach(function(meta){var name=meta.getAttribute("name");var content=meta.getAttribute("content");if(name&&content&&valid(name)&&content.length>0){optionName=name.split(":")[1];if(Array.from(optionName).includes("-")){optionName=convertToCamelCase(optionName)}options[optionName]=content}});return options}}]);return OptionParser}();exports.default=OptionParser},{"./polyfills/array/from.js":5,"./polyfills/array/includes.js":6}],5:[function(require,module,exports){"use strict";if(!Array.from){Array.from=function(){var toStr=Object.prototype.toString;var isCallable=function isCallable(fn){return typeof fn==="function"||toStr.call(fn)==="[object Function]"};var toInteger=function toInteger(value){var number=Number(value);if(isNaN(number)){return 0}if(number===0||!isFinite(number)){return number}return(number>0?1:-1)*Math.floor(Math.abs(number))};var maxSafeInteger=Math.pow(2,53)-1;var toLength=function toLength(value){var len=toInteger(value);return Math.min(Math.max(len,0),maxSafeInteger)};return function from(arrayLike){var C=this;var items=Object(arrayLike);if(arrayLike==null){throw new TypeError("Array.from requires an array-like object - not null or undefined")}var mapFn=arguments.length>1?arguments[1]:void undefined;var T;if(typeof mapFn!=="undefined"){if(!isCallable(mapFn)){throw new TypeError("Array.from: when provided, the second argument must be a function")}if(arguments.length>2){T=arguments[2]}}var len=toLength(items.length);var A=isCallable(C)?Object(new C(len)):new Array(len);var k=0;var kValue;while(k<len){kValue=items[k];if(mapFn){A[k]=typeof T==="undefined"?mapFn(kValue,k):mapFn.call(T,kValue,k)}else{A[k]=kValue}k+=1}A.length=len;return A}}()}},{}],6:[function(require,module,exports){"use strict";if(!Array.prototype.includes){Array.prototype.includes=function(searchElement){"use strict";if(this==null){throw new TypeError("Array.prototype.includes called on null or undefined")}var O=Object(this);var len=parseInt(O.length,10)||0;if(len===0){return false}var n=parseInt(arguments[1],10)||0;var k;if(n>=0){k=n}else{k=len+n;if(k<0){k=0}}var currentElement;while(k<len){currentElement=O[k];if(searchElement===currentElement||searchElement!==searchElement&&currentElement!==currentElement){return true}k++}return false}}},{}],7:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _optionparser=require("./optionparser.js");var _optionparser2=_interopRequireDefault(_optionparser);var _detector=require("./detector.js");var _detector2=_interopRequireDefault(_detector);var _bakery=require("./bakery.js");var _bakery2=_interopRequireDefault(_bakery);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var DEFAULT_PLATFORMS="android,ios";var datas={originalTop:"data-smartbanner-original-top",originalMarginTop:"data-smartbanner-original-margin-top"};function handleExitClick(event,self){self.exit();event.preventDefault()}function handleJQueryMobilePageLoad(event){if(!this.positioningDisabled){setContentPosition(event.data.height)}}function addEventListeners(self){var closeIcon=document.querySelector(".js_smartbanner__exit");closeIcon.addEventListener("click",function(event){return handleExitClick(event,self)});if(_detector2.default.jQueryMobilePage()){$(document).on("pagebeforeshow",self,handleJQueryMobilePageLoad)}}function removeEventListeners(){if(_detector2.default.jQueryMobilePage()){$(document).off("pagebeforeshow",handleJQueryMobilePageLoad)}}function setContentPosition(value){var wrappers=_detector2.default.wrapperElement();for(var i=0,l=wrappers.length,wrapper;i<l;i++){wrapper=wrappers[i];if(_detector2.default.jQueryMobilePage()){if(wrapper.getAttribute(datas.originalTop)){continue}var top=parseFloat(getComputedStyle(wrapper).top);wrapper.setAttribute(datas.originalTop,isNaN(top)?0:top);wrapper.style.top=value+"px"}else{if(wrapper.getAttribute(datas.originalMarginTop)){continue}var margin=parseFloat(getComputedStyle(wrapper).marginTop);wrapper.setAttribute(datas.originalMarginTop,isNaN(margin)?0:margin);wrapper.style.marginTop=value+"px"}}}function restoreContentPosition(){var wrappers=_detector2.default.wrapperElement();for(var i=0,l=wrappers.length,wrapper;i<l;i++){wrapper=wrappers[i];if(_detector2.default.jQueryMobilePage()&&wrapper.getAttribute(datas.originalTop)){wrapper.style.top=wrapper.getAttribute(datas.originalTop)+"px"}else if(wrapper.getAttribute(datas.originalMarginTop)){wrapper.style.marginTop=wrapper.getAttribute(datas.originalMarginTop)+"px"}}}var SmartBanner=function(){function SmartBanner(){_classCallCheck(this,SmartBanner);var parser=new _optionparser2.default;this.options=parser.parse();this.platform=_detector2.default.platform()}_createClass(SmartBanner,[{key:"publish",value:function publish(){if(Object.keys(this.options).length===0){throw new Error("No options detected. Please consult documentation.")}if(_bakery2.default.baked){return false}if(this.userAgentExcluded){return false}if(!(this.platformEnabled||this.userAgentIncluded)){return false}var bannerDiv=document.createElement("div");document.querySelector("body").appendChild(bannerDiv);bannerDiv.outerHTML=this.html;if(!this.positioningDisabled){setContentPosition(this.height)}addEventListeners(this)}},{key:"exit",value:function exit(){removeEventListeners();if(!this.positioningDisabled){restoreContentPosition()}var banner=document.querySelector(".js_smartbanner");document.querySelector("body").removeChild(banner);_bakery2.default.bake(this.hideTtl)}},{key:"originalTop",get:function get(){var wrapper=_detector2.default.wrapperElement()[0];return parseFloat(wrapper.getAttribute(datas.originalTop))}},{key:"originalTopMargin",get:function get(){var wrapper=_detector2.default.wrapperElement()[0];return parseFloat(wrapper.getAttribute(datas.originalMarginTop))}},{key:"priceSuffix",get:function get(){if(this.platform==="ios"){return this.options.priceSuffixApple}else if(this.platform==="android"){return this.options.priceSuffixGoogle}return""}},{key:"icon",get:function get(){if(this.platform==="android"){return this.options.iconGoogle}else{return this.options.iconApple}}},{key:"buttonUrl",get:function get(){if(this.platform==="android"){return this.options.buttonUrlGoogle}else if(this.platform==="ios"){return this.options.buttonUrlApple}return"#"}},{key:"html",get:function get(){return'<div class="smartbanner smartbanner--'+this.platform+' js_smartbanner">\n      <a href="javascript:void();" class="smartbanner__exit js_smartbanner__exit"></a>\n      <div class="smartbanner__icon" style="background-image: url('+this.icon+');"></div>\n      <div class="smartbanner__info">\n        <div>\n          <div class="smartbanner__info__title">'+this.options.title+'</div>\n          <div class="smartbanner__info__author">'+this.options.author+'</div>\n          <div class="smartbanner__info__price">'+this.options.price+this.priceSuffix+'</div>\n        </div>\n      </div>\n      <a href="'+this.buttonUrl+'" target="_blank" class="smartbanner__button"><span class="smartbanner__button__label">'+this.options.button+"</span></a>\n    </div>"}},{key:"height",get:function get(){var height=document.querySelector(".js_smartbanner").offsetHeight;return height!==undefined?height:0}},{key:"platformEnabled",get:function get(){var enabledPlatforms=this.options.enabledPlatforms||DEFAULT_PLATFORMS;return enabledPlatforms&&enabledPlatforms.replace(/\s+/g,"").split(",").indexOf(this.platform)!==-1}},{key:"positioningDisabled",get:function get(){return this.options.disablePositioning==="true"}},{key:"userAgentExcluded",get:function get(){if(!this.options.excludeUserAgentRegex){return false}return _detector2.default.userAgentMatchesRegex(this.options.excludeUserAgentRegex)}},{key:"userAgentIncluded",get:function get(){if(!this.options.includeUserAgentRegex){return false}return _detector2.default.userAgentMatchesRegex(this.options.includeUserAgentRegex)}},{key:"hideTtl",get:function get(){return this.options.hideTtl?parseInt(this.options.hideTtl):false}}]);return SmartBanner}();exports.default=SmartBanner},{"./bakery.js":1,"./detector.js":2,"./optionparser.js":4}]},{},[3]);;$(document).ready(function(){'use strict';var bootMenu={adaptationWidth:767,init:function(){this.cacheDom();this.bindEvents();this.loadCarousel();this.loadNewsTicker();this.loadSprites();this.calculateDistance();this.setResizeOptions();this.stickToTop();},cacheDom:function(){this.$document=$(document);this.$window=$(window);this.$html=$('html');this.$body=$('body');this.$html_body=$('html, body');this.$page_contents=$('#page-contents');this.$owl_carousel=this.$body.find('.owl-carousel');this.$news_ticker=this.$body.find('#js-news');this.$solid_menus=$('.solid-menus');this.$navbar=this.$body.find('.navbar');this.$navbar_nav_li_a=this.$body.find('.navbar-nav > li > a.dropdown-toggle');this.$navbar_push=this.$body.find('.navbar-push');this.$navbar_off=this.$body.find('.navbar-off-canvas');this.$navbar_collapse_push=this.$body.find('.navbar-push .navbar-collapse');this.$navbar_collapse_off=this.$body.find('.navbar-off-canvas .navbar-collapse');this.$navbar_toggle=this.$body.find('.navbar-toggle');this.$tab_nav=this.$body.find('.tab-nav');this.$tab_nav_links=this.$body.find('.tab-nav > li > a');this.$tab_nav_links_click_strict=this.$body.find('.tab-nav.tab-nav-click-strict > li > a');this.$navbar_nav=this.$body.find('.navbar-nav');this.$navbar_header=this.$body.find('.navbar-header');this.$dropdown=this.$body.find('.dropdown');this.$dropdown_custom=this.$body.find('.dropdown-custom');this.$dropdown_autoheight=this.$body.find('.dropdown-autoheight');this.$dropdown_menu=this.$body.find('.dropdown-menu');this.$sub_marker=this.$dropdown_menu.find('.sub-marker');this.$top_search=this.$body.find('#top-search');this.$search_close=this.$body.find('.x-search-close');this.$sprite_list=this.$body.find('.s-list-sprite > li > a');this.$tile_container=this.$body.find('.tile-container');this.$back_2_top=this.$body.find('#back-2-top');this.$top_social_links=this.$body.find('#top-social a');this.$mini_menu=this.$body.find('.mini-menu');this.$mini_nav=this.$body.find('.mini-nav');this.$rocket_idle=this.$body.find('#rocket-idle');this.$rocket_blast=this.$body.find('#rocket-blast');this.$a_w_title=this.$body.find('a[data-title]');this.$pure_sticky=this.$body.find('#sticky');this.$sticky=this.$body.find('#sticky.navbar-static-top');},bindEvents:function(){this.$body.on('click mouseenter','.tab-nav > li > a',this.setActiveTab);this.$body.on('click mouseenter mouseleave','.dropdown',this.showDropDown);this.$body.on('click mouseenter','.dropdown.dropdown-convey-width',this.conveyWidth);this.$body.on('click mouseenter','.dropdown.dropdown-convey-height',this.conveyHeight);this.$document.on('click','.navbar .dropdown-menu',this.stopPropagation);this.$body.on('click','.navbar-click .dropdown-right, .navbar-click .dropdown-left',this.setActiveMenu);this.$body.on('click','.x-search',this.activateTopSearch);this.$body.on('click mouseenter','.dropdown-autoheight',this.calculateHeight);this.$body.on('click','.sub-marker',this.setMenuActive);this.$window.on('resize',this.setResizeOptions.bind(this));this.$window.on('scroll',this.scrollSettings.bind(this));this.$body.on('click','#back-2-top',this.backToTop);this.$document.on('click','html',this.clickOutsideNav);this.$body.on('mouseenter mouseleave','#top-social a',this.topSocial);this.$body.on('mouseenter mouseleave click','.mini-nav',this.showDropDownMini);this.$body.on('mouseleave','.mini-nav',this.removeBlockSettings);this.$body.on('click','.prev-default',function(event){event.preventDefault();})
this.$body.on('click','.navbar-push .navbar-toggle',this.noOverflow.bind(this));this.$body.on('click','.navbar-off-canvas .navbar-toggle',this.noOverflow.bind(this));this.$body.on('click','.off-canvas-close p a',this.normalizeNav.bind(this));},loadCarousel:function(){if(this.checkExistence(this.$owl_carousel)){this.$owl_carousel.each(function(){var _this=$(this);var single_item=Boolean(_this.attr('data-single-item'));var items_no=_this.attr('data-items')?Number(_this.attr('data-items')):4;var navigation_value=_this.attr('data-navigation')?Boolean(_this.attr('data-navigation')):false;var autoplay_interval=_this.attr('data-autoplay')?Number(_this.attr('data-autoplay')):3000;var stop_on_hover=_this.attr('data-stop-on-hover')?Boolean(_this.attr('data-stop-on-hover')):false;var pagination_value=_this.attr('data-pagination')?Boolean(_this.attr('data-pagination')):true;var transition_value=_this.attr('data-transition')?String(_this.attr('data-transition')):false;var items_lg=_this.attr('data-items-lg')?Number(_this.attr('data-items-lg')):4;var items_md=_this.attr('data-items-md')?Number(_this.attr('data-items-md')):4;var items_sm=_this.attr('data-items-sm')?Number(_this.attr('data-items-sm')):2;var items_xs=_this.attr('data-items-xs')?Number(_this.attr('data-items-xs')):1;if(single_item==true){_this.owlCarousel({lazyLoad:true,single_item:true,pagination:false,autoPlay:autoplay_interval,navigation:navigation_value,navigationText:["<i class='icon-angle-left'></i>","<i class='icon-angle-right'></i>"],transitionStyle:transition_value});}else{_this.owlCarousel({lazyLoad:true,items:items_no,navigation:navigation_value,navigationText:["prev","next"],pagination:pagination_value,autoPlay:autoplay_interval,stopOnHover:stop_on_hover,itemsCustom:[[0,items_xs],[400,items_sm],[700,items_md],[1000,items_lg],[1200,items_lg],[1600,items_lg]],transitionStyle:transition_value});}});}},loadNewsTicker:function(){if(this.checkExistence(this.$news_ticker)){this.$news_ticker.ticker({htmlFeed:true,controls:false,titleText:'',speed:0.18,displayType:'reveal',direction:'ltr',pauseOnItems:5000,fadeInSpeed:600,fadeOutSpeed:600});}},loadSprites:function(){if(this.checkExistence(this.$sprite_list)){this.$sprite_list.each(function(){var _this=$(this);var x_pos=_this.attr('data-pos-x');var y_pos=_this.attr('data-pos-y');_this.css('background-position',x_pos+'px'+' '+y_pos+'px');});}},stopPropagation:function(event){event.stopPropagation();},setActiveTab:function(event){var _this=$(this);var tab_value=_this.attr('data-tabs');var parent=_this.parent();var siblings=parent.siblings();var tab_container=_this.parents('.tab-nav').siblings('.tab-container')
var target_tab_content=tab_container.children('div#'+tab_value);if(event.type=='mouseenter'&&_this.parents('.tab-nav').hasClass('tab-nav-hover')){parent.addClass('ui-tabs-active');siblings.removeClass('ui-tabs-active');target_tab_content.addClass('l-block').siblings().removeClass('l-block');}else if(event.type=='click'){parent.addClass('ui-tabs-active');siblings.removeClass('ui-tabs-active');target_tab_content.addClass('l-block').siblings().removeClass('l-block');}},showDropDown:function(event){var _this=$(this);if(event.type=='mouseenter'&&bootMenu.$navbar.hasClass('navbar-hover')){bootMenu.setDropAnimation(_this);}else if(event.type=='click'&&bootMenu.$navbar.hasClass('navbar-click')){bootMenu.setDropAnimation(_this);}else if(event.type=='mouseleave'&&bootMenu.$navbar.hasClass('navbar-hover')){bootMenu.$dropdown.removeClass('open');bootMenu.$mini_nav.find('.dropdown-menu').removeClass('l-block');}},showDropDownMini:function(event){var _this=$(this);if(_this.hasClass('navbar-hover')||_this.hasClass('navbar-click')){if(event.type=='mouseenter'&&bootMenu.$mini_nav.hasClass('navbar-hover')){_this.find('.dropdown-menu').addClass('l-block');bootMenu.setDropAnimation(_this);}else if(event.type=='click'&&bootMenu.$mini_nav.hasClass('navbar-click')){_this.find('.dropdown-menu').addClass('l-block');bootMenu.setDropAnimation(_this);_this.parent().siblings().find('.dropdown-menu').removeClass('l-block');}else if(event.type=="mouseleave"){bootMenu.removeBlockSettings();}}else{_this.find('.dropdown-menu').addClass('l-block');bootMenu.setDropAnimation(_this);_this.parent().siblings().find('.dropdown-menu').removeClass('l-block');}},setActiveMenu:function(event){var _this=$(this);if(_this.hasClass('dropdown-parent')){_this.find('.dropdown-right .dropdown-menu, .dropdown-left .dropdown-menu').removeClass('l-block');_this.siblings('.dropdown-parent').find('.dropdown-menu').removeClass('l-block');_this.children('.dropdown-menu').toggleClass('l-block');}else{_this.children('.dropdown-menu').toggleClass('l-block');}
bootMenu.showDropDown(_this);event.stopPropagation();},activateTopSearch:function(event){var _this=$(this);if(_this.hasClass('x-search-trigger')){bootMenu.$navbar_header.hide();bootMenu.$navbar_nav.hide();bootMenu.$top_search.fadeIn(500).find('input').focus();bootMenu.$navbar_collapse_push.removeClass('in');bootMenu.$navbar_collapse_off.removeClass('in');bootMenu.$page_contents.removeClass('body-push-right');}else{bootMenu.$top_search.hide()
bootMenu.$navbar_header.fadeIn(1000);bootMenu.$navbar_nav.fadeIn(1100);}
_this.fadeOut().siblings().show();event.preventDefault();},calculateHeight:function(event){var _this=$(this);var col_autoheight=_this.find('.col-autoheight');var dropdown_menu=_this.find('.dropdown-menu');var adjustment=dropdown_menu.attr('data-adjust')?dropdown_menu.attr('data-adjust'):Number(0);var computed_h=dropdown_menu.outerHeight();if(window.innerWidth>bootMenu.adaptationWidth){dropdown_menu.css('height',computed_h);col_autoheight.css('height',computed_h-adjustment);}else{dropdown_menu.css('height','auto !important');col_autoheight.css('height','auto !important');}},conveyWidth:function(event){var _this=$(this);var dropdown_menu=_this.find('.dropdown-menu');var dropdown_menu_c=$('.dropdown.dropdown-convey-width').find('.dropdown-menu');var computed_w=_this.children('.dropdown-menu').outerWidth();if(window.innerWidth>bootMenu.adaptationWidth){dropdown_menu.css('width',computed_w);}else{dropdown_menu_c.css('width','auto');}},conveyHeight:function(event){var _this=$(this);var dropdown_custom=_this.children('.dropdown-menu');var computed_h=_this.parent('.dropdown-menu').outerHeight();if(window.innerWidth>bootMenu.adaptationWidth){dropdown_custom.css('height',computed_h);}else{dropdown_custom.css('height','100%');}},calculateDistance:function(event){this.$dropdown_custom.each(function(){var _this=$(this);var dropdown_menu=_this.children('.dropdown-menu');var offset_value_y=Number(dropdown_menu.attr('data-offset-y'));if(window.innerWidth>bootMenu.adaptationWidth){dropdown_menu.css('top',offset_value_y);}else{dropdown_menu.css('top','auto');}});},setResizeOptions:function(){if(window.innerWidth<=bootMenu.adaptationWidth){this.removeBlockSettings();this.conveyWidth();this.$navbar.removeClass('navbar-hover').addClass('navbar-click');this.$tab_nav.removeClass('tab-nav-hover');this.$tab_nav_links_click_strict.removeClass('prev-default');this.$sub_marker.addClass('prev-default').removeClass('allow-default');this.$navbar_nav_li_a.removeClass('disabled');}else{this.navOptions();this.tabOptions();this.calculateDistance();this.$tab_nav_links_click_strict.addClass('prev-default');this.$sub_marker.removeClass('prev-default').addClass('allow-default');this.$navbar_nav_li_a.addClass('disabled');this.normalizeNav();}
if(window.innerWidth<=991&&window.innerWidth>bootMenu.adaptationWidth){this.activateTitle();}else{this.$a_w_title.removeAttr('title');}},scrollSettings:function(){var scroll_distance=this.$back_2_top.attr('data-scroll-distance');if(this.$window.scrollTop()>scroll_distance){this.$back_2_top.fadeIn();}else{this.$back_2_top.fadeOut();this.$rocket_idle.show();this.$rocket_blast.hide();}},stickToTop:function(){var that=this;if(this.checkExistence(this.$sticky)){var waypoint=this.$sticky.waypoint({handler:function(direction){if(direction=='down'){that.$sticky.removeClass('navbar-static-top').addClass('navbar-fixed-top');}else if(direction=='up'){that.$sticky.removeClass('navbar-fixed-top').addClass('navbar-static-top');}}});}},normalizeNav:function(){if(this.checkExistence(this.$navbar_push)){this.$body.removeClass('no-overflow');this.$body.removeClass('no-scroll');this.$page_contents.removeClass('body-push-right');this.$navbar_collapse_push.removeClass('collapse-push-right in');this.$navbar.removeClass('navbar-fixed-top').addClass('navbar-static-top');}
if(this.checkExistence(this.$navbar_off)){this.$body.removeClass('no-overflow');this.$body.removeClass('no-scroll');this.$page_contents.removeClass('body-push-right');this.$navbar_collapse_off.removeClass('collapse-push-right in');if(this.$pure_sticky.length>0){this.$navbar.removeClass('navbar-fixed-top').addClass('navbar-static-top');}}
this.$page_contents.off('touchmove');},backToTop:function(event){var _this=$(this);var easing_value=_this.data('easing')?_this.data('easing'):'swing';bootMenu.$html_body.animate({scrollTop:0},1250,easing_value);_this.children('#rocket-blast').show().addClass('animated shake');_this.children('#rocket-idle').hide();},navOptions:function(){if(this.$navbar.hasClass('navbar-click-strict')){this.$navbar.addClass('navbar-click').removeClass('navbar-hover');}else{this.$navbar.removeClass('navbar-click').addClass('navbar-hover');}
if(this.checkExistence(this.$navbar_push)){this.$body.removeClass('no-overflow');this.$page_contents.removeClass('move-right');}},tabOptions:function(){if(this.$tab_nav.hasClass('tab-nav-click-strict')){this.$tab_nav.removeClass('tab-nav-hover');}else{this.$tab_nav.addClass('tab-nav-hover');}},clickOutsideNav:function(event){if($(event.target).closest('#nav-section').length==0){bootMenu.removeBlockSettings();}},removeBlockSettings:function(){bootMenu.$dropdown_menu.removeClass('l-block');},setMenuActive:function(event){var _this=$(this);if(!_this.hasClass('allow-default')){event.preventDefault();}},setDropAnimation:function(_this){var animation_value=_this.attr('data-animation')?_this.attr('data-animation'):'fadeIn';var dropdown_menu=_this.find('.dropdown-menu').first();dropdown_menu.removeClass('animated').addClass('animated '+animation_value);},topSocial:function(event){var _this=$(this);var hover_width=_this.data('hover-width');var hover_bg=_this.data('hover-bg');if(event.type=='mouseenter'){_this.css({'width':hover_width,'background-color':hover_bg});}else if(event.type=='mouseleave'){bootMenu.$top_social_links.css({'width':'40','background-color':'transparent'});}},activateTitle:function(){if(this.checkExistence(this.$a_w_title)){this.$a_w_title.each(function(){var _this=$(this);var title_value=_this.data('title')
_this.attr('title',title_value);});}},noOverflow:function(){if(this.checkExistence(this.$navbar_push)){this.$navbar_collapse_push.toggleClass('collapse-push-right');this.$body.toggleClass('no-overflow');this.$page_contents.toggleClass('body-push-right');}
if(this.checkExistence(this.$navbar_off)){this.$navbar_collapse_push.toggleClass('collapse-push-right');this.$body.toggleClass('no-overflow');this.$page_contents.toggleClass('body-push-right');}
if(this.$page_contents.hasClass('body-push-right')){this.$page_contents.on('touchmove',function(e){e.preventDefault();});this.$navbar.addClass('navbar-fixed-top').removeClass('navbar-static-top');}else{this.$page_contents.off('touchmove');this.$navbar.removeClass('navbar-fixed-top').addClass('navbar-static-top');}},checkExistence:function(target_element){if(target_element.length>0){return true;}else{return false;}}}
bootMenu.init();$('#position-settings').on('click','button',function(){var _this=$(this);var pos_value=_this.attr('data-pos');var wrapper=$('#wrapper');var outer_container=$('#solidMenus');var row_carousel=$('#row-carousel');var navbar=$('.navbar');var navbar_inner=$('#navbar-inner-container');var main_carousel=$('#main-carousel');var page_contents=$('#page-contents');outer_container.removeClass('container-fluid container');navbar_inner.removeClass('container-fluid container');navbar.removeClass('navbar-static-top navbar-fixed-top');page_contents.removeClass('container-fluid container');switch(pos_value){case'default':wrapper.css({'padding-top':'20px','padding-bottom':'20px'});outer_container.addClass('container-fluid').removeAttr('style');navbar_inner.addClass('container-fluid');row_carousel.removeAttr('style').hide();page_contents.addClass('container-fluid');break;case'default-short':wrapper.css({'padding-top':'20px','padding-bottom':'20px'});outer_container.addClass('container').removeAttr('style');navbar_inner.addClass('container-fluid');row_carousel.removeAttr('style').hide();page_contents.addClass('container');break;case'static-top':wrapper.css('padding-top','0');outer_container.addClass('container-fluid').css({'padding-left':0,'padding-right':0});navbar_inner.addClass('container-fluid');navbar.addClass('navbar-static-top');row_carousel.css({'padding':'20px 15px','margin-top':'0'}).hide();page_contents.addClass('container-fluid');break;case'static-top-short':wrapper.css('padding-top','0');outer_container.addClass('container-fluid').css({'padding-left':0,'padding-right':0});navbar_inner.addClass('container');navbar.addClass('navbar-static-top');row_carousel.css({'padding':'20px 15px','margin-top':'0'}).hide();page_contents.addClass('container-fluid');break;case'fixed-top':wrapper.css('padding-top','0');outer_container.addClass('container-fluid').css({'padding-left':0,'padding-right':0});navbar_inner.addClass('container-fluid');navbar.addClass('navbar-fixed-top');row_carousel.css({'padding':'15px','margin-top':'55px'});page_contents.addClass('container-fluid').css({'margin-top':'50px'});break;case'fixed-top-short':wrapper.css('padding-top','0');outer_container.addClass('container-fluid').css({'padding-left':0,'padding-right':0});navbar_inner.addClass('container');navbar.addClass('navbar-fixed-top');row_carousel.css({'padding':'15px','margin-top':'55px'}).hide();page_contents.addClass('container-fluid').css({'margin-top':'50px'});break;}});if($('#menu-demos').length===1){$('#menu-demos').load('ajax/demos.html');}
if($('#menu-themes').length===1){$('#menu-themes').load('ajax/themes.html',function(){$('.color-box').on('click','li',function(){var _this=$(this);var navbar=$('.navbar');var mini_menu=$('.mini-menu');var theme_value=_this.attr('data-theme');var theme_value_s=_this.attr('data-theme-s');navbar.removeClass('navbar-dark navbar-red navbar-blue navbar-purple navbar-orange').addClass(theme_value);mini_menu.removeClass('mini-menu-light mini-menu-dark mini-menu-blue').addClass(theme_value_s);});});}});;$(document).ready(function(){$(document).on('click','.add_to_compare',function(e){e.preventDefault();if(typeof addToCompare!='undefined')
addToCompare(parseInt($(this).data('id-product')));});reloadProductComparison();compareButtonsStatusRefresh();totalCompareButtons();});function addToCompare(productId)
{var totalValueNow=parseInt($('.bt_compare').next('.compare_product_count').val());var action,totalVal;if($.inArray(parseInt(productId),comparedProductsIds)===-1)
action='add';else
action='remove';$.ajax({url:baseUri+'?controller=products-comparison&ajax=1&action='+action+'&id_product='+productId,async:true,cache:false,success:function(data){if(action==='add'&&comparedProductsIds.length<comparator_max_item){comparedProductsIds.push(parseInt(productId)),compareButtonsStatusRefresh(),totalVal=totalValueNow+1,$('.bt_compare').next('.compare_product_count').val(totalVal),totalValue(totalVal);}
else if(action==='remove'){comparedProductsIds.splice($.inArray(parseInt(productId),comparedProductsIds),1),compareButtonsStatusRefresh(),totalVal=totalValueNow-1,$('.bt_compare').next('.compare_product_count').val(totalVal),totalValue(totalVal);}
else
{if(!!$.prototype.fancybox)
$.fancybox.open([{type:'inline',autoScale:true,minHeight:30,content:'<p class="fancybox-error">'+max_item+'</p>'}],{padding:0});else
alert(max_item);}
totalCompareButtons();},error:function(){}});}
function reloadProductComparison()
{$(document).on('click','a.cmp_remove',function(e){e.preventDefault();var idProduct=parseInt($(this).data('id-product'));$.ajax({url:baseUri+'?controller=products-comparison&ajax=1&action=remove&id_product='+idProduct,async:false,cache:false});$('td.product-'+idProduct).fadeOut(600);var compare_product_list=get('compare_product_list');var bak=compare_product_list;var new_compare_product_list=[];compare_product_list=decodeURIComponent(compare_product_list).split('|');for(var i in compare_product_list)
if(parseInt(compare_product_list[i])!=idProduct)
new_compare_product_list.push(compare_product_list[i]);if(new_compare_product_list.length)
window.location.search=window.location.search.replace(bak,new_compare_product_list.join(encodeURIComponent('|')));});};function compareButtonsStatusRefresh()
{$('.add_to_compare').each(function(){if($.inArray(parseInt($(this).data('id-product')),comparedProductsIds)!==-1)
$(this).addClass('checked');else
$(this).removeClass('checked');});}
function totalCompareButtons()
{var totalProductsToCompare=parseInt($('.bt_compare .total-compare-val').html());if(typeof totalProductsToCompare!=="number"||totalProductsToCompare===0)
$('.bt_compare').attr("disabled",true);else
$('.bt_compare').attr("disabled",false);}
function totalValue(value)
{$('.bt_compare').find('.total-compare-val').html(value);}
function get(name)
{var regexS="[\\?&]"+name+"=([^&#]*)";var regex=new RegExp(regexS);var results=regex.exec(window.location.search);if(results==null)
return"";else
return results[1];};/*! jQuery UI - v1.11.4 - 2015-12-20
* http://jqueryui.com
* Includes: core.js, widget.js, mouse.js, draggable.js, droppable.js, sortable.js
* Copyright jQuery Foundation and other contributors; Licensed MIT */

(function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)})(function(e){function t(t,s){var n,a,o,r=t.nodeName.toLowerCase();return"area"===r?(n=t.parentNode,a=n.name,t.href&&a&&"map"===n.nodeName.toLowerCase()?(o=e("img[usemap='#"+a+"']")[0],!!o&&i(o)):!1):(/^(input|select|textarea|button|object)$/.test(r)?!t.disabled:"a"===r?t.href||s:s)&&i(t)}function i(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}e.ui=e.ui||{},e.extend(e.ui,{version:"1.11.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({scrollParent:function(t){var i=this.css("position"),s="absolute"===i,n=t?/(auto|scroll|hidden)/:/(auto|scroll)/,a=this.parents().filter(function(){var t=e(this);return s&&"static"===t.css("position")?!1:n.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))}).eq(0);return"fixed"!==i&&a.length?a:e(this[0].ownerDocument||document)},uniqueId:function(){var e=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(i){return!!e.data(i,t)}}):function(t,i,s){return!!e.data(t,s[3])},focusable:function(i){return t(i,!isNaN(e.attr(i,"tabindex")))},tabbable:function(i){var s=e.attr(i,"tabindex"),n=isNaN(s);return(n||s>=0)&&t(i,!n)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(t,i){function s(t,i,s,a){return e.each(n,function(){i-=parseFloat(e.css(t,"padding"+this))||0,s&&(i-=parseFloat(e.css(t,"border"+this+"Width"))||0),a&&(i-=parseFloat(e.css(t,"margin"+this))||0)}),i}var n="Width"===i?["Left","Right"]:["Top","Bottom"],a=i.toLowerCase(),o={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+i]=function(t){return void 0===t?o["inner"+i].call(this):this.each(function(){e(this).css(a,s(this,t)+"px")})},e.fn["outer"+i]=function(t,n){return"number"!=typeof t?o["outer"+i].call(this,t):this.each(function(){e(this).css(a,s(this,t,!0,n)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(i){return arguments.length?t.call(this,e.camelCase(i)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.fn.extend({focus:function(t){return function(i,s){return"number"==typeof i?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),s&&s.call(t)},i)}):t.apply(this,arguments)}}(e.fn.focus),disableSelection:function(){var e="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(e+".ui-disableSelection",function(e){e.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(t){if(void 0!==t)return this.css("zIndex",t);if(this.length)for(var i,s,n=e(this[0]);n.length&&n[0]!==document;){if(i=n.css("position"),("absolute"===i||"relative"===i||"fixed"===i)&&(s=parseInt(n.css("zIndex"),10),!isNaN(s)&&0!==s))return s;n=n.parent()}return 0}}),e.ui.plugin={add:function(t,i,s){var n,a=e.ui[t].prototype;for(n in s)a.plugins[n]=a.plugins[n]||[],a.plugins[n].push([i,s[n]])},call:function(e,t,i,s){var n,a=e.plugins[t];if(a&&(s||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(n=0;a.length>n;n++)e.options[a[n][0]]&&a[n][1].apply(e.element,i)}};var s=0,n=Array.prototype.slice;e.cleanData=function(t){return function(i){var s,n,a;for(a=0;null!=(n=i[a]);a++)try{s=e._data(n,"events"),s&&s.remove&&e(n).triggerHandler("remove")}catch(o){}t(i)}}(e.cleanData),e.widget=function(t,i,s){var n,a,o,r,h={},l=t.split(".")[0];return t=t.split(".")[1],n=l+"-"+t,s||(s=i,i=e.Widget),e.expr[":"][n.toLowerCase()]=function(t){return!!e.data(t,n)},e[l]=e[l]||{},a=e[l][t],o=e[l][t]=function(e,t){return this._createWidget?(arguments.length&&this._createWidget(e,t),void 0):new o(e,t)},e.extend(o,a,{version:s.version,_proto:e.extend({},s),_childConstructors:[]}),r=new i,r.options=e.widget.extend({},r.options),e.each(s,function(t,s){return e.isFunction(s)?(h[t]=function(){var e=function(){return i.prototype[t].apply(this,arguments)},n=function(e){return i.prototype[t].apply(this,e)};return function(){var t,i=this._super,a=this._superApply;return this._super=e,this._superApply=n,t=s.apply(this,arguments),this._super=i,this._superApply=a,t}}(),void 0):(h[t]=s,void 0)}),o.prototype=e.widget.extend(r,{widgetEventPrefix:a?r.widgetEventPrefix||t:t},h,{constructor:o,namespace:l,widgetName:t,widgetFullName:n}),a?(e.each(a._childConstructors,function(t,i){var s=i.prototype;e.widget(s.namespace+"."+s.widgetName,o,i._proto)}),delete a._childConstructors):i._childConstructors.push(o),e.widget.bridge(t,o),o},e.widget.extend=function(t){for(var i,s,a=n.call(arguments,1),o=0,r=a.length;r>o;o++)for(i in a[o])s=a[o][i],a[o].hasOwnProperty(i)&&void 0!==s&&(t[i]=e.isPlainObject(s)?e.isPlainObject(t[i])?e.widget.extend({},t[i],s):e.widget.extend({},s):s);return t},e.widget.bridge=function(t,i){var s=i.prototype.widgetFullName||t;e.fn[t]=function(a){var o="string"==typeof a,r=n.call(arguments,1),h=this;return o?this.each(function(){var i,n=e.data(this,s);return"instance"===a?(h=n,!1):n?e.isFunction(n[a])&&"_"!==a.charAt(0)?(i=n[a].apply(n,r),i!==n&&void 0!==i?(h=i&&i.jquery?h.pushStack(i.get()):i,!1):void 0):e.error("no such method '"+a+"' for "+t+" widget instance"):e.error("cannot call methods on "+t+" prior to initialization; "+"attempted to call method '"+a+"'")}):(r.length&&(a=e.widget.extend.apply(null,[a].concat(r))),this.each(function(){var t=e.data(this,s);t?(t.option(a||{}),t._init&&t._init()):e.data(this,s,new i(a,this))})),h}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,i){i=e(i||this.defaultElement||this)[0],this.element=e(i),this.uuid=s++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=e(),this.hoverable=e(),this.focusable=e(),i!==this&&(e.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===i&&this.destroy()}}),this.document=e(i.style?i.ownerDocument:i.document||i),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(t,i){var s,n,a,o=t;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof t)if(o={},s=t.split("."),t=s.shift(),s.length){for(n=o[t]=e.widget.extend({},this.options[t]),a=0;s.length-1>a;a++)n[s[a]]=n[s[a]]||{},n=n[s[a]];if(t=s.pop(),1===arguments.length)return void 0===n[t]?null:n[t];n[t]=i}else{if(1===arguments.length)return void 0===this.options[t]?null:this.options[t];o[t]=i}return this._setOptions(o),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!t),t&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(t,i,s){var n,a=this;"boolean"!=typeof t&&(s=i,i=t,t=!1),s?(i=n=e(i),this.bindings=this.bindings.add(i)):(s=i,i=this.element,n=this.widget()),e.each(s,function(s,o){function r(){return t||a.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof o?a[o]:o).apply(a,arguments):void 0}"string"!=typeof o&&(r.guid=o.guid=o.guid||r.guid||e.guid++);var h=s.match(/^([\w:-]*)\s*(.*)$/),l=h[1]+a.eventNamespace,u=h[2];u?n.delegate(u,l,r):i.bind(l,r)})},_off:function(t,i){i=(i||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.unbind(i).undelegate(i),this.bindings=e(this.bindings.not(t).get()),this.focusable=e(this.focusable.not(t).get()),this.hoverable=e(this.hoverable.not(t).get())},_delay:function(e,t){function i(){return("string"==typeof e?s[e]:e).apply(s,arguments)}var s=this;return setTimeout(i,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,i,s){var n,a,o=this.options[t];if(s=s||{},i=e.Event(i),i.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),i.target=this.element[0],a=i.originalEvent)for(n in a)n in i||(i[n]=a[n]);return this.element.trigger(i,s),!(e.isFunction(o)&&o.apply(this.element[0],[i].concat(s))===!1||i.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,i){e.Widget.prototype["_"+t]=function(s,n,a){"string"==typeof n&&(n={effect:n});var o,r=n?n===!0||"number"==typeof n?i:n.effect||i:t;n=n||{},"number"==typeof n&&(n={duration:n}),o=!e.isEmptyObject(n),n.complete=a,n.delay&&s.delay(n.delay),o&&e.effects&&e.effects.effect[r]?s[t](n):r!==t&&s[r]?s[r](n.duration,n.easing,a):s.queue(function(i){e(this)[t](),a&&a.call(s[0]),i()})}}),e.widget;var a=!1;e(document).mouseup(function(){a=!1}),e.widget("ui.mouse",{version:"1.11.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(i){return!0===e.data(i.target,t.widgetName+".preventClickEvent")?(e.removeData(i.target,t.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){if(!a){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var i=this,s=1===t.which,n="string"==typeof this.options.cancel&&t.target.nodeName?e(t.target).closest(this.options.cancel).length:!1;return s&&!n&&this._mouseCapture(t)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(t)!==!1,!this._mouseStarted)?(t.preventDefault(),!0):(!0===e.data(t.target,this.widgetName+".preventClickEvent")&&e.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return i._mouseMove(e)},this._mouseUpDelegate=function(e){return i._mouseUp(e)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),a=!0,!0)):!0}},_mouseMove:function(t){if(this._mouseMoved){if(e.ui.ie&&(!document.documentMode||9>document.documentMode)&&!t.button)return this._mouseUp(t);if(!t.which)return this._mouseUp(t)}return(t.which||t.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),a=!1,!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),e.widget("ui.draggable",e.ui.mouse,{version:"1.11.4",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(e,t){this._super(e,t),"handle"===e&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?(this.destroyOnClear=!0,void 0):(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),this._mouseDestroy(),void 0)},_mouseCapture:function(t){var i=this.options;return this._blurActiveElement(t),this.helper||i.disabled||e(t.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(t),this.handle?(this._blockFrames(i.iframeFix===!0?"iframe":i.iframeFix),!0):!1)},_blockFrames:function(t){this.iframeBlocks=this.document.find(t).map(function(){var t=e(this);return e("<div>").css("position","absolute").appendTo(t.parent()).outerWidth(t.outerWidth()).outerHeight(t.outerHeight()).offset(t.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(t){var i=this.document[0];if(this.handleElement.is(t.target))try{i.activeElement&&"body"!==i.activeElement.nodeName.toLowerCase()&&e(i.activeElement).blur()}catch(s){}},_mouseStart:function(t){var i=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter(function(){return"fixed"===e(this).css("position")}).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(t),this.originalPosition=this.position=this._generatePosition(t,!1),this.originalPageX=t.pageX,this.originalPageY=t.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._normalizeRightBottom(),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_refreshOffsets:function(e){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:e.pageX-this.offset.left,top:e.pageY-this.offset.top}},_mouseDrag:function(t,i){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t,!0),this.positionAbs=this._convertPositionTo("absolute"),!i){var s=this._uiHash();if(this._trigger("drag",t,s)===!1)return this._mouseUp({}),!1;this.position=s.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var i=this,s=!1;return e.ui.ddmanager&&!this.options.dropBehaviour&&(s=e.ui.ddmanager.drop(this,t)),this.dropped&&(s=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!s||"valid"===this.options.revert&&s||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,s)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){i._trigger("stop",t)!==!1&&i._clear()}):this._trigger("stop",t)!==!1&&this._clear(),!1},_mouseUp:function(t){return this._unblockFrames(),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),this.handleElement.is(t.target)&&this.element.focus(),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){return this.options.handle?!!e(t.target).closest(this.element.find(this.options.handle)).length:!0},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(t){var i=this.options,s=e.isFunction(i.helper),n=s?e(i.helper.apply(this.element[0],[t])):"clone"===i.helper?this.element.clone().removeAttr("id"):this.element;return n.parents("body").length||n.appendTo("parent"===i.appendTo?this.element[0].parentNode:i.appendTo),s&&n[0]===this.element[0]&&this._setPositionRelative(),n[0]===this.element[0]||/(fixed|absolute)/.test(n.css("position"))||n.css("position","absolute"),n},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_isRootNode:function(e){return/(html|body)/i.test(e.tagName)||e===this.document[0]},_getParentOffset:function(){var t=this.offsetParent.offset(),i=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==i&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var e=this.element.position(),t=this._isRootNode(this.scrollParent[0]);return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+(t?0:this.scrollParent.scrollTop()),left:e.left-(parseInt(this.helper.css("left"),10)||0)+(t?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,i,s,n=this.options,a=this.document[0];return this.relativeContainer=null,n.containment?"window"===n.containment?(this.containment=[e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,e(window).scrollLeft()+e(window).width()-this.helperProportions.width-this.margins.left,e(window).scrollTop()+(e(window).height()||a.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):"document"===n.containment?(this.containment=[0,0,e(a).width()-this.helperProportions.width-this.margins.left,(e(a).height()||a.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):n.containment.constructor===Array?(this.containment=n.containment,void 0):("parent"===n.containment&&(n.containment=this.helper[0].parentNode),i=e(n.containment),s=i[0],s&&(t=/(scroll|auto)/.test(i.css("overflow")),this.containment=[(parseInt(i.css("borderLeftWidth"),10)||0)+(parseInt(i.css("paddingLeft"),10)||0),(parseInt(i.css("borderTopWidth"),10)||0)+(parseInt(i.css("paddingTop"),10)||0),(t?Math.max(s.scrollWidth,s.offsetWidth):s.offsetWidth)-(parseInt(i.css("borderRightWidth"),10)||0)-(parseInt(i.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(s.scrollHeight,s.offsetHeight):s.offsetHeight)-(parseInt(i.css("borderBottomWidth"),10)||0)-(parseInt(i.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=i),void 0):(this.containment=null,void 0)},_convertPositionTo:function(e,t){t||(t=this.position);var i="absolute"===e?1:-1,s=this._isRootNode(this.scrollParent[0]);return{top:t.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.offset.scroll.top:s?0:this.offset.scroll.top)*i,left:t.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.offset.scroll.left:s?0:this.offset.scroll.left)*i}},_generatePosition:function(e,t){var i,s,n,a,o=this.options,r=this._isRootNode(this.scrollParent[0]),h=e.pageX,l=e.pageY;return r&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),t&&(this.containment&&(this.relativeContainer?(s=this.relativeContainer.offset(),i=[this.containment[0]+s.left,this.containment[1]+s.top,this.containment[2]+s.left,this.containment[3]+s.top]):i=this.containment,e.pageX-this.offset.click.left<i[0]&&(h=i[0]+this.offset.click.left),e.pageY-this.offset.click.top<i[1]&&(l=i[1]+this.offset.click.top),e.pageX-this.offset.click.left>i[2]&&(h=i[2]+this.offset.click.left),e.pageY-this.offset.click.top>i[3]&&(l=i[3]+this.offset.click.top)),o.grid&&(n=o.grid[1]?this.originalPageY+Math.round((l-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY,l=i?n-this.offset.click.top>=i[1]||n-this.offset.click.top>i[3]?n:n-this.offset.click.top>=i[1]?n-o.grid[1]:n+o.grid[1]:n,a=o.grid[0]?this.originalPageX+Math.round((h-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX,h=i?a-this.offset.click.left>=i[0]||a-this.offset.click.left>i[2]?a:a-this.offset.click.left>=i[0]?a-o.grid[0]:a+o.grid[0]:a),"y"===o.axis&&(h=this.originalPageX),"x"===o.axis&&(l=this.originalPageY)),{top:l-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:r?0:this.offset.scroll.top),left:h-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:r?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_normalizeRightBottom:function(){"y"!==this.options.axis&&"auto"!==this.helper.css("right")&&(this.helper.width(this.helper.width()),this.helper.css("right","auto")),"x"!==this.options.axis&&"auto"!==this.helper.css("bottom")&&(this.helper.height(this.helper.height()),this.helper.css("bottom","auto"))},_trigger:function(t,i,s){return s=s||this._uiHash(),e.ui.plugin.call(this,t,[i,s,this],!0),/^(drag|start|stop)/.test(t)&&(this.positionAbs=this._convertPositionTo("absolute"),s.offset=this.positionAbs),e.Widget.prototype._trigger.call(this,t,i,s)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,i,s){var n=e.extend({},i,{item:s.element});s.sortables=[],e(s.options.connectToSortable).each(function(){var i=e(this).sortable("instance");i&&!i.options.disabled&&(s.sortables.push(i),i.refreshPositions(),i._trigger("activate",t,n))})},stop:function(t,i,s){var n=e.extend({},i,{item:s.element});s.cancelHelperRemoval=!1,e.each(s.sortables,function(){var e=this;e.isOver?(e.isOver=0,s.cancelHelperRemoval=!0,e.cancelHelperRemoval=!1,e._storedCSS={position:e.placeholder.css("position"),top:e.placeholder.css("top"),left:e.placeholder.css("left")},e._mouseStop(t),e.options.helper=e.options._helper):(e.cancelHelperRemoval=!0,e._trigger("deactivate",t,n))})},drag:function(t,i,s){e.each(s.sortables,function(){var n=!1,a=this;a.positionAbs=s.positionAbs,a.helperProportions=s.helperProportions,a.offset.click=s.offset.click,a._intersectsWith(a.containerCache)&&(n=!0,e.each(s.sortables,function(){return this.positionAbs=s.positionAbs,this.helperProportions=s.helperProportions,this.offset.click=s.offset.click,this!==a&&this._intersectsWith(this.containerCache)&&e.contains(a.element[0],this.element[0])&&(n=!1),n})),n?(a.isOver||(a.isOver=1,s._parent=i.helper.parent(),a.currentItem=i.helper.appendTo(a.element).data("ui-sortable-item",!0),a.options._helper=a.options.helper,a.options.helper=function(){return i.helper[0]},t.target=a.currentItem[0],a._mouseCapture(t,!0),a._mouseStart(t,!0,!0),a.offset.click.top=s.offset.click.top,a.offset.click.left=s.offset.click.left,a.offset.parent.left-=s.offset.parent.left-a.offset.parent.left,a.offset.parent.top-=s.offset.parent.top-a.offset.parent.top,s._trigger("toSortable",t),s.dropped=a.element,e.each(s.sortables,function(){this.refreshPositions()}),s.currentItem=s.element,a.fromOutside=s),a.currentItem&&(a._mouseDrag(t),i.position=a.position)):a.isOver&&(a.isOver=0,a.cancelHelperRemoval=!0,a.options._revert=a.options.revert,a.options.revert=!1,a._trigger("out",t,a._uiHash(a)),a._mouseStop(t,!0),a.options.revert=a.options._revert,a.options.helper=a.options._helper,a.placeholder&&a.placeholder.remove(),i.helper.appendTo(s._parent),s._refreshOffsets(t),i.position=s._generatePosition(t,!0),s._trigger("fromSortable",t),s.dropped=!1,e.each(s.sortables,function(){this.refreshPositions()}))})}}),e.ui.plugin.add("draggable","cursor",{start:function(t,i,s){var n=e("body"),a=s.options;n.css("cursor")&&(a._cursor=n.css("cursor")),n.css("cursor",a.cursor)},stop:function(t,i,s){var n=s.options;n._cursor&&e("body").css("cursor",n._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,i,s){var n=e(i.helper),a=s.options;n.css("opacity")&&(a._opacity=n.css("opacity")),n.css("opacity",a.opacity)},stop:function(t,i,s){var n=s.options;n._opacity&&e(i.helper).css("opacity",n._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(e,t,i){i.scrollParentNotHidden||(i.scrollParentNotHidden=i.helper.scrollParent(!1)),i.scrollParentNotHidden[0]!==i.document[0]&&"HTML"!==i.scrollParentNotHidden[0].tagName&&(i.overflowOffset=i.scrollParentNotHidden.offset())},drag:function(t,i,s){var n=s.options,a=!1,o=s.scrollParentNotHidden[0],r=s.document[0];o!==r&&"HTML"!==o.tagName?(n.axis&&"x"===n.axis||(s.overflowOffset.top+o.offsetHeight-t.pageY<n.scrollSensitivity?o.scrollTop=a=o.scrollTop+n.scrollSpeed:t.pageY-s.overflowOffset.top<n.scrollSensitivity&&(o.scrollTop=a=o.scrollTop-n.scrollSpeed)),n.axis&&"y"===n.axis||(s.overflowOffset.left+o.offsetWidth-t.pageX<n.scrollSensitivity?o.scrollLeft=a=o.scrollLeft+n.scrollSpeed:t.pageX-s.overflowOffset.left<n.scrollSensitivity&&(o.scrollLeft=a=o.scrollLeft-n.scrollSpeed))):(n.axis&&"x"===n.axis||(t.pageY-e(r).scrollTop()<n.scrollSensitivity?a=e(r).scrollTop(e(r).scrollTop()-n.scrollSpeed):e(window).height()-(t.pageY-e(r).scrollTop())<n.scrollSensitivity&&(a=e(r).scrollTop(e(r).scrollTop()+n.scrollSpeed))),n.axis&&"y"===n.axis||(t.pageX-e(r).scrollLeft()<n.scrollSensitivity?a=e(r).scrollLeft(e(r).scrollLeft()-n.scrollSpeed):e(window).width()-(t.pageX-e(r).scrollLeft())<n.scrollSensitivity&&(a=e(r).scrollLeft(e(r).scrollLeft()+n.scrollSpeed)))),a!==!1&&e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(s,t)}}),e.ui.plugin.add("draggable","snap",{start:function(t,i,s){var n=s.options;s.snapElements=[],e(n.snap.constructor!==String?n.snap.items||":data(ui-draggable)":n.snap).each(function(){var t=e(this),i=t.offset();this!==s.element[0]&&s.snapElements.push({item:this,width:t.outerWidth(),height:t.outerHeight(),top:i.top,left:i.left})})},drag:function(t,i,s){var n,a,o,r,h,l,u,d,c,p,m=s.options,f=m.snapTolerance,g=i.offset.left,v=g+s.helperProportions.width,y=i.offset.top,b=y+s.helperProportions.height;for(c=s.snapElements.length-1;c>=0;c--)h=s.snapElements[c].left-s.margins.left,l=h+s.snapElements[c].width,u=s.snapElements[c].top-s.margins.top,d=u+s.snapElements[c].height,h-f>v||g>l+f||u-f>b||y>d+f||!e.contains(s.snapElements[c].item.ownerDocument,s.snapElements[c].item)?(s.snapElements[c].snapping&&s.options.snap.release&&s.options.snap.release.call(s.element,t,e.extend(s._uiHash(),{snapItem:s.snapElements[c].item})),s.snapElements[c].snapping=!1):("inner"!==m.snapMode&&(n=f>=Math.abs(u-b),a=f>=Math.abs(d-y),o=f>=Math.abs(h-v),r=f>=Math.abs(l-g),n&&(i.position.top=s._convertPositionTo("relative",{top:u-s.helperProportions.height,left:0}).top),a&&(i.position.top=s._convertPositionTo("relative",{top:d,left:0}).top),o&&(i.position.left=s._convertPositionTo("relative",{top:0,left:h-s.helperProportions.width}).left),r&&(i.position.left=s._convertPositionTo("relative",{top:0,left:l}).left)),p=n||a||o||r,"outer"!==m.snapMode&&(n=f>=Math.abs(u-y),a=f>=Math.abs(d-b),o=f>=Math.abs(h-g),r=f>=Math.abs(l-v),n&&(i.position.top=s._convertPositionTo("relative",{top:u,left:0}).top),a&&(i.position.top=s._convertPositionTo("relative",{top:d-s.helperProportions.height,left:0}).top),o&&(i.position.left=s._convertPositionTo("relative",{top:0,left:h}).left),r&&(i.position.left=s._convertPositionTo("relative",{top:0,left:l-s.helperProportions.width}).left)),!s.snapElements[c].snapping&&(n||a||o||r||p)&&s.options.snap.snap&&s.options.snap.snap.call(s.element,t,e.extend(s._uiHash(),{snapItem:s.snapElements[c].item})),s.snapElements[c].snapping=n||a||o||r||p)}}),e.ui.plugin.add("draggable","stack",{start:function(t,i,s){var n,a=s.options,o=e.makeArray(e(a.stack)).sort(function(t,i){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(i).css("zIndex"),10)||0)});o.length&&(n=parseInt(e(o[0]).css("zIndex"),10)||0,e(o).each(function(t){e(this).css("zIndex",n+t)}),this.css("zIndex",n+o.length))}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,i,s){var n=e(i.helper),a=s.options;n.css("zIndex")&&(a._zIndex=n.css("zIndex")),n.css("zIndex",a.zIndex)},stop:function(t,i,s){var n=s.options;n._zIndex&&e(i.helper).css("zIndex",n._zIndex)}}),e.ui.draggable,e.widget("ui.droppable",{version:"1.11.4",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var t,i=this.options,s=i.accept;
this.isover=!1,this.isout=!0,this.accept=e.isFunction(s)?s:function(e){return e.is(s)},this.proportions=function(){return arguments.length?(t=arguments[0],void 0):t?t:t={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}},this._addToManager(i.scope),i.addClasses&&this.element.addClass("ui-droppable")},_addToManager:function(t){e.ui.ddmanager.droppables[t]=e.ui.ddmanager.droppables[t]||[],e.ui.ddmanager.droppables[t].push(this)},_splice:function(e){for(var t=0;e.length>t;t++)e[t]===this&&e.splice(t,1)},_destroy:function(){var t=e.ui.ddmanager.droppables[this.options.scope];this._splice(t),this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(t,i){if("accept"===t)this.accept=e.isFunction(i)?i:function(e){return e.is(i)};else if("scope"===t){var s=e.ui.ddmanager.droppables[this.options.scope];this._splice(s),this._addToManager(i)}this._super(t,i)},_activate:function(t){var i=e.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),i&&this._trigger("activate",t,this.ui(i))},_deactivate:function(t){var i=e.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),i&&this._trigger("deactivate",t,this.ui(i))},_over:function(t){var i=e.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",t,this.ui(i)))},_out:function(t){var i=e.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",t,this.ui(i)))},_drop:function(t,i){var s=i||e.ui.ddmanager.current,n=!1;return s&&(s.currentItem||s.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var i=e(this).droppable("instance");return i.options.greedy&&!i.options.disabled&&i.options.scope===s.options.scope&&i.accept.call(i.element[0],s.currentItem||s.element)&&e.ui.intersect(s,e.extend(i,{offset:i.element.offset()}),i.options.tolerance,t)?(n=!0,!1):void 0}),n?!1:this.accept.call(this.element[0],s.currentItem||s.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",t,this.ui(s)),this.element):!1):!1},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}}}),e.ui.intersect=function(){function e(e,t,i){return e>=t&&t+i>e}return function(t,i,s,n){if(!i.offset)return!1;var a=(t.positionAbs||t.position.absolute).left+t.margins.left,o=(t.positionAbs||t.position.absolute).top+t.margins.top,r=a+t.helperProportions.width,h=o+t.helperProportions.height,l=i.offset.left,u=i.offset.top,d=l+i.proportions().width,c=u+i.proportions().height;switch(s){case"fit":return a>=l&&d>=r&&o>=u&&c>=h;case"intersect":return a+t.helperProportions.width/2>l&&d>r-t.helperProportions.width/2&&o+t.helperProportions.height/2>u&&c>h-t.helperProportions.height/2;case"pointer":return e(n.pageY,u,i.proportions().height)&&e(n.pageX,l,i.proportions().width);case"touch":return(o>=u&&c>=o||h>=u&&c>=h||u>o&&h>c)&&(a>=l&&d>=a||r>=l&&d>=r||l>a&&r>d);default:return!1}}}(),e.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,i){var s,n,a=e.ui.ddmanager.droppables[t.options.scope]||[],o=i?i.type:null,r=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();e:for(s=0;a.length>s;s++)if(!(a[s].options.disabled||t&&!a[s].accept.call(a[s].element[0],t.currentItem||t.element))){for(n=0;r.length>n;n++)if(r[n]===a[s].element[0]){a[s].proportions().height=0;continue e}a[s].visible="none"!==a[s].element.css("display"),a[s].visible&&("mousedown"===o&&a[s]._activate.call(a[s],i),a[s].offset=a[s].element.offset(),a[s].proportions({width:a[s].element[0].offsetWidth,height:a[s].element[0].offsetHeight}))}},drop:function(t,i){var s=!1;return e.each((e.ui.ddmanager.droppables[t.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&e.ui.intersect(t,this,this.options.tolerance,i)&&(s=this._drop.call(this,i)||s),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,i)))}),s},dragStart:function(t,i){t.element.parentsUntil("body").bind("scroll.droppable",function(){t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,i)})},drag:function(t,i){t.options.refreshPositions&&e.ui.ddmanager.prepareOffsets(t,i),e.each(e.ui.ddmanager.droppables[t.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var s,n,a,o=e.ui.intersect(t,this,this.options.tolerance,i),r=!o&&this.isover?"isout":o&&!this.isover?"isover":null;r&&(this.options.greedy&&(n=this.options.scope,a=this.element.parents(":data(ui-droppable)").filter(function(){return e(this).droppable("instance").options.scope===n}),a.length&&(s=e(a[0]).droppable("instance"),s.greedyChild="isover"===r)),s&&"isover"===r&&(s.isover=!1,s.isout=!0,s._out.call(s,i)),this[r]=!0,this["isout"===r?"isover":"isout"]=!1,this["isover"===r?"_over":"_out"].call(this,i),s&&"isout"===r&&(s.isout=!1,s.isover=!0,s._over.call(s,i)))}})},dragStop:function(t,i){t.element.parentsUntil("body").unbind("scroll.droppable"),t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,i)}},e.ui.droppable,e.widget("ui.sortable",e.ui.mouse,{version:"1.11.4",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(e,t,i){return e>=t&&t+i>e},_isFloating:function(e){return/left|right/.test(e.css("float"))||/inline|table-cell/.test(e.css("display"))},_create:function(){this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(e,t){this._super(e,t),"handle"===e&&this._setHandleClassName()},_setHandleClassName:function(){this.element.find(".ui-sortable-handle").removeClass("ui-sortable-handle"),e.each(this.items,function(){(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item).addClass("ui-sortable-handle")})},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").find(".ui-sortable-handle").removeClass("ui-sortable-handle"),this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(t,i){var s=null,n=!1,a=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(t),e(t.target).parents().each(function(){return e.data(this,a.widgetName+"-item")===a?(s=e(this),!1):void 0}),e.data(t.target,a.widgetName+"-item")===a&&(s=e(t.target)),s?!this.options.handle||i||(e(this.options.handle,s).find("*").addBack().each(function(){this===t.target&&(n=!0)}),n)?(this.currentItem=s,this._removeCurrentsFromItems(),!0):!1:!1)},_mouseStart:function(t,i,s){var n,a,o=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),o.containment&&this._setContainment(),o.cursor&&"auto"!==o.cursor&&(a=this.document.find("body"),this.storedCursor=a.css("cursor"),a.css("cursor",o.cursor),this.storedStylesheet=e("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(a)),o.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",o.opacity)),o.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",o.zIndex)),this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!s)for(n=this.containers.length-1;n>=0;n--)this.containers[n]._trigger("activate",t,this._uiHash(this));return e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!o.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){var i,s,n,a,o=this.options,r=!1;for(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<o.scrollSensitivity?this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop+o.scrollSpeed:t.pageY-this.overflowOffset.top<o.scrollSensitivity&&(this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop-o.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<o.scrollSensitivity?this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft+o.scrollSpeed:t.pageX-this.overflowOffset.left<o.scrollSensitivity&&(this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft-o.scrollSpeed)):(t.pageY-this.document.scrollTop()<o.scrollSensitivity?r=this.document.scrollTop(this.document.scrollTop()-o.scrollSpeed):this.window.height()-(t.pageY-this.document.scrollTop())<o.scrollSensitivity&&(r=this.document.scrollTop(this.document.scrollTop()+o.scrollSpeed)),t.pageX-this.document.scrollLeft()<o.scrollSensitivity?r=this.document.scrollLeft(this.document.scrollLeft()-o.scrollSpeed):this.window.width()-(t.pageX-this.document.scrollLeft())<o.scrollSensitivity&&(r=this.document.scrollLeft(this.document.scrollLeft()+o.scrollSpeed))),r!==!1&&e.ui.ddmanager&&!o.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),i=this.items.length-1;i>=0;i--)if(s=this.items[i],n=s.item[0],a=this._intersectsWithPointer(s),a&&s.instance===this.currentContainer&&n!==this.currentItem[0]&&this.placeholder[1===a?"next":"prev"]()[0]!==n&&!e.contains(this.placeholder[0],n)&&("semi-dynamic"===this.options.type?!e.contains(this.element[0],n):!0)){if(this.direction=1===a?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(s))break;this._rearrange(t,s),this._trigger("change",t,this._uiHash());break}return this._contactContainers(t),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,i){if(t){if(e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,t),this.options.revert){var s=this,n=this.placeholder.offset(),a=this.options.axis,o={};a&&"x"!==a||(o.left=n.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft)),a&&"y"!==a||(o.top=n.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,e(this.helper).animate(o,parseInt(this.options.revert,10)||500,function(){s._clear(t)})}else this._clear(t,i);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var i=this._getItemsAsjQuery(t&&t.connected),s=[];return t=t||{},e(i).each(function(){var i=(e(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[\-=_](.+)/);i&&s.push((t.key||i[1]+"[]")+"="+(t.key&&t.expression?i[1]:i[2]))}),!s.length&&t.key&&s.push(t.key+"="),s.join("&")},toArray:function(t){var i=this._getItemsAsjQuery(t&&t.connected),s=[];return t=t||{},i.each(function(){s.push(e(t.item||this).attr(t.attribute||"id")||"")}),s},_intersectsWith:function(e){var t=this.positionAbs.left,i=t+this.helperProportions.width,s=this.positionAbs.top,n=s+this.helperProportions.height,a=e.left,o=a+e.width,r=e.top,h=r+e.height,l=this.offset.click.top,u=this.offset.click.left,d="x"===this.options.axis||s+l>r&&h>s+l,c="y"===this.options.axis||t+u>a&&o>t+u,p=d&&c;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?p:t+this.helperProportions.width/2>a&&o>i-this.helperProportions.width/2&&s+this.helperProportions.height/2>r&&h>n-this.helperProportions.height/2},_intersectsWithPointer:function(e){var t="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top,e.height),i="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left,e.width),s=t&&i,n=this._getDragVerticalDirection(),a=this._getDragHorizontalDirection();return s?this.floating?a&&"right"===a||"down"===n?2:1:n&&("down"===n?2:1):!1},_intersectsWithSides:function(e){var t=this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),i=this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),s=this._getDragVerticalDirection(),n=this._getDragHorizontalDirection();return this.floating&&n?"right"===n&&i||"left"===n&&!i:s&&("down"===s&&t||"up"===s&&!t)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return 0!==e&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return 0!==e&&(e>0?"right":"left")},refresh:function(e){return this._refreshItems(e),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor===String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){function i(){r.push(this)}var s,n,a,o,r=[],h=[],l=this._connectWith();if(l&&t)for(s=l.length-1;s>=0;s--)for(a=e(l[s],this.document[0]),n=a.length-1;n>=0;n--)o=e.data(a[n],this.widgetFullName),o&&o!==this&&!o.options.disabled&&h.push([e.isFunction(o.options.items)?o.options.items.call(o.element):e(o.options.items,o.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),o]);for(h.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),s=h.length-1;s>=0;s--)h[s][0].each(i);return e(r)},_removeCurrentsFromItems:function(){var t=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=e.grep(this.items,function(e){for(var i=0;t.length>i;i++)if(t[i]===e.item[0])return!1;return!0})},_refreshItems:function(t){this.items=[],this.containers=[this];var i,s,n,a,o,r,h,l,u=this.items,d=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]],c=this._connectWith();if(c&&this.ready)for(i=c.length-1;i>=0;i--)for(n=e(c[i],this.document[0]),s=n.length-1;s>=0;s--)a=e.data(n[s],this.widgetFullName),a&&a!==this&&!a.options.disabled&&(d.push([e.isFunction(a.options.items)?a.options.items.call(a.element[0],t,{item:this.currentItem}):e(a.options.items,a.element),a]),this.containers.push(a));for(i=d.length-1;i>=0;i--)for(o=d[i][1],r=d[i][0],s=0,l=r.length;l>s;s++)h=e(r[s]),h.data(this.widgetName+"-item",o),u.push({item:h,instance:o,width:0,height:0,left:0,top:0})},refreshPositions:function(t){this.floating=this.items.length?"x"===this.options.axis||this._isFloating(this.items[0].item):!1,this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var i,s,n,a;for(i=this.items.length-1;i>=0;i--)s=this.items[i],s.instance!==this.currentContainer&&this.currentContainer&&s.item[0]!==this.currentItem[0]||(n=this.options.toleranceElement?e(this.options.toleranceElement,s.item):s.item,t||(s.width=n.outerWidth(),s.height=n.outerHeight()),a=n.offset(),s.left=a.left,s.top=a.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--)a=this.containers[i].element.offset(),this.containers[i].containerCache.left=a.left,this.containers[i].containerCache.top=a.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight();return this},_createPlaceholder:function(t){t=t||this;var i,s=t.options;s.placeholder&&s.placeholder.constructor!==String||(i=s.placeholder,s.placeholder={element:function(){var s=t.currentItem[0].nodeName.toLowerCase(),n=e("<"+s+">",t.document[0]).addClass(i||t.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tbody"===s?t._createTrPlaceholder(t.currentItem.find("tr").eq(0),e("<tr>",t.document[0]).appendTo(n)):"tr"===s?t._createTrPlaceholder(t.currentItem,n):"img"===s&&n.attr("src",t.currentItem.attr("src")),i||n.css("visibility","hidden"),n},update:function(e,n){(!i||s.forcePlaceholderSize)&&(n.height()||n.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css("paddingTop")||0,10)-parseInt(t.currentItem.css("paddingBottom")||0,10)),n.width()||n.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css("paddingLeft")||0,10)-parseInt(t.currentItem.css("paddingRight")||0,10)))}}),t.placeholder=e(s.placeholder.element.call(t.element,t.currentItem)),t.currentItem.after(t.placeholder),s.placeholder.update(t,t.placeholder)},_createTrPlaceholder:function(t,i){var s=this;t.children().each(function(){e("<td>&#160;</td>",s.document[0]).attr("colspan",e(this).attr("colspan")||1).appendTo(i)})},_contactContainers:function(t){var i,s,n,a,o,r,h,l,u,d,c=null,p=null;for(i=this.containers.length-1;i>=0;i--)if(!e.contains(this.currentItem[0],this.containers[i].element[0]))if(this._intersectsWith(this.containers[i].containerCache)){if(c&&e.contains(this.containers[i].element[0],c.element[0]))continue;c=this.containers[i],p=i}else this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",t,this._uiHash(this)),this.containers[i].containerCache.over=0);if(c)if(1===this.containers.length)this.containers[p].containerCache.over||(this.containers[p]._trigger("over",t,this._uiHash(this)),this.containers[p].containerCache.over=1);else{for(n=1e4,a=null,u=c.floating||this._isFloating(this.currentItem),o=u?"left":"top",r=u?"width":"height",d=u?"clientX":"clientY",s=this.items.length-1;s>=0;s--)e.contains(this.containers[p].element[0],this.items[s].item[0])&&this.items[s].item[0]!==this.currentItem[0]&&(h=this.items[s].item.offset()[o],l=!1,t[d]-h>this.items[s][r]/2&&(l=!0),n>Math.abs(t[d]-h)&&(n=Math.abs(t[d]-h),a=this.items[s],this.direction=l?"up":"down"));if(!a&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[p])return this.currentContainer.containerCache.over||(this.containers[p]._trigger("over",t,this._uiHash()),this.currentContainer.containerCache.over=1),void 0;a?this._rearrange(t,a,null,!0):this._rearrange(t,null,this.containers[p].element,!0),this._trigger("change",t,this._uiHash()),this.containers[p]._trigger("change",t,this._uiHash(this)),this.currentContainer=this.containers[p],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[p]._trigger("over",t,this._uiHash(this)),this.containers[p].containerCache.over=1}},_createHelper:function(t){var i=this.options,s=e.isFunction(i.helper)?e(i.helper.apply(this.element[0],[t,this.currentItem])):"clone"===i.helper?this.currentItem.clone():this.currentItem;return s.parents("body").length||e("parent"!==i.appendTo?i.appendTo:this.currentItem[0].parentNode)[0].appendChild(s[0]),s[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!s[0].style.width||i.forceHelperSize)&&s.width(this.currentItem.width()),(!s[0].style.height||i.forceHelperSize)&&s.height(this.currentItem.height()),s},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==this.document[0]&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===this.document[0].body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,i,s,n=this.options;"parent"===n.containment&&(n.containment=this.helper[0].parentNode),("document"===n.containment||"window"===n.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,"document"===n.containment?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,("document"===n.containment?this.document.width():this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(n.containment)||(t=e(n.containment)[0],i=e(n.containment).offset(),s="hidden"!==e(t).css("overflow"),this.containment=[i.left+(parseInt(e(t).css("borderLeftWidth"),10)||0)+(parseInt(e(t).css("paddingLeft"),10)||0)-this.margins.left,i.top+(parseInt(e(t).css("borderTopWidth"),10)||0)+(parseInt(e(t).css("paddingTop"),10)||0)-this.margins.top,i.left+(s?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(e(t).css("borderLeftWidth"),10)||0)-(parseInt(e(t).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(s?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(e(t).css("borderTopWidth"),10)||0)-(parseInt(e(t).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(t,i){i||(i=this.position);var s="absolute"===t?1:-1,n="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,a=/(html|body)/i.test(n[0].tagName);return{top:i.top+this.offset.relative.top*s+this.offset.parent.top*s-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():a?0:n.scrollTop())*s,left:i.left+this.offset.relative.left*s+this.offset.parent.left*s-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():a?0:n.scrollLeft())*s}},_generatePosition:function(t){var i,s,n=this.options,a=t.pageX,o=t.pageY,r="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,h=/(html|body)/i.test(r[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(a=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(o=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(a=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(o=this.containment[3]+this.offset.click.top)),n.grid&&(i=this.originalPageY+Math.round((o-this.originalPageY)/n.grid[1])*n.grid[1],o=this.containment?i-this.offset.click.top>=this.containment[1]&&i-this.offset.click.top<=this.containment[3]?i:i-this.offset.click.top>=this.containment[1]?i-n.grid[1]:i+n.grid[1]:i,s=this.originalPageX+Math.round((a-this.originalPageX)/n.grid[0])*n.grid[0],a=this.containment?s-this.offset.click.left>=this.containment[0]&&s-this.offset.click.left<=this.containment[2]?s:s-this.offset.click.left>=this.containment[0]?s-n.grid[0]:s+n.grid[0]:s)),{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():h?0:r.scrollTop()),left:a-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():h?0:r.scrollLeft())}},_rearrange:function(e,t,i,s){i?i[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var n=this.counter;this._delay(function(){n===this.counter&&this.refreshPositions(!s)})},_clear:function(e,t){function i(e,t,i){return function(s){i._trigger(e,s,t._uiHash(t))}}this.reverting=!1;var s,n=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(s in this._storedCSS)("auto"===this._storedCSS[s]||"static"===this._storedCSS[s])&&(this._storedCSS[s]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!t&&n.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||t||n.push(function(e){this._trigger("update",e,this._uiHash())}),this!==this.currentContainer&&(t||(n.push(function(e){this._trigger("remove",e,this._uiHash())}),n.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),n.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer)))),s=this.containers.length-1;s>=0;s--)t||n.push(i("deactivate",this,this.containers[s])),this.containers[s].containerCache.over&&(n.push(i("out",this,this.containers[s])),this.containers[s].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,t||this._trigger("beforeStop",e,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!t){for(s=0;n.length>s;s++)n[s].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){e.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(t){var i=t||this;return{helper:i.helper,placeholder:i.placeholder||e([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:t?t.element:null}}})});var fabric=fabric||{version:"1.6.7"};"undefined"!=typeof exports&&(exports.fabric=fabric),"undefined"!=typeof document&&"undefined"!=typeof window?(fabric.document=document,fabric.window=window,window.fabric=fabric):(fabric.document=require("jsdom").jsdom("<!DOCTYPE html><html><head></head><body></body></html>"),fabric.document.createWindow?fabric.window=fabric.document.createWindow():fabric.window=fabric.document.parentWindow),fabric.isTouchSupported="ontouchstart"in fabric.document.documentElement,fabric.isLikelyNode="undefined"!=typeof Buffer&&"undefined"==typeof window,fabric.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id"],fabric.DPI=96,fabric.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?)",fabric.fontPaths={},fabric.charWidthsCache={},fabric.devicePixelRatio=fabric.window.devicePixelRatio||fabric.window.webkitDevicePixelRatio||fabric.window.mozDevicePixelRatio||1,function(){function t(t,e){if(this.__eventListeners[t]){var i=this.__eventListeners[t];e?i[i.indexOf(e)]=!1:fabric.util.array.fill(i,!1)}}function e(t,e){if(this.__eventListeners||(this.__eventListeners={}),1===arguments.length)for(var i in t)this.on(i,t[i]);else this.__eventListeners[t]||(this.__eventListeners[t]=[]),this.__eventListeners[t].push(e);return this}function i(e,i){if(this.__eventListeners){if(0===arguments.length)for(e in this.__eventListeners)t.call(this,e);else if(1===arguments.length&&"object"==typeof arguments[0])for(var r in e)t.call(this,r,e[r]);else t.call(this,e,i);return this}}function r(t,e){if(this.__eventListeners){var i=this.__eventListeners[t];if(i){for(var r=0,n=i.length;r<n;r++)i[r]&&i[r].call(this,e||{});return this.__eventListeners[t]=i.filter(function(t){return t!==!1}),this}}}fabric.Observable={observe:e,stopObserving:i,fire:r,on:e,off:i,trigger:r}}(),fabric.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var t=0,e=arguments.length;t<e;t++)this._onObjectAdded(arguments[t]);return this.renderOnAddRemove&&this.renderAll(),this},insertAt:function(t,e,i){var r=this.getObjects();return i?r[e]=t:r.splice(e,0,t),this._onObjectAdded&&this._onObjectAdded(t),this.renderOnAddRemove&&this.renderAll(),this},remove:function(){for(var t,e=this.getObjects(),i=!1,r=0,n=arguments.length;r<n;r++)t=e.indexOf(arguments[r]),t!==-1&&(i=!0,e.splice(t,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[r]));return this.renderOnAddRemove&&i&&this.renderAll(),this},forEachObject:function(t,e){for(var i=this.getObjects(),r=0,n=i.length;r<n;r++)t.call(e,i[r],r,i);return this},getObjects:function(t){return"undefined"==typeof t?this._objects:this._objects.filter(function(e){return e.type===t})},item:function(t){return this.getObjects()[t]},isEmpty:function(){return 0===this.getObjects().length},size:function(){return this.getObjects().length},contains:function(t){return this.getObjects().indexOf(t)>-1},complexity:function(){return this.getObjects().reduce(function(t,e){return t+=e.complexity?e.complexity():0},0)}},function(t){var e=Math.sqrt,i=Math.atan2,r=Math.pow,n=Math.abs,s=Math.PI/180;fabric.util={removeFromArray:function(t,e){var i=t.indexOf(e);return i!==-1&&t.splice(i,1),t},getRandomInt:function(t,e){return Math.floor(Math.random()*(e-t+1))+t},degreesToRadians:function(t){return t*s},radiansToDegrees:function(t){return t/s},rotatePoint:function(t,e,i){t.subtractEquals(e);var r=fabric.util.rotateVector(t,i);return new fabric.Point(r.x,r.y).addEquals(e)},rotateVector:function(t,e){var i=Math.sin(e),r=Math.cos(e),n=t.x*r-t.y*i,s=t.x*i+t.y*r;return{x:n,y:s}},transformPoint:function(t,e,i){return i?new fabric.Point(e[0]*t.x+e[2]*t.y,e[1]*t.x+e[3]*t.y):new fabric.Point(e[0]*t.x+e[2]*t.y+e[4],e[1]*t.x+e[3]*t.y+e[5])},makeBoundingBoxFromPoints:function(t){var e=[t[0].x,t[1].x,t[2].x,t[3].x],i=fabric.util.array.min(e),r=fabric.util.array.max(e),n=Math.abs(i-r),s=[t[0].y,t[1].y,t[2].y,t[3].y],o=fabric.util.array.min(s),a=fabric.util.array.max(s),h=Math.abs(o-a);return{left:i,top:o,width:n,height:h}},invertTransform:function(t){var e=1/(t[0]*t[3]-t[1]*t[2]),i=[e*t[3],-e*t[1],-e*t[2],e*t[0]],r=fabric.util.transformPoint({x:t[4],y:t[5]},i,!0);return i[4]=-r.x,i[5]=-r.y,i},toFixed:function(t,e){return parseFloat(Number(t).toFixed(e))},parseUnit:function(t,e){var i=/\D{0,2}$/.exec(t),r=parseFloat(t);switch(e||(e=fabric.Text.DEFAULT_SVG_FONT_SIZE),i[0]){case"mm":return r*fabric.DPI/25.4;case"cm":return r*fabric.DPI/2.54;case"in":return r*fabric.DPI;case"pt":return r*fabric.DPI/72;case"pc":return r*fabric.DPI/72*12;case"em":return r*e;default:return r}},falseFunction:function(){return!1},getKlass:function(t,e){return t=fabric.util.string.camelize(t.charAt(0).toUpperCase()+t.slice(1)),fabric.util.resolveNamespace(e)[t]},resolveNamespace:function(e){if(!e)return fabric;var i,r=e.split("."),n=r.length,s=t||fabric.window;for(i=0;i<n;++i)s=s[r[i]];return s},loadImage:function(t,e,i,r){if(!t)return void(e&&e.call(i,t));var n=fabric.util.createImage();n.onload=function(){e&&e.call(i,n),n=n.onload=n.onerror=null},n.onerror=function(){fabric.log("Error loading "+n.src),e&&e.call(i,null,!0),n=n.onload=n.onerror=null},0!==t.indexOf("data")&&r&&(n.crossOrigin=r),n.src=t},enlivenObjects:function(t,e,i,r){function n(){++o===a&&e&&e(s)}t=t||[];var s=[],o=0,a=t.length;return a?void t.forEach(function(t,e){if(!t||!t.type)return void n();var o=fabric.util.getKlass(t.type,i);o.async?o.fromObject(t,function(i,o){o||(s[e]=i,r&&r(t,s[e])),n()}):(s[e]=o.fromObject(t),r&&r(t,s[e]),n())}):void(e&&e(s))},groupSVGElements:function(t,e,i){var r;return r=new fabric.PathGroup(t,e),"undefined"!=typeof i&&r.setSourcePath(i),r},populateWithProperties:function(t,e,i){if(i&&"[object Array]"===Object.prototype.toString.call(i))for(var r=0,n=i.length;r<n;r++)i[r]in t&&(e[i[r]]=t[i[r]])},drawDashedLine:function(t,r,n,s,o,a){var h=s-r,c=o-n,l=e(h*h+c*c),u=i(c,h),f=a.length,d=0,g=!0;for(t.save(),t.translate(r,n),t.moveTo(0,0),t.rotate(u),r=0;l>r;)r+=a[d++%f],r>l&&(r=l),t[g?"lineTo":"moveTo"](r,0),g=!g;t.restore()},createCanvasElement:function(t){return t||(t=fabric.document.createElement("canvas")),t.getContext||"undefined"==typeof G_vmlCanvasManager||G_vmlCanvasManager.initElement(t),t},createImage:function(){return fabric.isLikelyNode?new(require("canvas").Image):fabric.document.createElement("img")},createAccessors:function(t){var e,i,r,n,s,o=t.prototype;for(e=o.stateProperties.length;e--;)i=o.stateProperties[e],r=i.charAt(0).toUpperCase()+i.slice(1),n="set"+r,s="get"+r,o[s]||(o[s]=function(t){return new Function('return this.get("'+t+'")')}(i)),o[n]||(o[n]=function(t){return new Function("value",'return this.set("'+t+'", value)')}(i))},clipContext:function(t,e){e.save(),e.beginPath(),t.clipTo(e),e.clip()},multiplyTransformMatrices:function(t,e,i){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],i?0:t[0]*e[4]+t[2]*e[5]+t[4],i?0:t[1]*e[4]+t[3]*e[5]+t[5]]},qrDecompose:function(t){var n=i(t[1],t[0]),o=r(t[0],2)+r(t[1],2),a=e(o),h=(t[0]*t[3]-t[2]*t[1])/a,c=i(t[0]*t[2]+t[1]*t[3],o);return{angle:n/s,scaleX:a,scaleY:h,skewX:c/s,skewY:0,translateX:t[4],translateY:t[5]}},customTransformMatrix:function(t,e,i){var r=[1,0,n(Math.tan(i*s)),1],o=[n(t),0,0,n(e)];return fabric.util.multiplyTransformMatrices(o,r,!0)},resetObjectTransform:function(t){t.scaleX=1,t.scaleY=1,t.skewX=0,t.skewY=0,t.flipX=!1,t.flipY=!1,t.setAngle(0)},getFunctionBody:function(t){return(String(t).match(/function[^{]*\{([\s\S]*)\}/)||{})[1]},isTransparent:function(t,e,i,r){r>0&&(e>r?e-=r:e=0,i>r?i-=r:i=0);var n,s,o=!0,a=t.getImageData(e,i,2*r||1,2*r||1),h=a.data.length;for(n=3;n<h&&(s=a.data[n],o=s<=0,o!==!1);n+=4);return a=null,o},parsePreserveAspectRatioAttribute:function(t){var e,i="meet",r="Mid",n="Mid",s=t.split(" ");return s&&s.length&&(i=s.pop(),"meet"!==i&&"slice"!==i?(e=i,i="meet"):s.length&&(e=s.pop())),r="none"!==e?e.slice(1,4):"none",n="none"!==e?e.slice(5,8):"none",{meetOrSlice:i,alignX:r,alignY:n}},clearFabricFontCache:function(t){t?fabric.charWidthsCache[t]&&delete fabric.charWidthsCache[t]:fabric.charWidthsCache={}}}}("undefined"!=typeof exports?exports:this),function(){function t(t,r,s,o,h,c,l){var u=a.call(arguments);if(n[u])return n[u];var f=Math.PI,d=l*f/180,g=Math.sin(d),p=Math.cos(d),v=0,b=0;s=Math.abs(s),o=Math.abs(o);var m=-p*t*.5-g*r*.5,y=-p*r*.5+g*t*.5,_=s*s,x=o*o,S=y*y,C=m*m,w=_*x-_*S-x*C,O=0;if(w<0){var T=Math.sqrt(1-w/(_*x));s*=T,o*=T}else O=(h===c?-1:1)*Math.sqrt(w/(_*S+x*C));var k=O*s*y/o,j=-O*o*m/s,M=p*k-g*j+.5*t,A=g*k+p*j+.5*r,P=i(1,0,(m-k)/s,(y-j)/o),I=i((m-k)/s,(y-j)/o,(-m-k)/s,(-y-j)/o);0===c&&I>0?I-=2*f:1===c&&I<0&&(I+=2*f);for(var E=Math.ceil(Math.abs(I/f*2)),D=[],L=I/E,R=8/3*Math.sin(L/4)*Math.sin(L/4)/Math.sin(L/2),F=P+L,B=0;B<E;B++)D[B]=e(P,F,p,g,s,o,M,A,R,v,b),v=D[B][4],b=D[B][5],P=F,F+=L;return n[u]=D,D}function e(t,e,i,r,n,o,h,c,l,u,f){var d=a.call(arguments);if(s[d])return s[d];var g=Math.cos(t),p=Math.sin(t),v=Math.cos(e),b=Math.sin(e),m=i*n*v-r*o*b+h,y=r*n*v+i*o*b+c,_=u+l*(-i*n*p-r*o*g),x=f+l*(-r*n*p+i*o*g),S=m+l*(i*n*b+r*o*v),C=y+l*(r*n*b-i*o*v);return s[d]=[_,x,S,C,m,y],s[d]}function i(t,e,i,r){var n=Math.atan2(e,t),s=Math.atan2(r,i);return s>=n?s-n:2*Math.PI-(n-s)}function r(t,e,i,r,n,s,h,c){var l=a.call(arguments);if(o[l])return o[l];var u,f,d,g,p,v,b,m,y=Math.sqrt,_=Math.min,x=Math.max,S=Math.abs,C=[],w=[[],[]];f=6*t-12*i+6*n,u=-3*t+9*i-9*n+3*h,d=3*i-3*t;for(var O=0;O<2;++O)if(O>0&&(f=6*e-12*r+6*s,u=-3*e+9*r-9*s+3*c,d=3*r-3*e),S(u)<1e-12){if(S(f)<1e-12)continue;g=-d/f,0<g&&g<1&&C.push(g)}else b=f*f-4*d*u,b<0||(m=y(b),p=(-f+m)/(2*u),0<p&&p<1&&C.push(p),v=(-f-m)/(2*u),0<v&&v<1&&C.push(v));for(var T,k,j,M=C.length,A=M;M--;)g=C[M],j=1-g,T=j*j*j*t+3*j*j*g*i+3*j*g*g*n+g*g*g*h,w[0][M]=T,k=j*j*j*e+3*j*j*g*r+3*j*g*g*s+g*g*g*c,w[1][M]=k;w[0][A]=t,w[1][A]=e,w[0][A+1]=h,w[1][A+1]=c;var P=[{x:_.apply(null,w[0]),y:_.apply(null,w[1])},{x:x.apply(null,w[0]),y:x.apply(null,w[1])}];return o[l]=P,P}var n={},s={},o={},a=Array.prototype.join;fabric.util.drawArc=function(e,i,r,n){for(var s=n[0],o=n[1],a=n[2],h=n[3],c=n[4],l=n[5],u=n[6],f=[[],[],[],[]],d=t(l-i,u-r,s,o,h,c,a),g=0,p=d.length;g<p;g++)f[g][0]=d[g][0]+i,f[g][1]=d[g][1]+r,f[g][2]=d[g][2]+i,f[g][3]=d[g][3]+r,f[g][4]=d[g][4]+i,f[g][5]=d[g][5]+r,e.bezierCurveTo.apply(e,f[g])},fabric.util.getBoundsOfArc=function(e,i,n,s,o,a,h,c,l){for(var u,f=0,d=0,g=[],p=t(c-e,l-i,n,s,a,h,o),v=0,b=p.length;v<b;v++)u=r(f,d,p[v][0],p[v][1],p[v][2],p[v][3],p[v][4],p[v][5]),g.push({x:u[0].x+e,y:u[0].y+i}),g.push({x:u[1].x+e,y:u[1].y+i}),f=p[v][4],d=p[v][5];return g},fabric.util.getBoundsOfCurve=r}(),function(){function t(t,e){for(var i=s.call(arguments,2),r=[],n=0,o=t.length;n<o;n++)r[n]=i.length?t[n][e].apply(t[n],i):t[n][e].call(t[n]);return r}function e(t,e){return n(t,e,function(t,e){return t>=e})}function i(t,e){return n(t,e,function(t,e){return t<e})}function r(t,e){for(var i=t.length;i--;)t[i]=e;return t}function n(t,e,i){if(t&&0!==t.length){var r=t.length-1,n=e?t[r][e]:t[r];if(e)for(;r--;)i(t[r][e],n)&&(n=t[r][e]);else for(;r--;)i(t[r],n)&&(n=t[r]);return n}}var s=Array.prototype.slice;Array.prototype.indexOf||(Array.prototype.indexOf=function(t){if(void 0===this||null===this)throw new TypeError;var e=Object(this),i=e.length>>>0;if(0===i)return-1;var r=0;if(arguments.length>0&&(r=Number(arguments[1]),r!==r?r=0:0!==r&&r!==Number.POSITIVE_INFINITY&&r!==Number.NEGATIVE_INFINITY&&(r=(r>0||-1)*Math.floor(Math.abs(r)))),r>=i)return-1;for(var n=r>=0?r:Math.max(i-Math.abs(r),0);n<i;n++)if(n in e&&e[n]===t)return n;return-1}),Array.prototype.forEach||(Array.prototype.forEach=function(t,e){for(var i=0,r=this.length>>>0;i<r;i++)i in this&&t.call(e,this[i],i,this)}),Array.prototype.map||(Array.prototype.map=function(t,e){for(var i=[],r=0,n=this.length>>>0;r<n;r++)r in this&&(i[r]=t.call(e,this[r],r,this));return i}),Array.prototype.every||(Array.prototype.every=function(t,e){for(var i=0,r=this.length>>>0;i<r;i++)if(i in this&&!t.call(e,this[i],i,this))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(t,e){for(var i=0,r=this.length>>>0;i<r;i++)if(i in this&&t.call(e,this[i],i,this))return!0;return!1}),Array.prototype.filter||(Array.prototype.filter=function(t,e){for(var i,r=[],n=0,s=this.length>>>0;n<s;n++)n in this&&(i=this[n],t.call(e,i,n,this)&&r.push(i));return r}),Array.prototype.reduce||(Array.prototype.reduce=function(t){var e,i=this.length>>>0,r=0;if(arguments.length>1)e=arguments[1];else for(;;){if(r in this){e=this[r++];break}if(++r>=i)throw new TypeError}for(;r<i;r++)r in this&&(e=t.call(null,e,this[r],r,this));return e}),fabric.util.array={fill:r,invoke:t,min:i,max:e}}(),function(){function t(t,i,r){if(r)if(!fabric.isLikelyNode&&i instanceof Element)t=i;else if(i instanceof Array)t=i.map(function(t){return e(t,r)});else if(i instanceof Object)for(var n in i)t[n]=e(i[n],r);else t=i;else for(var n in i)t[n]=i[n];return t}function e(e,i){return t({},e,i)}fabric.util.object={extend:t,clone:e}}(),function(){function t(t){return t.replace(/-+(.)?/g,function(t,e){return e?e.toUpperCase():""})}function e(t,e){return t.charAt(0).toUpperCase()+(e?t.slice(1):t.slice(1).toLowerCase())}function i(t){return t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\xA0]+/,"").replace(/[\s\xA0]+$/,"")}),fabric.util.string={camelize:t,capitalize:e,escapeXml:i}}(),function(){var t=Array.prototype.slice,e=Function.prototype.apply,i=function(){};Function.prototype.bind||(Function.prototype.bind=function(r){var n,s=this,o=t.call(arguments,1);return n=o.length?function(){return e.call(s,this instanceof i?this:r,o.concat(t.call(arguments)))}:function(){return e.call(s,this instanceof i?this:r,arguments)},i.prototype=this.prototype,n.prototype=new i,n})}(),function(){function t(){}function e(t){var e=this.constructor.superclass.prototype[t];return arguments.length>1?e.apply(this,r.call(arguments,1)):e.call(this)}function i(){function i(){this.initialize.apply(this,arguments)}var s=null,a=r.call(arguments,0);"function"==typeof a[0]&&(s=a.shift()),i.superclass=s,i.subclasses=[],s&&(t.prototype=s.prototype,i.prototype=new t,s.subclasses.push(i));for(var h=0,c=a.length;h<c;h++)o(i,a[h],s);return i.prototype.initialize||(i.prototype.initialize=n),i.prototype.constructor=i,i.prototype.callSuper=e,i}var r=Array.prototype.slice,n=function(){},s=function(){for(var t in{toString:1})if("toString"===t)return!1;return!0}(),o=function(t,e,i){for(var r in e)r in t.prototype&&"function"==typeof t.prototype[r]&&(e[r]+"").indexOf("callSuper")>-1?t.prototype[r]=function(t){return function(){var r=this.constructor.superclass;this.constructor.superclass=i;var n=e[t].apply(this,arguments);if(this.constructor.superclass=r,"initialize"!==t)return n}}(r):t.prototype[r]=e[r],s&&(e.toString!==Object.prototype.toString&&(t.prototype.toString=e.toString),e.valueOf!==Object.prototype.valueOf&&(t.prototype.valueOf=e.valueOf))};fabric.util.createClass=i}(),function(){function t(t){var e,i,r=Array.prototype.slice.call(arguments,1),n=r.length;for(i=0;i<n;i++)if(e=typeof t[r[i]],!/^(?:function|object|unknown)$/.test(e))return!1;return!0}function e(t,e){return{handler:e,wrappedHandler:i(t,e)}}function i(t,e){return function(i){e.call(o(t),i||fabric.window.event)}}function r(t,e){return function(i){if(p[t]&&p[t][e])for(var r=p[t][e],n=0,s=r.length;n<s;n++)r[n].call(this,i||fabric.window.event)}}function n(t){t||(t=fabric.window.event);var e=t.target||(typeof t.srcElement!==h?t.srcElement:null),i=fabric.util.getScrollLeftTop(e);return{x:v(t)+i.left,y:b(t)+i.top}}function s(t,e,i){var r="touchend"===t.type?"changedTouches":"touches";return t[r]&&t[r][0]?t[r][0][e]-(t[r][0][e]-t[r][0][i])||t[i]:t[i]}var o,a,h="unknown",c=function(){var t=0;return function(e){return e.__uniqueID||(e.__uniqueID="uniqueID__"+t++)}}();!function(){var t={};o=function(e){return t[e]},a=function(e,i){t[e]=i}}();var l,u,f=t(fabric.document.documentElement,"addEventListener","removeEventListener")&&t(fabric.window,"addEventListener","removeEventListener"),d=t(fabric.document.documentElement,"attachEvent","detachEvent")&&t(fabric.window,"attachEvent","detachEvent"),g={},p={};f?(l=function(t,e,i){t.addEventListener(e,i,!1)},u=function(t,e,i){t.removeEventListener(e,i,!1)}):d?(l=function(t,i,r){var n=c(t);a(n,t),g[n]||(g[n]={}),g[n][i]||(g[n][i]=[]);var s=e(n,r);g[n][i].push(s),t.attachEvent("on"+i,s.wrappedHandler)},u=function(t,e,i){var r,n=c(t);if(g[n]&&g[n][e])for(var s=0,o=g[n][e].length;s<o;s++)r=g[n][e][s],r&&r.handler===i&&(t.detachEvent("on"+e,r.wrappedHandler),g[n][e][s]=null)}):(l=function(t,e,i){var n=c(t);if(p[n]||(p[n]={}),!p[n][e]){p[n][e]=[];var s=t["on"+e];s&&p[n][e].push(s),t["on"+e]=r(n,e)}p[n][e].push(i)},u=function(t,e,i){var r=c(t);if(p[r]&&p[r][e])for(var n=p[r][e],s=0,o=n.length;s<o;s++)n[s]===i&&n.splice(s,1)}),fabric.util.addListener=l,fabric.util.removeListener=u;var v=function(t){return typeof t.clientX!==h?t.clientX:0},b=function(t){return typeof t.clientY!==h?t.clientY:0};fabric.isTouchSupported&&(v=function(t){return s(t,"pageX","clientX")},b=function(t){return s(t,"pageY","clientY")}),fabric.util.getPointer=n,fabric.util.object.extend(fabric.util,fabric.Observable)}(),function(){function t(t,e){var i=t.style;if(!i)return t;if("string"==typeof e)return t.style.cssText+=";"+e,e.indexOf("opacity")>-1?s(t,e.match(/opacity:\s*(\d?\.?\d*)/)[1]):t;for(var r in e)if("opacity"===r)s(t,e[r]);else{var n="float"===r||"cssFloat"===r?"undefined"==typeof i.styleFloat?"cssFloat":"styleFloat":r;i[n]=e[r]}return t}var e=fabric.document.createElement("div"),i="string"==typeof e.style.opacity,r="string"==typeof e.style.filter,n=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,s=function(t){return t};i?s=function(t,e){return t.style.opacity=e,t}:r&&(s=function(t,e){var i=t.style;return t.currentStyle&&!t.currentStyle.hasLayout&&(i.zoom=1),n.test(i.filter)?(e=e>=.9999?"":"alpha(opacity="+100*e+")",i.filter=i.filter.replace(n,e)):i.filter+=" alpha(opacity="+100*e+")",t}),fabric.util.setStyle=t}(),function(){function t(t){return"string"==typeof t?fabric.document.getElementById(t):t}function e(t,e){var i=fabric.document.createElement(t);for(var r in e)"class"===r?i.className=e[r]:"for"===r?i.htmlFor=e[r]:i.setAttribute(r,e[r]);return i}function i(t,e){t&&(" "+t.className+" ").indexOf(" "+e+" ")===-1&&(t.className+=(t.className?" ":"")+e)}function r(t,i,r){return"string"==typeof i&&(i=e(i,r)),t.parentNode&&t.parentNode.replaceChild(i,t),i.appendChild(t),i}function n(t){for(var e=0,i=0,r=fabric.document.documentElement,n=fabric.document.body||{scrollLeft:0,scrollTop:0};t&&(t.parentNode||t.host)&&(t=t.parentNode||t.host,t===fabric.document?(e=n.scrollLeft||r.scrollLeft||0,i=n.scrollTop||r.scrollTop||0):(e+=t.scrollLeft||0,i+=t.scrollTop||0),1!==t.nodeType||"fixed"!==fabric.util.getElementStyle(t,"position")););return{left:e,top:i}}function s(t){var e,i,r=t&&t.ownerDocument,s={left:0,top:0},o={left:0,top:0},a={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!r)return o;for(var h in a)o[a[h]]+=parseInt(c(t,h),10)||0;return e=r.documentElement,"undefined"!=typeof t.getBoundingClientRect&&(s=t.getBoundingClientRect()),i=n(t),{left:s.left+i.left-(e.clientLeft||0)+o.left,top:s.top+i.top-(e.clientTop||0)+o.top}}var o,a=Array.prototype.slice,h=function(t){return a.call(t,0)};try{o=h(fabric.document.childNodes)instanceof Array}catch(t){}o||(h=function(t){for(var e=new Array(t.length),i=t.length;i--;)e[i]=t[i];return e});var c;c=fabric.document.defaultView&&fabric.document.defaultView.getComputedStyle?function(t,e){var i=fabric.document.defaultView.getComputedStyle(t,null);return i?i[e]:void 0}:function(t,e){var i=t.style[e];return!i&&t.currentStyle&&(i=t.currentStyle[e]),i},function(){function t(t){return"undefined"!=typeof t.onselectstart&&(t.onselectstart=fabric.util.falseFunction),r?t.style[r]="none":"string"==typeof t.unselectable&&(t.unselectable="on"),t}function e(t){return"undefined"!=typeof t.onselectstart&&(t.onselectstart=null),r?t.style[r]="":"string"==typeof t.unselectable&&(t.unselectable=""),t}var i=fabric.document.documentElement.style,r="userSelect"in i?"userSelect":"MozUserSelect"in i?"MozUserSelect":"WebkitUserSelect"in i?"WebkitUserSelect":"KhtmlUserSelect"in i?"KhtmlUserSelect":"";fabric.util.makeElementUnselectable=t,fabric.util.makeElementSelectable=e}(),function(){function t(t,e){var i=fabric.document.getElementsByTagName("head")[0],r=fabric.document.createElement("script"),n=!0;r.onload=r.onreadystatechange=function(t){if(n){if("string"==typeof this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState)return;n=!1,e(t||fabric.window.event),r=r.onload=r.onreadystatechange=null}},r.src=t,i.appendChild(r)}fabric.util.getScript=t}(),fabric.util.getById=t,fabric.util.toArray=h,fabric.util.makeElement=e,fabric.util.addClass=i,fabric.util.wrapElement=r,fabric.util.getScrollLeftTop=n,fabric.util.getElementOffset=s,fabric.util.getElementStyle=c}(),function(){function t(t,e){return t+(/\?/.test(t)?"&":"?")+e}function e(){}function i(i,n){n||(n={});var s=n.method?n.method.toUpperCase():"GET",o=n.onComplete||function(){},a=r(),h=n.body||n.parameters;return a.onreadystatechange=function(){4===a.readyState&&(o(a),a.onreadystatechange=e)},"GET"===s&&(h=null,"string"==typeof n.parameters&&(i=t(i,n.parameters))),a.open(s,i,!0),"POST"!==s&&"PUT"!==s||a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.send(h),a}var r=function(){for(var t=[function(){return new ActiveXObject("Microsoft.XMLHTTP")},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml2.XMLHTTP.3.0")},function(){return new XMLHttpRequest}],e=t.length;e--;)try{var i=t[e]();if(i)return t[e]}catch(t){}}();fabric.util.request=i}(),fabric.log=function(){},fabric.warn=function(){},"undefined"!=typeof console&&["log","warn"].forEach(function(t){"undefined"!=typeof console[t]&&"function"==typeof console[t].apply&&(fabric[t]=function(){return console[t].apply(console,arguments)})}),function(){function t(t){e(function(i){t||(t={});var r,n=i||+new Date,s=t.duration||500,o=n+s,a=t.onChange||function(){},h=t.abort||function(){return!1},c=t.easing||function(t,e,i,r){return-i*Math.cos(t/r*(Math.PI/2))+i+e},l="startValue"in t?t.startValue:0,u="endValue"in t?t.endValue:100,f=t.byValue||u-l;t.onStart&&t.onStart(),function i(u){r=u||+new Date;var d=r>o?s:r-n;return h()?void(t.onComplete&&t.onComplete()):(a(c(d,l,f,s)),r>o?void(t.onComplete&&t.onComplete()):void e(i))}(n)})}function e(){return i.apply(fabric.window,arguments)}var i=fabric.window.requestAnimationFrame||fabric.window.webkitRequestAnimationFrame||fabric.window.mozRequestAnimationFrame||fabric.window.oRequestAnimationFrame||fabric.window.msRequestAnimationFrame||function(t){fabric.window.setTimeout(t,1e3/60)};fabric.util.animate=t,fabric.util.requestAnimFrame=e}(),function(){function t(t,e,i,r){return t<Math.abs(e)?(t=e,r=i/4):r=0===e&&0===t?i/(2*Math.PI)*Math.asin(1):i/(2*Math.PI)*Math.asin(e/t),{a:t,c:e,p:i,s:r}}function e(t,e,i){return t.a*Math.pow(2,10*(e-=1))*Math.sin((e*i-t.s)*(2*Math.PI)/t.p)}function i(t,e,i,r){return i*((t=t/r-1)*t*t+1)+e}function r(t,e,i,r){return t/=r/2,t<1?i/2*t*t*t+e:i/2*((t-=2)*t*t+2)+e}function n(t,e,i,r){return i*(t/=r)*t*t*t+e}function s(t,e,i,r){return-i*((t=t/r-1)*t*t*t-1)+e}function o(t,e,i,r){return t/=r/2,t<1?i/2*t*t*t*t+e:-i/2*((t-=2)*t*t*t-2)+e}function a(t,e,i,r){return i*(t/=r)*t*t*t*t+e}function h(t,e,i,r){return i*((t=t/r-1)*t*t*t*t+1)+e}function c(t,e,i,r){return t/=r/2,t<1?i/2*t*t*t*t*t+e:i/2*((t-=2)*t*t*t*t+2)+e}function l(t,e,i,r){return-i*Math.cos(t/r*(Math.PI/2))+i+e}function u(t,e,i,r){return i*Math.sin(t/r*(Math.PI/2))+e}function f(t,e,i,r){return-i/2*(Math.cos(Math.PI*t/r)-1)+e}function d(t,e,i,r){return 0===t?e:i*Math.pow(2,10*(t/r-1))+e}function g(t,e,i,r){return t===r?e+i:i*(-Math.pow(2,-10*t/r)+1)+e}function p(t,e,i,r){return 0===t?e:t===r?e+i:(t/=r/2,t<1?i/2*Math.pow(2,10*(t-1))+e:i/2*(-Math.pow(2,-10*--t)+2)+e)}function v(t,e,i,r){return-i*(Math.sqrt(1-(t/=r)*t)-1)+e}function b(t,e,i,r){return i*Math.sqrt(1-(t=t/r-1)*t)+e}function m(t,e,i,r){return t/=r/2,t<1?-i/2*(Math.sqrt(1-t*t)-1)+e:i/2*(Math.sqrt(1-(t-=2)*t)+1)+e}function y(i,r,n,s){var o=1.70158,a=0,h=n;if(0===i)return r;if(i/=s,1===i)return r+n;a||(a=.3*s);var c=t(h,n,a,o);return-e(c,i,s)+r}function _(e,i,r,n){var s=1.70158,o=0,a=r;if(0===e)return i;if(e/=n,1===e)return i+r;o||(o=.3*n);var h=t(a,r,o,s);return h.a*Math.pow(2,-10*e)*Math.sin((e*n-h.s)*(2*Math.PI)/h.p)+h.c+i}function x(i,r,n,s){var o=1.70158,a=0,h=n;if(0===i)return r;if(i/=s/2,2===i)return r+n;a||(a=s*(.3*1.5));var c=t(h,n,a,o);return i<1?-.5*e(c,i,s)+r:c.a*Math.pow(2,-10*(i-=1))*Math.sin((i*s-c.s)*(2*Math.PI)/c.p)*.5+c.c+r}function S(t,e,i,r,n){return void 0===n&&(n=1.70158),i*(t/=r)*t*((n+1)*t-n)+e}function C(t,e,i,r,n){return void 0===n&&(n=1.70158),i*((t=t/r-1)*t*((n+1)*t+n)+1)+e}function w(t,e,i,r,n){return void 0===n&&(n=1.70158),t/=r/2,t<1?i/2*(t*t*(((n*=1.525)+1)*t-n))+e:i/2*((t-=2)*t*(((n*=1.525)+1)*t+n)+2)+e}function O(t,e,i,r){return i-T(r-t,0,i,r)+e}function T(t,e,i,r){return(t/=r)<1/2.75?i*(7.5625*t*t)+e:t<2/2.75?i*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?i*(7.5625*(t-=2.25/2.75)*t+.9375)+e:i*(7.5625*(t-=2.625/2.75)*t+.984375)+e}function k(t,e,i,r){return t<r/2?.5*O(2*t,0,i,r)+e:.5*T(2*t-r,0,i,r)+.5*i+e}fabric.util.ease={easeInQuad:function(t,e,i,r){return i*(t/=r)*t+e},easeOutQuad:function(t,e,i,r){return-i*(t/=r)*(t-2)+e},easeInOutQuad:function(t,e,i,r){return t/=r/2,t<1?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e},easeInCubic:function(t,e,i,r){return i*(t/=r)*t*t+e},easeOutCubic:i,easeInOutCubic:r,easeInQuart:n,easeOutQuart:s,easeInOutQuart:o,easeInQuint:a,easeOutQuint:h,easeInOutQuint:c,easeInSine:l,easeOutSine:u,easeInOutSine:f,easeInExpo:d,easeOutExpo:g,easeInOutExpo:p,easeInCirc:v,easeOutCirc:b,easeInOutCirc:m,easeInElastic:y,easeOutElastic:_,easeInOutElastic:x,easeInBack:S,easeOutBack:C,easeInOutBack:w,easeInBounce:O,easeOutBounce:T,easeInOutBounce:k}}(),function(t){"use strict";function e(t){return t in k?k[t]:t}function i(t,e,i,r){var n,s="[object Array]"===Object.prototype.toString.call(e);return"fill"!==t&&"stroke"!==t||"none"!==e?"strokeDashArray"===t?e=e.replace(/,/g," ").split(/\s+/).map(function(t){return parseFloat(t)}):"transformMatrix"===t?e=i&&i.transformMatrix?S(i.transformMatrix,v.parseTransformAttribute(e)):v.parseTransformAttribute(e):"visible"===t?(e="none"!==e&&"hidden"!==e,i&&i.visible===!1&&(e=!1)):"originX"===t?e="start"===e?"left":"end"===e?"right":"center":n=s?e.map(x):x(e,r):e="",!s&&isNaN(n)?e:n}function r(t){for(var e in j)if("undefined"!=typeof t[j[e]]&&""!==t[e]){if("undefined"==typeof t[e]){if(!v.Object.prototype[e])continue;t[e]=v.Object.prototype[e]}if(0!==t[e].indexOf("url(")){var i=new v.Color(t[e]);t[e]=i.setAlpha(_(i.getAlpha()*t[j[e]],2)).toRgba()}}return t}function n(t,e){for(var i,r,n=[],s=0;s<e.length;s++)i=e[s],r=t.getElementsByTagName(i),n=n.concat(Array.prototype.slice.call(r));return n}function s(t,r){var n,s;t.replace(/;\s*$/,"").split(";").forEach(function(t){var o=t.split(":");n=e(o[0].trim().toLowerCase()),s=i(n,o[1].trim()),r[n]=s})}function o(t,r){var n,s;for(var o in t)"undefined"!=typeof t[o]&&(n=e(o.toLowerCase()),s=i(n,t[o]),r[n]=s)}function a(t,e){var i={};for(var r in v.cssRules[e])if(h(t,r.split(" ")))for(var n in v.cssRules[e][r])i[n]=v.cssRules[e][r][n];return i}function h(t,e){var i,r=!0;return i=l(t,e.pop()),i&&e.length&&(r=c(t,e)),i&&r&&0===e.length}function c(t,e){for(var i,r=!0;t.parentNode&&1===t.parentNode.nodeType&&e.length;)r&&(i=e.pop()),t=t.parentNode,r=l(t,i);return 0===e.length}function l(t,e){var i,r=t.nodeName,n=t.getAttribute("class"),s=t.getAttribute("id");if(i=new RegExp("^"+r,"i"),e=e.replace(i,""),s&&e.length&&(i=new RegExp("#"+s+"(?![a-zA-Z\\-]+)","i"),e=e.replace(i,"")),n&&e.length){n=n.split(" ");for(var o=n.length;o--;)i=new RegExp("\\."+n[o]+"(?![a-zA-Z\\-]+)","i"),e=e.replace(i,"")}return 0===e.length}function u(t,e){var i;if(t.getElementById&&(i=t.getElementById(e)),i)return i;var r,n,s=t.getElementsByTagName("*");for(n=0;n<s.length;n++)if(r=s[n],e===r.getAttribute("id"))return r}function f(t){for(var e=n(t,["use","svg:use"]),i=0;e.length&&i<e.length;){var r,s,o,a,h,c=e[i],l=c.getAttribute("xlink:href").substr(1),f=c.getAttribute("x")||0,g=c.getAttribute("y")||0,p=u(t,l).cloneNode(!0),v=(p.getAttribute("transform")||"")+" translate("+f+", "+g+")",b=e.length;if(d(p),/^svg$/i.test(p.nodeName)){var m=p.ownerDocument.createElement("g");for(o=0,a=p.attributes,h=a.length;o<h;o++)s=a.item(o),m.setAttribute(s.nodeName,s.nodeValue);for(;p.firstChild;)m.appendChild(p.firstChild);p=m}for(o=0,a=c.attributes,h=a.length;o<h;o++)s=a.item(o),"x"!==s.nodeName&&"y"!==s.nodeName&&"xlink:href"!==s.nodeName&&("transform"===s.nodeName?v=s.nodeValue+" "+v:p.setAttribute(s.nodeName,s.nodeValue));p.setAttribute("transform",v),p.setAttribute("instantiated_by_use","1"),p.removeAttribute("id"),r=c.parentNode,r.replaceChild(p,c),e.length===b&&i++}}function d(t){var e,i,r,n,s=t.getAttribute("viewBox"),o=1,a=1,h=0,c=0,l=t.getAttribute("width"),u=t.getAttribute("height"),f=t.getAttribute("x")||0,d=t.getAttribute("y")||0,g=t.getAttribute("preserveAspectRatio")||"",p=!s||!w.test(t.nodeName)||!(s=s.match(M)),b=!l||!u||"100%"===l||"100%"===u,m=p&&b,y={},_="";if(y.width=0,y.height=0,y.toBeParsed=m,m)return y;if(p)return y.width=x(l),y.height=x(u),y;if(h=-parseFloat(s[1]),c=-parseFloat(s[2]),e=parseFloat(s[3]),i=parseFloat(s[4]),b?(y.width=e,y.height=i):(y.width=x(l),y.height=x(u),o=y.width/e,a=y.height/i),g=v.util.parsePreserveAspectRatioAttribute(g),"none"!==g.alignX&&(a=o=o>a?a:o),1===o&&1===a&&0===h&&0===c&&0===f&&0===d)return y;if((f||d)&&(_=" translate("+x(f)+" "+x(d)+") "),r=_+" matrix("+o+" 0 0 "+a+" "+h*o+" "+c*a+") ","svg"===t.nodeName){for(n=t.ownerDocument.createElement("g");t.firstChild;)n.appendChild(t.firstChild);t.appendChild(n)}else n=t,r=n.getAttribute("transform")+r;return n.setAttribute("transform",r),y}function g(t){var e=t.objects,i=t.options;return e=e.map(function(t){return v[m(t.type)].fromObject(t)}),{objects:e,options:i}}function p(t,e,i){e[i]&&e[i].toSVG&&t.push('\t<pattern x="0" y="0" id="',i,'Pattern" ','width="',e[i].source.width,'" height="',e[i].source.height,'" patternUnits="userSpaceOnUse">\n','\t\t<image x="0" y="0" ','width="',e[i].source.width,'" height="',e[i].source.height,'" xlink:href="',e[i].source.src,'"></image>\n\t</pattern>\n')}var v=t.fabric||(t.fabric={}),b=v.util.object.extend,m=v.util.string.capitalize,y=v.util.object.clone,_=v.util.toFixed,x=v.util.parseUnit,S=v.util.multiplyTransformMatrices,C=/^(path|circle|polygon|polyline|ellipse|rect|line|image|text)$/i,w=/^(symbol|image|marker|pattern|view|svg)$/i,O=/^(?:pattern|defs|symbol|metadata)$/i,T=/^(symbol|g|a|svg)$/i,k={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","stroke-dasharray":"strokeDashArray","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"originX"},j={stroke:"strokeOpacity",fill:"fillOpacity"};v.cssRules={},v.gradientDefs={},v.parseTransformAttribute=function(){function t(t,e){var i=e[0],r=3===e.length?e[1]:0,n=3===e.length?e[2]:0;t[0]=Math.cos(i),t[1]=Math.sin(i),t[2]=-Math.sin(i),t[3]=Math.cos(i),t[4]=r-(t[0]*r+t[2]*n),t[5]=n-(t[1]*r+t[3]*n)}function e(t,e){var i=e[0],r=2===e.length?e[1]:e[0];t[0]=i,t[3]=r}function i(t,e){t[2]=Math.tan(v.util.degreesToRadians(e[0]));
}function r(t,e){t[1]=Math.tan(v.util.degreesToRadians(e[0]))}function n(t,e){t[4]=e[0],2===e.length&&(t[5]=e[1])}var s=[1,0,0,1,0,0],o=v.reNum,a="(?:\\s+,?\\s*|,\\s*)",h="(?:(skewX)\\s*\\(\\s*("+o+")\\s*\\))",c="(?:(skewY)\\s*\\(\\s*("+o+")\\s*\\))",l="(?:(rotate)\\s*\\(\\s*("+o+")(?:"+a+"("+o+")"+a+"("+o+"))?\\s*\\))",u="(?:(scale)\\s*\\(\\s*("+o+")(?:"+a+"("+o+"))?\\s*\\))",f="(?:(translate)\\s*\\(\\s*("+o+")(?:"+a+"("+o+"))?\\s*\\))",d="(?:(matrix)\\s*\\(\\s*("+o+")"+a+"("+o+")"+a+"("+o+")"+a+"("+o+")"+a+"("+o+")"+a+"("+o+")\\s*\\))",g="(?:"+d+"|"+f+"|"+u+"|"+l+"|"+h+"|"+c+")",p="(?:"+g+"(?:"+a+"*"+g+")*)",b="^\\s*(?:"+p+"?)\\s*$",m=new RegExp(b),y=new RegExp(g,"g");return function(o){var a=s.concat(),h=[];if(!o||o&&!m.test(o))return a;o.replace(y,function(o){var c=new RegExp(g).exec(o).filter(function(t){return!!t}),l=c[1],u=c.slice(2).map(parseFloat);switch(l){case"translate":n(a,u);break;case"rotate":u[0]=v.util.degreesToRadians(u[0]),t(a,u);break;case"scale":e(a,u);break;case"skewX":i(a,u);break;case"skewY":r(a,u);break;case"matrix":a=u}h.push(a.concat()),a=s.concat()});for(var c=h[0];h.length>1;)h.shift(),c=v.util.multiplyTransformMatrices(c,h[0]);return c}}();var M=new RegExp("^\\s*("+v.reNum+"+)\\s*,?\\s*("+v.reNum+"+)\\s*,?\\s*("+v.reNum+"+)\\s*,?\\s*("+v.reNum+"+)\\s*$");v.parseSVGDocument=function(){function t(t,e){for(;t&&(t=t.parentNode);)if(t.nodeName&&e.test(t.nodeName.replace("svg:",""))&&!t.getAttribute("instantiated_by_use"))return!0;return!1}return function(e,i,r){if(e){f(e);var n=new Date,s=v.Object.__uid++,o=d(e),a=v.util.toArray(e.getElementsByTagName("*"));if(o.svgUid=s,0===a.length&&v.isLikelyNode){a=e.selectNodes('//*[name(.)!="svg"]');for(var h=[],c=0,l=a.length;c<l;c++)h[c]=a[c];a=h}var u=a.filter(function(e){return d(e),C.test(e.nodeName.replace("svg:",""))&&!t(e,O)});if(!u||u&&!u.length)return void(i&&i([],{}));v.gradientDefs[s]=v.getGradientDefs(e),v.cssRules[s]=v.getCSSRules(e),v.parseElements(u,function(t){v.documentParsingTime=new Date-n,i&&i(t,o)},y(o),r)}}}();var A={has:function(t,e){e(!1)},get:function(){},set:function(){}},P=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+v.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+v.reNum+"))?\\s+(.*)");b(v,{parseFontDeclaration:function(t,e){var i=t.match(P);if(i){var r=i[1],n=i[3],s=i[4],o=i[5],a=i[6];r&&(e.fontStyle=r),n&&(e.fontWeight=isNaN(parseFloat(n))?n:parseFloat(n)),s&&(e.fontSize=x(s)),a&&(e.fontFamily=a),o&&(e.lineHeight="normal"===o?1:o)}},getGradientDefs:function(t){var e,i,r,s=["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"],o=n(t,s),a=0,h={},c={};for(a=o.length;a--;)e=o[a],r=e.getAttribute("xlink:href"),i=e.getAttribute("id"),r&&(c[i]=r.substr(1)),h[i]=e;for(i in c){var l=h[c[i]].cloneNode(!0);for(e=h[i];l.firstChild;)e.appendChild(l.firstChild)}return h},parseAttributes:function(t,n,s){if(t){var o,h,c={};"undefined"==typeof s&&(s=t.getAttribute("svgUid")),t.parentNode&&T.test(t.parentNode.nodeName)&&(c=v.parseAttributes(t.parentNode,n,s)),h=c&&c.fontSize||t.getAttribute("font-size")||v.Text.DEFAULT_SVG_FONT_SIZE;var l=n.reduce(function(r,n){return o=t.getAttribute(n),o&&(n=e(n),o=i(n,o,c,h),r[n]=o),r},{});return l=b(l,b(a(t,s),v.parseStyleAttribute(t))),l.font&&v.parseFontDeclaration(l.font,l),r(b(c,l))}},parseElements:function(t,e,i,r){new v.ElementsParser(t,e,i,r).parse()},parseStyleAttribute:function(t){var e={},i=t.getAttribute("style");return i?("string"==typeof i?s(i,e):o(i,e),e):e},parsePointsAttribute:function(t){if(!t)return null;t=t.replace(/,/g," ").trim(),t=t.split(/\s+/);var e,i,r=[];for(e=0,i=t.length;e<i;e+=2)r.push({x:parseFloat(t[e]),y:parseFloat(t[e+1])});return r},getCSSRules:function(t){for(var r,n=t.getElementsByTagName("style"),s={},o=0,a=n.length;o<a;o++){var h=n[o].textContent||n[o].text;h=h.replace(/\/\*[\s\S]*?\*\//g,""),""!==h.trim()&&(r=h.match(/[^{]*\{[\s\S]*?\}/g),r=r.map(function(t){return t.trim()}),r.forEach(function(t){for(var r=t.match(/([\s\S]*?)\s*\{([^}]*)\}/),n={},o=r[2].trim(),a=o.replace(/;$/,"").split(/\s*;\s*/),h=0,c=a.length;h<c;h++){var l=a[h].split(/\s*:\s*/),u=e(l[0]),f=i(u,l[1],l[0]);n[u]=f}t=r[1],t.split(",").forEach(function(t){t=t.replace(/^svg/i,"").trim(),""!==t&&(s[t]?v.util.object.extend(s[t],n):s[t]=v.util.object.clone(n))})}))}return s},loadSVGFromURL:function(t,e,i){function r(r){var n=r.responseXML;n&&!n.documentElement&&v.window.ActiveXObject&&r.responseText&&(n=new ActiveXObject("Microsoft.XMLDOM"),n.async="false",n.loadXML(r.responseText.replace(/<!DOCTYPE[\s\S]*?(\[[\s\S]*\])*?>/i,""))),n&&n.documentElement||e&&e(null),v.parseSVGDocument(n.documentElement,function(i,r){A.set(t,{objects:v.util.array.invoke(i,"toObject"),options:r}),e&&e(i,r)},i)}t=t.replace(/^\n\s*/,"").trim(),A.has(t,function(i){i?A.get(t,function(t){var i=g(t);e(i.objects,i.options)}):new v.util.request(t,{method:"get",onComplete:r})})},loadSVGFromString:function(t,e,i){t=t.trim();var r;if("undefined"!=typeof DOMParser){var n=new DOMParser;n&&n.parseFromString&&(r=n.parseFromString(t,"text/xml"))}else v.window.ActiveXObject&&(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(t.replace(/<!DOCTYPE[\s\S]*?(\[[\s\S]*\])*?>/i,"")));v.parseSVGDocument(r.documentElement,function(t,i){e(t,i)},i)},createSVGFontFacesMarkup:function(t){for(var e,i,r,n,s,o,a,h="",c={},l=v.fontPaths,u=0,f=t.length;u<f;u++)if(e=t[u],i=e.fontFamily,e.type.indexOf("text")!==-1&&!c[i]&&l[i]&&(c[i]=!0,e.styles)){r=e.styles;for(s in r){n=r[s];for(a in n)o=n[a],i=o.fontFamily,!c[i]&&l[i]&&(c[i]=!0)}}for(var d in c)h+=["\t\t@font-face {\n","\t\t\tfont-family: '",d,"';\n","\t\t\tsrc: url('",l[d],"');\n","\t\t}\n"].join("");return h&&(h=['\t<style type="text/css">',"<![CDATA[\n",h,"]]>","</style>\n"].join("")),h},createSVGRefElementsMarkup:function(t){var e=[];return p(e,t,"backgroundColor"),p(e,t,"overlayColor"),e.join("")}})}("undefined"!=typeof exports?exports:this),fabric.ElementsParser=function(t,e,i,r){this.elements=t,this.callback=e,this.options=i,this.reviver=r,this.svgUid=i&&i.svgUid||0},fabric.ElementsParser.prototype.parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},fabric.ElementsParser.prototype.createObjects=function(){for(var t=0,e=this.elements.length;t<e;t++)this.elements[t].setAttribute("svgUid",this.svgUid),function(t,e){setTimeout(function(){t.createObject(t.elements[e],e)},0)}(this,t)},fabric.ElementsParser.prototype.createObject=function(t,e){var i=fabric[fabric.util.string.capitalize(t.tagName.replace("svg:",""))];if(i&&i.fromElement)try{this._createObject(i,t,e)}catch(t){fabric.log(t)}else this.checkIfDone()},fabric.ElementsParser.prototype._createObject=function(t,e,i){if(t.async)t.fromElement(e,this.createCallback(i,e),this.options);else{var r=t.fromElement(e,this.options);this.resolveGradient(r,"fill"),this.resolveGradient(r,"stroke"),this.reviver&&this.reviver(e,r),this.instances[i]=r,this.checkIfDone()}},fabric.ElementsParser.prototype.createCallback=function(t,e){var i=this;return function(r){i.resolveGradient(r,"fill"),i.resolveGradient(r,"stroke"),i.reviver&&i.reviver(e,r),i.instances[t]=r,i.checkIfDone()}},fabric.ElementsParser.prototype.resolveGradient=function(t,e){var i=t.get(e);if(/^url\(/.test(i)){var r=i.slice(5,i.length-1);fabric.gradientDefs[this.svgUid][r]&&t.set(e,fabric.Gradient.fromElement(fabric.gradientDefs[this.svgUid][r],t))}},fabric.ElementsParser.prototype.checkIfDone=function(){0===--this.numElements&&(this.instances=this.instances.filter(function(t){return null!=t}),this.callback(this.instances))},function(t){"use strict";function e(t,e){this.x=t,this.y=e}var i=t.fabric||(t.fabric={});return i.Point?void i.warn("fabric.Point is already defined"):(i.Point=e,void(e.prototype={type:"point",constructor:e,add:function(t){return new e(this.x+t.x,this.y+t.y)},addEquals:function(t){return this.x+=t.x,this.y+=t.y,this},scalarAdd:function(t){return new e(this.x+t,this.y+t)},scalarAddEquals:function(t){return this.x+=t,this.y+=t,this},subtract:function(t){return new e(this.x-t.x,this.y-t.y)},subtractEquals:function(t){return this.x-=t.x,this.y-=t.y,this},scalarSubtract:function(t){return new e(this.x-t,this.y-t)},scalarSubtractEquals:function(t){return this.x-=t,this.y-=t,this},multiply:function(t){return new e(this.x*t,this.y*t)},multiplyEquals:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return new e(this.x/t,this.y/t)},divideEquals:function(t){return this.x/=t,this.y/=t,this},eq:function(t){return this.x===t.x&&this.y===t.y},lt:function(t){return this.x<t.x&&this.y<t.y},lte:function(t){return this.x<=t.x&&this.y<=t.y},gt:function(t){return this.x>t.x&&this.y>t.y},gte:function(t){return this.x>=t.x&&this.y>=t.y},lerp:function(t,i){return"undefined"==typeof i&&(i=.5),i=Math.max(Math.min(1,i),0),new e(this.x+(t.x-this.x)*i,this.y+(t.y-this.y)*i)},distanceFrom:function(t){var e=this.x-t.x,i=this.y-t.y;return Math.sqrt(e*e+i*i)},midPointFrom:function(t){return this.lerp(t)},min:function(t){return new e(Math.min(this.x,t.x),Math.min(this.y,t.y))},max:function(t){return new e(Math.max(this.x,t.x),Math.max(this.y,t.y))},toString:function(){return this.x+","+this.y},setXY:function(t,e){return this.x=t,this.y=e,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setFromPoint:function(t){return this.x=t.x,this.y=t.y,this},swap:function(t){var e=this.x,i=this.y;this.x=t.x,this.y=t.y,t.x=e,t.y=i},clone:function(){return new e(this.x,this.y)}}))}("undefined"!=typeof exports?exports:this),function(t){"use strict";function e(t){this.status=t,this.points=[]}var i=t.fabric||(t.fabric={});return i.Intersection?void i.warn("fabric.Intersection is already defined"):(i.Intersection=e,i.Intersection.prototype={constructor:e,appendPoint:function(t){return this.points.push(t),this},appendPoints:function(t){return this.points=this.points.concat(t),this}},i.Intersection.intersectLineLine=function(t,r,n,s){var o,a=(s.x-n.x)*(t.y-n.y)-(s.y-n.y)*(t.x-n.x),h=(r.x-t.x)*(t.y-n.y)-(r.y-t.y)*(t.x-n.x),c=(s.y-n.y)*(r.x-t.x)-(s.x-n.x)*(r.y-t.y);if(0!==c){var l=a/c,u=h/c;0<=l&&l<=1&&0<=u&&u<=1?(o=new e("Intersection"),o.appendPoint(new i.Point(t.x+l*(r.x-t.x),t.y+l*(r.y-t.y)))):o=new e}else o=new e(0===a||0===h?"Coincident":"Parallel");return o},i.Intersection.intersectLinePolygon=function(t,i,r){for(var n,s,o,a=new e,h=r.length,c=0;c<h;c++)n=r[c],s=r[(c+1)%h],o=e.intersectLineLine(t,i,n,s),a.appendPoints(o.points);return a.points.length>0&&(a.status="Intersection"),a},i.Intersection.intersectPolygonPolygon=function(t,i){for(var r=new e,n=t.length,s=0;s<n;s++){var o=t[s],a=t[(s+1)%n],h=e.intersectLinePolygon(o,a,i);r.appendPoints(h.points)}return r.points.length>0&&(r.status="Intersection"),r},void(i.Intersection.intersectPolygonRectangle=function(t,r,n){var s=r.min(n),o=r.max(n),a=new i.Point(o.x,s.y),h=new i.Point(s.x,o.y),c=e.intersectLinePolygon(s,a,t),l=e.intersectLinePolygon(a,o,t),u=e.intersectLinePolygon(o,h,t),f=e.intersectLinePolygon(h,s,t),d=new e;return d.appendPoints(c.points),d.appendPoints(l.points),d.appendPoints(u.points),d.appendPoints(f.points),d.points.length>0&&(d.status="Intersection"),d}))}("undefined"!=typeof exports?exports:this),function(t){"use strict";function e(t){t?this._tryParsingColor(t):this.setSource([0,0,0,1])}function i(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t}var r=t.fabric||(t.fabric={});return r.Color?void r.warn("fabric.Color is already defined."):(r.Color=e,r.Color.prototype={_tryParsingColor:function(t){var i;t in e.colorNameMap&&(t=e.colorNameMap[t]),"transparent"===t&&(i=[255,255,255,0]),i||(i=e.sourceFromHex(t)),i||(i=e.sourceFromRgb(t)),i||(i=e.sourceFromHsl(t)),i||(i=[0,0,0,1]),i&&this.setSource(i)},_rgbToHsl:function(t,e,i){t/=255,e/=255,i/=255;var n,s,o,a=r.util.array.max([t,e,i]),h=r.util.array.min([t,e,i]);if(o=(a+h)/2,a===h)n=s=0;else{var c=a-h;switch(s=o>.5?c/(2-a-h):c/(a+h),a){case t:n=(e-i)/c+(e<i?6:0);break;case e:n=(i-t)/c+2;break;case i:n=(t-e)/c+4}n/=6}return[Math.round(360*n),Math.round(100*s),Math.round(100*o)]},getSource:function(){return this._source},setSource:function(t){this._source=t},toRgb:function(){var t=this.getSource();return"rgb("+t[0]+","+t[1]+","+t[2]+")"},toRgba:function(){var t=this.getSource();return"rgba("+t[0]+","+t[1]+","+t[2]+","+t[3]+")"},toHsl:function(){var t=this.getSource(),e=this._rgbToHsl(t[0],t[1],t[2]);return"hsl("+e[0]+","+e[1]+"%,"+e[2]+"%)"},toHsla:function(){var t=this.getSource(),e=this._rgbToHsl(t[0],t[1],t[2]);return"hsla("+e[0]+","+e[1]+"%,"+e[2]+"%,"+t[3]+")"},toHex:function(){var t,e,i,r=this.getSource();return t=r[0].toString(16),t=1===t.length?"0"+t:t,e=r[1].toString(16),e=1===e.length?"0"+e:e,i=r[2].toString(16),i=1===i.length?"0"+i:i,t.toUpperCase()+e.toUpperCase()+i.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(t){var e=this.getSource();return e[3]=t,this.setSource(e),this},toGrayscale:function(){var t=this.getSource(),e=parseInt((.3*t[0]+.59*t[1]+.11*t[2]).toFixed(0),10),i=t[3];return this.setSource([e,e,e,i]),this},toBlackWhite:function(t){var e=this.getSource(),i=(.3*e[0]+.59*e[1]+.11*e[2]).toFixed(0),r=e[3];return t=t||127,i=Number(i)<Number(t)?0:255,this.setSource([i,i,i,r]),this},overlayWith:function(t){t instanceof e||(t=new e(t));for(var i=[],r=this.getAlpha(),n=.5,s=this.getSource(),o=t.getSource(),a=0;a<3;a++)i.push(Math.round(s[a]*(1-n)+o[a]*n));return i[3]=r,this.setSource(i),this}},r.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/,r.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/,r.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,r.Color.colorNameMap={aqua:"#00FFFF",black:"#000000",blue:"#0000FF",fuchsia:"#FF00FF",gray:"#808080",grey:"#808080",green:"#008000",lime:"#00FF00",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#FFA500",purple:"#800080",red:"#FF0000",silver:"#C0C0C0",teal:"#008080",white:"#FFFFFF",yellow:"#FFFF00"},r.Color.fromRgb=function(t){return e.fromSource(e.sourceFromRgb(t))},r.Color.sourceFromRgb=function(t){var i=t.match(e.reRGBa);if(i){var r=parseInt(i[1],10)/(/%$/.test(i[1])?100:1)*(/%$/.test(i[1])?255:1),n=parseInt(i[2],10)/(/%$/.test(i[2])?100:1)*(/%$/.test(i[2])?255:1),s=parseInt(i[3],10)/(/%$/.test(i[3])?100:1)*(/%$/.test(i[3])?255:1);return[parseInt(r,10),parseInt(n,10),parseInt(s,10),i[4]?parseFloat(i[4]):1]}},r.Color.fromRgba=e.fromRgb,r.Color.fromHsl=function(t){return e.fromSource(e.sourceFromHsl(t))},r.Color.sourceFromHsl=function(t){var r=t.match(e.reHSLa);if(r){var n,s,o,a=(parseFloat(r[1])%360+360)%360/360,h=parseFloat(r[2])/(/%$/.test(r[2])?100:1),c=parseFloat(r[3])/(/%$/.test(r[3])?100:1);if(0===h)n=s=o=c;else{var l=c<=.5?c*(h+1):c+h-c*h,u=2*c-l;n=i(u,l,a+1/3),s=i(u,l,a),o=i(u,l,a-1/3)}return[Math.round(255*n),Math.round(255*s),Math.round(255*o),r[4]?parseFloat(r[4]):1]}},r.Color.fromHsla=e.fromHsl,r.Color.fromHex=function(t){return e.fromSource(e.sourceFromHex(t))},r.Color.sourceFromHex=function(t){if(t.match(e.reHex)){var i=t.slice(t.indexOf("#")+1),r=3===i.length||4===i.length,n=8===i.length||4===i.length,s=r?i.charAt(0)+i.charAt(0):i.substring(0,2),o=r?i.charAt(1)+i.charAt(1):i.substring(2,4),a=r?i.charAt(2)+i.charAt(2):i.substring(4,6),h=n?r?i.charAt(3)+i.charAt(3):i.substring(6,8):"FF";return[parseInt(s,16),parseInt(o,16),parseInt(a,16),parseFloat((parseInt(h,16)/255).toFixed(2))]}},void(r.Color.fromSource=function(t){var i=new e;return i.setSource(t),i}))}("undefined"!=typeof exports?exports:this),function(){function t(t){var e,i,r,n=t.getAttribute("style"),s=t.getAttribute("offset")||0;if(s=parseFloat(s)/(/%$/.test(s)?100:1),s=s<0?0:s>1?1:s,n){var o=n.split(/\s*;\s*/);""===o[o.length-1]&&o.pop();for(var a=o.length;a--;){var h=o[a].split(/\s*:\s*/),c=h[0].trim(),l=h[1].trim();"stop-color"===c?e=l:"stop-opacity"===c&&(r=l)}}return e||(e=t.getAttribute("stop-color")||"rgb(0,0,0)"),r||(r=t.getAttribute("stop-opacity")),e=new fabric.Color(e),i=e.getAlpha(),r=isNaN(parseFloat(r))?1:parseFloat(r),r*=i,{offset:s,color:e.toRgb(),opacity:r}}function e(t){return{x1:t.getAttribute("x1")||0,y1:t.getAttribute("y1")||0,x2:t.getAttribute("x2")||"100%",y2:t.getAttribute("y2")||0}}function i(t){return{x1:t.getAttribute("fx")||t.getAttribute("cx")||"50%",y1:t.getAttribute("fy")||t.getAttribute("cy")||"50%",r1:0,x2:t.getAttribute("cx")||"50%",y2:t.getAttribute("cy")||"50%",r2:t.getAttribute("r")||"50%"}}function r(t,e,i){var r,n=0,s=1,o="";for(var a in e)"Infinity"===e[a]?e[a]=1:"-Infinity"===e[a]&&(e[a]=0),r=parseFloat(e[a],10),s="string"==typeof e[a]&&/^\d+%$/.test(e[a])?.01:1,"x1"===a||"x2"===a||"r2"===a?(s*="objectBoundingBox"===i?t.width:1,n="objectBoundingBox"===i?t.left||0:0):"y1"!==a&&"y2"!==a||(s*="objectBoundingBox"===i?t.height:1,n="objectBoundingBox"===i?t.top||0:0),e[a]=r*s+n;if("ellipse"===t.type&&null!==e.r2&&"objectBoundingBox"===i&&t.rx!==t.ry){var h=t.ry/t.rx;o=" scale(1, "+h+")",e.y1&&(e.y1/=h),e.y2&&(e.y2/=h)}return o}fabric.Gradient=fabric.util.createClass({offsetX:0,offsetY:0,initialize:function(t){t||(t={});var e={};this.id=fabric.Object.__uid++,this.type=t.type||"linear",e={x1:t.coords.x1||0,y1:t.coords.y1||0,x2:t.coords.x2||0,y2:t.coords.y2||0},"radial"===this.type&&(e.r1=t.coords.r1||0,e.r2=t.coords.r2||0),this.coords=e,this.colorStops=t.colorStops.slice(),t.gradientTransform&&(this.gradientTransform=t.gradientTransform),this.offsetX=t.offsetX||this.offsetX,this.offsetY=t.offsetY||this.offsetY},addColorStop:function(t){for(var e in t){var i=new fabric.Color(t[e]);this.colorStops.push({offset:e,color:i.toRgb(),opacity:i.getAlpha()})}return this},toObject:function(){return{type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform}},toSVG:function(t){var e,i,r=fabric.util.object.clone(this.coords);if(this.colorStops.sort(function(t,e){return t.offset-e.offset}),!t.group||"path-group"!==t.group.type)for(var n in r)"x1"===n||"x2"===n||"r2"===n?r[n]+=this.offsetX-t.width/2:"y1"!==n&&"y2"!==n||(r[n]+=this.offsetY-t.height/2);i='id="SVGID_'+this.id+'" gradientUnits="userSpaceOnUse"',this.gradientTransform&&(i+=' gradientTransform="matrix('+this.gradientTransform.join(" ")+')" '),"linear"===this.type?e=["<linearGradient ",i,' x1="',r.x1,'" y1="',r.y1,'" x2="',r.x2,'" y2="',r.y2,'">\n']:"radial"===this.type&&(e=["<radialGradient ",i,' cx="',r.x2,'" cy="',r.y2,'" r="',r.r2,'" fx="',r.x1,'" fy="',r.y1,'">\n']);for(var s=0;s<this.colorStops.length;s++)e.push("<stop ",'offset="',100*this.colorStops[s].offset+"%",'" style="stop-color:',this.colorStops[s].color,null!==this.colorStops[s].opacity?";stop-opacity: "+this.colorStops[s].opacity:";",'"/>\n');return e.push("linear"===this.type?"</linearGradient>\n":"</radialGradient>\n"),e.join("")},toLive:function(t,e){var i,r,n=fabric.util.object.clone(this.coords);if(this.type){if(e.group&&"path-group"===e.group.type)for(r in n)"x1"===r||"x2"===r?n[r]+=-this.offsetX+e.width/2:"y1"!==r&&"y2"!==r||(n[r]+=-this.offsetY+e.height/2);"linear"===this.type?i=t.createLinearGradient(n.x1,n.y1,n.x2,n.y2):"radial"===this.type&&(i=t.createRadialGradient(n.x1,n.y1,n.r1,n.x2,n.y2,n.r2));for(var s=0,o=this.colorStops.length;s<o;s++){var a=this.colorStops[s].color,h=this.colorStops[s].opacity,c=this.colorStops[s].offset;"undefined"!=typeof h&&(a=new fabric.Color(a).setAlpha(h).toRgba()),i.addColorStop(parseFloat(c),a)}return i}}}),fabric.util.object.extend(fabric.Gradient,{fromElement:function(n,s){var o,a,h,c=n.getElementsByTagName("stop"),l=n.getAttribute("gradientUnits")||"objectBoundingBox",u=n.getAttribute("gradientTransform"),f=[];o="linearGradient"===n.nodeName||"LINEARGRADIENT"===n.nodeName?"linear":"radial","linear"===o?a=e(n):"radial"===o&&(a=i(n));for(var d=c.length;d--;)f.push(t(c[d]));h=r(s,a,l);var g=new fabric.Gradient({type:o,coords:a,colorStops:f,offsetX:-s.left,offsetY:-s.top});return(u||""!==h)&&(g.gradientTransform=fabric.parseTransformAttribute((u||"")+h)),g},forObject:function(t,e){return e||(e={}),r(t,e.coords,"userSpaceOnUse"),new fabric.Gradient(e)}})}(),fabric.Pattern=fabric.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,initialize:function(t){if(t||(t={}),this.id=fabric.Object.__uid++,t.source)if("string"==typeof t.source)if("undefined"!=typeof fabric.util.getFunctionBody(t.source))this.source=new Function(fabric.util.getFunctionBody(t.source));else{var e=this;this.source=fabric.util.createImage(),fabric.util.loadImage(t.source,function(t){e.source=t})}else this.source=t.source;t.repeat&&(this.repeat=t.repeat),t.offsetX&&(this.offsetX=t.offsetX),t.offsetY&&(this.offsetY=t.offsetY)},toObject:function(){var t;return"function"==typeof this.source?t=String(this.source):"string"==typeof this.source.src?t=this.source.src:"object"==typeof this.source&&this.source.toDataURL&&(t=this.source.toDataURL()),{source:t,repeat:this.repeat,offsetX:this.offsetX,offsetY:this.offsetY}},toSVG:function(t){var e="function"==typeof this.source?this.source():this.source,i=e.width/t.getWidth(),r=e.height/t.getHeight(),n=this.offsetX/t.getWidth(),s=this.offsetY/t.getHeight(),o="";return"repeat-x"!==this.repeat&&"no-repeat"!==this.repeat||(r=1),"repeat-y"!==this.repeat&&"no-repeat"!==this.repeat||(i=1),e.src?o=e.src:e.toDataURL&&(o=e.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+n+'" y="'+s+'" width="'+i+'" height="'+r+'">\n<image x="0" y="0" width="'+e.width+'" height="'+e.height+'" xlink:href="'+o+'"></image>\n</pattern>\n'},toLive:function(t){var e="function"==typeof this.source?this.source():this.source;if(!e)return"";if("undefined"!=typeof e.src){if(!e.complete)return"";if(0===e.naturalWidth||0===e.naturalHeight)return""}return t.createPattern(e,this.repeat)}}),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.toFixed;return e.Shadow?void e.warn("fabric.Shadow is already defined."):(e.Shadow=e.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,initialize:function(t){"string"==typeof t&&(t=this._parseShadow(t));for(var i in t)this[i]=t[i];this.id=e.Object.__uid++},_parseShadow:function(t){var i=t.trim(),r=e.Shadow.reOffsetsAndBlur.exec(i)||[],n=i.replace(e.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)";return{color:n.trim(),offsetX:parseInt(r[1],10)||0,offsetY:parseInt(r[2],10)||0,blur:parseInt(r[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(t){var r=40,n=40,s=e.Object.NUM_FRACTION_DIGITS,o=e.util.rotateVector({x:this.offsetX,y:this.offsetY},e.util.degreesToRadians(-t.angle)),a=20;return t.width&&t.height&&(r=100*i((Math.abs(o.x)+this.blur)/t.width,s)+a,n=100*i((Math.abs(o.y)+this.blur)/t.height,s)+a),t.flipX&&(o.x*=-1),t.flipY&&(o.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+n+'%" height="'+(100+2*n)+'%" x="-'+r+'%" width="'+(100+2*r)+'%" >\n\t<feGaussianBlur in="SourceAlpha" stdDeviation="'+i(this.blur?this.blur/2:0,s)+'"></feGaussianBlur>\n\t<feOffset dx="'+i(o.x,s)+'" dy="'+i(o.y,s)+'" result="oBlur" ></feOffset>\n\t<feFlood flood-color="'+this.color+'"/>\n\t<feComposite in2="oBlur" operator="in" />\n\t<feMerge>\n\t\t<feMergeNode></feMergeNode>\n\t\t<feMergeNode in="SourceGraphic"></feMergeNode>\n\t</feMerge>\n</filter>\n'},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke};var t={},i=e.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke"].forEach(function(e){this[e]!==i[e]&&(t[e]=this[e])},this),t}}),void(e.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:px)?(?:\s?|$))?(-?\d+(?:px)?(?:\s?|$))?(\d+(?:px)?)?(?:\s?|$)(?:$|\s)/))}("undefined"!=typeof exports?exports:this),function(){"use strict";if(fabric.StaticCanvas)return void fabric.warn("fabric.StaticCanvas is already defined.");var t=fabric.util.object.extend,e=fabric.util.getElementOffset,i=fabric.util.removeFromArray,r=fabric.util.toFixed,n=new Error("Could not initialize `canvas` element");fabric.StaticCanvas=fabric.util.createClass({initialize:function(t,e){e||(e={}),this._initStatic(t,e)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!0,renderOnAddRemove:!0,clipTo:null,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:[1,0,0,1,0,0],backgroundVpt:!0,overlayVpt:!0,onBeforeScaleRotate:function(){},enableRetinaScaling:!0,_initStatic:function(t,e){var i=fabric.StaticCanvas.prototype.renderAll.bind(this);this._objects=[],this._createLowerCanvas(t),this._initOptions(e),this._setImageSmoothing(),this.interactive||this._initRetinaScaling(),e.overlayImage&&this.setOverlayImage(e.overlayImage,i),e.backgroundImage&&this.setBackgroundImage(e.backgroundImage,i),e.backgroundColor&&this.setBackgroundColor(e.backgroundColor,i),e.overlayColor&&this.setOverlayColor(e.overlayColor,i),this.calcOffset()},_isRetinaScaling:function(){return 1!==fabric.devicePixelRatio&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?fabric.devicePixelRatio:1},_initRetinaScaling:function(){this._isRetinaScaling()&&(this.lowerCanvasEl.setAttribute("width",this.width*fabric.devicePixelRatio),this.lowerCanvasEl.setAttribute("height",this.height*fabric.devicePixelRatio),this.contextContainer.scale(fabric.devicePixelRatio,fabric.devicePixelRatio))},calcOffset:function(){return this._offset=e(this.lowerCanvasEl),this},setOverlayImage:function(t,e,i){return this.__setBgOverlayImage("overlayImage",t,e,i)},setBackgroundImage:function(t,e,i){return this.__setBgOverlayImage("backgroundImage",t,e,i)},setOverlayColor:function(t,e){return this.__setBgOverlayColor("overlayColor",t,e)},setBackgroundColor:function(t,e){return this.__setBgOverlayColor("backgroundColor",t,e)},_setImageSmoothing:function(){var t=this.getContext();t.imageSmoothingEnabled=t.imageSmoothingEnabled||t.webkitImageSmoothingEnabled||t.mozImageSmoothingEnabled||t.msImageSmoothingEnabled||t.oImageSmoothingEnabled,t.imageSmoothingEnabled=this.imageSmoothingEnabled},__setBgOverlayImage:function(t,e,i,r){return"string"==typeof e?fabric.util.loadImage(e,function(e){e&&(this[t]=new fabric.Image(e,r)),i&&i(e)},this,r&&r.crossOrigin):(r&&e.setOptions(r),this[t]=e,i&&i(e)),this},__setBgOverlayColor:function(t,e,i){if(e&&e.source){var r=this;fabric.util.loadImage(e.source,function(n){r[t]=new fabric.Pattern({source:n,repeat:e.repeat,offsetX:e.offsetX,offsetY:e.offsetY}),i&&i()})}else this[t]=e,i&&i();return this},_createCanvasElement:function(t){var e=fabric.util.createCanvasElement(t);if(e.style||(e.style={}),!e)throw n;if("undefined"==typeof e.getContext)throw n;return e},_initOptions:function(t){for(var e in t)this[e]=t[e];this.width=this.width||parseInt(this.lowerCanvasEl.width,10)||0,this.height=this.height||parseInt(this.lowerCanvasEl.height,10)||0,this.lowerCanvasEl.style&&(this.lowerCanvasEl.width=this.width,this.lowerCanvasEl.height=this.height,this.lowerCanvasEl.style.width=this.width+"px",this.lowerCanvasEl.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(t){this.lowerCanvasEl=fabric.util.getById(t)||this._createCanvasElement(t),fabric.util.addClass(this.lowerCanvasEl,"lower-canvas"),this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(t,e){return this.setDimensions({width:t},e)},setHeight:function(t,e){return this.setDimensions({height:t},e)},setDimensions:function(t,e){var i;e=e||{};for(var r in t)i=t[r],e.cssOnly||(this._setBackstoreDimension(r,t[r]),i+="px"),e.backstoreOnly||this._setCssDimension(r,i);return this._initRetinaScaling(),this._setImageSmoothing(),this.calcOffset(),e.cssOnly||this.renderAll(),this},_setBackstoreDimension:function(t,e){return this.lowerCanvasEl[t]=e,this.upperCanvasEl&&(this.upperCanvasEl[t]=e),this.cacheCanvasEl&&(this.cacheCanvasEl[t]=e),this[t]=e,this},_setCssDimension:function(t,e){return this.lowerCanvasEl.style[t]=e,this.upperCanvasEl&&(this.upperCanvasEl.style[t]=e),this.wrapperEl&&(this.wrapperEl.style[t]=e),this},getZoom:function(){return Math.sqrt(this.viewportTransform[0]*this.viewportTransform[3])},setViewportTransform:function(t){var e,i=this._activeGroup;this.viewportTransform=t;for(var r=0,n=this._objects.length;r<n;r++)e=this._objects[r],e.group||e.setCoords();return i&&i.setCoords(),this.renderAll(),this},zoomToPoint:function(t,e){var i=t,r=this.viewportTransform.slice(0);t=fabric.util.transformPoint(t,fabric.util.invertTransform(this.viewportTransform)),r[0]=e,r[3]=e;var n=fabric.util.transformPoint(t,r);return r[4]+=i.x-n.x,r[5]+=i.y-n.y,this.setViewportTransform(r)},setZoom:function(t){return this.zoomToPoint(new fabric.Point(0,0),t),this},absolutePan:function(t){var e=this.viewportTransform.slice(0);return e[4]=-t.x,e[5]=-t.y,this.setViewportTransform(e)},relativePan:function(t){return this.absolutePan(new fabric.Point(-t.x-this.viewportTransform[4],-t.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(t){this.stateful&&t.setupState(),t._set("canvas",this),t.setCoords(),this.fire("object:added",{target:t}),t.fire("added")},_onObjectRemoved:function(t){this.fire("object:removed",{target:t}),t.fire("removed"),delete t.canvas},clearContext:function(t){return t.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this._objects.length=0,this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("selection:cleared",this._canvasITextSelectionClearedHanlder),this.off("object:selected",this._canvasITextSelectionClearedHanlder),this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderAll(),this},renderAll:function(){var t=this.contextContainer;return this.renderCanvas(t,this._objects),this},renderCanvas:function(t,e){this.clearContext(t),this.fire("before:render"),this.clipTo&&fabric.util.clipContext(this,t),this._renderBackground(t),t.save(),t.transform.apply(t,this.viewportTransform),this._renderObjects(t,e),t.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(t),this.clipTo&&t.restore(),this._renderOverlay(t),this.controlsAboveOverlay&&this.interactive&&this.drawControls(t),this.fire("after:render")},_renderObjects:function(t,e){for(var i=0,r=e.length;i<r;++i)e[i]&&e[i].render(t)},_renderBackgroundOrOverlay:function(t,e){var i=this[e+"Color"];i&&(t.fillStyle=i.toLive?i.toLive(t):i,t.fillRect(i.offsetX||0,i.offsetY||0,this.width,this.height)),i=this[e+"Image"],i&&(this[e+"Vpt"]&&(t.save(),t.transform.apply(t,this.viewportTransform)),i.render(t),this[e+"Vpt"]&&t.restore())},_renderBackground:function(t){this._renderBackgroundOrOverlay(t,"background")},_renderOverlay:function(t){this._renderBackgroundOrOverlay(t,"overlay")},getCenter:function(){return{top:this.getHeight()/2,left:this.getWidth()/2}},centerObjectH:function(t){return this._centerObject(t,new fabric.Point(this.getCenter().left,t.getCenterPoint().y))},centerObjectV:function(t){return this._centerObject(t,new fabric.Point(t.getCenterPoint().x,this.getCenter().top))},centerObject:function(t){var e=this.getCenter();return this._centerObject(t,new fabric.Point(e.left,e.top))},viewportCenterObject:function(t){var e=this.getVpCenter();return this._centerObject(t,e)},viewportCenterObjectH:function(t){var e=this.getVpCenter();return this._centerObject(t,new fabric.Point(e.x,t.getCenterPoint().y)),
this},viewportCenterObjectV:function(t){var e=this.getVpCenter();return this._centerObject(t,new fabric.Point(t.getCenterPoint().x,e.y))},getVpCenter:function(){var t=this.getCenter(),e=fabric.util.invertTransform(this.viewportTransform);return fabric.util.transformPoint({x:t.left,y:t.top},e)},_centerObject:function(t,e){return t.setPositionByOrigin(e,"center","center"),this.renderAll(),this},toDatalessJSON:function(t){return this.toDatalessObject(t)},toObject:function(t){return this._toObjectMethod("toObject",t)},toDatalessObject:function(t){return this._toObjectMethod("toDatalessObject",t)},_toObjectMethod:function(e,i){var r={objects:this._toObjects(e,i)};return t(r,this.__serializeBgOverlay(e,i)),fabric.util.populateWithProperties(this,r,i),r},_toObjects:function(t,e){return this.getObjects().filter(function(t){return!t.excludeFromExport}).map(function(i){return this._toObject(i,t,e)},this)},_toObject:function(t,e,i){var r;this.includeDefaultValues||(r=t.includeDefaultValues,t.includeDefaultValues=!1);var n=t[e](i);return this.includeDefaultValues||(t.includeDefaultValues=r),n},__serializeBgOverlay:function(t,e){var i={background:this.backgroundColor&&this.backgroundColor.toObject?this.backgroundColor.toObject(e):this.backgroundColor};return this.overlayColor&&(i.overlay=this.overlayColor.toObject?this.overlayColor.toObject(e):this.overlayColor),this.backgroundImage&&(i.backgroundImage=this._toObject(this.backgroundImage,t,e)),this.overlayImage&&(i.overlayImage=this._toObject(this.overlayImage,t,e)),i},svgViewportTransformation:!0,toSVG:function(t,e){t||(t={});var i=[];return this._setSVGPreamble(i,t),this._setSVGHeader(i,t),this._setSVGBgOverlayColor(i,"backgroundColor"),this._setSVGBgOverlayImage(i,"backgroundImage",e),this._setSVGObjects(i,e),this._setSVGBgOverlayColor(i,"overlayColor"),this._setSVGBgOverlayImage(i,"overlayImage",e),i.push("</svg>"),i.join("")},_setSVGPreamble:function(t,e){e.suppressPreamble||t.push('<?xml version="1.0" encoding="',e.encoding||"UTF-8",'" standalone="no" ?>\n','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ','"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n')},_setSVGHeader:function(t,e){var i,n=e.width||this.width,s=e.height||this.height,o='viewBox="0 0 '+this.width+" "+this.height+'" ',a=fabric.Object.NUM_FRACTION_DIGITS;e.viewBox?o='viewBox="'+e.viewBox.x+" "+e.viewBox.y+" "+e.viewBox.width+" "+e.viewBox.height+'" ':this.svgViewportTransformation&&(i=this.viewportTransform,o='viewBox="'+r(-i[4]/i[0],a)+" "+r(-i[5]/i[3],a)+" "+r(this.width/i[0],a)+" "+r(this.height/i[3],a)+'" '),t.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',n,'" ','height="',s,'" ',this.backgroundColor&&!this.backgroundColor.toLive?'style="background-color: '+this.backgroundColor+'" ':null,o,'xml:space="preserve">\n',"<desc>Created with Fabric.js ",fabric.version,"</desc>\n","<defs>",fabric.createSVGFontFacesMarkup(this.getObjects()),fabric.createSVGRefElementsMarkup(this),"</defs>\n")},_setSVGObjects:function(t,e){for(var i,r=0,n=this.getObjects(),s=n.length;r<s;r++)i=n[r],i.excludeFromExport||this._setSVGObject(t,i,e)},_setSVGObject:function(t,e,i){t.push(e.toSVG(i))},_setSVGBgOverlayImage:function(t,e,i){this[e]&&this[e].toSVG&&t.push(this[e].toSVG(i))},_setSVGBgOverlayColor:function(t,e){this[e]&&this[e].source?t.push('<rect x="',this[e].offsetX,'" y="',this[e].offsetY,'" ','width="',"repeat-y"===this[e].repeat||"no-repeat"===this[e].repeat?this[e].source.width:this.width,'" height="',"repeat-x"===this[e].repeat||"no-repeat"===this[e].repeat?this[e].source.height:this.height,'" fill="url(#'+e+'Pattern)"',"></rect>\n"):this[e]&&"overlayColor"===e&&t.push('<rect x="0" y="0" ','width="',this.width,'" height="',this.height,'" fill="',this[e],'"',"></rect>\n")},sendToBack:function(t){if(!t)return this;var e,r,n,s=this._activeGroup;if(t===s)for(n=s._objects,e=n.length;e--;)r=n[e],i(this._objects,r),this._objects.unshift(r);else i(this._objects,t),this._objects.unshift(t);return this.renderAll&&this.renderAll()},bringToFront:function(t){if(!t)return this;var e,r,n,s=this._activeGroup;if(t===s)for(n=s._objects,e=0;e<n.length;e++)r=n[e],i(this._objects,r),this._objects.push(r);else i(this._objects,t),this._objects.push(t);return this.renderAll&&this.renderAll()},sendBackwards:function(t,e){if(!t)return this;var r,n,s,o,a,h=this._activeGroup;if(t===h)for(a=h._objects,r=0;r<a.length;r++)n=a[r],s=this._objects.indexOf(n),0!==s&&(o=s-1,i(this._objects,n),this._objects.splice(o,0,n));else s=this._objects.indexOf(t),0!==s&&(o=this._findNewLowerIndex(t,s,e),i(this._objects,t),this._objects.splice(o,0,t));return this.renderAll&&this.renderAll(),this},_findNewLowerIndex:function(t,e,i){var r;if(i){r=e;for(var n=e-1;n>=0;--n){var s=t.intersectsWithObject(this._objects[n])||t.isContainedWithinObject(this._objects[n])||this._objects[n].isContainedWithinObject(t);if(s){r=n;break}}}else r=e-1;return r},bringForward:function(t,e){if(!t)return this;var r,n,s,o,a,h=this._activeGroup;if(t===h)for(a=h._objects,r=a.length;r--;)n=a[r],s=this._objects.indexOf(n),s!==this._objects.length-1&&(o=s+1,i(this._objects,n),this._objects.splice(o,0,n));else s=this._objects.indexOf(t),s!==this._objects.length-1&&(o=this._findNewUpperIndex(t,s,e),i(this._objects,t),this._objects.splice(o,0,t));return this.renderAll&&this.renderAll(),this},_findNewUpperIndex:function(t,e,i){var r;if(i){r=e;for(var n=e+1;n<this._objects.length;++n){var s=t.intersectsWithObject(this._objects[n])||t.isContainedWithinObject(this._objects[n])||this._objects[n].isContainedWithinObject(t);if(s){r=n;break}}}else r=e+1;return r},moveTo:function(t,e){return i(this._objects,t),this._objects.splice(e,0,t),this.renderAll&&this.renderAll()},dispose:function(){return this.clear(),this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this.getObjects().length+" }>"}}),t(fabric.StaticCanvas.prototype,fabric.Observable),t(fabric.StaticCanvas.prototype,fabric.Collection),t(fabric.StaticCanvas.prototype,fabric.DataURLExporter),t(fabric.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(t){var e=fabric.util.createCanvasElement();if(!e||!e.getContext)return null;var i=e.getContext("2d");if(!i)return null;switch(t){case"getImageData":return"undefined"!=typeof i.getImageData;case"setLineDash":return"undefined"!=typeof i.setLineDash;case"toDataURL":return"undefined"!=typeof e.toDataURL;case"toDataURLWithQuality":try{return e.toDataURL("image/jpeg",0),!0}catch(t){}return!1;default:return null}}}),fabric.StaticCanvas.prototype.toJSON=fabric.StaticCanvas.prototype.toObject}(),fabric.BaseBrush=fabric.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeDashArray:null,setShadow:function(t){return this.shadow=new fabric.Shadow(t),this},_setBrushStyles:function(){var t=this.canvas.contextTop;t.strokeStyle=this.color,t.lineWidth=this.width,t.lineCap=this.strokeLineCap,t.lineJoin=this.strokeLineJoin,this.strokeDashArray&&fabric.StaticCanvas.supports("setLineDash")&&t.setLineDash(this.strokeDashArray)},_setShadow:function(){if(this.shadow){var t=this.canvas.contextTop;t.shadowColor=this.shadow.color,t.shadowBlur=this.shadow.blur,t.shadowOffsetX=this.shadow.offsetX,t.shadowOffsetY=this.shadow.offsetY}},_resetShadow:function(){var t=this.canvas.contextTop;t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0}}),function(){fabric.PencilBrush=fabric.util.createClass(fabric.BaseBrush,{initialize:function(t){this.canvas=t,this._points=[]},onMouseDown:function(t){this._prepareForDrawing(t),this._captureDrawingPath(t),this._render()},onMouseMove:function(t){this._captureDrawingPath(t),this.canvas.clearContext(this.canvas.contextTop),this._render()},onMouseUp:function(){this._finalizeAndAddPath()},_prepareForDrawing:function(t){var e=new fabric.Point(t.x,t.y);this._reset(),this._addPoint(e),this.canvas.contextTop.moveTo(e.x,e.y)},_addPoint:function(t){this._points.push(t)},_reset:function(){this._points.length=0,this._setBrushStyles(),this._setShadow()},_captureDrawingPath:function(t){var e=new fabric.Point(t.x,t.y);this._addPoint(e)},_render:function(){var t=this.canvas.contextTop,e=this.canvas.viewportTransform,i=this._points[0],r=this._points[1];t.save(),t.transform(e[0],e[1],e[2],e[3],e[4],e[5]),t.beginPath(),2===this._points.length&&i.x===r.x&&i.y===r.y&&(i.x-=.5,r.x+=.5),t.moveTo(i.x,i.y);for(var n=1,s=this._points.length;n<s;n++){var o=i.midPointFrom(r);t.quadraticCurveTo(i.x,i.y,o.x,o.y),i=this._points[n],r=this._points[n+1]}t.lineTo(i.x,i.y),t.stroke(),t.restore()},convertPointsToSVGPath:function(t){var e=[],i=new fabric.Point(t[0].x,t[0].y),r=new fabric.Point(t[1].x,t[1].y);e.push("M ",t[0].x," ",t[0].y," ");for(var n=1,s=t.length;n<s;n++){var o=i.midPointFrom(r);e.push("Q ",i.x," ",i.y," ",o.x," ",o.y," "),i=new fabric.Point(t[n].x,t[n].y),n+1<t.length&&(r=new fabric.Point(t[n+1].x,t[n+1].y))}return e.push("L ",i.x," ",i.y," "),e},createPath:function(t){var e=new fabric.Path(t,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray,originX:"center",originY:"center"});return this.shadow&&(this.shadow.affectStroke=!0,e.setShadow(this.shadow)),e},_finalizeAndAddPath:function(){var t=this.canvas.contextTop;t.closePath();var e=this.convertPointsToSVGPath(this._points).join("");if("M 0 0 Q 0 0 0 0 L 0 0"===e)return void this.canvas.renderAll();var i=this.createPath(e);this.canvas.add(i),i.setCoords(),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderAll(),this.canvas.fire("path:created",{path:i})}})}(),fabric.CircleBrush=fabric.util.createClass(fabric.BaseBrush,{width:10,initialize:function(t){this.canvas=t,this.points=[]},drawDot:function(t){var e=this.addPoint(t),i=this.canvas.contextTop,r=this.canvas.viewportTransform;i.save(),i.transform(r[0],r[1],r[2],r[3],r[4],r[5]),i.fillStyle=e.fill,i.beginPath(),i.arc(e.x,e.y,e.radius,0,2*Math.PI,!1),i.closePath(),i.fill(),i.restore()},onMouseDown:function(t){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(t)},onMouseMove:function(t){this.drawDot(t)},onMouseUp:function(){var t=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var e=[],i=0,r=this.points.length;i<r;i++){var n=this.points[i],s=new fabric.Circle({radius:n.radius,left:n.x,top:n.y,originX:"center",originY:"center",fill:n.fill});this.shadow&&s.setShadow(this.shadow),e.push(s)}var o=new fabric.Group(e,{originX:"center",originY:"center"});o.canvas=this.canvas,this.canvas.add(o),this.canvas.fire("path:created",{path:o}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=t,this.canvas.renderAll()},addPoint:function(t){var e=new fabric.Point(t.x,t.y),i=fabric.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,r=new fabric.Color(this.color).setAlpha(fabric.util.getRandomInt(0,100)/100).toRgba();return e.radius=i,e.fill=r,this.points.push(e),e}}),fabric.SprayBrush=fabric.util.createClass(fabric.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(t){this.canvas=t,this.sprayChunks=[]},onMouseDown:function(t){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(t),this.render()},onMouseMove:function(t){this.addSprayChunk(t),this.render()},onMouseUp:function(){var t=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var e=[],i=0,r=this.sprayChunks.length;i<r;i++)for(var n=this.sprayChunks[i],s=0,o=n.length;s<o;s++){var a=new fabric.Rect({width:n[s].width,height:n[s].width,left:n[s].x+1,top:n[s].y+1,originX:"center",originY:"center",fill:this.color});this.shadow&&a.setShadow(this.shadow),e.push(a)}this.optimizeOverlapping&&(e=this._getOptimizedRects(e));var h=new fabric.Group(e,{originX:"center",originY:"center"});h.canvas=this.canvas,this.canvas.add(h),this.canvas.fire("path:created",{path:h}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=t,this.canvas.renderAll()},_getOptimizedRects:function(t){for(var e,i={},r=0,n=t.length;r<n;r++)e=t[r].left+""+t[r].top,i[e]||(i[e]=t[r]);var s=[];for(e in i)s.push(i[e]);return s},render:function(){var t=this.canvas.contextTop;t.fillStyle=this.color;var e=this.canvas.viewportTransform;t.save(),t.transform(e[0],e[1],e[2],e[3],e[4],e[5]);for(var i=0,r=this.sprayChunkPoints.length;i<r;i++){var n=this.sprayChunkPoints[i];"undefined"!=typeof n.opacity&&(t.globalAlpha=n.opacity),t.fillRect(n.x,n.y,n.width,n.width)}t.restore()},addSprayChunk:function(t){this.sprayChunkPoints=[];for(var e,i,r,n=this.width/2,s=0;s<this.density;s++){e=fabric.util.getRandomInt(t.x-n,t.x+n),i=fabric.util.getRandomInt(t.y-n,t.y+n),r=this.dotWidthVariance?fabric.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):this.dotWidth;var o=new fabric.Point(e,i);o.width=r,this.randomOpacity&&(o.opacity=fabric.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(o)}this.sprayChunks.push(this.sprayChunkPoints)}}),fabric.PatternBrush=fabric.util.createClass(fabric.PencilBrush,{getPatternSrc:function(){var t=20,e=5,i=fabric.document.createElement("canvas"),r=i.getContext("2d");return i.width=i.height=t+e,r.fillStyle=this.color,r.beginPath(),r.arc(t/2,t/2,t/2,0,2*Math.PI,!1),r.closePath(),r.fill(),i},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(){return this.canvas.contextTop.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(){this.callSuper("_setBrushStyles"),this.canvas.contextTop.strokeStyle=this.getPattern()},createPath:function(t){var e=this.callSuper("createPath",t),i=e._getLeftTopCoords().scalarAdd(e.strokeWidth/2);return e.stroke=new fabric.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-i.x,offsetY:-i.y}),e}}),function(){var t=fabric.util.getPointer,e=fabric.util.degreesToRadians,i=fabric.util.radiansToDegrees,r=Math.atan2,n=Math.abs,s=fabric.StaticCanvas.supports("setLineDash"),o=.5;fabric.Canvas=fabric.util.createClass(fabric.StaticCanvas,{initialize:function(t,e){e||(e={}),this._initStatic(t,e),this._initInteractive(),this._createCacheCanvas()},uniScaleTransform:!1,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",rotationCursor:"crosshair",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=fabric.PencilBrush&&new fabric.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var t,e=this.getActiveGroup(),i=this.getActiveObject(),r=[],n=[];if(!e&&!i||this.preserveObjectStacking)r=this._objects;else{for(var s=0,o=this._objects.length;s<o;s++)t=this._objects[s],e&&e.contains(t)||t===i?n.push(t):r.push(t);e&&(e._set("_objects",n),r.push(e)),i&&r.push(i)}return r},renderAll:function(){!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1);var t=this.contextContainer;return this.renderCanvas(t,this._chooseObjectsToRender()),this},renderTop:function(){var t=this.contextTop;return this.clearContext(t),this.selection&&this._groupSelector&&this._drawSelection(t),this.fire("after:render"),this.contextTopDirty=!0,this},_resetCurrentTransform:function(){var t=this._currentTransform;t.target.set({scaleX:t.original.scaleX,scaleY:t.original.scaleY,skewX:t.original.skewX,skewY:t.original.skewY,left:t.original.left,top:t.original.top}),this._shouldCenterTransform(t.target)?"rotate"===t.action?this._setOriginToCenter(t.target):("center"!==t.originX&&("right"===t.originX?t.mouseXSign=-1:t.mouseXSign=1),"center"!==t.originY&&("bottom"===t.originY?t.mouseYSign=-1:t.mouseYSign=1),t.originX="center",t.originY="center"):(t.originX=t.original.originX,t.originY=t.original.originY)},containsPoint:function(t,e,i){var r,n=!0,s=i||this.getPointer(t,n);return r=e.group&&e.group===this.getActiveGroup()?this._normalizePointer(e.group,s):{x:s.x,y:s.y},e.containsPoint(r)||e._findTargetCorner(s)},_normalizePointer:function(t,e){var i=t.calcTransformMatrix(),r=fabric.util.invertTransform(i),n=this.viewportTransform,s=this.restorePointerVpt(e),o=fabric.util.transformPoint(s,r);return fabric.util.transformPoint(o,n)},isTargetTransparent:function(t,e,i){var r=t.hasBorders,n=t.transparentCorners,s=this.contextCache,o=t.selectionBackgroundColor;t.hasBorders=t.transparentCorners=!1,t.selectionBackgroundColor="",s.save(),s.transform.apply(s,this.viewportTransform),t.render(s),s.restore(),t.active&&t._renderControls(s),t.hasBorders=r,t.transparentCorners=n,t.selectionBackgroundColor=o;var a=fabric.util.isTransparent(s,e,i,this.targetFindTolerance);return this.clearContext(s),a},_shouldClearSelection:function(t,e){var i=this.getActiveGroup(),r=this.getActiveObject();return!e||e&&i&&!i.contains(e)&&i!==e&&!t[this.selectionKey]||e&&!e.evented||e&&!e.selectable&&r&&r!==e},_shouldCenterTransform:function(t){if(t){var e,i=this._currentTransform;return"scale"===i.action||"scaleX"===i.action||"scaleY"===i.action?e=this.centeredScaling||t.centeredScaling:"rotate"===i.action&&(e=this.centeredRotation||t.centeredRotation),e?!i.altKey:i.altKey}},_getOriginFromCorner:function(t,e){var i={x:t.originX,y:t.originY};return"ml"===e||"tl"===e||"bl"===e?i.x="right":"mr"!==e&&"tr"!==e&&"br"!==e||(i.x="left"),"tl"===e||"mt"===e||"tr"===e?i.y="bottom":"bl"!==e&&"mb"!==e&&"br"!==e||(i.y="top"),i},_getActionFromCorner:function(t,e,i){if(!e)return"drag";switch(e){case"mtr":return"rotate";case"ml":case"mr":return i[this.altActionKey]?"skewY":"scaleX";case"mt":case"mb":return i[this.altActionKey]?"skewX":"scaleY";default:return"scale"}},_setupCurrentTransform:function(t,i){if(i){var r=this.getPointer(t),n=i._findTargetCorner(this.getPointer(t,!0)),s=this._getActionFromCorner(i,n,t),o=this._getOriginFromCorner(i,n);this._currentTransform={target:i,action:s,corner:n,scaleX:i.scaleX,scaleY:i.scaleY,skewX:i.skewX,skewY:i.skewY,offsetX:r.x-i.left,offsetY:r.y-i.top,originX:o.x,originY:o.y,ex:r.x,ey:r.y,lastX:r.x,lastY:r.y,left:i.left,top:i.top,theta:e(i.angle),width:i.width*i.scaleX,mouseXSign:1,mouseYSign:1,shiftKey:t.shiftKey,altKey:t[this.centeredKey]},this._currentTransform.original={left:i.left,top:i.top,scaleX:i.scaleX,scaleY:i.scaleY,skewX:i.skewX,skewY:i.skewY,originX:o.x,originY:o.y},this._resetCurrentTransform()}},_translateObject:function(t,e){var i=this._currentTransform,r=i.target,n=t-i.offsetX,s=e-i.offsetY,o=!r.get("lockMovementX")&&r.left!==n,a=!r.get("lockMovementY")&&r.top!==s;return o&&r.set("left",n),a&&r.set("top",s),o||a},_changeSkewTransformOrigin:function(t,e,i){var r="originX",n={0:"center"},s=e.target.skewX,o="left",a="right",h="mt"===e.corner||"ml"===e.corner?1:-1,c=1;t=t>0?1:-1,"y"===i&&(s=e.target.skewY,o="top",a="bottom",r="originY"),n[-1]=o,n[1]=a,e.target.flipX&&(c*=-1),e.target.flipY&&(c*=-1),0===s?(e.skewSign=-h*t*c,e[r]=n[-t]):(s=s>0?1:-1,e.skewSign=s,e[r]=n[s*h*c])},_skewObject:function(t,e,i){var r=this._currentTransform,n=r.target,s=!1,o=n.get("lockSkewingX"),a=n.get("lockSkewingY");if(o&&"x"===i||a&&"y"===i)return!1;var h,c,l=n.getCenterPoint(),u=n.toLocalPoint(new fabric.Point(t,e),"center","center")[i],f=n.toLocalPoint(new fabric.Point(r.lastX,r.lastY),"center","center")[i],d=n._getTransformedDimensions();return this._changeSkewTransformOrigin(u-f,r,i),h=n.toLocalPoint(new fabric.Point(t,e),r.originX,r.originY)[i],c=n.translateToOriginPoint(l,r.originX,r.originY),s=this._setObjectSkew(h,r,i,d),r.lastX=t,r.lastY=e,n.setPositionByOrigin(c,r.originX,r.originY),s},_setObjectSkew:function(t,e,i,r){var n,s,o,a,h,c,l,u,f,d=e.target,g=!1,p=e.skewSign;return"x"===i?(a="y",h="Y",c="X",u=0,f=d.skewY):(a="x",h="X",c="Y",u=d.skewX,f=0),o=d._getTransformedDimensions(u,f),l=2*Math.abs(t)-o[i],l<=2?n=0:(n=p*Math.atan(l/d["scale"+c]/(o[a]/d["scale"+h])),n=fabric.util.radiansToDegrees(n)),g=d["skew"+c]!==n,d.set("skew"+c,n),0!==d["skew"+h]&&(s=d._getTransformedDimensions(),n=r[a]/s[a]*d["scale"+h],d.set("scale"+h,n)),g},_scaleObject:function(t,e,i){var r=this._currentTransform,n=r.target,s=n.get("lockScalingX"),o=n.get("lockScalingY"),a=n.get("lockScalingFlip");if(s&&o)return!1;var h=n.translateToOriginPoint(n.getCenterPoint(),r.originX,r.originY),c=n.toLocalPoint(new fabric.Point(t,e),r.originX,r.originY),l=n._getTransformedDimensions(),u=!1;return this._setLocalMouse(c,r),u=this._setObjectScale(c,r,s,o,i,a,l),n.setPositionByOrigin(h,r.originX,r.originY),u},_setObjectScale:function(t,e,i,r,n,s,o){var a,h,c,l,u=e.target,f=!1,d=!1,g=!1;return c=t.x*u.scaleX/o.x,l=t.y*u.scaleY/o.y,a=u.scaleX!==c,h=u.scaleY!==l,s&&c<=0&&c<u.scaleX&&(f=!0),s&&l<=0&&l<u.scaleY&&(d=!0),"equally"!==n||i||r?n?"x"!==n||u.get("lockUniScaling")?"y"!==n||u.get("lockUniScaling")||d||r||u.set("scaleY",l)&&(g=g||h):f||i||u.set("scaleX",c)&&(g=g||a):(f||i||u.set("scaleX",c)&&(g=g||a),d||r||u.set("scaleY",l)&&(g=g||h)):f||d||(g=this._scaleObjectEqually(t,u,e,o)),e.newScaleX=c,e.newScaleY=l,f||d||this._flipObject(e,n),g},_scaleObjectEqually:function(t,e,i,r){var n,s=t.y+t.x,o=r.y*i.original.scaleY/e.scaleY+r.x*i.original.scaleX/e.scaleX;return i.newScaleX=i.original.scaleX*s/o,i.newScaleY=i.original.scaleY*s/o,n=i.newScaleX!==e.scaleX||i.newScaleY!==e.scaleY,e.set("scaleX",i.newScaleX),e.set("scaleY",i.newScaleY),n},_flipObject:function(t,e){t.newScaleX<0&&"y"!==e&&("left"===t.originX?t.originX="right":"right"===t.originX&&(t.originX="left")),t.newScaleY<0&&"x"!==e&&("top"===t.originY?t.originY="bottom":"bottom"===t.originY&&(t.originY="top"))},_setLocalMouse:function(t,e){var i=e.target;"right"===e.originX?t.x*=-1:"center"===e.originX&&(t.x*=2*e.mouseXSign,t.x<0&&(e.mouseXSign=-e.mouseXSign)),"bottom"===e.originY?t.y*=-1:"center"===e.originY&&(t.y*=2*e.mouseYSign,t.y<0&&(e.mouseYSign=-e.mouseYSign)),n(t.x)>i.padding?t.x<0?t.x+=i.padding:t.x-=i.padding:t.x=0,n(t.y)>i.padding?t.y<0?t.y+=i.padding:t.y-=i.padding:t.y=0},_rotateObject:function(t,e){var n=this._currentTransform;if(n.target.get("lockRotation"))return!1;var s=r(n.ey-n.top,n.ex-n.left),o=r(e-n.top,t-n.left),a=i(o-s+n.theta),h=!0;if(a<0&&(a=360+a),a%=360,n.target.snapAngle>0){var c=n.target.snapAngle,l=n.target.snapThreshold||c,u=Math.ceil(a/c)*c,f=Math.floor(a/c)*c;Math.abs(a-f)<l?a=f:Math.abs(a-u)<l&&(a=u),n.target.angle===a&&(h=!1)}return n.target.angle=a,h},setCursor:function(t){this.upperCanvasEl.style.cursor=t},_resetObjectTransform:function(t){t.scaleX=1,t.scaleY=1,t.skewX=0,t.skewY=0,t.setAngle(0)},_drawSelection:function(t){var e=this._groupSelector,i=e.left,r=e.top,a=n(i),h=n(r);if(this.selectionColor&&(t.fillStyle=this.selectionColor,t.fillRect(e.ex-(i>0?0:-i),e.ey-(r>0?0:-r),a,h)),this.selectionLineWidth&&this.selectionBorderColor)if(t.lineWidth=this.selectionLineWidth,t.strokeStyle=this.selectionBorderColor,this.selectionDashArray.length>1&&!s){var c=e.ex+o-(i>0?0:a),l=e.ey+o-(r>0?0:h);t.beginPath(),fabric.util.drawDashedLine(t,c,l,c+a,l,this.selectionDashArray),fabric.util.drawDashedLine(t,c,l+h-1,c+a,l+h-1,this.selectionDashArray),fabric.util.drawDashedLine(t,c,l,c,l+h,this.selectionDashArray),fabric.util.drawDashedLine(t,c+a-1,l,c+a-1,l+h,this.selectionDashArray),t.closePath(),t.stroke()}else fabric.Object.prototype._setLineDash.call(this,t,this.selectionDashArray),t.strokeRect(e.ex+o-(i>0?0:a),e.ey+o-(r>0?0:h),a,h)},findTarget:function(t,e){if(!this.skipTargetFind){var i,r=!0,n=this.getPointer(t,r),s=this.getActiveGroup(),o=this.getActiveObject();if(s&&!e&&this._checkTarget(n,s))return this._fireOverOutEvents(s,t),s;if(o&&o._findTargetCorner(n))return this._fireOverOutEvents(o,t),o;if(o&&this._checkTarget(n,o)){if(!this.preserveObjectStacking)return this._fireOverOutEvents(o,t),o;i=o}this.targets=[];var a=this._searchPossibleTargets(this._objects,n);return t[this.altSelectionKey]&&a&&i&&a!==i&&(a=i),this._fireOverOutEvents(a,t),a}},_fireOverOutEvents:function(t,e){t?this._hoveredTarget!==t&&(this._hoveredTarget&&(this.fire("mouse:out",{target:this._hoveredTarget,e:e}),this._hoveredTarget.fire("mouseout")),this.fire("mouse:over",{target:t,e:e}),t.fire("mouseover"),this._hoveredTarget=t):this._hoveredTarget&&(this.fire("mouse:out",{target:this._hoveredTarget,e:e}),this._hoveredTarget.fire("mouseout"),this._hoveredTarget=null)},_checkTarget:function(t,e){if(e&&e.visible&&e.evented&&this.containsPoint(null,e,t)){if(!this.perPixelTargetFind&&!e.perPixelTargetFind||e.isEditing)return!0;var i=this.isTargetTransparent(e,t.x,t.y);if(!i)return!0}},_searchPossibleTargets:function(t,e){for(var i,r,n,s=t.length;s--;)if(this._checkTarget(e,t[s])){i=t[s],"group"===i.type&&i.subTargetCheck&&(r=this._normalizePointer(i,e),n=this._searchPossibleTargets(i._objects,r),n&&this.targets.push(n));break}return i},restorePointerVpt:function(t){return fabric.util.transformPoint(t,fabric.util.invertTransform(this.viewportTransform))},getPointer:function(e,i,r){r||(r=this.upperCanvasEl);var n,s=t(e),o=r.getBoundingClientRect(),a=o.width||0,h=o.height||0;return a&&h||("top"in o&&"bottom"in o&&(h=Math.abs(o.top-o.bottom)),"right"in o&&"left"in o&&(a=Math.abs(o.right-o.left))),this.calcOffset(),s.x=s.x-this._offset.left,s.y=s.y-this._offset.top,i||(s=this.restorePointerVpt(s)),n=0===a||0===h?{width:1,height:1}:{width:r.width/a,height:r.height/h},{x:s.x*n.width,y:s.y*n.height}},_createUpperCanvas:function(){var t=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,"");this.upperCanvasEl=this._createCanvasElement(),fabric.util.addClass(this.upperCanvasEl,"upper-canvas "+t),this.wrapperEl.appendChild(this.upperCanvasEl),this._copyCanvasStyle(this.lowerCanvasEl,this.upperCanvasEl),this._applyCanvasStyle(this.upperCanvasEl),this.contextTop=this.upperCanvasEl.getContext("2d")},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=fabric.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),fabric.util.setStyle(this.wrapperEl,{width:this.getWidth()+"px",height:this.getHeight()+"px",position:"relative"}),fabric.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(t){var e=this.getWidth()||t.width,i=this.getHeight()||t.height;fabric.util.setStyle(t,{position:"absolute",width:e+"px",height:i+"px",left:0,top:0}),t.width=e,t.height=i,fabric.util.makeElementUnselectable(t)},_copyCanvasStyle:function(t,e){e.style.cssText=t.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},_setActiveObject:function(t){this._activeObject&&this._activeObject.set("active",!1),this._activeObject=t,t.set("active",!0)},setActiveObject:function(t,e){return this._setActiveObject(t),this.renderAll(),this.fire("object:selected",{target:t,e:e}),t.fire("selected",{e:e}),this},getActiveObject:function(){return this._activeObject},_onObjectRemoved:function(t){this.getActiveObject()===t&&(this.fire("before:selection:cleared",{target:t}),this._discardActiveObject(),this.fire("selection:cleared",{target:t}),t.fire("deselected")),this.callSuper("_onObjectRemoved",t)},_discardActiveObject:function(){this._activeObject&&this._activeObject.set("active",!1),this._activeObject=null},discardActiveObject:function(t){var e=this._activeObject;return this.fire("before:selection:cleared",{target:e,e:t}),this._discardActiveObject(),this.fire("selection:cleared",{e:t}),e&&e.fire("deselected",{e:t}),this},_setActiveGroup:function(t){this._activeGroup=t,t&&t.set("active",!0)},setActiveGroup:function(t,e){return this._setActiveGroup(t),t&&(this.fire("object:selected",{target:t,e:e}),t.fire("selected",{e:e})),this},getActiveGroup:function(){return this._activeGroup},_discardActiveGroup:function(){var t=this.getActiveGroup();t&&t.destroy(),this.setActiveGroup(null)},discardActiveGroup:function(t){var e=this.getActiveGroup();return this.fire("before:selection:cleared",{e:t,target:e}),this._discardActiveGroup(),this.fire("selection:cleared",{e:t}),this},deactivateAll:function(){for(var t=this.getObjects(),e=0,i=t.length;e<i;e++)t[e].set("active",!1);return this._discardActiveGroup(),this._discardActiveObject(),this},deactivateAllWithDispatch:function(t){var e=this.getActiveGroup(),i=this.getActiveObject();return(i||e)&&this.fire("before:selection:cleared",{target:i||e,e:t}),this.deactivateAll(),(i||e)&&(this.fire("selection:cleared",{e:t,target:i}),i&&i.fire("deselected")),this},dispose:function(){this.callSuper("dispose");var t=this.wrapperEl;return this.removeListeners(),t.removeChild(this.upperCanvasEl),t.removeChild(this.lowerCanvasEl),delete this.upperCanvasEl,t.parentNode&&t.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,this},clear:function(){return this.discardActiveGroup(),this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(t){var e=this.getActiveGroup();e?e._renderControls(t):this._drawObjectsControls(t)},_drawObjectsControls:function(t){for(var e=0,i=this._objects.length;e<i;++e)this._objects[e]&&this._objects[e].active&&this._objects[e]._renderControls(t)},_toObject:function(t,e,i){var r=this._realizeGroupTransformOnObject(t),n=this.callSuper("_toObject",t,e,i);return this._unwindGroupTransformOnObject(t,r),n},_realizeGroupTransformOnObject:function(t){var e=["angle","flipX","flipY","height","left","scaleX","scaleY","top","width"];if(t.group&&t.group===this.getActiveGroup()){var i={};return e.forEach(function(e){i[e]=t[e]}),this.getActiveGroup().realizeTransform(t),i}return null},_unwindGroupTransformOnObject:function(t,e){e&&t.set(e)},_setSVGObject:function(t,e,i){var r;r=this._realizeGroupTransformOnObject(e),this.callSuper("_setSVGObject",t,e,i),this._unwindGroupTransformOnObject(e,r)}});for(var a in fabric.StaticCanvas)"prototype"!==a&&(fabric.Canvas[a]=fabric.StaticCanvas[a]);fabric.isTouchSupported&&(fabric.Canvas.prototype._setCursorFromEvent=function(){}),fabric.Element=fabric.Canvas}(),function(){var t={mt:0,tr:1,mr:2,br:3,mb:4,bl:5,ml:6,tl:7},e=fabric.util.addListener,i=fabric.util.removeListener;fabric.util.object.extend(fabric.Canvas.prototype,{cursorMap:["n-resize","ne-resize","e-resize","se-resize","s-resize","sw-resize","w-resize","nw-resize"],_initEventListeners:function(){this._bindEvents(),e(fabric.window,"resize",this._onResize),e(this.upperCanvasEl,"mousedown",this._onMouseDown),e(this.upperCanvasEl,"mousemove",this._onMouseMove),e(this.upperCanvasEl,"mouseout",this._onMouseOut),e(this.upperCanvasEl,"mouseenter",this._onMouseEnter),e(this.upperCanvasEl,"wheel",this._onMouseWheel),e(this.upperCanvasEl,"contextmenu",this._onContextMenu),e(this.upperCanvasEl,"touchstart",this._onMouseDown),e(this.upperCanvasEl,"touchmove",this._onMouseMove),"undefined"!=typeof eventjs&&"add"in eventjs&&(eventjs.add(this.upperCanvasEl,"gesture",this._onGesture),eventjs.add(this.upperCanvasEl,"drag",this._onDrag),eventjs.add(this.upperCanvasEl,"orientation",this._onOrientationChange),eventjs.add(this.upperCanvasEl,"shake",this._onShake),
eventjs.add(this.upperCanvasEl,"longpress",this._onLongPress))},_bindEvents:function(){this._onMouseDown=this._onMouseDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this)},removeListeners:function(){i(fabric.window,"resize",this._onResize),i(this.upperCanvasEl,"mousedown",this._onMouseDown),i(this.upperCanvasEl,"mousemove",this._onMouseMove),i(this.upperCanvasEl,"mouseout",this._onMouseOut),i(this.upperCanvasEl,"mouseenter",this._onMouseEnter),i(this.upperCanvasEl,"wheel",this._onMouseWheel),i(this.upperCanvasEl,"contextmenu",this._onContextMenu),i(this.upperCanvasEl,"touchstart",this._onMouseDown),i(this.upperCanvasEl,"touchmove",this._onMouseMove),"undefined"!=typeof eventjs&&"remove"in eventjs&&(eventjs.remove(this.upperCanvasEl,"gesture",this._onGesture),eventjs.remove(this.upperCanvasEl,"drag",this._onDrag),eventjs.remove(this.upperCanvasEl,"orientation",this._onOrientationChange),eventjs.remove(this.upperCanvasEl,"shake",this._onShake),eventjs.remove(this.upperCanvasEl,"longpress",this._onLongPress))},_onGesture:function(t,e){this.__onTransformGesture&&this.__onTransformGesture(t,e)},_onDrag:function(t,e){this.__onDrag&&this.__onDrag(t,e)},_onMouseWheel:function(t){this.__onMouseWheel(t)},_onMouseOut:function(t){var e=this._hoveredTarget;this.fire("mouse:out",{target:e,e:t}),this._hoveredTarget=null,e&&e.fire("mouseout",{e:t})},_onMouseEnter:function(t){this.findTarget(t)||(this.fire("mouse:over",{target:null,e:t}),this._hoveredTarget=null)},_onOrientationChange:function(t,e){this.__onOrientationChange&&this.__onOrientationChange(t,e)},_onShake:function(t,e){this.__onShake&&this.__onShake(t,e)},_onLongPress:function(t,e){this.__onLongPress&&this.__onLongPress(t,e)},_onContextMenu:function(t){return this.stopContextMenu&&(t.stopPropagation(),t.preventDefault()),!1},_onMouseDown:function(t){this.__onMouseDown(t),e(fabric.document,"touchend",this._onMouseUp),e(fabric.document,"touchmove",this._onMouseMove),i(this.upperCanvasEl,"mousemove",this._onMouseMove),i(this.upperCanvasEl,"touchmove",this._onMouseMove),"touchstart"===t.type?i(this.upperCanvasEl,"mousedown",this._onMouseDown):(e(fabric.document,"mouseup",this._onMouseUp),e(fabric.document,"mousemove",this._onMouseMove))},_onMouseUp:function(t){if(this.__onMouseUp(t),i(fabric.document,"mouseup",this._onMouseUp),i(fabric.document,"touchend",this._onMouseUp),i(fabric.document,"mousemove",this._onMouseMove),i(fabric.document,"touchmove",this._onMouseMove),e(this.upperCanvasEl,"mousemove",this._onMouseMove),e(this.upperCanvasEl,"touchmove",this._onMouseMove),"touchend"===t.type){var r=this;setTimeout(function(){e(r.upperCanvasEl,"mousedown",r._onMouseDown)},400)}},_onMouseMove:function(t){!this.allowTouchScrolling&&t.preventDefault&&t.preventDefault(),this.__onMouseMove(t)},_onResize:function(){this.calcOffset()},_shouldRender:function(t,e){var i=this.getActiveGroup()||this.getActiveObject();return!!(t&&(t.isMoving||t!==i)||!t&&i||!t&&!i&&!this._groupSelector||e&&this._previousPointer&&this.selection&&(e.x!==this._previousPointer.x||e.y!==this._previousPointer.y))},__onMouseUp:function(t){var e,i=!0,r=this._currentTransform,n=this._groupSelector,s=!n||0===n.left&&0===n.top;if(this.isDrawingMode&&this._isCurrentlyDrawing)return void this._onMouseUpInDrawingMode(t);r&&(this._finalizeCurrentTransform(),i=!r.actionPerformed),e=i?this.findTarget(t,!0):r.target;var o=this._shouldRender(e,this.getPointer(t));e||!s?this._maybeGroupObjects(t):(this._groupSelector=null,this._currentTransform=null),e&&(e.isMoving=!1),this._handleCursorAndEvent(t,e,"up"),e&&(e.__corner=0),o&&this.renderAll()},_handleCursorAndEvent:function(t,e,i){this._setCursorFromEvent(t,e),this._handleEvent(t,i,e?e:null)},_handleEvent:function(t,e,i){var r=void 0===typeof i?this.findTarget(t):i,n=this.targets||[],s={e:t,target:r,subTargets:n};this.fire("mouse:"+e,s),r&&r.fire("mouse"+e,s);for(var o=0;o<n.length;o++)n[o].fire("mouse"+e,s)},_finalizeCurrentTransform:function(){var t=this._currentTransform,e=t.target;e._scaling&&(e._scaling=!1),e.setCoords(),this._restoreOriginXY(e),(t.actionPerformed||this.stateful&&e.hasStateChanged())&&(this.fire("object:modified",{target:e}),e.fire("modified"))},_restoreOriginXY:function(t){if(this._previousOriginX&&this._previousOriginY){var e=t.translateToOriginPoint(t.getCenterPoint(),this._previousOriginX,this._previousOriginY);t.originX=this._previousOriginX,t.originY=this._previousOriginY,t.left=e.x,t.top=e.y,this._previousOriginX=null,this._previousOriginY=null}},_onMouseDownInDrawingMode:function(t){this._isCurrentlyDrawing=!0,this.discardActiveObject(t).renderAll(),this.clipTo&&fabric.util.clipContext(this,this.contextTop);var e=this.getPointer(t);this.freeDrawingBrush.onMouseDown(e),this._handleEvent(t,"down")},_onMouseMoveInDrawingMode:function(t){if(this._isCurrentlyDrawing){var e=this.getPointer(t);this.freeDrawingBrush.onMouseMove(e)}this.setCursor(this.freeDrawingCursor),this._handleEvent(t,"move")},_onMouseUpInDrawingMode:function(t){this._isCurrentlyDrawing=!1,this.clipTo&&this.contextTop.restore(),this.freeDrawingBrush.onMouseUp(),this._handleEvent(t,"up")},__onMouseDown:function(t){var e=this.findTarget(t),i=this.getPointer(t,!0),r="which"in t?3===t.which:2===t.button;if(r)return void(this.fireRightClick&&this._handleEvent(t,"down",e?e:null));if(this.isDrawingMode)return void this._onMouseDownInDrawingMode(t);if(!this._currentTransform){this._previousPointer=i;var n=this._shouldRender(e,i),s=this._shouldGroup(t,e);this._shouldClearSelection(t,e)?this._clearSelection(t,e,i):s&&(this._handleGrouping(t,e),e=this.getActiveGroup()),e&&(!e.selectable||!e.__corner&&s||(this._beforeTransform(t,e),this._setupCurrentTransform(t,e)),e!==this.getActiveGroup()&&e!==this.getActiveObject()&&(this.deactivateAll(),e.selectable&&this.setActiveObject(e,t))),this._handleEvent(t,"down",e?e:null),n&&this.renderAll()}},_beforeTransform:function(t,e){this.stateful&&e.saveState(),e._findTargetCorner(this.getPointer(t))&&this.onBeforeScaleRotate(e)},_clearSelection:function(t,e,i){this.deactivateAllWithDispatch(t),e&&e.selectable?this.setActiveObject(e,t):this.selection&&(this._groupSelector={ex:i.x,ey:i.y,top:0,left:0})},_setOriginToCenter:function(t){this._previousOriginX=this._currentTransform.target.originX,this._previousOriginY=this._currentTransform.target.originY;var e=t.getCenterPoint();t.originX="center",t.originY="center",t.left=e.x,t.top=e.y,this._currentTransform.left=t.left,this._currentTransform.top=t.top},_setCenterToOrigin:function(t){var e=t.translateToOriginPoint(t.getCenterPoint(),this._previousOriginX,this._previousOriginY);t.originX=this._previousOriginX,t.originY=this._previousOriginY,t.left=e.x,t.top=e.y,this._previousOriginX=null,this._previousOriginY=null},__onMouseMove:function(t){var e,i;if(this.isDrawingMode)return void this._onMouseMoveInDrawingMode(t);if(!("undefined"!=typeof t.touches&&t.touches.length>1)){var r=this._groupSelector;r?(i=this.getPointer(t,!0),r.left=i.x-r.ex,r.top=i.y-r.ey,this.renderTop()):this._currentTransform?this._transformObject(t):(e=this.findTarget(t),this._setCursorFromEvent(t,e)),this._handleEvent(t,"move",e?e:null)}},__onMouseWheel:function(t){this.fire("mouse:wheel",{e:t})},_transformObject:function(t){var e=this.getPointer(t),i=this._currentTransform;i.reset=!1,i.target.isMoving=!0,this._beforeScaleTransform(t,i),this._performTransformAction(t,i,e),i.actionPerformed&&this.renderAll()},_performTransformAction:function(t,e,i){var r=i.x,n=i.y,s=e.target,o=e.action,a=!1;"rotate"===o?(a=this._rotateObject(r,n))&&this._fire("rotating",s,t):"scale"===o?(a=this._onScale(t,e,r,n))&&this._fire("scaling",s,t):"scaleX"===o?(a=this._scaleObject(r,n,"x"))&&this._fire("scaling",s,t):"scaleY"===o?(a=this._scaleObject(r,n,"y"))&&this._fire("scaling",s,t):"skewX"===o?(a=this._skewObject(r,n,"x"))&&this._fire("skewing",s,t):"skewY"===o?(a=this._skewObject(r,n,"y"))&&this._fire("skewing",s,t):(a=this._translateObject(r,n),a&&(this._fire("moving",s,t),this.setCursor(s.moveCursor||this.moveCursor))),e.actionPerformed=a},_fire:function(t,e,i){this.fire("object:"+t,{target:e,e:i}),e.fire(t,{e:i})},_beforeScaleTransform:function(t,e){if("scale"===e.action||"scaleX"===e.action||"scaleY"===e.action){var i=this._shouldCenterTransform(e.target);(i&&("center"!==e.originX||"center"!==e.originY)||!i&&"center"===e.originX&&"center"===e.originY)&&(this._resetCurrentTransform(),e.reset=!0)}},_onScale:function(t,e,i,r){return!t[this.uniScaleKey]&&!this.uniScaleTransform||e.target.get("lockUniScaling")?(e.reset||"scale"!==e.currentAction||this._resetCurrentTransform(),e.currentAction="scaleEqually",this._scaleObject(i,r,"equally")):(e.currentAction="scale",this._scaleObject(i,r))},_setCursorFromEvent:function(t,e){if(!e)return this.setCursor(this.defaultCursor),!1;var i=e.hoverCursor||this.hoverCursor;if(e.selectable){var r=this.getActiveGroup(),n=e._findTargetCorner&&(!r||!r.contains(e))&&e._findTargetCorner(this.getPointer(t,!0));n?this._setCornerCursor(n,e,t):this.setCursor(i)}else this.setCursor(i);return!0},_setCornerCursor:function(e,i,r){if(e in t)this.setCursor(this._getRotatedCornerCursor(e,i,r));else{if("mtr"!==e||!i.hasRotatingPoint)return this.setCursor(this.defaultCursor),!1;this.setCursor(this.rotationCursor)}},_getRotatedCornerCursor:function(e,i,r){var n=Math.round(i.getAngle()%360/45);return n<0&&(n+=8),n+=t[e],r[this.altActionKey]&&t[e]%2===0&&(n+=2),n%=8,this.cursorMap[n]}})}(),function(){var t=Math.min,e=Math.max;fabric.util.object.extend(fabric.Canvas.prototype,{_shouldGroup:function(t,e){var i=this.getActiveObject();return t[this.selectionKey]&&e&&e.selectable&&(this.getActiveGroup()||i&&i!==e)&&this.selection},_handleGrouping:function(t,e){var i=this.getActiveGroup();(e!==i||(e=this.findTarget(t,!0)))&&(i?this._updateActiveGroup(e,t):this._createActiveGroup(e,t),this._activeGroup&&this._activeGroup.saveCoords())},_updateActiveGroup:function(t,e){var i=this.getActiveGroup();if(i.contains(t)){if(i.removeWithUpdate(t),t.set("active",!1),1===i.size())return this.discardActiveGroup(e),void this.setActiveObject(i.item(0))}else i.addWithUpdate(t);this.fire("selection:created",{target:i,e:e}),i.set("active",!0)},_createActiveGroup:function(t,e){if(this._activeObject&&t!==this._activeObject){var i=this._createGroup(t);i.addWithUpdate(),this.setActiveGroup(i),this._activeObject=null,this.fire("selection:created",{target:i,e:e})}t.set("active",!0)},_createGroup:function(t){var e=this.getObjects(),i=e.indexOf(this._activeObject)<e.indexOf(t),r=i?[this._activeObject,t]:[t,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new fabric.Group(r,{canvas:this})},_groupSelectedObjects:function(t){var e=this._collectObjects();1===e.length?this.setActiveObject(e[0],t):e.length>1&&(e=new fabric.Group(e.reverse(),{canvas:this}),e.addWithUpdate(),this.setActiveGroup(e,t),e.saveCoords(),this.fire("selection:created",{target:e}),this.renderAll())},_collectObjects:function(){for(var i,r=[],n=this._groupSelector.ex,s=this._groupSelector.ey,o=n+this._groupSelector.left,a=s+this._groupSelector.top,h=new fabric.Point(t(n,o),t(s,a)),c=new fabric.Point(e(n,o),e(s,a)),l=n===o&&s===a,u=this._objects.length;u--&&(i=this._objects[u],!(i&&i.selectable&&i.visible&&(i.intersectsWithRect(h,c)||i.isContainedWithinRect(h,c)||i.containsPoint(h)||i.containsPoint(c))&&(i.set("active",!0),r.push(i),l))););return r},_maybeGroupObjects:function(t){this.selection&&this._groupSelector&&this._groupSelectedObjects(t);var e=this.getActiveGroup();e&&(e.setObjectsCoords().setCoords(),e.isMoving=!1,this.setCursor(this.defaultCursor)),this._groupSelector=null,this._currentTransform=null}})}(),function(){var t=fabric.StaticCanvas.supports("toDataURLWithQuality");fabric.util.object.extend(fabric.StaticCanvas.prototype,{toDataURL:function(t){t||(t={});var e=t.format||"png",i=t.quality||1,r=t.multiplier||1,n={left:t.left||0,top:t.top||0,width:t.width||0,height:t.height||0};return this.__toDataURLWithMultiplier(e,i,n,r)},__toDataURLWithMultiplier:function(t,e,i,r){var n=this.getWidth(),s=this.getHeight(),o=(i.width||this.getWidth())*r,a=(i.height||this.getHeight())*r,h=this.getZoom(),c=h*r,l=this.viewportTransform,u=(l[4]-i.left)*r,f=(l[5]-i.top)*r,d=[c,0,0,c,u,f],g=this.interactive;this.viewportTransform=d,this.interactive&&(this.interactive=!1),n!==o||s!==a?this.setDimensions({width:o,height:a}):this.renderAll();var p=this.__toDataURL(t,e,i);return g&&(this.interactive=g),this.viewportTransform=l,this.setDimensions({width:n,height:s}),p},__toDataURL:function(e,i){var r=this.contextContainer.canvas;"jpg"===e&&(e="jpeg");var n=t?r.toDataURL("image/"+e,i):r.toDataURL("image/"+e);return n},toDataURLWithMultiplier:function(t,e,i){return this.toDataURL({format:t,multiplier:e,quality:i})}})}(),fabric.util.object.extend(fabric.StaticCanvas.prototype,{loadFromDatalessJSON:function(t,e,i){return this.loadFromJSON(t,e,i)},loadFromJSON:function(t,e,i){if(t){var r="string"==typeof t?JSON.parse(t):fabric.util.object.clone(t);this.clear();var n=this;return this._enlivenObjects(r.objects,function(){n._setBgOverlay(r,function(){delete r.objects,delete r.backgroundImage,delete r.overlayImage,delete r.background,delete r.overlay;for(var t in r)n[t]=r[t];e&&e()})},i),this}},_setBgOverlay:function(t,e){var i=this,r={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(!(t.backgroundImage||t.overlayImage||t.background||t.overlay))return void(e&&e());var n=function(){r.backgroundImage&&r.overlayImage&&r.backgroundColor&&r.overlayColor&&(i.renderAll(),e&&e())};this.__setBgOverlay("backgroundImage",t.backgroundImage,r,n),this.__setBgOverlay("overlayImage",t.overlayImage,r,n),this.__setBgOverlay("backgroundColor",t.background,r,n),this.__setBgOverlay("overlayColor",t.overlay,r,n),n()},__setBgOverlay:function(t,e,i,r){var n=this;return e?void("backgroundImage"===t||"overlayImage"===t?fabric.Image.fromObject(e,function(e){n[t]=e,i[t]=!0,r&&r()}):this["set"+fabric.util.string.capitalize(t,!0)](e,function(){i[t]=!0,r&&r()})):void(i[t]=!0)},_enlivenObjects:function(t,e,i){var r=this;if(!t||0===t.length)return void(e&&e());var n=this.renderOnAddRemove;this.renderOnAddRemove=!1,fabric.util.enlivenObjects(t,function(t){t.forEach(function(t,e){r.insertAt(t,e)}),r.renderOnAddRemove=n,e&&e()},null,i)},_toDataURL:function(t,e){this.clone(function(i){e(i.toDataURL(t))})},_toDataURLWithMultiplier:function(t,e,i){this.clone(function(r){i(r.toDataURLWithMultiplier(t,e))})},clone:function(t,e){var i=JSON.stringify(this.toJSON(e));this.cloneWithoutData(function(e){e.loadFromJSON(i,function(){t&&t(e)})})},cloneWithoutData:function(t){var e=fabric.document.createElement("canvas");e.width=this.getWidth(),e.height=this.getHeight();var i=new fabric.Canvas(e);i.clipTo=this.clipTo,this.backgroundImage?(i.setBackgroundImage(this.backgroundImage.src,function(){i.renderAll(),t&&t(i)}),i.backgroundImageOpacity=this.backgroundImageOpacity,i.backgroundImageStretch=this.backgroundImageStretch):t&&t(i)}}),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.util.toFixed,n=e.util.string.capitalize,s=e.util.degreesToRadians,o=e.StaticCanvas.supports("setLineDash");e.Object||(e.Object=e.util.createClass({type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgba(102,153,255,0.75)",borderDashArray:null,cornerColor:"rgba(102,153,255,0.5)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:10,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,transformMatrix:null,minScaleLimit:.01,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,hasRotatingPoint:!0,rotatingPointOffset:40,perPixelTargetFind:!1,includeDefaultValues:!0,clipTo:null,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockUniScaling:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeLineJoin strokeMiterLimit angle opacity fill fillRule globalCompositeOperation shadow clipTo visible backgroundColor skewX skewY".split(" "),initialize:function(t){t&&this.setOptions(t)},_initGradient:function(t){!t.fill||!t.fill.colorStops||t.fill instanceof e.Gradient||this.set("fill",new e.Gradient(t.fill)),!t.stroke||!t.stroke.colorStops||t.stroke instanceof e.Gradient||this.set("stroke",new e.Gradient(t.stroke))},_initPattern:function(t){!t.fill||!t.fill.source||t.fill instanceof e.Pattern||this.set("fill",new e.Pattern(t.fill)),!t.stroke||!t.stroke.source||t.stroke instanceof e.Pattern||this.set("stroke",new e.Pattern(t.stroke))},_initClipping:function(t){if(t.clipTo&&"string"==typeof t.clipTo){var i=e.util.getFunctionBody(t.clipTo);"undefined"!=typeof i&&(this.clipTo=new Function("ctx",i))}},setOptions:function(t){for(var e in t)this.set(e,t[e]);this._initGradient(t),this._initPattern(t),this._initClipping(t)},transform:function(t,e){this.group&&!this.group._transformDone&&this.group===this.canvas._activeGroup&&this.group.transform(t);var i=e?this._getLeftTopCoords():this.getCenterPoint();t.translate(i.x,i.y),t.rotate(s(this.angle)),t.scale(this.scaleX*(this.flipX?-1:1),this.scaleY*(this.flipY?-1:1)),t.transform(1,0,Math.tan(s(this.skewX)),1,0,0),t.transform(1,Math.tan(s(this.skewY)),0,1,0,0)},toObject:function(t){var i=e.Object.NUM_FRACTION_DIGITS,n={type:this.type,originX:this.originX,originY:this.originY,left:r(this.left,i),top:r(this.top,i),width:r(this.width,i),height:r(this.height,i),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:r(this.strokeWidth,i),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:r(this.strokeMiterLimit,i),scaleX:r(this.scaleX,i),scaleY:r(this.scaleY,i),angle:r(this.getAngle(),i),flipX:this.flipX,flipY:this.flipY,opacity:r(this.opacity,i),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,clipTo:this.clipTo&&String(this.clipTo),backgroundColor:this.backgroundColor,fillRule:this.fillRule,globalCompositeOperation:this.globalCompositeOperation,transformMatrix:this.transformMatrix?this.transformMatrix.concat():this.transformMatrix,skewX:r(this.skewX,i),skewY:r(this.skewY,i)};return e.util.populateWithProperties(this,n,t),this.includeDefaultValues||(n=this._removeDefaultValues(n)),n},toDatalessObject:function(t){return this.toObject(t)},_removeDefaultValues:function(t){var i=e.util.getKlass(t.type).prototype,r=i.stateProperties;return r.forEach(function(e){t[e]===i[e]&&delete t[e];var r="[object Array]"===Object.prototype.toString.call(t[e])&&"[object Array]"===Object.prototype.toString.call(i[e]);r&&0===t[e].length&&0===i[e].length&&delete t[e]}),t},toString:function(){return"#<fabric."+n(this.type)+">"},get:function(t){return this[t]},getObjectScaling:function(){var t=this.scaleX,e=this.scaleY;if(this.group){var i=this.group.getObjectScaling();t*=i.scaleX,e*=i.scaleY}return{scaleX:t,scaleY:e}},_setObject:function(t){for(var e in t)this._set(e,t[e])},set:function(t,e){return"object"==typeof t?this._setObject(t):"function"==typeof e&&"clipTo"!==t?this._set(t,e(this.get(t))):this._set(t,e),this},_set:function(t,i){var r="scaleX"===t||"scaleY"===t;return r&&(i=this._constrainScale(i)),"scaleX"===t&&i<0?(this.flipX=!this.flipX,i*=-1):"scaleY"===t&&i<0?(this.flipY=!this.flipY,i*=-1):"shadow"!==t||!i||i instanceof e.Shadow||(i=new e.Shadow(i)),this[t]=i,"width"!==t&&"height"!==t||(this.minScaleLimit=Math.min(.1,1/Math.max(this.width,this.height))),this},setOnGroup:function(){},toggle:function(t){var e=this.get(t);return"boolean"==typeof e&&this.set(t,!e),this},setSourcePath:function(t){return this.sourcePath=t,this},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:[1,0,0,1,0,0]},render:function(t,i){0===this.width&&0===this.height||!this.visible||(t.save(),this._setupCompositeOperation(t),this.drawSelectionBackground(t),i||this.transform(t),this._setOpacity(t),this._setShadow(t),this._renderBackground(t),this._setStrokeStyles(t),this._setFillStyles(t),this.transformMatrix&&t.transform.apply(t,this.transformMatrix),this.clipTo&&e.util.clipContext(this,t),this._render(t,i),this.clipTo&&t.restore(),t.restore())},_renderBackground:function(t){this.backgroundColor&&(t.fillStyle=this.backgroundColor,t.fillRect(-this.width/2,-this.height/2,this.width,this.height),this._removeShadow(t))},_setOpacity:function(t){this.group&&this.group._setOpacity(t),t.globalAlpha*=this.opacity},_setStrokeStyles:function(t){this.stroke&&(t.lineWidth=this.strokeWidth,t.lineCap=this.strokeLineCap,t.lineJoin=this.strokeLineJoin,t.miterLimit=this.strokeMiterLimit,t.strokeStyle=this.stroke.toLive?this.stroke.toLive(t,this):this.stroke)},_setFillStyles:function(t){this.fill&&(t.fillStyle=this.fill.toLive?this.fill.toLive(t,this):this.fill)},_setLineDash:function(t,e,i){e&&(1&e.length&&e.push.apply(e,e),o?t.setLineDash(e):i&&i(t))},_renderControls:function(t,i){if(!(!this.active||i||this.group&&this.group!==this.canvas.getActiveGroup())){var r,n=this.getViewportTransform(),o=this.calcTransformMatrix();o=e.util.multiplyTransformMatrices(n,o),r=e.util.qrDecompose(o),t.save(),t.translate(r.translateX,r.translateY),t.lineWidth=1*this.borderScaleFactor,t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,this.group&&this.group===this.canvas.getActiveGroup()?(t.rotate(s(r.angle)),this.drawBordersInGroup(t,r)):(t.rotate(s(this.angle)),this.drawBorders(t)),this.drawControls(t),t.restore()}},_setShadow:function(t){if(this.shadow){var i=this.canvas&&this.canvas.viewportTransform[0]||1,r=this.canvas&&this.canvas.viewportTransform[3]||1,n=this.getObjectScaling();this.canvas&&this.canvas._isRetinaScaling()&&(i*=e.devicePixelRatio,r*=e.devicePixelRatio),t.shadowColor=this.shadow.color,t.shadowBlur=this.shadow.blur*(i+r)*(n.scaleX+n.scaleY)/4,t.shadowOffsetX=this.shadow.offsetX*i*n.scaleX,t.shadowOffsetY=this.shadow.offsetY*r*n.scaleY}},_removeShadow:function(t){this.shadow&&(t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0)},_renderFill:function(t){if(this.fill){if(t.save(),this.fill.gradientTransform){var e=this.fill.gradientTransform;t.transform.apply(t,e)}this.fill.toLive&&t.translate(-this.width/2+this.fill.offsetX||0,-this.height/2+this.fill.offsetY||0),"evenodd"===this.fillRule?t.fill("evenodd"):t.fill(),t.restore()}},_renderStroke:function(t){if(this.stroke&&0!==this.strokeWidth){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this._setLineDash(t,this.strokeDashArray,this._renderDashedStroke),this.stroke.gradientTransform){var e=this.stroke.gradientTransform;t.transform.apply(t,e)}this.stroke.toLive&&t.translate(-this.width/2+this.stroke.offsetX||0,-this.height/2+this.stroke.offsetY||0),t.stroke(),t.restore()}},clone:function(t,i){return this.constructor.fromObject?this.constructor.fromObject(this.toObject(i),t):new e.Object(this.toObject(i))},cloneAsImage:function(t,i){var r=this.toDataURL(i);return e.util.loadImage(r,function(i){t&&t(new e.Image(i))}),this},toDataURL:function(t){t||(t={});var i=e.util.createCanvasElement(),r=this.getBoundingRect();i.width=r.width,i.height=r.height,e.util.wrapElement(i,"div");var n=new e.StaticCanvas(i,{enableRetinaScaling:t.enableRetinaScaling});"jpg"===t.format&&(t.format="jpeg"),"jpeg"===t.format&&(n.backgroundColor="#fff");var s={active:this.get("active"),left:this.getLeft(),top:this.getTop()};this.set("active",!1),this.setPositionByOrigin(new e.Point(n.getWidth()/2,n.getHeight()/2),"center","center");var o=this.canvas;n.add(this);var a=n.toDataURL(t);return this.set(s).setCoords(),this.canvas=o,n.dispose(),n=null,a},isType:function(t){return this.type===t},complexity:function(){return 0},toJSON:function(t){return this.toObject(t)},setGradient:function(t,i){i||(i={});var r={colorStops:[]};r.type=i.type||(i.r1||i.r2?"radial":"linear"),r.coords={x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2},(i.r1||i.r2)&&(r.coords.r1=i.r1,r.coords.r2=i.r2),i.gradientTransform&&(r.gradientTransform=i.gradientTransform);for(var n in i.colorStops){var s=new e.Color(i.colorStops[n]);r.colorStops.push({offset:n,color:s.toRgb(),opacity:s.getAlpha()})}return this.set(t,e.Gradient.forObject(this,r))},setPatternFill:function(t){return this.set("fill",new e.Pattern(t))},setShadow:function(t){return this.set("shadow",t?new e.Shadow(t):null)},setColor:function(t){return this.set("fill",t),this},setAngle:function(t){var e=("center"!==this.originX||"center"!==this.originY)&&this.centeredRotation;return e&&this._setOriginToCenter(),this.set("angle",t),e&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},remove:function(){return this.canvas&&this.canvas.remove(this),this},getLocalPointer:function(t,i){i=i||this.canvas.getPointer(t);var r=new e.Point(i.x,i.y),n=this._getLeftTopCoords();return this.angle&&(r=e.util.rotatePoint(r,n,e.util.degreesToRadians(-this.angle))),{x:r.x-n.x,y:r.y-n.y}},_setupCompositeOperation:function(t){this.globalCompositeOperation&&(t.globalCompositeOperation=this.globalCompositeOperation)}}),e.util.createAccessors(e.Object),e.Object.prototype.rotate=e.Object.prototype.setAngle,i(e.Object.prototype,e.Observable),e.Object.NUM_FRACTION_DIGITS=2,e.Object.__uid=0)}("undefined"!=typeof exports?exports:this),function(){var t=fabric.util.degreesToRadians,e={left:-.5,center:0,right:.5},i={top:-.5,center:0,bottom:.5};fabric.util.object.extend(fabric.Object.prototype,{translateToGivenOrigin:function(t,r,n,s,o){var a,h,c,l=t.x,u=t.y;return"string"==typeof r?r=e[r]:r-=.5,"string"==typeof s?s=e[s]:s-=.5,a=s-r,"string"==typeof n?n=i[n]:n-=.5,"string"==typeof o?o=i[o]:o-=.5,h=o-n,(a||h)&&(c=this._getTransformedDimensions(),l=t.x+a*c.x,u=t.y+h*c.y),new fabric.Point(l,u)},translateToCenterPoint:function(e,i,r){var n=this.translateToGivenOrigin(e,i,r,"center","center");return this.angle?fabric.util.rotatePoint(n,e,t(this.angle)):n},translateToOriginPoint:function(e,i,r){var n=this.translateToGivenOrigin(e,"center","center",i,r);return this.angle?fabric.util.rotatePoint(n,e,t(this.angle)):n},getCenterPoint:function(){var t=new fabric.Point(this.left,this.top);return this.translateToCenterPoint(t,this.originX,this.originY)},getPointByOrigin:function(t,e){var i=this.getCenterPoint();return this.translateToOriginPoint(i,t,e)},toLocalPoint:function(e,i,r){var n,s,o=this.getCenterPoint();return n="undefined"!=typeof i&&"undefined"!=typeof r?this.translateToGivenOrigin(o,"center","center",i,r):new fabric.Point(this.left,this.top),s=new fabric.Point(e.x,e.y),this.angle&&(s=fabric.util.rotatePoint(s,o,-t(this.angle))),s.subtractEquals(n)},setPositionByOrigin:function(t,e,i){var r=this.translateToCenterPoint(t,e,i),n=this.translateToOriginPoint(r,this.originX,this.originY);this.set("left",n.x),this.set("top",n.y)},adjustPosition:function(i){var r,n,s=t(this.angle),o=this.getWidth(),a=Math.cos(s)*o,h=Math.sin(s)*o;r="string"==typeof this.originX?e[this.originX]:this.originX-.5,n="string"==typeof i?e[i]:i-.5,this.left+=a*(n-r),this.top+=h*(n-r),this.setCoords(),this.originX=i},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var t=this.getCenterPoint();this.originX="center",this.originY="center",this.left=t.x,this.top=t.y},_resetOrigin:function(){var t=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=t.x,this.top=t.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}})}(),function(){function t(t){return[new fabric.Point(t.tl.x,t.tl.y),new fabric.Point(t.tr.x,t.tr.y),new fabric.Point(t.br.x,t.br.y),new fabric.Point(t.bl.x,t.bl.y)]}var e=fabric.util.degreesToRadians,i=fabric.util.multiplyTransformMatrices;fabric.util.object.extend(fabric.Object.prototype,{oCoords:null,intersectsWithRect:function(e,i){var r=t(this.oCoords),n=fabric.Intersection.intersectPolygonRectangle(r,e,i);return"Intersection"===n.status},intersectsWithObject:function(e){var i=fabric.Intersection.intersectPolygonPolygon(t(this.oCoords),t(e.oCoords));return"Intersection"===i.status||e.isContainedWithinObject(this)||this.isContainedWithinObject(e)},isContainedWithinObject:function(e){for(var i=t(this.oCoords),r=0;r<4;r++)if(!e.containsPoint(i[r]))return!1;return!0},isContainedWithinRect:function(t,e){var i=this.getBoundingRect();return i.left>=t.x&&i.left+i.width<=e.x&&i.top>=t.y&&i.top+i.height<=e.y},containsPoint:function(t){this.oCoords||this.setCoords();var e=this._getImageLines(this.oCoords),i=this._findCrossPoints(t,e);return 0!==i&&i%2===1},_getImageLines:function(t){return{topline:{o:t.tl,d:t.tr},rightline:{o:t.tr,d:t.br},bottomline:{o:t.br,d:t.bl},leftline:{o:t.bl,d:t.tl}}},_findCrossPoints:function(t,e){var i,r,n,s,o,a,h=0;for(var c in e)if(a=e[c],!(a.o.y<t.y&&a.d.y<t.y||a.o.y>=t.y&&a.d.y>=t.y||(a.o.x===a.d.x&&a.o.x>=t.x?o=a.o.x:(i=0,r=(a.d.y-a.o.y)/(a.d.x-a.o.x),n=t.y-i*t.x,s=a.o.y-r*a.o.x,o=-(n-s)/(i-r)),o>=t.x&&(h+=1),2!==h)))break;return h},getBoundingRectWidth:function(){return this.getBoundingRect().width},getBoundingRectHeight:function(){return this.getBoundingRect().height},getBoundingRect:function(){return this.oCoords||this.setCoords(),fabric.util.makeBoundingBoxFromPoints([this.oCoords.tl,this.oCoords.tr,this.oCoords.br,this.oCoords.bl])},getWidth:function(){return this._getTransformedDimensions().x},getHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(t){return Math.abs(t)<this.minScaleLimit?t<0?-this.minScaleLimit:this.minScaleLimit:t},scale:function(t){return t=this._constrainScale(t),t<0&&(this.flipX=!this.flipX,this.flipY=!this.flipY,t*=-1),this.scaleX=t,this.scaleY=t,this.setCoords(),this},scaleToWidth:function(t){var e=this.getBoundingRect().width/this.getWidth();return this.scale(t/this.width/e)},scaleToHeight:function(t){var e=this.getBoundingRect().height/this.getHeight();return this.scale(t/this.height/e)},setCoords:function(){var t=e(this.angle),i=this.getViewportTransform(),r=this._calculateCurrentDimensions(),n=r.x,s=r.y;n<0&&(n=Math.abs(n));var o=Math.sin(t),a=Math.cos(t),h=n>0?Math.atan(s/n):0,c=n/Math.cos(h)/2,l=Math.cos(h+t)*c,u=Math.sin(h+t)*c,f=fabric.util.transformPoint(this.getCenterPoint(),i),d=new fabric.Point(f.x-l,f.y-u),g=new fabric.Point(d.x+n*a,d.y+n*o),p=new fabric.Point(d.x-s*o,d.y+s*a),v=new fabric.Point(f.x+l,f.y+u),b=new fabric.Point((d.x+p.x)/2,(d.y+p.y)/2),m=new fabric.Point((g.x+d.x)/2,(g.y+d.y)/2),y=new fabric.Point((v.x+g.x)/2,(v.y+g.y)/2),_=new fabric.Point((v.x+p.x)/2,(v.y+p.y)/2),x=new fabric.Point(m.x+o*this.rotatingPointOffset,m.y-a*this.rotatingPointOffset);
return this.oCoords={tl:d,tr:g,br:v,bl:p,ml:b,mt:m,mr:y,mb:_,mtr:x},this._setCornerCoords&&this._setCornerCoords(),this},_calcRotateMatrix:function(){if(this.angle){var t=e(this.angle),i=Math.cos(t),r=Math.sin(t);return[i,r,-r,i,0,0]}return[1,0,0,1,0,0]},calcTransformMatrix:function(){var t=this.getCenterPoint(),e=[1,0,0,1,t.x,t.y],r=this._calcRotateMatrix(),n=this._calcDimensionsTransformMatrix(this.skewX,this.skewY,!0),s=this.group?this.group.calcTransformMatrix():[1,0,0,1,0,0];return s=i(s,e),s=i(s,r),s=i(s,n)},_calcDimensionsTransformMatrix:function(t,r,n){var s=[1,0,Math.tan(e(t)),1],o=[1,Math.tan(e(r)),0,1],a=this.scaleX*(n&&this.flipX?-1:1),h=this.scaleY*(n&&this.flipY?-1:1),c=[a,0,0,h],l=i(c,s,!0);return i(l,o,!0)}})}(),fabric.util.object.extend(fabric.Object.prototype,{sendToBack:function(){return this.group?fabric.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?fabric.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas.bringToFront(this),this},sendBackwards:function(t){return this.group?fabric.StaticCanvas.prototype.sendBackwards.call(this.group,this,t):this.canvas.sendBackwards(this,t),this},bringForward:function(t){return this.group?fabric.StaticCanvas.prototype.bringForward.call(this.group,this,t):this.canvas.bringForward(this,t),this},moveTo:function(t){return this.group?fabric.StaticCanvas.prototype.moveTo.call(this.group,this,t):this.canvas.moveTo(this,t),this}}),function(){function t(t,e){if(e){if(e.toLive)return t+": url(#SVGID_"+e.id+"); ";var i=new fabric.Color(e),r=t+": "+i.toRgb()+"; ",n=i.getAlpha();return 1!==n&&(r+=t+"-opacity: "+n.toString()+"; "),r}return t+": none; "}fabric.util.object.extend(fabric.Object.prototype,{getSvgStyles:function(e){var i=this.fillRule,r=this.strokeWidth?this.strokeWidth:"0",n=this.strokeDashArray?this.strokeDashArray.join(" "):"none",s=this.strokeLineCap?this.strokeLineCap:"butt",o=this.strokeLineJoin?this.strokeLineJoin:"miter",a=this.strokeMiterLimit?this.strokeMiterLimit:"4",h="undefined"!=typeof this.opacity?this.opacity:"1",c=this.visible?"":" visibility: hidden;",l=e?"":this.getSvgFilter(),u=t("fill",this.fill),f=t("stroke",this.stroke);return[f,"stroke-width: ",r,"; ","stroke-dasharray: ",n,"; ","stroke-linecap: ",s,"; ","stroke-linejoin: ",o,"; ","stroke-miterlimit: ",a,"; ",u,"fill-rule: ",i,"; ","opacity: ",h,";",l,c].join("")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgId:function(){return this.id?'id="'+this.id+'" ':""},getSvgTransform:function(){if(this.group&&"path-group"===this.group.type)return"";var t=fabric.util.toFixed,e=this.getAngle(),i=this.getSkewX()%360,r=this.getSkewY()%360,n=this.getCenterPoint(),s=fabric.Object.NUM_FRACTION_DIGITS,o="path-group"===this.type?"":"translate("+t(n.x,s)+" "+t(n.y,s)+")",a=0!==e?" rotate("+t(e,s)+")":"",h=1===this.scaleX&&1===this.scaleY?"":" scale("+t(this.scaleX,s)+" "+t(this.scaleY,s)+")",c=0!==i?" skewX("+t(i,s)+")":"",l=0!==r?" skewY("+t(r,s)+")":"",u="path-group"===this.type?this.width:0,f=this.flipX?" matrix(-1 0 0 1 "+u+" 0) ":"",d="path-group"===this.type?this.height:0,g=this.flipY?" matrix(1 0 0 -1 0 "+d+")":"";return[o,a,h,f,g,c,l].join("")},getSvgTransformMatrix:function(){return this.transformMatrix?" matrix("+this.transformMatrix.join(" ")+") ":""},_createBaseSVGMarkup:function(){var t=[];return this.fill&&this.fill.toLive&&t.push(this.fill.toSVG(this,!1)),this.stroke&&this.stroke.toLive&&t.push(this.stroke.toSVG(this,!1)),this.shadow&&t.push(this.shadow.toSVG(this)),t}})}(),function(){function t(t,e,r){var n={},s=!0;r.forEach(function(e){n[e]=t[e]}),i(t[e],n,s)}function e(t,i){if(!fabric.isLikelyNode&&t instanceof Element)return t===i;if(t instanceof Array){if(t.length!==i.length)return!1;var r=i.concat().sort(),n=t.concat().sort();return!n.some(function(t,i){return!e(r[i],t)})}if(t instanceof Object){for(var s in t)if(!e(t[s],i[s]))return!1;return!0}return t===i}var i=fabric.util.object.extend;fabric.util.object.extend(fabric.Object.prototype,{hasStateChanged:function(){return!e(this.originalState,this)},saveState:function(e){return t(this,"originalState",this.stateProperties),e&&e.stateProperties&&t(this,"originalState",e.stateProperties),this},setupState:function(t){return this.originalState={},this.saveState(t),this}})}(),function(){var t=fabric.util.degreesToRadians,e=function(){return"undefined"!=typeof G_vmlCanvasManager};fabric.util.object.extend(fabric.Object.prototype,{_controlsVisibility:null,_findTargetCorner:function(t){if(!this.hasControls||!this.active)return!1;var e,i,r=t.x,n=t.y;this.__corner=0;for(var s in this.oCoords)if(this.isControlVisible(s)&&("mtr"!==s||this.hasRotatingPoint)&&(!this.get("lockUniScaling")||"mt"!==s&&"mr"!==s&&"mb"!==s&&"ml"!==s)&&(i=this._getImageLines(this.oCoords[s].corner),e=this._findCrossPoints({x:r,y:n},i),0!==e&&e%2===1))return this.__corner=s,s;return!1},_setCornerCoords:function(){var e,i,r=this.oCoords,n=t(45-this.angle),s=.707106*this.cornerSize,o=s*Math.cos(n),a=s*Math.sin(n);for(var h in r)e=r[h].x,i=r[h].y,r[h].corner={tl:{x:e-a,y:i-o},tr:{x:e+o,y:i-a},bl:{x:e-o,y:i+a},br:{x:e+a,y:i+o}}},_getNonTransformedDimensions:function(){var t=this.strokeWidth,e=this.width,i=this.height,r=!0,n=!0;return"line"===this.type&&"butt"===this.strokeLineCap&&(n=e,r=i),n&&(i+=i<0?-t:t),r&&(e+=e<0?-t:t),{x:e,y:i}},_getTransformedDimensions:function(t,e){"undefined"==typeof t&&(t=this.skewX),"undefined"==typeof e&&(e=this.skewY);var i,r,n=this._getNonTransformedDimensions(),s=n.x/2,o=n.y/2,a=[{x:-s,y:-o},{x:s,y:-o},{x:-s,y:o},{x:s,y:o}],h=this._calcDimensionsTransformMatrix(t,e,!1);for(i=0;i<a.length;i++)a[i]=fabric.util.transformPoint(a[i],h);return r=fabric.util.makeBoundingBoxFromPoints(a),{x:r.width,y:r.height}},_calculateCurrentDimensions:function(){var t=this.getViewportTransform(),e=this._getTransformedDimensions(),i=e.x,r=e.y,n=fabric.util.transformPoint(new fabric.Point(i,r),t,!0);return n.scalarAdd(2*this.padding)},drawSelectionBackground:function(e){if(!this.selectionBackgroundColor||this.group||!this.active)return this;e.save();var i=this.getCenterPoint(),r=this._calculateCurrentDimensions(),n=this.canvas.viewportTransform;return e.translate(i.x,i.y),e.scale(1/n[0],1/n[3]),e.rotate(t(this.angle)),e.fillStyle=this.selectionBackgroundColor,e.fillRect(-r.x/2,-r.y/2,r.x,r.y),e.restore(),this},drawBorders:function(t){if(!this.hasBorders)return this;var e=this._calculateCurrentDimensions(),i=1/this.borderScaleFactor,r=e.x+i,n=e.y+i;if(t.save(),t.strokeStyle=this.borderColor,this._setLineDash(t,this.borderDashArray,null),t.strokeRect(-r/2,-n/2,r,n),this.hasRotatingPoint&&this.isControlVisible("mtr")&&!this.get("lockRotation")&&this.hasControls){var s=-n/2;t.beginPath(),t.moveTo(0,s),t.lineTo(0,s-this.rotatingPointOffset),t.closePath(),t.stroke()}return t.restore(),this},drawBordersInGroup:function(t,e){if(!this.hasBorders)return this;var i=this._getNonTransformedDimensions(),r=fabric.util.customTransformMatrix(e.scaleX,e.scaleY,e.skewX),n=fabric.util.transformPoint(i,r),s=1/this.borderScaleFactor,o=n.x+s+2*this.padding,a=n.y+s+2*this.padding;return t.save(),this._setLineDash(t,this.borderDashArray,null),t.strokeStyle=this.borderColor,t.strokeRect(-o/2,-a/2,o,a),t.restore(),this},drawControls:function(t){if(!this.hasControls)return this;var e=this._calculateCurrentDimensions(),i=e.x,r=e.y,n=this.cornerSize,s=-(i+n)/2,o=-(r+n)/2,a=this.transparentCorners?"stroke":"fill";return t.save(),t.strokeStyle=t.fillStyle=this.cornerColor,this.transparentCorners||(t.strokeStyle=this.cornerStrokeColor),this._setLineDash(t,this.cornerDashArray,null),this._drawControl("tl",t,a,s,o),this._drawControl("tr",t,a,s+i,o),this._drawControl("bl",t,a,s,o+r),this._drawControl("br",t,a,s+i,o+r),this.get("lockUniScaling")||(this._drawControl("mt",t,a,s+i/2,o),this._drawControl("mb",t,a,s+i/2,o+r),this._drawControl("mr",t,a,s+i,o+r/2),this._drawControl("ml",t,a,s,o+r/2)),this.hasRotatingPoint&&this._drawControl("mtr",t,a,s+i/2,o-this.rotatingPointOffset),t.restore(),this},_drawControl:function(t,i,r,n,s){if(this.isControlVisible(t)){var o=this.cornerSize,a=!this.transparentCorners&&this.cornerStrokeColor;switch(this.cornerStyle){case"circle":i.beginPath(),i.arc(n+o/2,s+o/2,o/2,0,2*Math.PI,!1),i[r](),a&&i.stroke();break;default:e()||this.transparentCorners||i.clearRect(n,s,o,o),i[r+"Rect"](n,s,o,o),a&&i.strokeRect(n,s,o,o)}}},isControlVisible:function(t){return this._getControlsVisibility()[t]},setControlVisible:function(t,e){return this._getControlsVisibility()[t]=e,this},setControlsVisibility:function(t){t||(t={});for(var e in t)this.setControlVisible(e,t[e]);return this},_getControlsVisibility:function(){return this._controlsVisibility||(this._controlsVisibility={tl:!0,tr:!0,br:!0,bl:!0,ml:!0,mt:!0,mr:!0,mb:!0,mtr:!0}),this._controlsVisibility}})}(),fabric.util.object.extend(fabric.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(t,e){e=e||{};var i=function(){},r=e.onComplete||i,n=e.onChange||i,s=this;return fabric.util.animate({startValue:t.get("left"),endValue:this.getCenter().left,duration:this.FX_DURATION,onChange:function(e){t.set("left",e),s.renderAll(),n()},onComplete:function(){t.setCoords(),r()}}),this},fxCenterObjectV:function(t,e){e=e||{};var i=function(){},r=e.onComplete||i,n=e.onChange||i,s=this;return fabric.util.animate({startValue:t.get("top"),endValue:this.getCenter().top,duration:this.FX_DURATION,onChange:function(e){t.set("top",e),s.renderAll(),n()},onComplete:function(){t.setCoords(),r()}}),this},fxRemove:function(t,e){e=e||{};var i=function(){},r=e.onComplete||i,n=e.onChange||i,s=this;return fabric.util.animate({startValue:t.get("opacity"),endValue:0,duration:this.FX_DURATION,onStart:function(){t.set("active",!1)},onChange:function(e){t.set("opacity",e),s.renderAll(),n()},onComplete:function(){s.remove(t),r()}}),this}}),fabric.util.object.extend(fabric.Object.prototype,{animate:function(){if(arguments[0]&&"object"==typeof arguments[0]){var t,e,i=[];for(t in arguments[0])i.push(t);for(var r=0,n=i.length;r<n;r++)t=i[r],e=r!==n-1,this._animate(t,arguments[0][t],arguments[1],e)}else this._animate.apply(this,arguments);return this},_animate:function(t,e,i,r){var n,s=this;e=e.toString(),i=i?fabric.util.object.clone(i):{},~t.indexOf(".")&&(n=t.split("."));var o=n?this.get(n[0])[n[1]]:this.get(t);"from"in i||(i.from=o),e=~e.indexOf("=")?o+parseFloat(e.replace("=","")):parseFloat(e),fabric.util.animate({startValue:i.from,endValue:e,byValue:i.by,easing:i.easing,duration:i.duration,abort:i.abort&&function(){return i.abort.call(s)},onChange:function(e){n?s[n[0]][n[1]]=e:s.set(t,e),r||i.onChange&&i.onChange()},onComplete:function(){r||(s.setCoords(),i.onComplete&&i.onComplete())}})}}),function(t){"use strict";function e(t,e){var i=t.origin,r=t.axis1,n=t.axis2,s=t.dimension,o=e.nearest,a=e.center,h=e.farthest;return function(){switch(this.get(i)){case o:return Math.min(this.get(r),this.get(n));case a:return Math.min(this.get(r),this.get(n))+.5*this.get(s);case h:return Math.max(this.get(r),this.get(n))}}}var i=t.fabric||(t.fabric={}),r=i.util.object.extend,n={x1:1,x2:1,y1:1,y2:1},s=i.StaticCanvas.supports("setLineDash");return i.Line?void i.warn("fabric.Line is already defined"):(i.Line=i.util.createClass(i.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,initialize:function(t,e){e=e||{},t||(t=[0,0,0,0]),this.callSuper("initialize",e),this.set("x1",t[0]),this.set("y1",t[1]),this.set("x2",t[2]),this.set("y2",t[3]),this._setWidthHeight(e)},_setWidthHeight:function(t){t||(t={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in t?t.left:this._getLeftToOriginX(),this.top="top"in t?t.top:this._getTopToOriginY()},_set:function(t,e){return this.callSuper("_set",t,e),"undefined"!=typeof n[t]&&this._setWidthHeight(),this},_getLeftToOriginX:e({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:e({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(t,e){if(t.beginPath(),e){var i=this.getCenterPoint();t.translate(i.x-this.strokeWidth/2,i.y-this.strokeWidth/2)}if(!this.strokeDashArray||this.strokeDashArray&&s){var r=this.calcLinePoints();t.moveTo(r.x1,r.y1),t.lineTo(r.x2,r.y2)}t.lineWidth=this.strokeWidth;var n=t.strokeStyle;t.strokeStyle=this.stroke||t.fillStyle,this.stroke&&this._renderStroke(t),t.strokeStyle=n},_renderDashedStroke:function(t){var e=this.calcLinePoints();t.beginPath(),i.util.drawDashedLine(t,e.x1,e.y1,e.x2,e.y2,this.strokeDashArray),t.closePath()},toObject:function(t){return r(this.callSuper("toObject",t),this.calcLinePoints())},calcLinePoints:function(){var t=this.x1<=this.x2?-1:1,e=this.y1<=this.y2?-1:1,i=t*this.width*.5,r=e*this.height*.5,n=t*this.width*-.5,s=e*this.height*-.5;return{x1:i,x2:n,y1:r,y2:s}},toSVG:function(t){var e=this._createBaseSVGMarkup(),i={x1:this.x1,x2:this.x2,y1:this.y1,y2:this.y2};return this.group&&"path-group"===this.group.type||(i=this.calcLinePoints()),e.push("<line ",this.getSvgId(),'x1="',i.x1,'" y1="',i.y1,'" x2="',i.x2,'" y2="',i.y2,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'"/>\n'),t?t(e.join("")):e.join("")},complexity:function(){return 1}}),i.Line.ATTRIBUTE_NAMES=i.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),i.Line.fromElement=function(t,e){var n=i.parseAttributes(t,i.Line.ATTRIBUTE_NAMES),s=[n.x1||0,n.y1||0,n.x2||0,n.y2||0];return new i.Line(s,r(n,e))},void(i.Line.fromObject=function(t,e){var r=[t.x1,t.y1,t.x2,t.y2],n=new i.Line(r,t);return e&&e(n),n}))}("undefined"!=typeof exports?exports:this),function(t){"use strict";function e(t){return"radius"in t&&t.radius>=0}var i=t.fabric||(t.fabric={}),r=Math.PI,n=i.util.object.extend;return i.Circle?void i.warn("fabric.Circle is already defined."):(i.Circle=i.util.createClass(i.Object,{type:"circle",radius:0,startAngle:0,endAngle:2*r,initialize:function(t){t=t||{},this.callSuper("initialize",t),this.set("radius",t.radius||0),this.startAngle=t.startAngle||this.startAngle,this.endAngle=t.endAngle||this.endAngle},_set:function(t,e){return this.callSuper("_set",t,e),"radius"===t&&this.setRadius(e),this},toObject:function(t){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(t))},toSVG:function(t){var e=this._createBaseSVGMarkup(),i=0,n=0,s=(this.endAngle-this.startAngle)%(2*r);if(0===s)this.group&&"path-group"===this.group.type&&(i=this.left+this.radius,n=this.top+this.radius),e.push("<circle ",this.getSvgId(),'cx="'+i+'" cy="'+n+'" ','r="',this.radius,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform()," ",this.getSvgTransformMatrix(),'"/>\n');else{var o=Math.cos(this.startAngle)*this.radius,a=Math.sin(this.startAngle)*this.radius,h=Math.cos(this.endAngle)*this.radius,c=Math.sin(this.endAngle)*this.radius,l=s>r?"1":"0";e.push('<path d="M '+o+" "+a," A "+this.radius+" "+this.radius," 0 ",+l+" 1"," "+h+" "+c,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform()," ",this.getSvgTransformMatrix(),'"/>\n')}return t?t(e.join("")):e.join("")},_render:function(t,e){t.beginPath(),t.arc(e?this.left+this.radius:0,e?this.top+this.radius:0,this.radius,this.startAngle,this.endAngle,!1),this._renderFill(t),this._renderStroke(t)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(t){return this.radius=t,this.set("width",2*t).set("height",2*t)},complexity:function(){return 1}}),i.Circle.ATTRIBUTE_NAMES=i.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),i.Circle.fromElement=function(t,r){r||(r={});var s=i.parseAttributes(t,i.Circle.ATTRIBUTE_NAMES);if(!e(s))throw new Error("value of `r` attribute is required and can not be negative");s.left=s.left||0,s.top=s.top||0;var o=new i.Circle(n(s,r));return o.left-=o.radius,o.top-=o.radius,o},void(i.Circle.fromObject=function(t,e){var r=new i.Circle(t);return e&&e(r),r}))}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={});return e.Triangle?void e.warn("fabric.Triangle is already defined"):(e.Triangle=e.util.createClass(e.Object,{type:"triangle",initialize:function(t){t=t||{},this.callSuper("initialize",t),this.set("width",t.width||100).set("height",t.height||100)},_render:function(t){var e=this.width/2,i=this.height/2;t.beginPath(),t.moveTo(-e,i),t.lineTo(0,-i),t.lineTo(e,i),t.closePath(),this._renderFill(t),this._renderStroke(t)},_renderDashedStroke:function(t){var i=this.width/2,r=this.height/2;t.beginPath(),e.util.drawDashedLine(t,-i,r,0,-r,this.strokeDashArray),e.util.drawDashedLine(t,0,-r,i,r,this.strokeDashArray),e.util.drawDashedLine(t,i,r,-i,r,this.strokeDashArray),t.closePath()},toSVG:function(t){var e=this._createBaseSVGMarkup(),i=this.width/2,r=this.height/2,n=[-i+" "+r,"0 "+-r,i+" "+r].join(",");return e.push("<polygon ",this.getSvgId(),'points="',n,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),'"/>'),t?t(e.join("")):e.join("")},complexity:function(){return 1}}),void(e.Triangle.fromObject=function(t,i){var r=new e.Triangle(t);return i&&i(r),r}))}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=2*Math.PI,r=e.util.object.extend;return e.Ellipse?void e.warn("fabric.Ellipse is already defined."):(e.Ellipse=e.util.createClass(e.Object,{type:"ellipse",rx:0,ry:0,initialize:function(t){t=t||{},this.callSuper("initialize",t),this.set("rx",t.rx||0),this.set("ry",t.ry||0)},_set:function(t,e){switch(this.callSuper("_set",t,e),t){case"rx":this.rx=e,this.set("width",2*e);break;case"ry":this.ry=e,this.set("height",2*e)}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(t){return this.callSuper("toObject",["rx","ry"].concat(t))},toSVG:function(t){var e=this._createBaseSVGMarkup(),i=0,r=0;return this.group&&"path-group"===this.group.type&&(i=this.left+this.rx,r=this.top+this.ry),e.push("<ellipse ",this.getSvgId(),'cx="',i,'" cy="',r,'" ','rx="',this.rx,'" ry="',this.ry,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'"/>\n'),t?t(e.join("")):e.join("")},_render:function(t,e){t.beginPath(),t.save(),t.transform(1,0,0,this.ry/this.rx,0,0),t.arc(e?this.left+this.rx:0,e?(this.top+this.ry)*this.rx/this.ry:0,this.rx,0,i,!1),t.restore(),this._renderFill(t),this._renderStroke(t)},complexity:function(){return 1}}),e.Ellipse.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),e.Ellipse.fromElement=function(t,i){i||(i={});var n=e.parseAttributes(t,e.Ellipse.ATTRIBUTE_NAMES);n.left=n.left||0,n.top=n.top||0;var s=new e.Ellipse(r(n,i));return s.top-=s.ry,s.left-=s.rx,s},void(e.Ellipse.fromObject=function(t,i){var r=new e.Ellipse(t);return i&&i(r),r}))}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;if(e.Rect)return void e.warn("fabric.Rect is already defined");var r=e.Object.prototype.stateProperties.concat();r.push("rx","ry","x","y"),e.Rect=e.util.createClass(e.Object,{stateProperties:r,type:"rect",rx:0,ry:0,strokeDashArray:null,initialize:function(t){t=t||{},this.callSuper("initialize",t),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(t,e){if(1===this.width&&1===this.height)return void t.fillRect(-.5,-.5,1,1);var i=this.rx?Math.min(this.rx,this.width/2):0,r=this.ry?Math.min(this.ry,this.height/2):0,n=this.width,s=this.height,o=e?this.left:-this.width/2,a=e?this.top:-this.height/2,h=0!==i||0!==r,c=.4477152502;t.beginPath(),t.moveTo(o+i,a),t.lineTo(o+n-i,a),h&&t.bezierCurveTo(o+n-c*i,a,o+n,a+c*r,o+n,a+r),t.lineTo(o+n,a+s-r),h&&t.bezierCurveTo(o+n,a+s-c*r,o+n-c*i,a+s,o+n-i,a+s),t.lineTo(o+i,a+s),h&&t.bezierCurveTo(o+c*i,a+s,o,a+s-c*r,o,a+s-r),t.lineTo(o,a+r),h&&t.bezierCurveTo(o,a+c*r,o+c*i,a,o+i,a),t.closePath(),this._renderFill(t),this._renderStroke(t)},_renderDashedStroke:function(t){var i=-this.width/2,r=-this.height/2,n=this.width,s=this.height;t.beginPath(),e.util.drawDashedLine(t,i,r,i+n,r,this.strokeDashArray),e.util.drawDashedLine(t,i+n,r,i+n,r+s,this.strokeDashArray),e.util.drawDashedLine(t,i+n,r+s,i,r+s,this.strokeDashArray),e.util.drawDashedLine(t,i,r+s,i,r,this.strokeDashArray),t.closePath()},toObject:function(t){return this.callSuper("toObject",["rx","ry"].concat(t))},toSVG:function(t){var e=this._createBaseSVGMarkup(),i=this.left,r=this.top;return this.group&&"path-group"===this.group.type||(i=-this.width/2,r=-this.height/2),e.push("<rect ",this.getSvgId(),'x="',i,'" y="',r,'" rx="',this.get("rx"),'" ry="',this.get("ry"),'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'"/>\n'),t?t(e.join("")):e.join("")},complexity:function(){return 1}}),e.Rect.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),e.Rect.fromElement=function(t,r){if(!t)return null;r=r||{};var n=e.parseAttributes(t,e.Rect.ATTRIBUTE_NAMES);n.left=n.left||0,n.top=n.top||0;var s=new e.Rect(i(r?e.util.object.clone(r):{},n));return s.visible=s.visible&&s.width>0&&s.height>0,s},e.Rect.fromObject=function(t,i){var r=new e.Rect(t);return i&&i(r),r}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={});return e.Polyline?void e.warn("fabric.Polyline is already defined"):(e.Polyline=e.util.createClass(e.Object,{type:"polyline",points:null,minX:0,minY:0,initialize:function(t,i){return e.Polygon.prototype.initialize.call(this,t,i)},_calcDimensions:function(){return e.Polygon.prototype._calcDimensions.call(this)},toObject:function(t){return e.Polygon.prototype.toObject.call(this,t)},toSVG:function(t){return e.Polygon.prototype.toSVG.call(this,t)},_render:function(t,i){e.Polygon.prototype.commonRender.call(this,t,i)&&(this._renderFill(t),this._renderStroke(t))},_renderDashedStroke:function(t){var i,r;t.beginPath();for(var n=0,s=this.points.length;n<s;n++)i=this.points[n],r=this.points[n+1]||i,e.util.drawDashedLine(t,i.x,i.y,r.x,r.y,this.strokeDashArray)},complexity:function(){return this.get("points").length}}),e.Polyline.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(),e.Polyline.fromElement=function(t,i){if(!t)return null;i||(i={});var r=e.parsePointsAttribute(t.getAttribute("points")),n=e.parseAttributes(t,e.Polyline.ATTRIBUTE_NAMES);return new e.Polyline(r,e.util.object.extend(n,i))},void(e.Polyline.fromObject=function(t,i){var r=new e.Polyline(t.points,t);return i&&i(r),r}))}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.util.array.min,n=e.util.array.max,s=e.util.toFixed;return e.Polygon?void e.warn("fabric.Polygon is already defined"):(e.Polygon=e.util.createClass(e.Object,{type:"polygon",points:null,minX:0,minY:0,initialize:function(t,e){e=e||{},this.points=t||[],this.callSuper("initialize",e),this._calcDimensions(),"top"in e||(this.top=this.minY),"left"in e||(this.left=this.minX),this.pathOffset={x:this.minX+this.width/2,y:this.minY+this.height/2}},_calcDimensions:function(){var t=this.points,e=r(t,"x"),i=r(t,"y"),s=n(t,"x"),o=n(t,"y");this.width=s-e||0,this.height=o-i||0,this.minX=e||0,this.minY=i||0},toObject:function(t){return i(this.callSuper("toObject",t),{points:this.points.concat()})},toSVG:function(t){for(var e,i=[],r=this._createBaseSVGMarkup(),n=0,o=this.points.length;n<o;n++)i.push(s(this.points[n].x,2),",",s(this.points[n].y,2)," ");return this.group&&"path-group"===this.group.type||(e=" translate("+-this.pathOffset.x+", "+-this.pathOffset.y+") "),r.push("<",this.type," ",this.getSvgId(),'points="',i.join(""),'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),e," ",this.getSvgTransformMatrix(),'"/>\n'),t?t(r.join("")):r.join("")},_render:function(t,e){this.commonRender(t,e)&&(this._renderFill(t),(this.stroke||this.strokeDashArray)&&(t.closePath(),this._renderStroke(t)))},commonRender:function(t,e){var i,r=this.points.length;if(!r||isNaN(this.points[r-1].y))return!1;e||t.translate(-this.pathOffset.x,-this.pathOffset.y),t.beginPath(),t.moveTo(this.points[0].x,this.points[0].y);for(var n=0;n<r;n++)i=this.points[n],t.lineTo(i.x,i.y);return!0},_renderDashedStroke:function(t){e.Polyline.prototype._renderDashedStroke.call(this,t),t.closePath()},complexity:function(){return this.points.length}}),e.Polygon.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(),e.Polygon.fromElement=function(t,r){if(!t)return null;r||(r={});var n=e.parsePointsAttribute(t.getAttribute("points")),s=e.parseAttributes(t,e.Polygon.ATTRIBUTE_NAMES);return new e.Polygon(n,i(s,r))},void(e.Polygon.fromObject=function(t,i){var r=new e.Polygon(t.points,t);return i&&i(r),r}))}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.array.min,r=e.util.array.max,n=e.util.object.extend,s=Object.prototype.toString,o=e.util.drawArc,a={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},h={m:"l",M:"L"};return e.Path?void e.warn("fabric.Path is already defined"):(e.Path=e.util.createClass(e.Object,{type:"path",path:null,minX:0,minY:0,initialize:function(t,e){e=e||{},this.setOptions(e),t||(t=[]);var i="[object Array]"===s.call(t);this.path=i?t:t.match&&t.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi),this.path&&(i||(this.path=this._parsePath()),this._setPositionDimensions(e),e.sourcePath&&this.setSourcePath(e.sourcePath))},_setPositionDimensions:function(t){var e=this._parseDimensions();this.minX=e.left,this.minY=e.top,this.width=e.width,this.height=e.height,"undefined"==typeof t.left&&(this.left=e.left+("center"===this.originX?this.width/2:"right"===this.originX?this.width:0)),"undefined"==typeof t.top&&(this.top=e.top+("center"===this.originY?this.height/2:"bottom"===this.originY?this.height:0)),this.pathOffset=this.pathOffset||{x:this.minX+this.width/2,y:this.minY+this.height/2}},_renderPathCommands:function(t){var e,i,r,n=null,s=0,a=0,h=0,c=0,l=0,u=0,f=-this.pathOffset.x,d=-this.pathOffset.y;this.group&&"path-group"===this.group.type&&(f=0,d=0),t.beginPath();for(var g=0,p=this.path.length;g<p;++g){switch(e=this.path[g],e[0]){case"l":h+=e[1],c+=e[2],t.lineTo(h+f,c+d);break;case"L":h=e[1],c=e[2],t.lineTo(h+f,c+d);break;case"h":h+=e[1],t.lineTo(h+f,c+d);break;case"H":h=e[1],t.lineTo(h+f,c+d);break;case"v":c+=e[1],t.lineTo(h+f,c+d);break;case"V":c=e[1],t.lineTo(h+f,c+d);break;case"m":h+=e[1],c+=e[2],s=h,a=c,t.moveTo(h+f,c+d);break;case"M":h=e[1],c=e[2],s=h,a=c,t.moveTo(h+f,c+d);break;case"c":i=h+e[5],r=c+e[6],l=h+e[3],u=c+e[4],t.bezierCurveTo(h+e[1]+f,c+e[2]+d,l+f,u+d,i+f,r+d),h=i,c=r;break;case"C":h=e[5],c=e[6],l=e[3],u=e[4],t.bezierCurveTo(e[1]+f,e[2]+d,l+f,u+d,h+f,c+d);break;case"s":i=h+e[3],r=c+e[4],null===n[0].match(/[CcSs]/)?(l=h,u=c):(l=2*h-l,u=2*c-u),t.bezierCurveTo(l+f,u+d,h+e[1]+f,c+e[2]+d,i+f,r+d),l=h+e[1],u=c+e[2],h=i,c=r;break;case"S":i=e[3],r=e[4],null===n[0].match(/[CcSs]/)?(l=h,u=c):(l=2*h-l,u=2*c-u),t.bezierCurveTo(l+f,u+d,e[1]+f,e[2]+d,i+f,r+d),h=i,c=r,l=e[1],u=e[2];break;case"q":i=h+e[3],r=c+e[4],l=h+e[1],u=c+e[2],t.quadraticCurveTo(l+f,u+d,i+f,r+d),h=i,c=r;break;case"Q":i=e[3],r=e[4],t.quadraticCurveTo(e[1]+f,e[2]+d,i+f,r+d),h=i,c=r,l=e[1],u=e[2];break;case"t":i=h+e[1],r=c+e[2],null===n[0].match(/[QqTt]/)?(l=h,u=c):(l=2*h-l,u=2*c-u),t.quadraticCurveTo(l+f,u+d,i+f,r+d),h=i,c=r;break;case"T":i=e[1],r=e[2],null===n[0].match(/[QqTt]/)?(l=h,u=c):(l=2*h-l,u=2*c-u),t.quadraticCurveTo(l+f,u+d,i+f,r+d),h=i,c=r;break;case"a":o(t,h+f,c+d,[e[1],e[2],e[3],e[4],e[5],e[6]+h+f,e[7]+c+d]),h+=e[6],c+=e[7];break;case"A":o(t,h+f,c+d,[e[1],e[2],e[3],e[4],e[5],e[6]+f,e[7]+d]),h=e[6],c=e[7];break;case"z":case"Z":h=s,c=a,t.closePath()}n=e}},_render:function(t){this._renderPathCommands(t),this._renderFill(t),this._renderStroke(t)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(t){var e=n(this.callSuper("toObject",["sourcePath","pathOffset"].concat(t)),{path:this.path.map(function(t){return t.slice()})});return e},toDatalessObject:function(t){var e=this.toObject(t);return this.sourcePath&&(e.path=this.sourcePath),delete e.sourcePath,e},toSVG:function(t){for(var e=[],i=this._createBaseSVGMarkup(),r="",n=0,s=this.path.length;n<s;n++)e.push(this.path[n].join(" "));var o=e.join(" ");return this.group&&"path-group"===this.group.type||(r=" translate("+-this.pathOffset.x+", "+-this.pathOffset.y+") "),i.push("<path ",this.getSvgId(),'d="',o,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),r,this.getSvgTransformMatrix(),'" stroke-linecap="round" ',"/>\n"),t?t(i.join("")):i.join("")},complexity:function(){return this.path.length},_parsePath:function(){for(var t,e,i,r,n,s=[],o=[],c=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi,l=0,u=this.path.length;l<u;l++){for(t=this.path[l],r=t.slice(1).trim(),o.length=0;i=c.exec(r);)o.push(i[0]);n=[t.charAt(0)];for(var f=0,d=o.length;f<d;f++)e=parseFloat(o[f]),isNaN(e)||n.push(e);var g=n[0],p=a[g.toLowerCase()],v=h[g]||g;if(n.length-1>p)for(var b=1,m=n.length;b<m;b+=p)s.push([g].concat(n.slice(b,b+p))),g=v;else s.push(n)}return s},_parseDimensions:function(){for(var t,n,s,o,a=[],h=[],c=null,l=0,u=0,f=0,d=0,g=0,p=0,v=0,b=this.path.length;v<b;++v){switch(t=this.path[v],t[0]){case"l":f+=t[1],d+=t[2],o=[];break;case"L":f=t[1],d=t[2],o=[];break;case"h":f+=t[1],o=[];break;case"H":f=t[1],o=[];break;case"v":d+=t[1],o=[];break;case"V":d=t[1],o=[];break;case"m":f+=t[1],d+=t[2],l=f,u=d,o=[];break;case"M":f=t[1],d=t[2],l=f,u=d,o=[];break;case"c":n=f+t[5],s=d+t[6],g=f+t[3],p=d+t[4],o=e.util.getBoundsOfCurve(f,d,f+t[1],d+t[2],g,p,n,s),f=n,d=s;break;case"C":f=t[5],d=t[6],g=t[3],p=t[4],o=e.util.getBoundsOfCurve(f,d,t[1],t[2],g,p,f,d);break;case"s":n=f+t[3],s=d+t[4],null===c[0].match(/[CcSs]/)?(g=f,p=d):(g=2*f-g,p=2*d-p),o=e.util.getBoundsOfCurve(f,d,g,p,f+t[1],d+t[2],n,s),g=f+t[1],p=d+t[2],f=n,d=s;break;case"S":n=t[3],s=t[4],null===c[0].match(/[CcSs]/)?(g=f,p=d):(g=2*f-g,p=2*d-p),o=e.util.getBoundsOfCurve(f,d,g,p,t[1],t[2],n,s),f=n,d=s,g=t[1],p=t[2];break;case"q":n=f+t[3],s=d+t[4],g=f+t[1],p=d+t[2],o=e.util.getBoundsOfCurve(f,d,g,p,g,p,n,s),f=n,d=s;break;case"Q":g=t[1],p=t[2],o=e.util.getBoundsOfCurve(f,d,g,p,g,p,t[3],t[4]),f=t[3],d=t[4];break;case"t":n=f+t[1],s=d+t[2],null===c[0].match(/[QqTt]/)?(g=f,p=d):(g=2*f-g,p=2*d-p),o=e.util.getBoundsOfCurve(f,d,g,p,g,p,n,s),f=n,d=s;break;case"T":n=t[1],s=t[2],null===c[0].match(/[QqTt]/)?(g=f,p=d):(g=2*f-g,p=2*d-p),o=e.util.getBoundsOfCurve(f,d,g,p,g,p,n,s),f=n,d=s;break;case"a":o=e.util.getBoundsOfArc(f,d,t[1],t[2],t[3],t[4],t[5],t[6]+f,t[7]+d),f+=t[6],d+=t[7];break;case"A":o=e.util.getBoundsOfArc(f,d,t[1],t[2],t[3],t[4],t[5],t[6],t[7]),f=t[6],d=t[7];break;case"z":case"Z":f=l,d=u}c=t,o.forEach(function(t){a.push(t.x),h.push(t.y)}),a.push(f),h.push(d)}var m=i(a)||0,y=i(h)||0,_=r(a)||0,x=r(h)||0,S=_-m,C=x-y,w={left:m,top:y,width:S,height:C};return w}}),e.Path.fromObject=function(t,i){var r;return"string"!=typeof t.path?(r=new e.Path(t.path,t),i&&i(r),r):void e.loadSVGFromURL(t.path,function(n){var s=t.path;r=n[0],delete t.path,e.util.object.extend(r,t),r.setSourcePath(s),i&&i(r)})},e.Path.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(["d"]),e.Path.fromElement=function(t,i,r){var s=e.parseAttributes(t,e.Path.ATTRIBUTE_NAMES);i&&i(new e.Path(s.d,n(s,r)))},void(e.Path.async=!0))}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.util.array.invoke,n=e.Object.prototype.toObject;return e.PathGroup?void e.warn("fabric.PathGroup is already defined"):(e.PathGroup=e.util.createClass(e.Path,{type:"path-group",fill:"",initialize:function(t,e){e=e||{},this.paths=t||[];for(var i=this.paths.length;i--;)this.paths[i].group=this;
e.toBeParsed&&(this.parseDimensionsFromPaths(e),delete e.toBeParsed),this.setOptions(e),this.setCoords(),e.sourcePath&&this.setSourcePath(e.sourcePath)},parseDimensionsFromPaths:function(t){for(var i,r,n,s,o,a,h=[],c=[],l=this.paths.length;l--;){n=this.paths[l],s=n.height+n.strokeWidth,o=n.width+n.strokeWidth,i=[{x:n.left,y:n.top},{x:n.left+o,y:n.top},{x:n.left,y:n.top+s},{x:n.left+o,y:n.top+s}],a=this.paths[l].transformMatrix;for(var u=0;u<i.length;u++)r=i[u],a&&(r=e.util.transformPoint(r,a,!1)),h.push(r.x),c.push(r.y)}t.width=Math.max.apply(null,h),t.height=Math.max.apply(null,c)},render:function(t){if(this.visible){t.save(),this.transformMatrix&&t.transform.apply(t,this.transformMatrix),this.transform(t),this._setShadow(t),this.clipTo&&e.util.clipContext(this,t),t.translate(-this.width/2,-this.height/2);for(var i=0,r=this.paths.length;i<r;++i)this.paths[i].render(t,!0);this.clipTo&&t.restore(),t.restore()}},_set:function(t,e){if("fill"===t&&e&&this.isSameColor())for(var i=this.paths.length;i--;)this.paths[i]._set(t,e);return this.callSuper("_set",t,e)},toObject:function(t){var e=i(n.call(this,["sourcePath"].concat(t)),{paths:r(this.getObjects(),"toObject",t)});return e},toDatalessObject:function(t){var e=this.toObject(t);return this.sourcePath&&(e.paths=this.sourcePath),e},toSVG:function(t){var e=this.getObjects(),i=this.getPointByOrigin("left","top"),r="translate("+i.x+" "+i.y+")",n=this._createBaseSVGMarkup();n.push("<g ",this.getSvgId(),'style="',this.getSvgStyles(),'" ','transform="',this.getSvgTransformMatrix(),r,this.getSvgTransform(),'" ',">\n");for(var s=0,o=e.length;s<o;s++)n.push("\t",e[s].toSVG(t));return n.push("</g>\n"),t?t(n.join("")):n.join("")},toString:function(){return"#<fabric.PathGroup ("+this.complexity()+"): { top: "+this.top+", left: "+this.left+" }>"},isSameColor:function(){var t=this.getObjects()[0].get("fill")||"";return"string"==typeof t&&(t=t.toLowerCase(),this.getObjects().every(function(e){var i=e.get("fill")||"";return"string"==typeof i&&i.toLowerCase()===t}))},complexity:function(){return this.paths.reduce(function(t,e){return t+(e&&e.complexity?e.complexity():0)},0)},getObjects:function(){return this.paths}}),e.PathGroup.fromObject=function(t,i){"string"==typeof t.paths?e.loadSVGFromURL(t.paths,function(r){var n=t.paths;delete t.paths;var s=e.util.groupSVGElements(r,t,n);i(s)}):e.util.enlivenObjects(t.paths,function(r){delete t.paths,i(new e.PathGroup(r,t))})},void(e.PathGroup.async=!0))}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.util.array.min,n=e.util.array.max,s=e.util.array.invoke;if(!e.Group){var o={lockMovementX:!0,lockMovementY:!0,lockRotation:!0,lockScalingX:!0,lockScalingY:!0,lockUniScaling:!0};e.Group=e.util.createClass(e.Object,e.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,initialize:function(t,e,i){e=e||{},this._objects=[],i&&this.callSuper("initialize",e),this._objects=t||[];for(var r=this._objects.length;r--;)this._objects[r].group=this;this.originalState={},e.originX&&(this.originX=e.originX),e.originY&&(this.originY=e.originY),i?this._updateObjectsCoords(!0):(this._calcBounds(),this._updateObjectsCoords(),this.callSuper("initialize",e)),this.setCoords(),this.saveCoords()},_updateObjectsCoords:function(t){for(var e=this._objects.length;e--;)this._updateObjectCoords(this._objects[e],t)},_updateObjectCoords:function(t,e){if(t.__origHasControls=t.hasControls,t.hasControls=!1,!e){var i=t.getLeft(),r=t.getTop(),n=this.getCenterPoint();t.set({originalLeft:i,originalTop:r,left:i-n.x,top:r-n.y}),t.setCoords()}},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(t){return this._restoreObjectsState(),e.util.resetObjectTransform(this),t&&(this._objects.push(t),t.group=this,t._set("canvas",this.canvas)),this.forEachObject(this._setObjectActive,this),this._calcBounds(),this._updateObjectsCoords(),this},_setObjectActive:function(t){t.set("active",!0),t.group=this},removeWithUpdate:function(t){return this._restoreObjectsState(),e.util.resetObjectTransform(this),this.forEachObject(this._setObjectActive,this),this.remove(t),this._calcBounds(),this._updateObjectsCoords(),this},_onObjectAdded:function(t){t.group=this,t._set("canvas",this.canvas)},_onObjectRemoved:function(t){delete t.group,t.set("active",!1)},delegatedProperties:{fill:!0,stroke:!0,strokeWidth:!0,fontFamily:!0,fontWeight:!0,fontSize:!0,fontStyle:!0,lineHeight:!0,textDecoration:!0,textAlign:!0,backgroundColor:!0},_set:function(t,e){var i=this._objects.length;if(this.delegatedProperties[t]||"canvas"===t)for(;i--;)this._objects[i].set(t,e);else for(;i--;)this._objects[i].setOnGroup(t,e);this.callSuper("_set",t,e)},toObject:function(t){return i(this.callSuper("toObject",t),{objects:s(this._objects,"toObject",t)})},render:function(t){if(this.visible){t.save(),this.transformMatrix&&t.transform.apply(t,this.transformMatrix),this.transform(t),this._setShadow(t),this.clipTo&&e.util.clipContext(this,t),this._transformDone=!0;for(var i=0,r=this._objects.length;i<r;i++)this._renderObject(this._objects[i],t);this.clipTo&&t.restore(),t.restore(),this._transformDone=!1}},_renderControls:function(t,e){this.callSuper("_renderControls",t,e);for(var i=0,r=this._objects.length;i<r;i++)this._objects[i]._renderControls(t)},_renderObject:function(t,e){if(t.visible){var i=t.hasRotatingPoint;t.hasRotatingPoint=!1,t.render(e),t.hasRotatingPoint=i}},_restoreObjectsState:function(){return this._objects.forEach(this._restoreObjectState,this),this},realizeTransform:function(t){var i=t.calcTransformMatrix(),r=e.util.qrDecompose(i),n=new e.Point(r.translateX,r.translateY);return t.scaleX=r.scaleX,t.scaleY=r.scaleY,t.skewX=r.skewX,t.skewY=r.skewY,t.angle=r.angle,t.flipX=!1,t.flipY=!1,t.setPositionByOrigin(n,"center","center"),t},_restoreObjectState:function(t){return this.realizeTransform(t),t.setCoords(),t.hasControls=t.__origHasControls,delete t.__origHasControls,t.set("active",!1),delete t.group,this},destroy:function(){return this._restoreObjectsState()},saveCoords:function(){return this._originalLeft=this.get("left"),this._originalTop=this.get("top"),this},hasMoved:function(){return this._originalLeft!==this.get("left")||this._originalTop!==this.get("top")},setObjectsCoords:function(){return this.forEachObject(function(t){t.setCoords()}),this},_calcBounds:function(t){for(var e,i,r,n=[],s=[],o=["tr","br","bl","tl"],a=0,h=this._objects.length,c=o.length;a<h;++a)for(e=this._objects[a],e.setCoords(),r=0;r<c;r++)i=o[r],n.push(e.oCoords[i].x),s.push(e.oCoords[i].y);this.set(this._getBounds(n,s,t))},_getBounds:function(t,i,s){var o=e.util.invertTransform(this.getViewportTransform()),a=e.util.transformPoint(new e.Point(r(t),r(i)),o),h=e.util.transformPoint(new e.Point(n(t),n(i)),o),c={width:h.x-a.x||0,height:h.y-a.y||0};return s||(c.left=a.x||0,c.top=a.y||0,"center"===this.originX&&(c.left+=c.width/2),"right"===this.originX&&(c.left+=c.width),"center"===this.originY&&(c.top+=c.height/2),"bottom"===this.originY&&(c.top+=c.height)),c},toSVG:function(t){var e=this._createBaseSVGMarkup();e.push("<g ",this.getSvgId(),'transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'" style="',this.getSvgFilter(),'">\n');for(var i=0,r=this._objects.length;i<r;i++)e.push("\t",this._objects[i].toSVG(t));return e.push("</g>\n"),t?t(e.join("")):e.join("")},get:function(t){if(t in o){if(this[t])return this[t];for(var e=0,i=this._objects.length;e<i;e++)if(this._objects[e][t])return!0;return!1}return t in this.delegatedProperties?this._objects[0]&&this._objects[0].get(t):this[t]}}),e.Group.fromObject=function(t,i){e.util.enlivenObjects(t.objects,function(r){delete t.objects,i&&i(new e.Group(r,t,!0))})},e.Group.async=!0}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=fabric.util.object.extend;if(t.fabric||(t.fabric={}),t.fabric.Image)return void fabric.warn("fabric.Image is already defined.");var i=fabric.Object.prototype.stateProperties.concat();i.push("alignX","alignY","meetOrSlice"),fabric.Image=fabric.util.createClass(fabric.Object,{type:"image",crossOrigin:"",alignX:"none",alignY:"none",meetOrSlice:"meet",strokeWidth:0,_lastScaleX:1,_lastScaleY:1,minimumScaleTrigger:.5,stateProperties:i,initialize:function(t,e,i){e||(e={}),this.filters=[],this.resizeFilters=[],this.callSuper("initialize",e),this._initElement(t,e,i)},getElement:function(){return this._element},setElement:function(t,e,i){var r,n;return this._element=t,this._originalElement=t,this._initConfig(i),0===this.resizeFilters.length?r=e:(n=this,r=function(){n.applyFilters(e,n.resizeFilters,n._filteredEl||n._originalElement,!0)}),0!==this.filters.length?this.applyFilters(r):r&&r(this),this},setCrossOrigin:function(t){return this.crossOrigin=t,this._element.crossOrigin=t,this},getOriginalSize:function(){var t=this.getElement();return{width:t.width,height:t.height}},_stroke:function(t){if(this.stroke&&0!==this.strokeWidth){var e=this.width/2,i=this.height/2;t.beginPath(),t.moveTo(-e,-i),t.lineTo(e,-i),t.lineTo(e,i),t.lineTo(-e,i),t.lineTo(-e,-i),t.closePath()}},_renderDashedStroke:function(t){var e=-this.width/2,i=-this.height/2,r=this.width,n=this.height;t.save(),this._setStrokeStyles(t),t.beginPath(),fabric.util.drawDashedLine(t,e,i,e+r,i,this.strokeDashArray),fabric.util.drawDashedLine(t,e+r,i,e+r,i+n,this.strokeDashArray),fabric.util.drawDashedLine(t,e+r,i+n,e,i+n,this.strokeDashArray),fabric.util.drawDashedLine(t,e,i+n,e,i,this.strokeDashArray),t.closePath(),t.restore()},toObject:function(t){var i=[],r=[],n=1,s=1;this.filters.forEach(function(t){t&&("Resize"===t.type&&(n*=t.scaleX,s*=t.scaleY),i.push(t.toObject()))}),this.resizeFilters.forEach(function(t){t&&r.push(t.toObject())});var o=e(this.callSuper("toObject",["crossOrigin","alignX","alignY","meetOrSlice"].concat(t)),{src:this.getSrc(),filters:i,resizeFilters:r});return o.width/=n,o.height/=s,o},toSVG:function(t){var e=this._createBaseSVGMarkup(),i=-this.width/2,r=-this.height/2,n="none",s=!0;if(this.group&&"path-group"===this.group.type&&(i=this.left,r=this.top),"none"!==this.alignX&&"none"!==this.alignY&&(n="x"+this.alignX+"Y"+this.alignY+" "+this.meetOrSlice),e.push('<g transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'">\n',"<image ",this.getSvgId(),'xlink:href="',this.getSvgSrc(s),'" x="',i,'" y="',r,'" style="',this.getSvgStyles(),'" width="',this.width,'" height="',this.height,'" preserveAspectRatio="',n,'"',"></image>\n"),this.stroke||this.strokeDashArray){var o=this.fill;this.fill=null,e.push("<rect ",'x="',i,'" y="',r,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'"/>\n'),this.fill=o}return e.push("</g>\n"),t?t(e.join("")):e.join("")},getSrc:function(t){var e=t?this._element:this._originalElement;return e?fabric.isLikelyNode?e._src:e.src:this.src||""},setSrc:function(t,e,i){fabric.util.loadImage(t,function(t){return this.setElement(t,e,i)},this,i&&i.crossOrigin)},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyFilters:function(t,e,i,r){if(e=e||this.filters,i=i||this._originalElement){var n,s,o=fabric.util.createImage(),a=this.canvas?this.canvas.getRetinaScaling():fabric.devicePixelRatio,h=this.minimumScaleTrigger/a,c=this;if(0===e.length)return this._element=i,t&&t(this),i;var l=fabric.util.createCanvasElement();return l.width=i.width,l.height=i.height,l.getContext("2d").drawImage(i,0,0,i.width,i.height),e.forEach(function(t){t&&(r?(n=c.scaleX<h?c.scaleX:1,s=c.scaleY<h?c.scaleY:1,n*a<1&&(n*=a),s*a<1&&(s*=a)):(n=t.scaleX,s=t.scaleY),t.applyTo(l,n,s),r||"Resize"!==t.type||(c.width*=t.scaleX,c.height*=t.scaleY))}),o.width=l.width,o.height=l.height,fabric.isLikelyNode?(o.src=l.toBuffer(void 0,fabric.Image.pngCompression),c._element=o,!r&&(c._filteredEl=o),t&&t(c)):(o.onload=function(){c._element=o,!r&&(c._filteredEl=o),t&&t(c),o.onload=l=null},o.src=l.toDataURL("image/png")),l}},_render:function(t,e){var i,r,n,s=this._findMargins();i=e?this.left:-this.width/2,r=e?this.top:-this.height/2,"slice"===this.meetOrSlice&&(t.beginPath(),t.rect(i,r,this.width,this.height),t.clip()),this.isMoving===!1&&this.resizeFilters.length&&this._needsResize()?(this._lastScaleX=this.scaleX,this._lastScaleY=this.scaleY,n=this.applyFilters(null,this.resizeFilters,this._filteredEl||this._originalElement,!0)):n=this._element,n&&t.drawImage(n,i+s.marginX,r+s.marginY,s.width,s.height),this._stroke(t),this._renderStroke(t)},_needsResize:function(){return this.scaleX!==this._lastScaleX||this.scaleY!==this._lastScaleY},_findMargins:function(){var t,e,i=this.width,r=this.height,n=0,s=0;return"none"===this.alignX&&"none"===this.alignY||(t=[this.width/this._element.width,this.height/this._element.height],e="meet"===this.meetOrSlice?Math.min.apply(null,t):Math.max.apply(null,t),i=this._element.width*e,r=this._element.height*e,"Mid"===this.alignX&&(n=(this.width-i)/2),"Max"===this.alignX&&(n=this.width-i),"Mid"===this.alignY&&(s=(this.height-r)/2),"Max"===this.alignY&&(s=this.height-r)),{width:i,height:r,marginX:n,marginY:s}},_resetWidthHeight:function(){var t=this.getElement();this.set("width",t.width),this.set("height",t.height)},_initElement:function(t,e,i){this.setElement(fabric.util.getById(t),i,e),fabric.util.addClass(this.getElement(),fabric.Image.CSS_CANVAS)},_initConfig:function(t){t||(t={}),this.setOptions(t),this._setWidthHeight(t),this._element&&this.crossOrigin&&(this._element.crossOrigin=this.crossOrigin)},_initFilters:function(t,e){t&&t.length?fabric.util.enlivenObjects(t,function(t){e&&e(t)},"fabric.Image.filters"):e&&e()},_setWidthHeight:function(t){this.width="width"in t?t.width:this.getElement()?this.getElement().width||0:0,this.height="height"in t?t.height:this.getElement()?this.getElement().height||0:0},complexity:function(){return 1}}),fabric.Image.CSS_CANVAS="canvas-img",fabric.Image.prototype.getSvgSrc=fabric.Image.prototype.getSrc,fabric.Image.fromObject=function(t,e){fabric.util.loadImage(t.src,function(i){fabric.Image.prototype._initFilters.call(t,t.filters,function(r){t.filters=r||[],fabric.Image.prototype._initFilters.call(t,t.resizeFilters,function(r){return t.resizeFilters=r||[],new fabric.Image(i,t,e)})})},null,t.crossOrigin)},fabric.Image.fromURL=function(t,e,i){fabric.util.loadImage(t,function(t){e&&e(new fabric.Image(t,i))},null,i&&i.crossOrigin)},fabric.Image.ATTRIBUTE_NAMES=fabric.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href".split(" ")),fabric.Image.fromElement=function(t,i,r){var n,s=fabric.parseAttributes(t,fabric.Image.ATTRIBUTE_NAMES);s.preserveAspectRatio&&(n=fabric.util.parsePreserveAspectRatioAttribute(s.preserveAspectRatio),e(s,n)),fabric.Image.fromURL(s["xlink:href"],i,e(r?fabric.util.object.clone(r):{},s))},fabric.Image.async=!0,fabric.Image.pngCompression=1}("undefined"!=typeof exports?exports:this),fabric.util.object.extend(fabric.Object.prototype,{_getAngleValueForStraighten:function(){var t=this.getAngle()%360;return t>0?90*Math.round((t-1)/90):90*Math.round(t/90)},straighten:function(){return this.setAngle(this._getAngleValueForStraighten()),this},fxStraighten:function(t){t=t||{};var e=function(){},i=t.onComplete||e,r=t.onChange||e,n=this;return fabric.util.animate({startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(t){n.setAngle(t),r()},onComplete:function(){n.setCoords(),i()},onStart:function(){n.set("active",!1)}}),this}}),fabric.util.object.extend(fabric.StaticCanvas.prototype,{straightenObject:function(t){return t.straighten(),this.renderAll(),this},fxStraightenObject:function(t){return t.fxStraighten({onChange:this.renderAll.bind(this)}),this}}),fabric.Image.filters=fabric.Image.filters||{},fabric.Image.filters.BaseFilter=fabric.util.createClass({type:"BaseFilter",initialize:function(t){t&&this.setOptions(t)},setOptions:function(t){for(var e in t)this[e]=t[e]},toObject:function(){return{type:this.type}},toJSON:function(){return this.toObject()}}),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.Image.filters,n=e.util.createClass;r.Brightness=n(r.BaseFilter,{type:"Brightness",initialize:function(t){t=t||{},this.brightness=t.brightness||0},applyTo:function(t){for(var e=t.getContext("2d"),i=e.getImageData(0,0,t.width,t.height),r=i.data,n=this.brightness,s=0,o=r.length;s<o;s+=4)r[s]+=n,r[s+1]+=n,r[s+2]+=n;e.putImageData(i,0,0)},toObject:function(){return i(this.callSuper("toObject"),{brightness:this.brightness})}}),e.Image.filters.Brightness.fromObject=function(t){return new e.Image.filters.Brightness(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.Image.filters,n=e.util.createClass;r.Convolute=n(r.BaseFilter,{type:"Convolute",initialize:function(t){t=t||{},this.opaque=t.opaque,this.matrix=t.matrix||[0,0,0,0,1,0,0,0,0]},applyTo:function(t){for(var e,i,r,n,s,o,a,h,c,l=this.matrix,u=t.getContext("2d"),f=u.getImageData(0,0,t.width,t.height),d=Math.round(Math.sqrt(l.length)),g=Math.floor(d/2),p=f.data,v=f.width,b=f.height,m=u.createImageData(v,b),y=m.data,_=this.opaque?1:0,x=0;x<b;x++)for(var S=0;S<v;S++){s=4*(x*v+S),e=0,i=0,r=0,n=0;for(var C=0;C<d;C++)for(var w=0;w<d;w++)a=x+C-g,o=S+w-g,a<0||a>b||o<0||o>v||(h=4*(a*v+o),c=l[C*d+w],e+=p[h]*c,i+=p[h+1]*c,r+=p[h+2]*c,n+=p[h+3]*c);y[s]=e,y[s+1]=i,y[s+2]=r,y[s+3]=n+_*(255-n)}u.putImageData(m,0,0)},toObject:function(){return i(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),e.Image.filters.Convolute.fromObject=function(t){return new e.Image.filters.Convolute(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.Image.filters,n=e.util.createClass;r.GradientTransparency=n(r.BaseFilter,{type:"GradientTransparency",initialize:function(t){t=t||{},this.threshold=t.threshold||100},applyTo:function(t){for(var e=t.getContext("2d"),i=e.getImageData(0,0,t.width,t.height),r=i.data,n=this.threshold,s=r.length,o=0,a=r.length;o<a;o+=4)r[o+3]=n+255*(s-o)/s;e.putImageData(i,0,0)},toObject:function(){return i(this.callSuper("toObject"),{threshold:this.threshold})}}),e.Image.filters.GradientTransparency.fromObject=function(t){return new e.Image.filters.GradientTransparency(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,r=e.util.createClass;i.Grayscale=r(i.BaseFilter,{type:"Grayscale",applyTo:function(t){for(var e,i=t.getContext("2d"),r=i.getImageData(0,0,t.width,t.height),n=r.data,s=r.width*r.height*4,o=0;o<s;)e=(n[o]+n[o+1]+n[o+2])/3,n[o]=e,n[o+1]=e,n[o+2]=e,o+=4;i.putImageData(r,0,0)}}),e.Image.filters.Grayscale.fromObject=function(){return new e.Image.filters.Grayscale}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,r=e.util.createClass;i.Invert=r(i.BaseFilter,{type:"Invert",applyTo:function(t){var e,i=t.getContext("2d"),r=i.getImageData(0,0,t.width,t.height),n=r.data,s=n.length;for(e=0;e<s;e+=4)n[e]=255-n[e],n[e+1]=255-n[e+1],n[e+2]=255-n[e+2];i.putImageData(r,0,0)}}),e.Image.filters.Invert.fromObject=function(){return new e.Image.filters.Invert}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.Image.filters,n=e.util.createClass;r.Mask=n(r.BaseFilter,{type:"Mask",initialize:function(t){t=t||{},this.mask=t.mask,this.channel=[0,1,2,3].indexOf(t.channel)>-1?t.channel:0},applyTo:function(t){if(this.mask){var i,r=t.getContext("2d"),n=r.getImageData(0,0,t.width,t.height),s=n.data,o=this.mask.getElement(),a=e.util.createCanvasElement(),h=this.channel,c=n.width*n.height*4;a.width=t.width,a.height=t.height,a.getContext("2d").drawImage(o,0,0,t.width,t.height);var l=a.getContext("2d").getImageData(0,0,t.width,t.height),u=l.data;for(i=0;i<c;i+=4)s[i+3]=u[i+h];r.putImageData(n,0,0)}},toObject:function(){return i(this.callSuper("toObject"),{mask:this.mask.toObject(),channel:this.channel})}}),e.Image.filters.Mask.fromObject=function(t,i){e.util.loadImage(t.mask.src,function(r){t.mask=new e.Image(r,t.mask),i&&i(new e.Image.filters.Mask(t))})},e.Image.filters.Mask.async=!0}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.Image.filters,n=e.util.createClass;r.Noise=n(r.BaseFilter,{type:"Noise",initialize:function(t){t=t||{},this.noise=t.noise||0},applyTo:function(t){for(var e,i=t.getContext("2d"),r=i.getImageData(0,0,t.width,t.height),n=r.data,s=this.noise,o=0,a=n.length;o<a;o+=4)e=(.5-Math.random())*s,n[o]+=e,n[o+1]+=e,n[o+2]+=e;i.putImageData(r,0,0)},toObject:function(){return i(this.callSuper("toObject"),{noise:this.noise})}}),e.Image.filters.Noise.fromObject=function(t){return new e.Image.filters.Noise(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.Image.filters,n=e.util.createClass;r.Pixelate=n(r.BaseFilter,{type:"Pixelate",initialize:function(t){t=t||{},this.blocksize=t.blocksize||4},applyTo:function(t){var e,i,r,n,s,o,a,h=t.getContext("2d"),c=h.getImageData(0,0,t.width,t.height),l=c.data,u=c.height,f=c.width;for(i=0;i<u;i+=this.blocksize)for(r=0;r<f;r+=this.blocksize){e=4*i*f+4*r,n=l[e],s=l[e+1],o=l[e+2],a=l[e+3];for(var d=i,g=i+this.blocksize;d<g;d++)for(var p=r,v=r+this.blocksize;p<v;p++)e=4*d*f+4*p,l[e]=n,l[e+1]=s,l[e+2]=o,l[e+3]=a}h.putImageData(c,0,0)},toObject:function(){return i(this.callSuper("toObject"),{blocksize:this.blocksize})}}),e.Image.filters.Pixelate.fromObject=function(t){return new e.Image.filters.Pixelate(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.Image.filters,n=e.util.createClass;r.RemoveWhite=n(r.BaseFilter,{type:"RemoveWhite",initialize:function(t){t=t||{},this.threshold=t.threshold||30,this.distance=t.distance||20},applyTo:function(t){for(var e,i,r,n=t.getContext("2d"),s=n.getImageData(0,0,t.width,t.height),o=s.data,a=this.threshold,h=this.distance,c=255-a,l=Math.abs,u=0,f=o.length;u<f;u+=4)e=o[u],i=o[u+1],r=o[u+2],e>c&&i>c&&r>c&&l(e-i)<h&&l(e-r)<h&&l(i-r)<h&&(o[u+3]=0);n.putImageData(s,0,0)},toObject:function(){return i(this.callSuper("toObject"),{threshold:this.threshold,distance:this.distance})}}),e.Image.filters.RemoveWhite.fromObject=function(t){return new e.Image.filters.RemoveWhite(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,r=e.util.createClass;i.Sepia=r(i.BaseFilter,{type:"Sepia",applyTo:function(t){var e,i,r=t.getContext("2d"),n=r.getImageData(0,0,t.width,t.height),s=n.data,o=s.length;for(e=0;e<o;e+=4)i=.3*s[e]+.59*s[e+1]+.11*s[e+2],s[e]=i+100,s[e+1]=i+50,s[e+2]=i+255;r.putImageData(n,0,0)}}),e.Image.filters.Sepia.fromObject=function(){return new e.Image.filters.Sepia}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,r=e.util.createClass;i.Sepia2=r(i.BaseFilter,{type:"Sepia2",applyTo:function(t){var e,i,r,n,s=t.getContext("2d"),o=s.getImageData(0,0,t.width,t.height),a=o.data,h=a.length;for(e=0;e<h;e+=4)i=a[e],r=a[e+1],n=a[e+2],a[e]=(.393*i+.769*r+.189*n)/1.351,a[e+1]=(.349*i+.686*r+.168*n)/1.203,a[e+2]=(.272*i+.534*r+.131*n)/2.14;s.putImageData(o,0,0)}}),e.Image.filters.Sepia2.fromObject=function(){return new e.Image.filters.Sepia2}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.Image.filters,n=e.util.createClass;r.Tint=n(r.BaseFilter,{type:"Tint",initialize:function(t){t=t||{},this.color=t.color||"#000000",this.opacity="undefined"!=typeof t.opacity?t.opacity:new e.Color(this.color).getAlpha()},applyTo:function(t){var i,r,n,s,o,a,h,c,l,u=t.getContext("2d"),f=u.getImageData(0,0,t.width,t.height),d=f.data,g=d.length;for(l=new e.Color(this.color).getSource(),r=l[0]*this.opacity,n=l[1]*this.opacity,s=l[2]*this.opacity,c=1-this.opacity,i=0;i<g;i+=4)o=d[i],a=d[i+1],h=d[i+2],d[i]=r+o*c,d[i+1]=n+a*c,d[i+2]=s+h*c;u.putImageData(f,0,0)},toObject:function(){return i(this.callSuper("toObject"),{color:this.color,opacity:this.opacity})}}),e.Image.filters.Tint.fromObject=function(t){return new e.Image.filters.Tint(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.Image.filters,n=e.util.createClass;r.Multiply=n(r.BaseFilter,{type:"Multiply",initialize:function(t){t=t||{},this.color=t.color||"#000000"},applyTo:function(t){var i,r,n=t.getContext("2d"),s=n.getImageData(0,0,t.width,t.height),o=s.data,a=o.length;for(r=new e.Color(this.color).getSource(),i=0;i<a;i+=4)o[i]*=r[0]/255,o[i+1]*=r[1]/255,o[i+2]*=r[2]/255;n.putImageData(s,0,0)},toObject:function(){return i(this.callSuper("toObject"),{color:this.color})}}),e.Image.filters.Multiply.fromObject=function(t){return new e.Image.filters.Multiply(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric,i=e.Image.filters,r=e.util.createClass;i.Blend=r(i.BaseFilter,{type:"Blend",initialize:function(t){t=t||{},this.color=t.color||"#000",this.image=t.image||!1,this.mode=t.mode||"multiply",this.alpha=t.alpha||1},applyTo:function(t){var i,r,n,s,o,a,h,c,l,u,f=t.getContext("2d"),d=f.getImageData(0,0,t.width,t.height),g=d.data,p=!1;if(this.image){p=!0;var v=e.util.createCanvasElement();v.width=this.image.width,v.height=this.image.height;var b=new e.StaticCanvas(v);b.add(this.image);var m=b.getContext("2d");u=m.getImageData(0,0,b.width,b.height).data}else u=new e.Color(this.color).getSource(),i=u[0]*this.alpha,r=u[1]*this.alpha,n=u[2]*this.alpha;for(var y=0,_=g.length;y<_;y+=4)switch(s=g[y],o=g[y+1],a=g[y+2],p&&(i=u[y]*this.alpha,r=u[y+1]*this.alpha,n=u[y+2]*this.alpha),this.mode){case"multiply":g[y]=s*i/255,g[y+1]=o*r/255,g[y+2]=a*n/255;break;case"screen":g[y]=1-(1-s)*(1-i),g[y+1]=1-(1-o)*(1-r),g[y+2]=1-(1-a)*(1-n);break;case"add":g[y]=Math.min(255,s+i),g[y+1]=Math.min(255,o+r),g[y+2]=Math.min(255,a+n);break;case"diff":case"difference":g[y]=Math.abs(s-i),g[y+1]=Math.abs(o-r),g[y+2]=Math.abs(a-n);break;case"subtract":h=s-i,c=o-r,l=a-n,g[y]=h<0?0:h,g[y+1]=c<0?0:c,g[y+2]=l<0?0:l;break;case"darken":g[y]=Math.min(s,i),g[y+1]=Math.min(o,r),g[y+2]=Math.min(a,n);break;case"lighten":g[y]=Math.max(s,i),g[y+1]=Math.max(o,r),g[y+2]=Math.max(a,n)}f.putImageData(d,0,0)},toObject:function(){return{color:this.color,image:this.image,mode:this.mode,alpha:this.alpha}}}),e.Image.filters.Blend.fromObject=function(t){return new e.Image.filters.Blend(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=Math.pow,r=Math.floor,n=Math.sqrt,s=Math.abs,o=Math.max,a=Math.round,h=Math.sin,c=Math.ceil,l=e.Image.filters,u=e.util.createClass;l.Resize=u(l.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:0,scaleY:0,lanczosLobes:3,applyTo:function(t,e,i){if(1!==e||1!==i){this.rcpScaleX=1/e,this.rcpScaleY=1/i;var r,n=t.width,s=t.height,o=a(n*e),h=a(s*i);"sliceHack"===this.resizeType&&(r=this.sliceByTwo(t,n,s,o,h)),"hermite"===this.resizeType&&(r=this.hermiteFastResize(t,n,s,o,h)),"bilinear"===this.resizeType&&(r=this.bilinearFiltering(t,n,s,o,h)),"lanczos"===this.resizeType&&(r=this.lanczosResize(t,n,s,o,h)),t.width=o,t.height=h,t.getContext("2d").putImageData(r,0,0)}},sliceByTwo:function(t,i,n,s,a){var h,c=t.getContext("2d"),l=.5,u=.5,f=1,d=1,g=!1,p=!1,v=i,b=n,m=e.util.createCanvasElement(),y=m.getContext("2d");for(s=r(s),a=r(a),m.width=o(s,i),m.height=o(a,n),s>i&&(l=2,f=-1),a>n&&(u=2,d=-1),h=c.getImageData(0,0,i,n),t.width=o(s,i),t.height=o(a,n),c.putImageData(h,0,0);!g||!p;)i=v,n=b,s*f<r(v*l*f)?v=r(v*l):(v=s,g=!0),a*d<r(b*u*d)?b=r(b*u):(b=a,p=!0),h=c.getImageData(0,0,i,n),y.putImageData(h,0,0),c.clearRect(0,0,v,b),c.drawImage(m,0,0,i,n,0,0,v,b);return c.getImageData(0,0,s,a)},lanczosResize:function(t,e,o,a,l){function u(t){return function(e){if(e>t)return 0;if(e*=Math.PI,s(e)<1e-16)return 1;var i=e/t;return h(e)*h(i)/e/i}}function f(t){var h,c,u,d,g,j,M,A,P,I,E;for(T.x=(t+.5)*y,k.x=r(T.x),h=0;h<l;h++){for(T.y=(h+.5)*_,k.y=r(T.y),g=0,j=0,M=0,A=0,P=0,c=k.x-C;c<=k.x+C;c++)if(!(c<0||c>=e)){I=r(1e3*s(c-T.x)),O[I]||(O[I]={});for(var D=k.y-w;D<=k.y+w;D++)D<0||D>=o||(E=r(1e3*s(D-T.y)),O[I][E]||(O[I][E]=m(n(i(I*x,2)+i(E*S,2))/1e3)),u=O[I][E],u>0&&(d=4*(D*e+c),g+=u,j+=u*v[d],M+=u*v[d+1],A+=u*v[d+2],P+=u*v[d+3]))}d=4*(h*a+t),b[d]=j/g,b[d+1]=M/g,b[d+2]=A/g,b[d+3]=P/g}return++t<a?f(t):p}var d=t.getContext("2d"),g=d.getImageData(0,0,e,o),p=d.getImageData(0,0,a,l),v=g.data,b=p.data,m=u(this.lanczosLobes),y=this.rcpScaleX,_=this.rcpScaleY,x=2/this.rcpScaleX,S=2/this.rcpScaleY,C=c(y*this.lanczosLobes/2),w=c(_*this.lanczosLobes/2),O={},T={},k={};return f(0)},bilinearFiltering:function(t,e,i,n,s){var o,a,h,c,l,u,f,d,g,p,v,b,m,y=0,_=this.rcpScaleX,x=this.rcpScaleY,S=t.getContext("2d"),C=4*(e-1),w=S.getImageData(0,0,e,i),O=w.data,T=S.getImageData(0,0,n,s),k=T.data;for(f=0;f<s;f++)for(d=0;d<n;d++)for(l=r(_*d),u=r(x*f),g=_*d-l,p=x*f-u,m=4*(u*e+l),v=0;v<4;v++)o=O[m+v],a=O[m+4+v],h=O[m+C+v],c=O[m+C+4+v],b=o*(1-g)*(1-p)+a*g*(1-p)+h*p*(1-g)+c*g*p,k[y++]=b;return T},hermiteFastResize:function(t,e,i,o,a){for(var h=this.rcpScaleX,l=this.rcpScaleY,u=c(h/2),f=c(l/2),d=t.getContext("2d"),g=d.getImageData(0,0,e,i),p=g.data,v=d.getImageData(0,0,o,a),b=v.data,m=0;m<a;m++)for(var y=0;y<o;y++){for(var _=4*(y+m*o),x=0,S=0,C=0,w=0,O=0,T=0,k=0,j=(m+.5)*l,M=r(m*l);M<(m+1)*l;M++)for(var A=s(j-(M+.5))/f,P=(y+.5)*h,I=A*A,E=r(y*h);E<(y+1)*h;E++){var D=s(P-(E+.5))/u,L=n(I+D*D);L>1&&L<-1||(x=2*L*L*L-3*L*L+1,x>0&&(D=4*(E+M*e),k+=x*p[D+3],C+=x,p[D+3]<255&&(x=x*p[D+3]/250),w+=x*p[D],O+=x*p[D+1],T+=x*p[D+2],S+=x))}b[_]=w/S,b[_+1]=O/S,b[_+2]=T/S,b[_+3]=k/C}return v},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),e.Image.filters.Resize.fromObject=function(t){return new e.Image.filters.Resize(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.Image.filters,n=e.util.createClass;r.ColorMatrix=n(r.BaseFilter,{type:"ColorMatrix",initialize:function(t){t||(t={}),this.matrix=t.matrix||[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]},applyTo:function(t){var e,i,r,n,s,o=t.getContext("2d"),a=o.getImageData(0,0,t.width,t.height),h=a.data,c=h.length,l=this.matrix;for(e=0;e<c;e+=4)i=h[e],r=h[e+1],n=h[e+2],s=h[e+3],h[e]=i*l[0]+r*l[1]+n*l[2]+s*l[3]+l[4],h[e+1]=i*l[5]+r*l[6]+n*l[7]+s*l[8]+l[9],h[e+2]=i*l[10]+r*l[11]+n*l[12]+s*l[13]+l[14],h[e+3]=i*l[15]+r*l[16]+n*l[17]+s*l[18]+l[19];o.putImageData(a,0,0)},toObject:function(){return i(this.callSuper("toObject"),{type:this.type,matrix:this.matrix})}}),e.Image.filters.ColorMatrix.fromObject=function(t){return new e.Image.filters.ColorMatrix(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.Image.filters,n=e.util.createClass;r.Contrast=n(r.BaseFilter,{type:"Contrast",initialize:function(t){t=t||{},this.contrast=t.contrast||0},applyTo:function(t){for(var e=t.getContext("2d"),i=e.getImageData(0,0,t.width,t.height),r=i.data,n=259*(this.contrast+255)/(255*(259-this.contrast)),s=0,o=r.length;s<o;s+=4)r[s]=n*(r[s]-128)+128,r[s+1]=n*(r[s+1]-128)+128,r[s+2]=n*(r[s+2]-128)+128;e.putImageData(i,0,0)},toObject:function(){return i(this.callSuper("toObject"),{contrast:this.contrast})}}),e.Image.filters.Contrast.fromObject=function(t){return new e.Image.filters.Contrast(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.Image.filters,n=e.util.createClass;r.Saturate=n(r.BaseFilter,{type:"Saturate",initialize:function(t){t=t||{},this.saturate=t.saturate||0},applyTo:function(t){for(var e,i=t.getContext("2d"),r=i.getImageData(0,0,t.width,t.height),n=r.data,s=.01*-this.saturate,o=0,a=n.length;o<a;o+=4)e=Math.max(n[o],n[o+1],n[o+2]),
n[o]+=e!==n[o]?(e-n[o])*s:0,n[o+1]+=e!==n[o+1]?(e-n[o+1])*s:0,n[o+2]+=e!==n[o+2]?(e-n[o+2])*s:0;i.putImageData(r,0,0)},toObject:function(){return i(this.callSuper("toObject"),{saturate:this.saturate})}}),e.Image.filters.Saturate.fromObject=function(t){return new e.Image.filters.Saturate(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.clone,r=e.util.toFixed,n=e.Object.NUM_FRACTION_DIGITS,s=2;if(e.Text)return void e.warn("fabric.Text is already defined");var o=e.Object.prototype.stateProperties.concat();o.push("fontFamily","fontWeight","fontSize","text","textDecoration","textAlign","fontStyle","lineHeight","textBackgroundColor"),e.Text=e.util.createClass(e.Object,{_dimensionAffectingProps:{fontSize:!0,fontWeight:!0,fontFamily:!0,fontStyle:!0,lineHeight:!0,text:!0,charSpacing:!0,textAlign:!0,strokeWidth:!1},_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",textDecoration:"",textAlign:"left",fontStyle:"",lineHeight:1.16,textBackgroundColor:"",stateProperties:o,stroke:null,shadow:null,_fontSizeFraction:.25,_fontSizeMult:1.13,charSpacing:0,initialize:function(t,e){e=e||{},this.text=t,this.__skipDimension=!0,this.setOptions(e),this.__skipDimension=!1,this._initDimensions()},_initDimensions:function(t){this.__skipDimension||(t||(t=e.util.createCanvasElement().getContext("2d"),this._setTextStyles(t)),this._textLines=this._splitTextIntoLines(),this._clearCache(),this.width=this._getTextWidth(t)||this.cursorWidth||s,this.height=this._getTextHeight(t))},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_render:function(t){this.clipTo&&e.util.clipContext(this,t),this._setOpacity(t),this._setShadow(t),this._setupCompositeOperation(t),this._renderTextBackground(t),this._setStrokeStyles(t),this._setFillStyles(t),this._renderText(t),this._renderTextDecoration(t),this.clipTo&&t.restore()},_renderText:function(t){this._renderTextFill(t),this._renderTextStroke(t)},_setTextStyles:function(t){t.textBaseline="alphabetic",t.font=this._getFontDeclaration()},_getTextHeight:function(){return this._getHeightOfSingleLine()+(this._textLines.length-1)*this._getHeightOfLine()},_getTextWidth:function(t){for(var e=this._getLineWidth(t,0),i=1,r=this._textLines.length;i<r;i++){var n=this._getLineWidth(t,i);n>e&&(e=n)}return e},_getNonTransformedDimensions:function(){return{x:this.width,y:this.height}},_renderChars:function(t,e,i,r,n){var s,o,a=t.slice(0,-4);if(this[a].toLive){var h=-this.width/2+this[a].offsetX||0,c=-this.height/2+this[a].offsetY||0;e.save(),e.translate(h,c),r-=h,n-=c}if(0!==this.charSpacing){var l=this._getWidthOfCharSpacing();i=i.split("");for(var u=0,f=i.length;u<f;u++)s=i[u],o=e.measureText(s).width+l,e[t](s,r,n),r+=o>0?o:0}else e[t](i,r,n);this[a].toLive&&e.restore()},_renderTextLine:function(t,e,i,r,n,s){n-=this.fontSize*this._fontSizeFraction;var o=this._getLineWidth(e,s);if("justify"!==this.textAlign||this.width<o)return void this._renderChars(t,e,i,r,n,s);for(var a,h=i.split(/\s+/),c=0,l=this._getWidthOfWords(e,h.join(" "),s,0),u=this.width-l,f=h.length-1,d=f>0?u/f:0,g=0,p=0,v=h.length;p<v;p++){for(;" "===i[c]&&c<i.length;)c++;a=h[p],this._renderChars(t,e,a,r+g,n,s,c),g+=this._getWidthOfWords(e,a,s,c)+d,c+=a.length}},_getWidthOfWords:function(t,e){var i,r,n=t.measureText(e).width;return 0!==this.charSpacing&&(i=e.split("").length,r=i*this._getWidthOfCharSpacing(),n+=r),n>0?n:0},_getLeftOffset:function(){return-this.width/2},_getTopOffset:function(){return-this.height/2},isEmptyStyles:function(){return!0},_renderTextCommon:function(t,e){for(var i=0,r=this._getLeftOffset(),n=this._getTopOffset(),s=0,o=this._textLines.length;s<o;s++){var a=this._getHeightOfLine(t,s),h=a/this.lineHeight,c=this._getLineWidth(t,s),l=this._getLineLeftOffset(c);this._renderTextLine(e,t,this._textLines[s],r+l,n+i+h,s),i+=a}},_renderTextFill:function(t){!this.fill&&this.isEmptyStyles()||this._renderTextCommon(t,"fillText")},_renderTextStroke:function(t){(this.stroke&&0!==this.strokeWidth||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this._setLineDash(t,this.strokedashArray),t.beginPath(),this._renderTextCommon(t,"strokeText"),t.closePath(),t.restore())},_getHeightOfLine:function(){return this._getHeightOfSingleLine()*this.lineHeight},_getHeightOfSingleLine:function(){return this.fontSize*this._fontSizeMult},_renderTextBackground:function(t){this._renderBackground(t),this._renderTextLinesBackground(t)},_renderTextLinesBackground:function(t){if(this.textBackgroundColor){var e,i,r,n=0;t.fillStyle=this.textBackgroundColor;for(var s=0,o=this._textLines.length;s<o;s++)e=this._getHeightOfLine(t,s),i=this._getLineWidth(t,s),i>0&&(r=this._getLineLeftOffset(i),t.fillRect(this._getLeftOffset()+r,this._getTopOffset()+n,i,e/this.lineHeight)),n+=e;this._removeShadow(t)}},_getLineLeftOffset:function(t){return"center"===this.textAlign?(this.width-t)/2:"right"===this.textAlign?this.width-t:0},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[]},_shouldClearCache:function(){var t=!1;if(this._forceClearCache)return this._forceClearCache=!1,!0;for(var e in this._dimensionAffectingProps)this["__"+e]!==this[e]&&(this["__"+e]=this[e],t=!0);return t},_getLineWidth:function(t,e){if(this.__lineWidths[e])return this.__lineWidths[e]===-1?this.width:this.__lineWidths[e];var i,r,n=this._textLines[e];return i=""===n?0:this._measureLine(t,e),this.__lineWidths[e]=i,i&&"justify"===this.textAlign&&(r=n.split(/\s+/),r.length>1&&(this.__lineWidths[e]=-1)),i},_getWidthOfCharSpacing:function(){return 0!==this.charSpacing?this.fontSize*this.charSpacing/1e3:0},_measureLine:function(t,e){var i,r,n=this._textLines[e],s=t.measureText(n).width,o=0;return 0!==this.charSpacing&&(i=n.split("").length,o=(i-1)*this._getWidthOfCharSpacing()),r=s+o,r>0?r:0},_renderTextDecoration:function(t){function e(e){var n,s,o,a,h,c,l,u=0;for(n=0,s=r._textLines.length;n<s;n++){for(h=r._getLineWidth(t,n),c=r._getLineLeftOffset(h),l=r._getHeightOfLine(t,n),o=0,a=e.length;o<a;o++)t.fillRect(r._getLeftOffset()+c,u+(r._fontSizeMult-1+e[o])*r.fontSize-i,h,r.fontSize/15);u+=l}}if(this.textDecoration){var i=this.height/2,r=this,n=[];this.textDecoration.indexOf("underline")>-1&&n.push(.85),this.textDecoration.indexOf("line-through")>-1&&n.push(.43),this.textDecoration.indexOf("overline")>-1&&n.push(-.12),n.length>0&&e(n)}},_getFontDeclaration:function(){return[e.isLikelyNode?this.fontWeight:this.fontStyle,e.isLikelyNode?this.fontStyle:this.fontWeight,this.fontSize+"px",e.isLikelyNode?'"'+this.fontFamily+'"':this.fontFamily].join(" ")},render:function(t,e){this.visible&&(t.save(),this._setTextStyles(t),this._shouldClearCache()&&this._initDimensions(t),this.drawSelectionBackground(t),e||this.transform(t),this.transformMatrix&&t.transform.apply(t,this.transformMatrix),this.group&&"path-group"===this.group.type&&t.translate(this.left,this.top),this._render(t),t.restore())},_splitTextIntoLines:function(){return this.text.split(this._reNewline)},toObject:function(t){var e=["text","fontSize","fontWeight","fontFamily","fontStyle","lineHeight","textDecoration","textAlign","textBackgroundColor","charSpacing"].concat(t);return this.callSuper("toObject",e)},toSVG:function(t){this.ctx||(this.ctx=e.util.createCanvasElement().getContext("2d"));var i=this._createBaseSVGMarkup(),r=this._getSVGLeftTopOffsets(this.ctx),n=this._getSVGTextAndBg(r.textTop,r.textLeft);return this._wrapSVGTextAndBg(i,n),t?t(i.join("")):i.join("")},_getSVGLeftTopOffsets:function(t){var e=this._getHeightOfLine(t,0),i=-this.width/2,r=0;return{textLeft:i+(this.group&&"path-group"===this.group.type?this.left:0),textTop:r+(this.group&&"path-group"===this.group.type?-this.top:0),lineTop:e}},_wrapSVGTextAndBg:function(t,e){var i=!0,r=this.getSvgFilter(),n=""===r?"":' style="'+r+'"';t.push("\t<g ",this.getSvgId(),'transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'"',n,">\n",e.textBgRects.join(""),"\t\t<text ",this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",this.textDecoration?'text-decoration="'+this.textDecoration+'" ':"",'style="',this.getSvgStyles(i),'" >\n',e.textSpans.join(""),"\t\t</text>\n","\t</g>\n")},_getSVGTextAndBg:function(t,e){var i=[],r=[],n=0;this._setSVGBg(r);for(var s=0,o=this._textLines.length;s<o;s++)this.textBackgroundColor&&this._setSVGTextLineBg(r,s,e,t,n),this._setSVGTextLineText(s,i,n,e,t,r),n+=this._getHeightOfLine(this.ctx,s);return{textSpans:i,textBgRects:r}},_setSVGTextLineText:function(t,i,s,o,a){var h=this.fontSize*(this._fontSizeMult-this._fontSizeFraction)-a+s-this.height/2;return"justify"===this.textAlign?void this._setSVGTextLineJustifed(t,i,h,o):void i.push('\t\t\t<tspan x="',r(o+this._getLineLeftOffset(this._getLineWidth(this.ctx,t)),n),'" ','y="',r(h,n),'" ',this._getFillAttributes(this.fill),">",e.util.string.escapeXml(this._textLines[t]),"</tspan>\n")},_setSVGTextLineJustifed:function(t,i,s,o){var a=e.util.createCanvasElement().getContext("2d");this._setTextStyles(a);var h,c,l=this._textLines[t],u=l.split(/\s+/),f=this._getWidthOfWords(a,u.join("")),d=this.width-f,g=u.length-1,p=g>0?d/g:0,v=this._getFillAttributes(this.fill);for(o+=this._getLineLeftOffset(this._getLineWidth(a,t)),t=0,c=u.length;t<c;t++)h=u[t],i.push('\t\t\t<tspan x="',r(o,n),'" ','y="',r(s,n),'" ',v,">",e.util.string.escapeXml(h),"</tspan>\n"),o+=this._getWidthOfWords(a,h)+p},_setSVGTextLineBg:function(t,e,i,s,o){t.push("\t\t<rect ",this._getFillAttributes(this.textBackgroundColor),' x="',r(i+this._getLineLeftOffset(this._getLineWidth(this.ctx,e)),n),'" y="',r(o-this.height/2,n),'" width="',r(this._getLineWidth(this.ctx,e),n),'" height="',r(this._getHeightOfLine(this.ctx,e)/this.lineHeight,n),'"></rect>\n')},_setSVGBg:function(t){this.backgroundColor&&t.push("\t\t<rect ",this._getFillAttributes(this.backgroundColor),' x="',r(-this.width/2,n),'" y="',r(-this.height/2,n),'" width="',r(this.width,n),'" height="',r(this.height,n),'"></rect>\n')},_getFillAttributes:function(t){var i=t&&"string"==typeof t?new e.Color(t):"";return i&&i.getSource()&&1!==i.getAlpha()?'opacity="'+i.getAlpha()+'" fill="'+i.setAlpha(1).toRgb()+'"':'fill="'+t+'"'},_set:function(t,e){this.callSuper("_set",t,e),t in this._dimensionAffectingProps&&(this._initDimensions(),this.setCoords())},complexity:function(){return 1}}),e.Text.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size text-decoration text-anchor".split(" ")),e.Text.DEFAULT_SVG_FONT_SIZE=16,e.Text.fromElement=function(t,i){if(!t)return null;var r=e.parseAttributes(t,e.Text.ATTRIBUTE_NAMES);i=e.util.object.extend(i?e.util.object.clone(i):{},r),i.top=i.top||0,i.left=i.left||0,"dx"in r&&(i.left+=r.dx),"dy"in r&&(i.top+=r.dy),"fontSize"in i||(i.fontSize=e.Text.DEFAULT_SVG_FONT_SIZE),i.originX||(i.originX="left");var n="";"textContent"in t?n=t.textContent:"firstChild"in t&&null!==t.firstChild&&"data"in t.firstChild&&null!==t.firstChild.data&&(n=t.firstChild.data),n=n.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var s=new e.Text(n,i),o=s.getHeight()/s.height,a=(s.height+s.strokeWidth)*s.lineHeight-s.height,h=a*o,c=s.getHeight()+h,l=0;return"left"===s.originX&&(l=s.getWidth()/2),"right"===s.originX&&(l=-s.getWidth()/2),s.set({left:s.getLeft()+l,top:s.getTop()-c/2+s.fontSize*(.18+s._fontSizeFraction)/s.lineHeight}),s},e.Text.fromObject=function(t,r){var n=new e.Text(t.text,i(t));return r&&r(n),n},e.util.createAccessors(e.Text)}("undefined"!=typeof exports?exports:this),function(){var t=fabric.util.object.clone;fabric.IText=fabric.util.createClass(fabric.Text,fabric.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"#333",cursorDelay:1e3,cursorDuration:600,styles:null,caching:!0,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],initialize:function(t,e){this.styles=e?e.styles||{}:{},this.callSuper("initialize",t,e),this.initBehavior()},_clearCache:function(){this.callSuper("_clearCache"),this.__widthOfSpace=[]},isEmptyStyles:function(){if(!this.styles)return!0;var t=this.styles;for(var e in t)for(var i in t[e])for(var r in t[e][i])return!1;return!0},setSelectionStart:function(t){t=Math.max(t,0),this._updateAndFire("selectionStart",t)},setSelectionEnd:function(t){t=Math.min(t,this.text.length),this._updateAndFire("selectionEnd",t)},_updateAndFire:function(t,e){this[t]!==e&&(this._fireSelectionChanged(),this[t]=e),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},getSelectionStyles:function(t,e){if(2===arguments.length){for(var i=[],r=t;r<e;r++)i.push(this.getSelectionStyles(r));return i}var n=this.get2DCursorLocation(t),s=this._getStyleDeclaration(n.lineIndex,n.charIndex);return s||{}},setSelectionStyles:function(t){if(this.selectionStart===this.selectionEnd)this._extendStyles(this.selectionStart,t);else for(var e=this.selectionStart;e<this.selectionEnd;e++)this._extendStyles(e,t);return this._forceClearCache=!0,this},_extendStyles:function(t,e){var i=this.get2DCursorLocation(t);this._getLineStyle(i.lineIndex)||this._setLineStyle(i.lineIndex,{}),this._getStyleDeclaration(i.lineIndex,i.charIndex)||this._setStyleDeclaration(i.lineIndex,i.charIndex,{}),fabric.util.object.extend(this._getStyleDeclaration(i.lineIndex,i.charIndex),e)},render:function(t,e){this.clearContextTop(),this.callSuper("render",t,e)},_render:function(t){this.callSuper("_render",t),this.ctx=t,this.cursorOffsetCache={},this.renderCursorOrSelection()},clearContextTop:function(){if(this.active&&this.isEditing&&this.canvas&&this.canvas.contextTop){var t=this.canvas.contextTop;t.save(),t.transform.apply(t,this.canvas.viewportTransform),this.transform(t),this.transformMatrix&&t.transform.apply(t,this.transformMatrix),this._clearTextArea(t),t.restore()}},renderCursorOrSelection:function(){if(this.active&&this.isEditing){var t,e,i=this.text.split("");this.canvas&&this.canvas.contextTop?(e=this.canvas.contextTop,e.save(),e.transform.apply(e,this.canvas.viewportTransform),this.transform(e),this.transformMatrix&&e.transform.apply(e,this.transformMatrix),this._clearTextArea(e)):(e=this.ctx,e.save()),this.selectionStart===this.selectionEnd?(t=this._getCursorBoundaries(i,"cursor"),this.renderCursor(t,e)):(t=this._getCursorBoundaries(i,"selection"),this.renderSelection(i,t,e)),e.restore()}},_clearTextArea:function(t){var e=this.width+4,i=this.height+4;t.clearRect(-e/2,-i/2,e,i)},get2DCursorLocation:function(t){"undefined"==typeof t&&(t=this.selectionStart);for(var e=this._textLines.length,i=0;i<e;i++){if(t<=this._textLines[i].length)return{lineIndex:i,charIndex:t};t-=this._textLines[i].length+1}return{lineIndex:i-1,charIndex:this._textLines[i-1].length<t?this._textLines[i-1].length:t}},getCurrentCharStyle:function(t,e){var i=this._getStyleDeclaration(t,0===e?0:e-1);return{fontSize:i&&i.fontSize||this.fontSize,fill:i&&i.fill||this.fill,textBackgroundColor:i&&i.textBackgroundColor||this.textBackgroundColor,textDecoration:i&&i.textDecoration||this.textDecoration,fontFamily:i&&i.fontFamily||this.fontFamily,fontWeight:i&&i.fontWeight||this.fontWeight,fontStyle:i&&i.fontStyle||this.fontStyle,stroke:i&&i.stroke||this.stroke,strokeWidth:i&&i.strokeWidth||this.strokeWidth}},getCurrentCharFontSize:function(t,e){var i=this._getStyleDeclaration(t,0===e?0:e-1);return i&&i.fontSize?i.fontSize:this.fontSize},getCurrentCharColor:function(t,e){var i=this._getStyleDeclaration(t,0===e?0:e-1);return i&&i.fill?i.fill:this.cursorColor},_getCursorBoundaries:function(t,e){var i=Math.round(this._getLeftOffset()),r=this._getTopOffset(),n=this._getCursorBoundariesOffsets(t,e);return{left:i,top:r,leftOffset:n.left+n.lineLeft,topOffset:n.top}},_getCursorBoundariesOffsets:function(t,e){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;for(var i,r=0,n=0,s=0,o=0,a=0,h=0;h<this.selectionStart;h++)"\n"===t[h]?(a=0,o+=this._getHeightOfLine(this.ctx,n),n++,s=0):(a+=this._getWidthOfChar(this.ctx,t[h],n,s),s++),r=this._getLineLeftOffset(this._getLineWidth(this.ctx,n));return"cursor"===e&&(o+=(1-this._fontSizeFraction)*this._getHeightOfLine(this.ctx,n)/this.lineHeight-this.getCurrentCharFontSize(n,s)*(1-this._fontSizeFraction)),0!==this.charSpacing&&s===this._textLines[n].length&&(a-=this._getWidthOfCharSpacing()),i={top:o,left:a>0?a:0,lineLeft:r},this.cursorOffsetCache=i,this.cursorOffsetCache},renderCursor:function(t,e){var i=this.get2DCursorLocation(),r=i.lineIndex,n=i.charIndex,s=this.getCurrentCharFontSize(r,n),o=0===r&&0===n?this._getLineLeftOffset(this._getLineWidth(e,r)):t.leftOffset,a=this.scaleX*this.canvas.getZoom(),h=this.cursorWidth/a;e.fillStyle=this.getCurrentCharColor(r,n),e.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,e.fillRect(t.left+o-h/2,t.top+t.topOffset,h,s)},renderSelection:function(t,e,i){i.fillStyle=this.selectionColor;for(var r=this.get2DCursorLocation(this.selectionStart),n=this.get2DCursorLocation(this.selectionEnd),s=r.lineIndex,o=n.lineIndex,a=s;a<=o;a++){var h=this._getLineLeftOffset(this._getLineWidth(i,a))||0,c=this._getHeightOfLine(this.ctx,a),l=0,u=0,f=this._textLines[a];if(a===s){for(var d=0,g=f.length;d<g;d++)d>=r.charIndex&&(a!==o||d<n.charIndex)&&(u+=this._getWidthOfChar(i,f[d],a,d)),d<r.charIndex&&(h+=this._getWidthOfChar(i,f[d],a,d));d===f.length&&(u-=this._getWidthOfCharSpacing())}else if(a>s&&a<o)u+=this._getLineWidth(i,a)||5;else if(a===o){for(var p=0,v=n.charIndex;p<v;p++)u+=this._getWidthOfChar(i,f[p],a,p);n.charIndex===f.length&&(u-=this._getWidthOfCharSpacing())}l=c,(this.lineHeight<1||a===o&&this.lineHeight>1)&&(c/=this.lineHeight),i.fillRect(e.left+h,e.top+e.topOffset,u>0?u:0,c),e.topOffset+=l}},_renderChars:function(t,e,i,r,n,s,o){if(this.isEmptyStyles())return this._renderCharsFast(t,e,i,r,n);o=o||0;var a,h,c=this._getHeightOfLine(e,s),l="";e.save(),n-=c/this.lineHeight*this._fontSizeFraction;for(var u=o,f=i.length+o;u<=f;u++)a=a||this.getCurrentCharStyle(s,u),h=this.getCurrentCharStyle(s,u+1),(this._hasStyleChanged(a,h)||u===f)&&(this._renderChar(t,e,s,u-1,l,r,n,c),l="",a=h),l+=i[u-o];e.restore()},_renderCharsFast:function(t,e,i,r,n){"fillText"===t&&this.fill&&this.callSuper("_renderChars",t,e,i,r,n),"strokeText"===t&&(this.stroke&&this.strokeWidth>0||this.skipFillStrokeCheck)&&this.callSuper("_renderChars",t,e,i,r,n)},_renderChar:function(t,e,i,r,n,s,o,a){var h,c,l,u,f,d,g,p,v,b=this._getStyleDeclaration(i,r);if(b?(c=this._getHeightOfChar(e,n,i,r),u=b.stroke,l=b.fill,d=b.textDecoration):c=this.fontSize,u=(u||this.stroke)&&"strokeText"===t,l=(l||this.fill)&&"fillText"===t,b&&e.save(),h=this._applyCharStylesGetWidth(e,n,i,r,b||null),d=d||this.textDecoration,b&&b.textBackgroundColor&&this._removeShadow(e),0!==this.charSpacing){p=this._getWidthOfCharSpacing(),g=n.split(""),h=0;for(var m,y=0,_=g.length;y<_;y++)m=g[y],l&&e.fillText(m,s+h,o),u&&e.strokeText(m,s+h,o),v=e.measureText(m).width+p,h+=v>0?v:0}else l&&e.fillText(n,s,o),u&&e.strokeText(n,s,o);(d||""!==d)&&(f=this._fontSizeFraction*a/this.lineHeight,this._renderCharDecoration(e,d,s,o,f,h,c)),b&&e.restore(),e.translate(h,0)},_hasStyleChanged:function(t,e){return t.fill!==e.fill||t.fontSize!==e.fontSize||t.textBackgroundColor!==e.textBackgroundColor||t.textDecoration!==e.textDecoration||t.fontFamily!==e.fontFamily||t.fontWeight!==e.fontWeight||t.fontStyle!==e.fontStyle||t.stroke!==e.stroke||t.strokeWidth!==e.strokeWidth},_renderCharDecoration:function(t,e,i,r,n,s,o){if(e){var a,h,c=o/15,l={underline:r+o/10,"line-through":r-o*(this._fontSizeFraction+this._fontSizeMult-1)+c,overline:r-(this._fontSizeMult-this._fontSizeFraction)*o},u=["underline","line-through","overline"];for(a=0;a<u.length;a++)h=u[a],e.indexOf(h)>-1&&t.fillRect(i,l[h],s,c)}},_renderTextLine:function(t,e,i,r,n,s){this.isEmptyStyles()||(n+=this.fontSize*(this._fontSizeFraction+.03)),this.callSuper("_renderTextLine",t,e,i,r,n,s)},_renderTextDecoration:function(t){if(this.isEmptyStyles())return this.callSuper("_renderTextDecoration",t)},_renderTextLinesBackground:function(t){this.callSuper("_renderTextLinesBackground",t);for(var e,i,r,n,s,o,a=0,h=this._getLeftOffset(),c=this._getTopOffset(),l=0,u=this._textLines.length;l<u;l++)if(e=this._getHeightOfLine(t,l),n=this._textLines[l],""!==n&&this.styles&&this._getLineStyle(l)){i=this._getLineWidth(t,l),r=this._getLineLeftOffset(i);for(var f=0,d=n.length;f<d;f++)o=this._getStyleDeclaration(l,f),o&&o.textBackgroundColor&&(s=n[f],t.fillStyle=o.textBackgroundColor,t.fillRect(h+r+this._getWidthOfCharsAt(t,l,f),c+a,this._getWidthOfChar(t,s,l,f),e/this.lineHeight));a+=e}else a+=e},_getCacheProp:function(t,e){return t+e.fontSize+e.fontWeight+e.fontStyle},_getFontCache:function(t){return fabric.charWidthsCache[t]||(fabric.charWidthsCache[t]={}),fabric.charWidthsCache[t]},_applyCharStylesGetWidth:function(e,i,r,n,s){var o,a,h,c=s||this._getStyleDeclaration(r,n),l=t(c);if(this._applyFontStyles(l),h=this._getFontCache(l.fontFamily),a=this._getCacheProp(i,l),!c&&h[a]&&this.caching)return h[a];"string"==typeof l.shadow&&(l.shadow=new fabric.Shadow(l.shadow));var u=l.fill||this.fill;return e.fillStyle=u.toLive?u.toLive(e,this):u,l.stroke&&(e.strokeStyle=l.stroke&&l.stroke.toLive?l.stroke.toLive(e,this):l.stroke),e.lineWidth=l.strokeWidth||this.strokeWidth,e.font=this._getFontDeclaration.call(l),l.shadow&&(l.scaleX=this.scaleX,l.scaleY=this.scaleY,l.canvas=this.canvas,l.getObjectScaling=this.getObjectScaling,this._setShadow.call(l,e)),this.caching&&h[a]?h[a]:(o=e.measureText(i).width,this.caching&&(h[a]=o),o)},_applyFontStyles:function(t){t.fontFamily||(t.fontFamily=this.fontFamily),t.fontSize||(t.fontSize=this.fontSize),t.fontWeight||(t.fontWeight=this.fontWeight),t.fontStyle||(t.fontStyle=this.fontStyle)},_getStyleDeclaration:function(e,i,r){return r?this.styles[e]&&this.styles[e][i]?t(this.styles[e][i]):{}:this.styles[e]&&this.styles[e][i]?this.styles[e][i]:null},_setStyleDeclaration:function(t,e,i){this.styles[t][e]=i},_deleteStyleDeclaration:function(t,e){delete this.styles[t][e]},_getLineStyle:function(t){return this.styles[t]},_setLineStyle:function(t,e){this.styles[t]=e},_deleteLineStyle:function(t){delete this.styles[t]},_getWidthOfChar:function(t,e,i,r){if(!this._isMeasuring&&"justify"===this.textAlign&&this._reSpacesAndTabs.test(e))return this._getWidthOfSpace(t,i);t.save();var n=this._applyCharStylesGetWidth(t,e,i,r);return 0!==this.charSpacing&&(n+=this._getWidthOfCharSpacing()),t.restore(),n>0?n:0},_getHeightOfChar:function(t,e,i){var r=this._getStyleDeclaration(e,i);return r&&r.fontSize?r.fontSize:this.fontSize},_getWidthOfCharsAt:function(t,e,i){var r,n,s=0;for(r=0;r<i;r++)n=this._textLines[e][r],s+=this._getWidthOfChar(t,n,e,r);return s},_measureLine:function(t,e){this._isMeasuring=!0;var i=this._getWidthOfCharsAt(t,e,this._textLines[e].length);return 0!==this.charSpacing&&(i-=this._getWidthOfCharSpacing()),this._isMeasuring=!1,i>0?i:0},_getWidthOfSpace:function(t,e){if(this.__widthOfSpace[e])return this.__widthOfSpace[e];var i=this._textLines[e],r=this._getWidthOfWords(t,i,e,0),n=this.width-r,s=i.length-i.replace(this._reSpacesAndTabs,"").length,o=Math.max(n/s,t.measureText(" ").width);return this.__widthOfSpace[e]=o,o},_getWidthOfWords:function(t,e,i,r){for(var n=0,s=0;s<e.length;s++){var o=e[s];o.match(/\s/)||(n+=this._getWidthOfChar(t,o,i,s+r))}return n},_getHeightOfLine:function(t,e){if(this.__lineHeights[e])return this.__lineHeights[e];for(var i=this._textLines[e],r=this._getHeightOfChar(t,e,0),n=1,s=i.length;n<s;n++){var o=this._getHeightOfChar(t,e,n);o>r&&(r=o)}return this.__lineHeights[e]=r*this.lineHeight*this._fontSizeMult,this.__lineHeights[e]},_getTextHeight:function(t){for(var e,i=0,r=0,n=this._textLines.length;r<n;r++)e=this._getHeightOfLine(t,r),i+=r===n-1?e/this.lineHeight:e;return i},toObject:function(e){return fabric.util.object.extend(this.callSuper("toObject",e),{styles:t(this.styles,!0)})}}),fabric.IText.fromObject=function(e,i){var r=new fabric.IText(e.text,t(e));return i&&i(r),r}}(),function(){var t=fabric.util.object.clone;fabric.util.object.extend(fabric.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},initSelectedHandler:function(){this.on("selected",function(){var t=this;setTimeout(function(){t.selected=!0},100)})},initAddedHandler:function(){var t=this;this.on("added",function(){var e=t.canvas;e&&(e._hasITextHandlers||(e._hasITextHandlers=!0,t._initCanvasHandlers(e)),e._iTextInstances=e._iTextInstances||[],e._iTextInstances.push(t))})},initRemovedHandler:function(){var t=this;this.on("removed",function(){var e=t.canvas;e&&(e._iTextInstances=e._iTextInstances||[],fabric.util.removeFromArray(e._iTextInstances,t),0===e._iTextInstances.length&&(e._hasITextHandlers=!1,t._removeCanvasHandlers(e)))})},_initCanvasHandlers:function(t){t._canvasITextSelectionClearedHanlder=function(){fabric.IText.prototype.exitEditingOnOthers(t)}.bind(this),t._mouseUpITextHandler=function(){t._iTextInstances&&t._iTextInstances.forEach(function(t){t.__isMousedown=!1})}.bind(this),t.on("selection:cleared",t._canvasITextSelectionClearedHanlder),t.on("object:selected",t._canvasITextSelectionClearedHanlder),t.on("mouse:up",t._mouseUpITextHandler)},_removeCanvasHandlers:function(t){t.off("selection:cleared",t._canvasITextSelectionClearedHanlder),t.off("object:selected",t._canvasITextSelectionClearedHanlder),t.off("mouse:up",t._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(t,e,i,r){var n;return n={isAborted:!1,abort:function(){this.isAborted=!0}},t.animate("_currentCursorOpacity",e,{duration:i,onComplete:function(){n.isAborted||t[r]()},onChange:function(){t.canvas&&t.selectionStart===t.selectionEnd&&t.renderCursorOrSelection()},abort:function(){return n.isAborted}}),n},_onTickComplete:function(){var t=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){t._currentTickCompleteState=t._animateCursor(t,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(t){var e=this,i=t?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout(function(){e._tick()},i)},abortCursorAnimation:function(){var t=this._currentTickState||this._currentTickCompleteState;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,t&&this.canvas&&this.canvas.clearContext(this.canvas.contextTop||this.ctx)},selectAll:function(){this.selectionStart=0,this.selectionEnd=this.text.length,this._fireSelectionChanged(),this._updateTextarea()},getSelectedText:function(){return this.text.slice(this.selectionStart,this.selectionEnd)},findWordBoundaryLeft:function(t){var e=0,i=t-1;if(this._reSpace.test(this.text.charAt(i)))for(;this._reSpace.test(this.text.charAt(i));)e++,i--;for(;/\S/.test(this.text.charAt(i))&&i>-1;)e++,i--;return t-e},findWordBoundaryRight:function(t){var e=0,i=t;if(this._reSpace.test(this.text.charAt(i)))for(;this._reSpace.test(this.text.charAt(i));)e++,i++;for(;/\S/.test(this.text.charAt(i))&&i<this.text.length;)e++,i++;return t+e},findLineBoundaryLeft:function(t){for(var e=0,i=t-1;!/\n/.test(this.text.charAt(i))&&i>-1;)e++,i--;return t-e},findLineBoundaryRight:function(t){for(var e=0,i=t;!/\n/.test(this.text.charAt(i))&&i<this.text.length;)e++,i++;return t+e},getNumNewLinesInSelectedText:function(){for(var t=this.getSelectedText(),e=0,i=0,r=t.length;i<r;i++)"\n"===t[i]&&e++;return e},searchWordBoundary:function(t,e){for(var i=this._reSpace.test(this.text.charAt(t))?t-1:t,r=this.text.charAt(i),n=/[ \n\.,;!\?\-]/;!n.test(r)&&i>0&&i<this.text.length;)i+=e,r=this.text.charAt(i);return n.test(r)&&"\n"!==r&&(i+=1===e?0:1),i},selectWord:function(t){t=t||this.selectionStart;var e=this.searchWordBoundary(t,-1),i=this.searchWordBoundary(t,1);this.selectionStart=e,this.selectionEnd=i,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(t){t=t||this.selectionStart;var e=this.findLineBoundaryLeft(t),i=this.findLineBoundaryRight(t);this.selectionStart=e,this.selectionEnd=i,this._fireSelectionChanged(),this._updateTextarea()},enterEditing:function(t){if(!this.isEditing&&this.editable)return this.canvas&&this.exitEditingOnOthers(this.canvas),this.isEditing=!0,this.initHiddenTextarea(t),this.hiddenTextarea.focus(),this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.renderAll(),this):this},exitEditingOnOthers:function(t){t._iTextInstances&&t._iTextInstances.forEach(function(t){t.selected=!1,t.isEditing&&t.exitEditing()})},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(t){if(this.__isMousedown&&this.isEditing){var e=this.getSelectionStartFromPointer(t.e),i=this.selectionStart,r=this.selectionEnd;e!==this.__selectionStartOnMouseDown&&(e>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=e):(this.selectionStart=e,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===i&&this.selectionEnd===r||(this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},_updateTextarea:function(){if(this.hiddenTextarea&&!this.inCompositionMode&&(this.cursorOffsetCache={},this.hiddenTextarea.value=this.text,this.hiddenTextarea.selectionStart=this.selectionStart,this.hiddenTextarea.selectionEnd=this.selectionEnd,this.selectionStart===this.selectionEnd)){var t=this._calcTextareaPosition();this.hiddenTextarea.style.left=t.left,this.hiddenTextarea.style.top=t.top,this.hiddenTextarea.style.fontSize=t.fontSize}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var t=this.text.split(""),e=this._getCursorBoundaries(t,"cursor"),i=this.get2DCursorLocation(),r=i.lineIndex,n=i.charIndex,s=this.getCurrentCharFontSize(r,n),o=0===r&&0===n?this._getLineLeftOffset(this._getLineWidth(this.ctx,r)):e.leftOffset,a=this.calcTransformMatrix(),h={x:e.left+o,y:e.top+e.topOffset+s},c=this.canvas.upperCanvasEl,l=c.width-s,u=c.height-s;return h=fabric.util.transformPoint(h,a),h=fabric.util.transformPoint(h,this.canvas.viewportTransform),h.x<0&&(h.x=0),h.x>l&&(h.x=l),h.y<0&&(h.y=0),h.y>u&&(h.y=u),h.x+=this.canvas._offset.left,h.y+=this.canvas._offset.top,{left:h.x+"px",top:h.y+"px",fontSize:s}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.overCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.lockMovementX=this._savedProps.lockMovementX,
this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var t=this._textBeforeEdit!==this.text;return this.selected=!1,this.isEditing=!1,this.selectable=!0,this.selectionEnd=this.selectionStart,this.hiddenTextarea&&this.canvas&&this.hiddenTextarea.parentNode.removeChild(this.hiddenTextarea),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this.fire("editing:exited"),t&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),t&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var t in this.styles)this._textLines[t]||delete this.styles[t]},_removeCharsFromTo:function(t,e){for(;e!==t;)this._removeSingleCharAndStyle(t+1),e--;this.selectionStart=t,this.selectionEnd=t},_removeSingleCharAndStyle:function(t){var e="\n"===this.text[t-1],i=e?t:t-1;this.removeStyleObject(e,i),this.text=this.text.slice(0,t-1)+this.text.slice(t),this._textLines=this._splitTextIntoLines()},insertChars:function(t,e){var i;if(this.selectionEnd-this.selectionStart>1&&this._removeCharsFromTo(this.selectionStart,this.selectionEnd),!e&&this.isEmptyStyles())return void this.insertChar(t,!1);for(var r=0,n=t.length;r<n;r++)e&&(i=fabric.copiedTextStyle[r]),this.insertChar(t[r],r<n-1,i)},insertChar:function(t,e,i){var r="\n"===this.text[this.selectionStart];this.text=this.text.slice(0,this.selectionStart)+t+this.text.slice(this.selectionEnd),this._textLines=this._splitTextIntoLines(),this.insertStyleObjects(t,r,i),this.selectionStart+=t.length,this.selectionEnd=this.selectionStart,e||(this._updateTextarea(),this.setCoords(),this._fireSelectionChanged(),this.fire("changed"),this.canvas&&this.canvas.fire("text:changed",{target:this}),this.canvas&&this.canvas.renderAll())},insertNewlineStyleObject:function(e,i,r){this.shiftLineStyles(e,1),this.styles[e+1]||(this.styles[e+1]={});var n={},s={};if(this.styles[e]&&this.styles[e][i-1]&&(n=this.styles[e][i-1]),r)s[0]=t(n),this.styles[e+1]=s;else{for(var o in this.styles[e])parseInt(o,10)>=i&&(s[parseInt(o,10)-i]=this.styles[e][o],delete this.styles[e][o]);this.styles[e+1]=s}this._forceClearCache=!0},insertCharStyleObject:function(e,i,r){var n=this.styles[e],s=t(n);0!==i||r||(i=1);for(var o in s){var a=parseInt(o,10);a>=i&&(n[a+1]=s[a],s[a-1]||delete n[a])}this.styles[e][i]=r||t(n[i-1]),this._forceClearCache=!0},insertStyleObjects:function(t,e,i){var r=this.get2DCursorLocation(),n=r.lineIndex,s=r.charIndex;this._getLineStyle(n)||this._setLineStyle(n,{}),"\n"===t?this.insertNewlineStyleObject(n,s,e):this.insertCharStyleObject(n,s,i)},shiftLineStyles:function(e,i){var r=t(this.styles);for(var n in this.styles){var s=parseInt(n,10);s>e&&(this.styles[s+i]=r[s],r[s-i]||delete this.styles[s])}},removeStyleObject:function(t,e){var i=this.get2DCursorLocation(e),r=i.lineIndex,n=i.charIndex;this._removeStyleObject(t,i,r,n)},_getTextOnPreviousLine:function(t){return this._textLines[t-1]},_removeStyleObject:function(e,i,r,n){if(e){var s=this._getTextOnPreviousLine(i.lineIndex),o=s?s.length:0;this.styles[r-1]||(this.styles[r-1]={});for(n in this.styles[r])this.styles[r-1][parseInt(n,10)+o]=this.styles[r][n];this.shiftLineStyles(i.lineIndex,-1)}else{var a=this.styles[r];a&&delete a[n];var h=t(a);for(var c in h){var l=parseInt(c,10);l>=n&&0!==l&&(a[l-1]=h[l],delete a[l])}}},insertNewline:function(){this.insertChars("\n")},setSelectionStartEndWithShift:function(t,e,i){i<=t?(e===t?this._selectionDirection="left":"right"===this._selectionDirection&&(this._selectionDirection="left",this.selectionEnd=t),this.selectionStart=i):i>t&&i<e?"right"===this._selectionDirection?this.selectionEnd=i:this.selectionStart=i:(e===t?this._selectionDirection="right":"left"===this._selectionDirection&&(this._selectionDirection="right",this.selectionStart=e),this.selectionEnd=i)},setSelectionInBoundaries:function(){var t=this.text.length;this.selectionStart>t?this.selectionStart=t:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>t?this.selectionEnd=t:this.selectionEnd<0&&(this.selectionEnd=0)}})}(),fabric.util.object.extend(fabric.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown.bind(this))},onMouseDown:function(t){this.__newClickTime=+new Date;var e=this.canvas.getPointer(t.e);this.isTripleClick(e)?(this.fire("tripleclick",t),this._stopEvent(t.e)):this.isDoubleClick(e)&&(this.fire("dblclick",t),this._stopEvent(t.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=e,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected},isDoubleClick:function(t){return this.__newClickTime-this.__lastClickTime<500&&this.__lastPointer.x===t.x&&this.__lastPointer.y===t.y&&this.__lastIsEditing},isTripleClick:function(t){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===t.x&&this.__lastPointer.y===t.y},_stopEvent:function(t){t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation()},initCursorSelectionHandlers:function(){this.initSelectedHandler(),this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},initClicks:function(){this.on("dblclick",function(t){this.selectWord(this.getSelectionStartFromPointer(t.e))}),this.on("tripleclick",function(t){this.selectLine(this.getSelectionStartFromPointer(t.e))})},initMousedownHandler:function(){this.on("mousedown",function(t){if(this.editable){var e=this.canvas.getPointer(t.e);this.__mousedownX=e.x,this.__mousedownY=e.y,this.__isMousedown=!0,this.selected&&this.setCursorByClick(t.e),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection())}})},_isObjectMoved:function(t){var e=this.canvas.getPointer(t);return this.__mousedownX!==e.x||this.__mousedownY!==e.y},initMouseupHandler:function(){this.on("mouseup",function(t){this.__isMousedown=!1,this.editable&&!this._isObjectMoved(t.e)&&(this.__lastSelected&&!this.__corner&&(this.enterEditing(t.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()),this.selected=!0)})},setCursorByClick:function(t){var e=this.getSelectionStartFromPointer(t),i=this.selectionStart,r=this.selectionEnd;t.shiftKey?this.setSelectionStartEndWithShift(i,r,e):(this.selectionStart=e,this.selectionEnd=e),this._fireSelectionChanged(),this._updateTextarea()},getSelectionStartFromPointer:function(t){for(var e,i,r=this.getLocalPointer(t),n=0,s=0,o=0,a=0,h=0,c=this._textLines.length;h<c;h++){i=this._textLines[h],o+=this._getHeightOfLine(this.ctx,h)*this.scaleY;var l=this._getLineWidth(this.ctx,h),u=this._getLineLeftOffset(l);s=u*this.scaleX;for(var f=0,d=i.length;f<d;f++){if(n=s,s+=this._getWidthOfChar(this.ctx,i[f],h,this.flipX?d-f:f)*this.scaleX,!(o<=r.y||s<=r.x))return this._getNewSelectionStartFromOffset(r,n,s,a+h,d);a++}if(r.y<o)return this._getNewSelectionStartFromOffset(r,n,s,a+h-1,d)}if("undefined"==typeof e)return this.text.length},_getNewSelectionStartFromOffset:function(t,e,i,r,n){var s=t.x-e,o=i-t.x,a=o>s?0:1,h=r+a;return this.flipX&&(h=n-h),h>this.text.length&&(h=this.text.length),h}}),fabric.util.object.extend(fabric.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=fabric.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off");var t=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+t.top+"; left: "+t.left+"; opacity: 0; width: 0px; height: 0px; z-index: -999;",fabric.document.body.appendChild(this.hiddenTextarea),fabric.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),fabric.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),fabric.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),fabric.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),fabric.util.addListener(this.hiddenTextarea,"cut",this.cut.bind(this)),fabric.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),fabric.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),fabric.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),fabric.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(fabric.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},_keysMap:{8:"removeChars",9:"exitEditing",27:"exitEditing",13:"insertNewline",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown",46:"forwardDelete"},_ctrlKeysMapUp:{67:"copy",88:"cut"},_ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(t){if(this.isEditing){if(t.keyCode in this._keysMap)this[this._keysMap[t.keyCode]](t);else{if(!(t.keyCode in this._ctrlKeysMapDown&&(t.ctrlKey||t.metaKey)))return;this[this._ctrlKeysMapDown[t.keyCode]](t)}t.stopImmediatePropagation(),t.preventDefault(),this.canvas&&this.canvas.renderAll()}},onKeyUp:function(t){return!this.isEditing||this._copyDone?void(this._copyDone=!1):void(t.keyCode in this._ctrlKeysMapUp&&(t.ctrlKey||t.metaKey)&&(this[this._ctrlKeysMapUp[t.keyCode]](t),t.stopImmediatePropagation(),t.preventDefault(),this.canvas&&this.canvas.renderAll()))},onInput:function(t){if(this.isEditing&&!this.inCompositionMode){var e,i,r,n=this.selectionStart||0,s=this.selectionEnd||0,o=this.text.length,a=this.hiddenTextarea.value.length;a>o?(r="left"===this._selectionDirection?s:n,e=a-o,i=this.hiddenTextarea.value.slice(r,r+e)):(e=a-o+s-n,i=this.hiddenTextarea.value.slice(n,n+e)),this.insertChars(i),t.stopPropagation()}},onCompositionStart:function(){this.inCompositionMode=!0,this.prevCompositionLength=0,this.compositionStart=this.selectionStart},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(t){var e=t.data;this.selectionStart=this.compositionStart,this.selectionEnd=this.selectionEnd===this.selectionStart?this.compositionStart+this.prevCompositionLength:this.selectionEnd,this.insertChars(e,!1),this.prevCompositionLength=e.length},forwardDelete:function(t){if(this.selectionStart===this.selectionEnd){if(this.selectionStart===this.text.length)return;this.moveCursorRight(t)}this.removeChars(t)},copy:function(t){if(this.selectionStart!==this.selectionEnd){var e=this.getSelectedText(),i=this._getClipboardData(t);i&&i.setData("text",e),fabric.copiedText=e,fabric.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd),t.stopImmediatePropagation(),t.preventDefault(),this._copyDone=!0}},paste:function(t){var e=null,i=this._getClipboardData(t),r=!0;i?(e=i.getData("text").replace(/\r/g,""),fabric.copiedTextStyle&&fabric.copiedText===e||(r=!1)):e=fabric.copiedText,e&&this.insertChars(e,r),t.stopImmediatePropagation(),t.preventDefault()},cut:function(t){this.selectionStart!==this.selectionEnd&&(this.copy(t),this.removeChars(t))},_getClipboardData:function(t){return t&&t.clipboardData||fabric.window.clipboardData},_getWidthBeforeCursor:function(t,e){for(var i,r=this._textLines[t].slice(0,e),n=this._getLineWidth(this.ctx,t),s=this._getLineLeftOffset(n),o=0,a=r.length;o<a;o++)i=r[o],s+=this._getWidthOfChar(this.ctx,i,t,o);return s},getDownCursorOffset:function(t,e){var i=this._getSelectionForOffset(t,e),r=this.get2DCursorLocation(i),n=r.lineIndex;if(n===this._textLines.length-1||t.metaKey||34===t.keyCode)return this.text.length-i;var s=r.charIndex,o=this._getWidthBeforeCursor(n,s),a=this._getIndexOnLine(n+1,o),h=this._textLines[n].slice(s);return h.length+a+2},_getSelectionForOffset:function(t,e){return t.shiftKey&&this.selectionStart!==this.selectionEnd&&e?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(t,e){var i=this._getSelectionForOffset(t,e),r=this.get2DCursorLocation(i),n=r.lineIndex;if(0===n||t.metaKey||33===t.keyCode)return-i;var s=r.charIndex,o=this._getWidthBeforeCursor(n,s),a=this._getIndexOnLine(n-1,o),h=this._textLines[n].slice(0,s);return-this._textLines[n-1].length+a-h.length},_getIndexOnLine:function(t,e){for(var i,r=this._getLineWidth(this.ctx,t),n=this._textLines[t],s=this._getLineLeftOffset(r),o=s,a=0,h=0,c=n.length;h<c;h++){var l=n[h],u=this._getWidthOfChar(this.ctx,l,t,h);if(o+=u,o>e){i=!0;var f=o-u,d=o,g=Math.abs(f-e),p=Math.abs(d-e);a=p<g?h:h-1;break}}return i||(a=n.length-1),a},moveCursorDown:function(t){this.selectionStart>=this.text.length&&this.selectionEnd>=this.text.length||this._moveCursorUpOrDown("Down",t)},moveCursorUp:function(t){0===this.selectionStart&&0===this.selectionEnd||this._moveCursorUpOrDown("Up",t)},_moveCursorUpOrDown:function(t,e){var i="get"+t+"CursorOffset",r=this[i](e,"right"===this._selectionDirection);e.shiftKey?this.moveCursorWithShift(r):this.moveCursorWithoutShift(r),0!==r&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(t){var e="left"===this._selectionDirection?this.selectionStart+t:this.selectionEnd+t;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,e),0!==t},moveCursorWithoutShift:function(t){return t<0?(this.selectionStart+=t,this.selectionEnd=this.selectionStart):(this.selectionEnd+=t,this.selectionStart=this.selectionEnd),0!==t},moveCursorLeft:function(t){0===this.selectionStart&&0===this.selectionEnd||this._moveCursorLeftOrRight("Left",t)},_move:function(t,e,i){var r;if(t.altKey)r=this["findWordBoundary"+i](this[e]);else{if(!t.metaKey&&35!==t.keyCode&&36!==t.keyCode)return this[e]+="Left"===i?-1:1,!0;r=this["findLineBoundary"+i](this[e])}if(void 0!==typeof r&&this[e]!==r)return this[e]=r,!0},_moveLeft:function(t,e){return this._move(t,e,"Left")},_moveRight:function(t,e){return this._move(t,e,"Right")},moveCursorLeftWithoutShift:function(t){var e=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&0!==this.selectionStart&&(e=this._moveLeft(t,"selectionStart")),this.selectionEnd=this.selectionStart,e},moveCursorLeftWithShift:function(t){return"right"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?this._moveLeft(t,"selectionEnd"):0!==this.selectionStart?(this._selectionDirection="left",this._moveLeft(t,"selectionStart")):void 0},moveCursorRight:function(t){this.selectionStart>=this.text.length&&this.selectionEnd>=this.text.length||this._moveCursorLeftOrRight("Right",t)},_moveCursorLeftOrRight:function(t,e){var i="moveCursor"+t+"With";this._currentCursorOpacity=1,i+=e.shiftKey?"Shift":"outShift",this[i](e)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(t){return"left"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?this._moveRight(t,"selectionStart"):this.selectionEnd!==this.text.length?(this._selectionDirection="right",this._moveRight(t,"selectionEnd")):void 0},moveCursorRightWithoutShift:function(t){var e=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(e=this._moveRight(t,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,e},removeChars:function(t){this.selectionStart===this.selectionEnd?this._removeCharsNearCursor(t):this._removeCharsFromTo(this.selectionStart,this.selectionEnd),this.setSelectionEnd(this.selectionStart),this._removeExtraneousStyles(),this.canvas&&this.canvas.renderAll(),this.setCoords(),this.fire("changed"),this.canvas&&this.canvas.fire("text:changed",{target:this})},_removeCharsNearCursor:function(t){if(0!==this.selectionStart)if(t.metaKey){var e=this.findLineBoundaryLeft(this.selectionStart);this._removeCharsFromTo(e,this.selectionStart),this.setSelectionStart(e)}else if(t.altKey){var i=this.findWordBoundaryLeft(this.selectionStart);this._removeCharsFromTo(i,this.selectionStart),this.setSelectionStart(i)}else this._removeSingleCharAndStyle(this.selectionStart),this.setSelectionStart(this.selectionStart-1)}}),function(){var t=fabric.util.toFixed,e=fabric.Object.NUM_FRACTION_DIGITS;fabric.util.object.extend(fabric.IText.prototype,{_setSVGTextLineText:function(t,e,i,r,n,s){this._getLineStyle(t)?this._setSVGTextLineChars(t,e,i,r,s):fabric.Text.prototype._setSVGTextLineText.call(this,t,e,i,r,n)},_setSVGTextLineChars:function(t,e,i,r,n){for(var s=this._textLines[t],o=0,a=this._getLineLeftOffset(this._getLineWidth(this.ctx,t))-this.width/2,h=this._getSVGLineTopOffset(t),c=this._getHeightOfLine(this.ctx,t),l=0,u=s.length;l<u;l++){var f=this._getStyleDeclaration(t,l)||{};e.push(this._createTextCharSpan(s[l],f,a,h.lineTop+h.offset,o));var d=this._getWidthOfChar(this.ctx,s[l],t,l);f.textBackgroundColor&&n.push(this._createTextCharBg(f,a,h.lineTop,c,d,o)),o+=d}},_getSVGLineTopOffset:function(t){for(var e=0,i=0,r=0;r<t;r++)e+=this._getHeightOfLine(this.ctx,r);return i=this._getHeightOfLine(this.ctx,r),{lineTop:e,offset:(this._fontSizeMult-this._fontSizeFraction)*i/(this.lineHeight*this._fontSizeMult)}},_createTextCharBg:function(i,r,n,s,o,a){return['\t\t<rect fill="',i.textBackgroundColor,'" x="',t(r+a,e),'" y="',t(n-this.height/2,e),'" width="',t(o,e),'" height="',t(s/this.lineHeight,e),'"></rect>\n'].join("")},_createTextCharSpan:function(i,r,n,s,o){var a=this.getSvgStyles.call(fabric.util.object.extend({visible:!0,fill:this.fill,stroke:this.stroke,type:"text",getSvgFilter:fabric.Object.prototype.getSvgFilter},r));return['\t\t\t<tspan x="',t(n+o,e),'" y="',t(s-this.height/2,e),'" ',r.fontFamily?'font-family="'+r.fontFamily.replace(/"/g,"'")+'" ':"",r.fontSize?'font-size="'+r.fontSize+'" ':"",r.fontStyle?'font-style="'+r.fontStyle+'" ':"",r.fontWeight?'font-weight="'+r.fontWeight+'" ':"",r.textDecoration?'text-decoration="'+r.textDecoration+'" ':"",'style="',a,'">',fabric.util.string.escapeXml(i),"</tspan>\n"].join("")}})}(),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.clone;e.Textbox=e.util.createClass(e.IText,e.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingY:!0,lockScalingFlip:!0,initialize:function(t,i){this.ctx=e.util.createCanvasElement().getContext("2d"),this.callSuper("initialize",t,i),this.setControlsVisibility(e.Textbox.getTextboxControlVisibility()),this._dimensionAffectingProps.width=!0},_initDimensions:function(t){this.__skipDimension||(t||(t=e.util.createCanvasElement().getContext("2d"),this._setTextStyles(t)),this.dynamicMinWidth=0,this._textLines=this._splitTextIntoLines(),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this._clearCache(),this.height=this._getTextHeight(t))},_generateStyleMap:function(){for(var t=0,e=0,i=0,r={},n=0;n<this._textLines.length;n++)"\n"===this.text[i]&&n>0?(e=0,i++,t++):" "===this.text[i]&&n>0&&(e++,i++),r[n]={line:t,offset:e},i+=this._textLines[n].length,e+=this._textLines[n].length;return r},_getStyleDeclaration:function(t,e,i){if(this._styleMap){var r=this._styleMap[t];if(!r)return i?{}:null;t=r.line,e=r.offset+e}return this.callSuper("_getStyleDeclaration",t,e,i)},_setStyleDeclaration:function(t,e,i){var r=this._styleMap[t];t=r.line,e=r.offset+e,this.styles[t][e]=i},_deleteStyleDeclaration:function(t,e){var i=this._styleMap[t];t=i.line,e=i.offset+e,delete this.styles[t][e]},_getLineStyle:function(t){var e=this._styleMap[t];return this.styles[e.line]},_setLineStyle:function(t,e){var i=this._styleMap[t];this.styles[i.line]=e},_deleteLineStyle:function(t){var e=this._styleMap[t];delete this.styles[e.line]},_wrapText:function(t,e){var i,r=e.split(this._reNewline),n=[];for(i=0;i<r.length;i++)n=n.concat(this._wrapLine(t,r[i],i));return n},_measureText:function(t,e,i,r){var n=0;r=r||0;for(var s=0,o=e.length;s<o;s++)n+=this._getWidthOfChar(t,e[s],i,s+r);return n},_wrapLine:function(t,e,i){for(var r=0,n=[],s="",o=e.split(" "),a="",h=0,c=" ",l=0,u=0,f=0,d=!0,g=this._getWidthOfCharSpacing(),p=0;p<o.length;p++)a=o[p],l=this._measureText(t,a,i,h),h+=a.length,r+=u+l-g,r>=this.width&&!d?(n.push(s),s="",r=l,d=!0):r+=g,d||(s+=c),s+=a,u=this._measureText(t,c,i,h),h++,d=!1,l>f&&(f=l);return p&&n.push(s),f>this.dynamicMinWidth&&(this.dynamicMinWidth=f-g),n},_splitTextIntoLines:function(){var t=this.textAlign;this.ctx.save(),this._setTextStyles(this.ctx),this.textAlign="left";var e=this._wrapText(this.ctx,this.text);return this.textAlign=t,this.ctx.restore(),this._textLines=e,this._styleMap=this._generateStyleMap(),e},setOnGroup:function(t,e){"scaleX"===t&&(this.set("scaleX",Math.abs(1/e)),this.set("width",this.get("width")*e/("undefined"==typeof this.__oldScaleX?1:this.__oldScaleX)),this.__oldScaleX=e)},get2DCursorLocation:function(t){"undefined"==typeof t&&(t=this.selectionStart);for(var e=this._textLines.length,i=0,r=0;r<e;r++){var n=this._textLines[r],s=n.length;if(t<=i+s)return{lineIndex:r,charIndex:t-i};i+=s,"\n"!==this.text[i]&&" "!==this.text[i]||i++}return{lineIndex:e-1,charIndex:this._textLines[e-1].length}},_getCursorBoundariesOffsets:function(t,e){for(var i=0,r=0,n=this.get2DCursorLocation(),s=this._textLines[n.lineIndex].split(""),o=this._getLineLeftOffset(this._getLineWidth(this.ctx,n.lineIndex)),a=0;a<n.charIndex;a++)r+=this._getWidthOfChar(this.ctx,s[a],n.lineIndex,a);for(a=0;a<n.lineIndex;a++)i+=this._getHeightOfLine(this.ctx,a);return"cursor"===e&&(i+=(1-this._fontSizeFraction)*this._getHeightOfLine(this.ctx,n.lineIndex)/this.lineHeight-this.getCurrentCharFontSize(n.lineIndex,n.charIndex)*(1-this._fontSizeFraction)),{top:i,left:r,lineLeft:o}},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},toObject:function(t){return this.callSuper("toObject",["minWidth"].concat(t))}}),e.Textbox.fromObject=function(t,r){var n=new e.Textbox(t.text,i(t));return r&&r(n),n},e.Textbox.getTextboxControlVisibility=function(){return{tl:!1,tr:!1,br:!1,bl:!1,ml:!0,mt:!1,mr:!0,mb:!1,mtr:!0}}}("undefined"!=typeof exports?exports:this),function(){var t=fabric.Canvas.prototype._setObjectScale;fabric.Canvas.prototype._setObjectScale=function(e,i,r,n,s,o,a){var h=i.target;if(!(h instanceof fabric.Textbox))return t.call(fabric.Canvas.prototype,e,i,r,n,s,o,a);var c=h.width*(e.x/i.scaleX/(h.width+h.strokeWidth));return c>=h.getMinWidth()?(h.set("width",c),!0):void 0},fabric.Group.prototype._refreshControlsVisibility=function(){if("undefined"!=typeof fabric.Textbox)for(var t=this._objects.length;t--;)if(this._objects[t]instanceof fabric.Textbox)return void this.setControlsVisibility(fabric.Textbox.getTextboxControlVisibility())};var e=fabric.util.object.clone;fabric.util.object.extend(fabric.Textbox.prototype,{_removeExtraneousStyles:function(){for(var t in this._styleMap)this._textLines[t]||delete this.styles[this._styleMap[t].line]},insertCharStyleObject:function(t,e,i){var r=this._styleMap[t];t=r.line,e=r.offset+e,fabric.IText.prototype.insertCharStyleObject.apply(this,[t,e,i])},insertNewlineStyleObject:function(t,e,i){var r=this._styleMap[t];t=r.line,e=r.offset+e,fabric.IText.prototype.insertNewlineStyleObject.apply(this,[t,e,i])},shiftLineStyles:function(t,i){var r=e(this.styles),n=this._styleMap[t];t=n.line;for(var s in this.styles){var o=parseInt(s,10);o>t&&(this.styles[o+i]=r[o],r[o-i]||delete this.styles[o])}},_getTextOnPreviousLine:function(t){for(var e=this._textLines[t-1];this._styleMap[t-2]&&this._styleMap[t-2].line===this._styleMap[t-1].line;)e=this._textLines[t-2]+e,t--;return e},removeStyleObject:function(t,e){var i=this.get2DCursorLocation(e),r=this._styleMap[i.lineIndex],n=r.line,s=r.offset+i.charIndex;this._removeStyleObject(t,i,n,s)}})}(),function(){var t=fabric.IText.prototype._getNewSelectionStartFromOffset;fabric.IText.prototype._getNewSelectionStartFromOffset=function(e,i,r,n,s){n=t.call(this,e,i,r,n,s);for(var o=0,a=0,h=0;h<this._textLines.length&&(o+=this._textLines[h].length,!(o+a>=n));h++)"\n"!==this.text[o+a]&&" "!==this.text[o+a]||a++;return n-h+a}}(),function(){function request(t,e,i){var r=URL.parse(t);r.port||(r.port=0===r.protocol.indexOf("https:")?443:80);var n=0===r.protocol.indexOf("https:")?HTTPS:HTTP,s=n.request({hostname:r.hostname,port:r.port,path:r.path,method:"GET"},function(t){var r="";e&&t.setEncoding(e),t.on("end",function(){i(r)}),t.on("data",function(e){200===t.statusCode&&(r+=e)})});s.on("error",function(t){t.errno===process.ECONNREFUSED?fabric.log("ECONNREFUSED: connection refused to "+r.hostname+":"+r.port):fabric.log(t.message),i(null)}),s.end()}function requestFs(t,e){var i=require("fs");i.readFile(t,function(t,i){if(t)throw fabric.log(t),t;e(i)})}if("undefined"==typeof document||"undefined"==typeof window){var DOMParser=require("xmldom").DOMParser,URL=require("url"),HTTP=require("http"),HTTPS=require("https"),Canvas=require("canvas"),Image=require("canvas").Image;fabric.util.loadImage=function(t,e,i){function r(r){r?(n.src=new Buffer(r,"binary"),n._src=t,e&&e.call(i,n)):(n=null,e&&e.call(i,null,!0))}var n=new Image;t&&(t instanceof Buffer||0===t.indexOf("data"))?(n.src=n._src=t,e&&e.call(i,n)):t&&0!==t.indexOf("http")?requestFs(t,r):t?request(t,"binary",r):e&&e.call(i,t)},fabric.loadSVGFromURL=function(t,e,i){t=t.replace(/^\n\s*/,"").replace(/\?.*$/,"").trim(),0!==t.indexOf("http")?requestFs(t,function(t){fabric.loadSVGFromString(t.toString(),e,i)}):request(t,"",function(t){fabric.loadSVGFromString(t,e,i)})},fabric.loadSVGFromString=function(t,e,i){var r=(new DOMParser).parseFromString(t);fabric.parseSVGDocument(r.documentElement,function(t,i){e&&e(t,i)},i)},fabric.util.getScript=function(url,callback){request(url,"",function(body){eval(body),callback&&callback()})},fabric.createCanvasForNode=function(t,e,i,r){r=r||i;var n=fabric.document.createElement("canvas"),s=new Canvas(t||600,e||600,r),o=new Canvas(t||600,e||600,r);n.style={},n.width=s.width,n.height=s.height,i=i||{},i.nodeCanvas=s,i.nodeCacheCanvas=o;var a=fabric.Canvas||fabric.StaticCanvas,h=new a(n,i);return h.nodeCanvas=s,h.nodeCacheCanvas=o,h.contextContainer=s.getContext("2d"),h.contextCache=o.getContext("2d"),h.Font=Canvas.Font,h};var originaInitStatic=fabric.StaticCanvas.prototype._initStatic;fabric.StaticCanvas.prototype._initStatic=function(t,e){t=t||fabric.document.createElement("canvas"),this.nodeCanvas=new Canvas(t.width,t.height),this.nodeCacheCanvas=new Canvas(t.width,t.height),originaInitStatic.call(this,t,e),this.contextContainer=this.nodeCanvas.getContext("2d"),this.contextCache=this.nodeCacheCanvas.getContext("2d"),this.Font=Canvas.Font},fabric.StaticCanvas.prototype.createPNGStream=function(){return this.nodeCanvas.createPNGStream()},fabric.StaticCanvas.prototype.createJPEGStream=function(t){return this.nodeCanvas.createJPEGStream(t)},fabric.StaticCanvas.prototype._initRetinaScaling=function(){if(this._isRetinaScaling())return this.lowerCanvasEl.setAttribute("width",this.width*fabric.devicePixelRatio),this.lowerCanvasEl.setAttribute("height",this.height*fabric.devicePixelRatio),this.nodeCanvas.width=this.width*fabric.devicePixelRatio,this.nodeCanvas.height=this.height*fabric.devicePixelRatio,this.contextContainer.scale(fabric.devicePixelRatio,fabric.devicePixelRatio),this},fabric.Canvas&&(fabric.Canvas.prototype._initRetinaScaling=fabric.StaticCanvas.prototype._initRetinaScaling);var origSetBackstoreDimension=fabric.StaticCanvas.prototype._setBackstoreDimension;fabric.StaticCanvas.prototype._setBackstoreDimension=function(t,e){return origSetBackstoreDimension.call(this,t,e),this.nodeCanvas[t]=e,this},fabric.Canvas&&(fabric.Canvas.prototype._setBackstoreDimension=fabric.StaticCanvas.prototype._setBackstoreDimension)}}();!function(t){"use strict";var e=t.fabric||(t.fabric={}),s=e.util.object.extend,i=e.util.object.clone;if(e.CurvedText)return void e.warn("fabric.CurvedText is already defined");var r=e.Text.prototype.stateProperties.concat();r.push("radius","spacing","reverse","effect","range","largeFont","smallFont");var h=e.Text.prototype._dimensionAffectingProps;h.radius=!0,h.spacing=!0,h.reverse=!0,h.fill=!0,h.effect=!0,h.width=!0,h.height=!0,h.range=!0,h.fontSize=!0,h.shadow=!0,h.largeFont=!0,h.smallFont=!0;var l=e.Group.prototype.delegatedProperties;l.backgroundColor=!0,l.textBackgroundColor=!0,l.textDecoration=!0,l.stroke=!0,l.strokeWidth=!0,l.shadow=!0,l.fontWeight=!0,l.fontStyle=!0,l.strokeWidth=!0,l.textAlign=!0,e.CurvedText=e.util.createClass(e.Text,e.Collection,{type:"curvedText",radius:50,range:5,smallFont:10,largeFont:30,effect:"curved",spacing:20,reverse:!1,stateProperties:r,delegatedProperties:l,_dimensionAffectingProps:h,_isRendering:0,complexity:function(){this.callSuper("complexity")},initialize:function(t,s){s||(s={}),this.letters=new e.Group([],{selectable:!1,padding:0}),this.__skipDimension=!0,this.setOptions(s),this.__skipDimension=!1,this.setText(t)},setText:function(t){if(this.letters){for(;0!==t.length&&this.letters.size()>=t.length;)this.letters.remove(this.letters.item(this.letters.size()-1));0===t.length&&this.letters.remove(this.letters.item(0));for(var s=0;s<t.length;s++)void 0===this.letters.item(s)?this.letters.add(new e.Text(t[s])):this.letters.item(s).setText(t[s])}this.callSuper("setText",t)},_initDimensions:function(t){if(!this.__skipDimension){t||(t=e.util.createCanvasElement().getContext("2d"),this._setTextStyles(t)),this._textLines=this.text.split(this._reNewline),this._clearCache();var s=this.textAlign;this.textAlign="left",this.width=this._getTextWidth(t),this.textAlign=s,this.height=this._getTextHeight(t),this._render(t)}},_render:function(t){var s=e.util.getRandomInt(100,999);if(this._isRendering=s,this.letters){var i=0,r=0,h=0,l=0,n=parseInt(this.spacing),a=0;if("curved"===this.effect){for(var o=0,g=this.text.length;g>o;o++)l+=this.letters.item(o).width+n;l-=n}else"arc"===this.effect&&(a=(this.letters.item(0).fontSize+n)/this.radius/(Math.PI/180),l=(this.text.length+1)*(this.letters.item(0).fontSize+n));i="right"===this.get("textAlign")?90-l/2/this.radius/(Math.PI/180):"left"===this.get("textAlign")?-90-l/2/this.radius/(Math.PI/180):-(l/2/this.radius/(Math.PI/180)),this.reverse&&(i=-i);for(var d=0,c=this.reverse?-1:1,f=0,m=0,o=0,g=this.text.length;g>o;o++){if(s!==this._isRendering)return;for(var p in this.delegatedProperties)this.letters.item(o).set(p,this.get(p));if(this.letters.item(o).set("left",d),this.letters.item(o).set("top",0),this.letters.item(o).setAngle(0),this.letters.item(o).set("padding",0),"curved"===this.effect)f=(this.letters.item(o).width+n)/this.radius/(Math.PI/180),r=c*(c*i+m+f/4),i=c*(c*i+m),h=i*(Math.PI/180),m=f,this.letters.item(o).setAngle(r),this.letters.item(o).set("top",-1*c*(Math.cos(h)*this.radius)),this.letters.item(o).set("left",c*(Math.sin(h)*this.radius)),this.letters.item(o).set("padding",0),this.letters.item(o).set("selectable",!1);else if("arc"===this.effect)i=c*(c*i+a),h=i*(Math.PI/180),this.letters.item(o).set("top",-1*c*(Math.cos(h)*this.radius)),this.letters.item(o).set("left",c*(Math.sin(h)*this.radius)),this.letters.item(o).set("padding",0),this.letters.item(o).set("selectable",!1);else if("STRAIGHT"===this.effect)this.letters.item(o).set("left",d),this.letters.item(o).set("top",0),this.letters.item(o).setAngle(0),d+=this.letters.item(o).get("width"),this.letters.item(o).set("padding",0),this.letters.item(o).set({borderColor:"red",cornerColor:"green",cornerSize:6,transparentCorners:!1}),this.letters.item(o).set("selectable",!1);else if("smallToLarge"===this.effect){var u=parseInt(this.smallFont),v=parseInt(this.largeFont),x=v-u,C=Math.ceil(this.text.length/2),T=x/this.text.length,_=u+o*T;this.letters.item(o).set("fontSize",_),this.letters.item(o).set("left",d),d+=this.letters.item(o).get("width"),this.letters.item(o).set("padding",0),this.letters.item(o).set("selectable",!1),this.letters.item(o).set("top",-1*this.letters.item(o).get("fontSize")+o)}else if("largeToSmallTop"===this.effect){var u=parseInt(this.largeFont),v=parseInt(this.smallFont),x=v-u,C=Math.ceil(this.text.length/2),T=x/this.text.length,_=u+o*T;this.letters.item(o).set("fontSize",_),this.letters.item(o).set("left",d),d+=this.letters.item(o).get("width"),this.letters.item(o).set("padding",0),this.letters.item(o).set({borderColor:"red",cornerColor:"green",cornerSize:6,transparentCorners:!1}),this.letters.item(o).set("padding",0),this.letters.item(o).set("selectable",!1),this.letters.item(o).top=-1*this.letters.item(o).get("fontSize")+o/this.text.length}else if("largeToSmallBottom"===this.effect){var u=parseInt(this.largeFont),v=parseInt(this.smallFont),x=v-u,C=Math.ceil(this.text.length/2),T=x/this.text.length,_=u+o*T;this.letters.item(o).set("fontSize",_),this.letters.item(o).set("left",d),d+=this.letters.item(o).get("width"),this.letters.item(o).set("padding",0),this.letters.item(o).set({borderColor:"red",cornerColor:"green",cornerSize:6,transparentCorners:!1}),this.letters.item(o).set("padding",0),this.letters.item(o).set("selectable",!1),this.letters.item(o).top=-1*this.letters.item(o).get("fontSize")-o}else if("bulge"===this.effect){var u=parseInt(this.smallFont),v=parseInt(this.largeFont),x=v-u,C=Math.ceil(this.text.length/2),T=x/(this.text.length-C);if(C>o)var _=u+o*T;else var _=v-(o-C+1)*T;this.letters.item(o).set("fontSize",_),this.letters.item(o).set("left",d),d+=this.letters.item(o).get("width"),this.letters.item(o).set("padding",0),this.letters.item(o).set("selectable",!1),this.letters.item(o).set("top",-1*this.letters.item(o).get("height")/2)}}var b=this.letters.get("scaleX"),S=this.letters.get("scaleY"),w=this.letters.get("angle");this.letters.set("scaleX",1),this.letters.set("scaleY",1),this.letters.set("angle",0),this.letters._calcBounds(),this.letters._updateObjectsCoords(),this.letters.saveCoords(),this.letters.set("scaleX",b),this.letters.set("scaleY",S),this.letters.set("angle",w),this.width=this.letters.width,this.height=this.letters.height,this.letters.left=-(this.letters.width/2),this.letters.top=-(this.letters.height/2)}},_renderOld:function(t){if(this.letters){var e=0,s=0,i=0,r=0;this.reverse&&(r=.5),"center"===this.get("textAlign")||"justify"===this.get("textAlign")?i=this.spacing/2*(this.text.length-r):"right"===this.get("textAlign")&&(i=this.spacing*(this.text.length-r));for(var h=this.reverse?1:-1,l=0,n=this.text.length;n>l;l++){e=h*(-l*parseInt(this.spacing,10)+i),s=e*(Math.PI/180);for(var a in this.delegatedProperties)this.letters.item(l).set(a,this.get(a));this.letters.item(l).set("top",h-Math.cos(s)*this.radius),this.letters.item(l).set("left",h+Math.sin(s)*this.radius),this.letters.item(l).setAngle(e),this.letters.item(l).set("padding",0),this.letters.item(l).set("selectable",!1)}this.letters._calcBounds(),this.reverse?this.letters.top=this.letters.top-2.5*this.height:this.letters.top=0,this.letters.left=this.letters.left-this.width/2,this.letters.saveCoords(),this.width=this.letters.width,this.height=this.letters.height,this.letters.left=-(this.letters.width/2),this.letters.top=-(this.letters.height/2)}},render:function(t,s){if(this.visible&&this.letters){t.save(),this.transform(t);Math.max(this.scaleX,this.scaleY);this.clipTo&&e.util.clipContext(this,t);for(var i=0,r=this.letters.size();r>i;i++){var h=this.letters.item(i);h.borderScaleFactor,h.hasRotatingPoint;h.visible&&h.render(t)}this.clipTo&&t.restore(),t.restore(),this.setCoords()}},_set:function(t,e){this.callSuper("_set",t,e),this.letters&&(this.letters.set(t,e),t in this._dimensionAffectingProps&&(this._initDimensions(),this.setCoords()))},toObject:function(t){var e=s(this.callSuper("toObject",t),{radius:this.radius,spacing:this.spacing,reverse:this.reverse,effect:this.effect,range:this.range,smallFont:this.smallFont,largeFont:this.largeFont});return this.includeDefaultValues||this._removeDefaultValues(e),e},toString:function(){return"#<fabric.CurvedText ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'", "radius": "'+this.radius+'", "spacing": "'+this.spacing+'", "reverse": "'+this.reverse+'" }>'},toSVG:function(t){var e=["<g ",'transform="',this.getSvgTransform(),'">'];if(this.letters)for(var s=0,i=this.letters.size();i>s;s++)e.push(this.letters.item(s).toSVG(t));return e.push("</g>"),t?t(e.join("")):e.join("")}}),e.CurvedText.fromObject=function(t){return new e.CurvedText(t.text,i(t))},e.util.createAccessors(e.CurvedText),e.CurvedText.async=!1}("undefined"!=typeof exports?exports:this);
(function(){function aa(a,b,c){return a.call.apply(a.bind,arguments)}function ba(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function p(a,b,c){p=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?aa:ba;return p.apply(null,arguments)}var q=Date.now||function(){return+new Date};function ca(a,b){this.a=a;this.m=b||a;this.c=this.m.document}var da=!!window.FontFace;function t(a,b,c,d){b=a.c.createElement(b);if(c)for(var e in c)c.hasOwnProperty(e)&&("style"==e?b.style.cssText=c[e]:b.setAttribute(e,c[e]));d&&b.appendChild(a.c.createTextNode(d));return b}function u(a,b,c){a=a.c.getElementsByTagName(b)[0];a||(a=document.documentElement);a.insertBefore(c,a.lastChild)}function v(a){a.parentNode&&a.parentNode.removeChild(a)}
function w(a,b,c){b=b||[];c=c||[];for(var d=a.className.split(/\s+/),e=0;e<b.length;e+=1){for(var f=!1,g=0;g<d.length;g+=1)if(b[e]===d[g]){f=!0;break}f||d.push(b[e])}b=[];for(e=0;e<d.length;e+=1){f=!1;for(g=0;g<c.length;g+=1)if(d[e]===c[g]){f=!0;break}f||b.push(d[e])}a.className=b.join(" ").replace(/\s+/g," ").replace(/^\s+|\s+$/,"")}function y(a,b){for(var c=a.className.split(/\s+/),d=0,e=c.length;d<e;d++)if(c[d]==b)return!0;return!1}
function z(a){if("string"===typeof a.f)return a.f;var b=a.m.location.protocol;"about:"==b&&(b=a.a.location.protocol);return"https:"==b?"https:":"http:"}function ea(a){return a.m.location.hostname||a.a.location.hostname}
function A(a,b,c){function d(){k&&e&&f&&(k(g),k=null)}b=t(a,"link",{rel:"stylesheet",href:b,media:"all"});var e=!1,f=!0,g=null,k=c||null;da?(b.onload=function(){e=!0;d()},b.onerror=function(){e=!0;g=Error("Stylesheet failed to load");d()}):setTimeout(function(){e=!0;d()},0);u(a,"head",b)}
function B(a,b,c,d){var e=a.c.getElementsByTagName("head")[0];if(e){var f=t(a,"script",{src:b}),g=!1;f.onload=f.onreadystatechange=function(){g||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(g=!0,c&&c(null),f.onload=f.onreadystatechange=null,"HEAD"==f.parentNode.tagName&&e.removeChild(f))};e.appendChild(f);setTimeout(function(){g||(g=!0,c&&c(Error("Script load timeout")))},d||5E3);return f}return null};function C(){this.a=0;this.c=null}function D(a){a.a++;return function(){a.a--;E(a)}}function F(a,b){a.c=b;E(a)}function E(a){0==a.a&&a.c&&(a.c(),a.c=null)};function G(a){this.a=a||"-"}G.prototype.c=function(a){for(var b=[],c=0;c<arguments.length;c++)b.push(arguments[c].replace(/[\W_]+/g,"").toLowerCase());return b.join(this.a)};function H(a,b){this.c=a;this.f=4;this.a="n";var c=(b||"n4").match(/^([nio])([1-9])$/i);c&&(this.a=c[1],this.f=parseInt(c[2],10))}function fa(a){return I(a)+" "+(a.f+"00")+" 300px "+J(a.c)}function J(a){var b=[];a=a.split(/,\s*/);for(var c=0;c<a.length;c++){var d=a[c].replace(/['"]/g,"");-1!=d.indexOf(" ")||/^\d/.test(d)?b.push("'"+d+"'"):b.push(d)}return b.join(",")}function K(a){return a.a+a.f}function I(a){var b="normal";"o"===a.a?b="oblique":"i"===a.a&&(b="italic");return b}
function ga(a){var b=4,c="n",d=null;a&&((d=a.match(/(normal|oblique|italic)/i))&&d[1]&&(c=d[1].substr(0,1).toLowerCase()),(d=a.match(/([1-9]00|normal|bold)/i))&&d[1]&&(/bold/i.test(d[1])?b=7:/[1-9]00/.test(d[1])&&(b=parseInt(d[1].substr(0,1),10))));return c+b};function ha(a,b){this.c=a;this.f=a.m.document.documentElement;this.h=b;this.a=new G("-");this.j=!1!==b.events;this.g=!1!==b.classes}function ia(a){a.g&&w(a.f,[a.a.c("wf","loading")]);L(a,"loading")}function M(a){if(a.g){var b=y(a.f,a.a.c("wf","active")),c=[],d=[a.a.c("wf","loading")];b||c.push(a.a.c("wf","inactive"));w(a.f,c,d)}L(a,"inactive")}function L(a,b,c){if(a.j&&a.h[b])if(c)a.h[b](c.c,K(c));else a.h[b]()};function ja(){this.c={}}function ka(a,b,c){var d=[],e;for(e in b)if(b.hasOwnProperty(e)){var f=a.c[e];f&&d.push(f(b[e],c))}return d};function N(a,b){this.c=a;this.f=b;this.a=t(this.c,"span",{"aria-hidden":"true"},this.f)}function O(a){u(a.c,"body",a.a)}function P(a){return"display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:"+J(a.c)+";"+("font-style:"+I(a)+";font-weight:"+(a.f+"00")+";")};function Q(a,b,c,d,e,f){this.g=a;this.j=b;this.a=d;this.c=c;this.f=e||3E3;this.h=f||void 0}Q.prototype.start=function(){var a=this.c.m.document,b=this,c=q(),d=new Promise(function(d,e){function k(){q()-c>=b.f?e():a.fonts.load(fa(b.a),b.h).then(function(a){1<=a.length?d():setTimeout(k,25)},function(){e()})}k()}),e=new Promise(function(a,d){setTimeout(d,b.f)});Promise.race([e,d]).then(function(){b.g(b.a)},function(){b.j(b.a)})};function R(a,b,c,d,e,f,g){this.v=a;this.B=b;this.c=c;this.a=d;this.s=g||"BESbswy";this.f={};this.w=e||3E3;this.u=f||null;this.o=this.j=this.h=this.g=null;this.g=new N(this.c,this.s);this.h=new N(this.c,this.s);this.j=new N(this.c,this.s);this.o=new N(this.c,this.s);a=new H(this.a.c+",serif",K(this.a));a=P(a);this.g.a.style.cssText=a;a=new H(this.a.c+",sans-serif",K(this.a));a=P(a);this.h.a.style.cssText=a;a=new H("serif",K(this.a));a=P(a);this.j.a.style.cssText=a;a=new H("sans-serif",K(this.a));a=
P(a);this.o.a.style.cssText=a;O(this.g);O(this.h);O(this.j);O(this.o)}var S={D:"serif",C:"sans-serif"},T=null;function U(){if(null===T){var a=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent);T=!!a&&(536>parseInt(a[1],10)||536===parseInt(a[1],10)&&11>=parseInt(a[2],10))}return T}R.prototype.start=function(){this.f.serif=this.j.a.offsetWidth;this.f["sans-serif"]=this.o.a.offsetWidth;this.A=q();la(this)};
function ma(a,b,c){for(var d in S)if(S.hasOwnProperty(d)&&b===a.f[S[d]]&&c===a.f[S[d]])return!0;return!1}function la(a){var b=a.g.a.offsetWidth,c=a.h.a.offsetWidth,d;(d=b===a.f.serif&&c===a.f["sans-serif"])||(d=U()&&ma(a,b,c));d?q()-a.A>=a.w?U()&&ma(a,b,c)&&(null===a.u||a.u.hasOwnProperty(a.a.c))?V(a,a.v):V(a,a.B):na(a):V(a,a.v)}function na(a){setTimeout(p(function(){la(this)},a),50)}function V(a,b){setTimeout(p(function(){v(this.g.a);v(this.h.a);v(this.j.a);v(this.o.a);b(this.a)},a),0)};function W(a,b,c){this.c=a;this.a=b;this.f=0;this.o=this.j=!1;this.s=c}var X=null;W.prototype.g=function(a){var b=this.a;b.g&&w(b.f,[b.a.c("wf",a.c,K(a).toString(),"active")],[b.a.c("wf",a.c,K(a).toString(),"loading"),b.a.c("wf",a.c,K(a).toString(),"inactive")]);L(b,"fontactive",a);this.o=!0;oa(this)};
W.prototype.h=function(a){var b=this.a;if(b.g){var c=y(b.f,b.a.c("wf",a.c,K(a).toString(),"active")),d=[],e=[b.a.c("wf",a.c,K(a).toString(),"loading")];c||d.push(b.a.c("wf",a.c,K(a).toString(),"inactive"));w(b.f,d,e)}L(b,"fontinactive",a);oa(this)};function oa(a){0==--a.f&&a.j&&(a.o?(a=a.a,a.g&&w(a.f,[a.a.c("wf","active")],[a.a.c("wf","loading"),a.a.c("wf","inactive")]),L(a,"active")):M(a.a))};function pa(a){this.j=a;this.a=new ja;this.h=0;this.f=this.g=!0}pa.prototype.load=function(a){this.c=new ca(this.j,a.context||this.j);this.g=!1!==a.events;this.f=!1!==a.classes;qa(this,new ha(this.c,a),a)};
function ra(a,b,c,d,e){var f=0==--a.h;(a.f||a.g)&&setTimeout(function(){var a=e||null,k=d||null||{};if(0===c.length&&f)M(b.a);else{b.f+=c.length;f&&(b.j=f);var h,m=[];for(h=0;h<c.length;h++){var l=c[h],n=k[l.c],r=b.a,x=l;r.g&&w(r.f,[r.a.c("wf",x.c,K(x).toString(),"loading")]);L(r,"fontloading",x);r=null;if(null===X)if(window.FontFace){var x=/Gecko.*Firefox\/(\d+)/.exec(window.navigator.userAgent),ya=/OS X.*Version\/10\..*Safari/.exec(window.navigator.userAgent)&&/Apple/.exec(window.navigator.vendor);
X=x?42<parseInt(x[1],10):ya?!1:!0}else X=!1;X?r=new Q(p(b.g,b),p(b.h,b),b.c,l,b.s,n):r=new R(p(b.g,b),p(b.h,b),b.c,l,b.s,a,n);m.push(r)}for(h=0;h<m.length;h++)m[h].start()}},0)}function qa(a,b,c){var d=[],e=c.timeout;ia(b);var d=ka(a.a,c,a.c),f=new W(a.c,b,e);a.h=d.length;b=0;for(c=d.length;b<c;b++)d[b].load(function(b,d,c){ra(a,f,b,d,c)})};function sa(a,b){this.c=a;this.a=b}function ta(a,b,c){var d=z(a.c);a=(a.a.api||"fast.fonts.net/jsapi").replace(/^.*http(s?):(\/\/)?/,"");return d+"//"+a+"/"+b+".js"+(c?"?v="+c:"")}
sa.prototype.load=function(a){function b(){if(f["__mti_fntLst"+d]){var c=f["__mti_fntLst"+d](),e=[],h;if(c)for(var m=0;m<c.length;m++){var l=c[m].fontfamily;void 0!=c[m].fontStyle&&void 0!=c[m].fontWeight?(h=c[m].fontStyle+c[m].fontWeight,e.push(new H(l,h))):e.push(new H(l))}a(e)}else setTimeout(function(){b()},50)}var c=this,d=c.a.projectId,e=c.a.version;if(d){var f=c.c.m;B(this.c,ta(c,d,e),function(e){e?a([]):(f["__MonotypeConfiguration__"+d]=function(){return c.a},b())}).id="__MonotypeAPIScript__"+
d}else a([])};function ua(a,b){this.c=a;this.a=b}ua.prototype.load=function(a){var b,c,d=this.a.urls||[],e=this.a.families||[],f=this.a.testStrings||{},g=new C;b=0;for(c=d.length;b<c;b++)A(this.c,d[b],D(g));var k=[];b=0;for(c=e.length;b<c;b++)if(d=e[b].split(":"),d[1])for(var h=d[1].split(","),m=0;m<h.length;m+=1)k.push(new H(d[0],h[m]));else k.push(new H(d[0]));F(g,function(){a(k,f)})};function va(a,b,c){a?this.c=a:this.c=b+wa;this.a=[];this.f=[];this.g=c||""}var wa="//fonts.googleapis.com/css";function xa(a,b){for(var c=b.length,d=0;d<c;d++){var e=b[d].split(":");3==e.length&&a.f.push(e.pop());var f="";2==e.length&&""!=e[1]&&(f=":");a.a.push(e.join(f))}}
function za(a){if(0==a.a.length)throw Error("No fonts to load!");if(-1!=a.c.indexOf("kit="))return a.c;for(var b=a.a.length,c=[],d=0;d<b;d++)c.push(a.a[d].replace(/ /g,"+"));b=a.c+"?family="+c.join("%7C");0<a.f.length&&(b+="&subset="+a.f.join(","));0<a.g.length&&(b+="&text="+encodeURIComponent(a.g));return b};function Aa(a){this.f=a;this.a=[];this.c={}}
var Ba={latin:"BESbswy","latin-ext":"\u00e7\u00f6\u00fc\u011f\u015f",cyrillic:"\u0439\u044f\u0416",greek:"\u03b1\u03b2\u03a3",khmer:"\u1780\u1781\u1782",Hanuman:"\u1780\u1781\u1782"},Ca={thin:"1",extralight:"2","extra-light":"2",ultralight:"2","ultra-light":"2",light:"3",regular:"4",book:"4",medium:"5","semi-bold":"6",semibold:"6","demi-bold":"6",demibold:"6",bold:"7","extra-bold":"8",extrabold:"8","ultra-bold":"8",ultrabold:"8",black:"9",heavy:"9",l:"3",r:"4",b:"7"},Da={i:"i",italic:"i",n:"n",normal:"n"},
Ea=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/;
function Fa(a){for(var b=a.f.length,c=0;c<b;c++){var d=a.f[c].split(":"),e=d[0].replace(/\+/g," "),f=["n4"];if(2<=d.length){var g;var k=d[1];g=[];if(k)for(var k=k.split(","),h=k.length,m=0;m<h;m++){var l;l=k[m];if(l.match(/^[\w-]+$/)){var n=Ea.exec(l.toLowerCase());if(null==n)l="";else{l=n[2];l=null==l||""==l?"n":Da[l];n=n[1];if(null==n||""==n)n="4";else var r=Ca[n],n=r?r:isNaN(n)?"4":n.substr(0,1);l=[l,n].join("")}}else l="";l&&g.push(l)}0<g.length&&(f=g);3==d.length&&(d=d[2],g=[],d=d?d.split(","):
g,0<d.length&&(d=Ba[d[0]])&&(a.c[e]=d))}a.c[e]||(d=Ba[e])&&(a.c[e]=d);for(d=0;d<f.length;d+=1)a.a.push(new H(e,f[d]))}};function Ga(a,b){this.c=a;this.a=b}var Ha={Arimo:!0,Cousine:!0,Tinos:!0};Ga.prototype.load=function(a){var b=new C,c=this.c,d=new va(this.a.api,z(c),this.a.text),e=this.a.families;xa(d,e);var f=new Aa(e);Fa(f);A(c,za(d),D(b));F(b,function(){a(f.a,f.c,Ha)})};function Ia(a,b){this.c=a;this.a=b}Ia.prototype.load=function(a){var b=this.a.id,c=this.c.m;b?B(this.c,(this.a.api||"https://use.typekit.net")+"/"+b+".js",function(b){if(b)a([]);else if(c.Typekit&&c.Typekit.config&&c.Typekit.config.fn){b=c.Typekit.config.fn;for(var e=[],f=0;f<b.length;f+=2)for(var g=b[f],k=b[f+1],h=0;h<k.length;h++)e.push(new H(g,k[h]));try{c.Typekit.load({events:!1,classes:!1,async:!0})}catch(m){}a(e)}},2E3):a([])};function Ja(a,b){this.c=a;this.f=b;this.a=[]}Ja.prototype.load=function(a){var b=this.f.id,c=this.c.m,d=this;b?(c.__webfontfontdeckmodule__||(c.__webfontfontdeckmodule__={}),c.__webfontfontdeckmodule__[b]=function(b,c){for(var g=0,k=c.fonts.length;g<k;++g){var h=c.fonts[g];d.a.push(new H(h.name,ga("font-weight:"+h.weight+";font-style:"+h.style)))}a(d.a)},B(this.c,z(this.c)+(this.f.api||"//f.fontdeck.com/s/css/js/")+ea(this.c)+"/"+b+".js",function(b){b&&a([])})):a([])};var Y=new pa(window);Y.a.c.custom=function(a,b){return new ua(b,a)};Y.a.c.fontdeck=function(a,b){return new Ja(b,a)};Y.a.c.monotype=function(a,b){return new sa(b,a)};Y.a.c.typekit=function(a,b){return new Ia(b,a)};Y.a.c.google=function(a,b){return new Ga(b,a)};var Z={load:p(Y.load,Y)};"function"===typeof define&&define.amd?define(function(){return Z}):"undefined"!==typeof module&&module.exports?module.exports=Z:(window.WebFont=Z,window.WebFontConfig&&Y.load(window.WebFontConfig));}());

fabric.Object.prototype._drawControl=function(t,i,r,e,o){var n=this.cornerSize,s=4,a=n-2*s,h=.5*n,c=10;if(h=c=0,this._fpdOffset=h,this._fpdOffsetCorner=c,this.isControlVisible(t)){var f=this._calculateCurrentDimensions(),l=f.x;f.y;if("br"==t||"mtr"==t||"tl"==t||"bl"==t||"ml"==t||"mr"==t||"mb"==t||"mt"==t)switch(t){case"tl":e=e-h+c,o=o-h+c,icon=this.__editorMode||this.copyable?String.fromCharCode("0xe623"):!1;break;case"mtr":e=e+l/2+h-c,o=o-h+c,icon=this.__editorMode||this.rotatable?String.fromCharCode("0xe923"):!1;break;case"br":e=e+h-c,o=o+h-c,icon=this.__editorMode||this.resizable?String.fromCharCode("0xe922"):!1;break;case"bl":e=e-h+c,o=o+h-c,icon=this.__editorMode||this.removable?String.fromCharCode("0xe926"):!1;break;case"ml":e=e-h+c,o=o/2-s,icon=this.lockUniScaling?!1:String.fromCharCode("0xe92e");break;case"mr":e=e+h-c,o=o/2-s,icon=this.lockUniScaling?!1:String.fromCharCode("0xe92d");break;case"mt":e=e-h+c,o-=s,icon=this.lockUniScaling?!1:String.fromCharCode("0xe92f");break;case"mb":e=e+h-c,o-=s,icon=this.lockUniScaling?!1:String.fromCharCode("0xe930")}if(this.transparentCorners||i.clearRect(e,o,n,n),icon!==!1){var b="mt"==t||"mb"==t?5:0;i.fillStyle=this.cornerColor,i.fillRect(e,o,n,n),i.font=a+"px FontFPD",i.fillStyle=this.cornerIconColor,i.textAlign="left",i.textBaseline="top",i.fillText(icon,e+s+b,o+s)}}},fabric.Object.prototype.setCoords=function(){var t=fabric.util.degreesToRadians(this.angle),i=this.getViewportTransform(),r=this._calculateCurrentDimensions(),e=this._fpdOffset?this._fpdOffset:0,o=this._fpdOffsetCorner?this._fpdOffsetCorner:0,e=o=0,n=r.x+2*(e-o),s=r.y+2*(e-o);0>n&&(n=Math.abs(n));var a=Math.sin(t),h=Math.cos(t),c=n>0?Math.atan(s/n):0,f=n/Math.cos(c)/2,l=Math.cos(c+t)*f,b=Math.sin(c+t)*f,d=fabric.util.transformPoint(this.getCenterPoint(),i),m=new fabric.Point(d.x-l,d.y-b),C=new fabric.Point(m.x+n*h,m.y+n*a),x=new fabric.Point(m.x-s*a,m.y+s*h),p=new fabric.Point(d.x+l,d.y+b),_=new fabric.Point((m.x+x.x)/2,(m.y+x.y)/2),u=new fabric.Point((C.x+m.x)/2,(C.y+m.y)/2),y=new fabric.Point((p.x+C.x)/2,(p.y+C.y)/2),g=new fabric.Point((p.x+x.x)/2,(p.y+x.y)/2),w=new fabric.Point(C.x+a*this.rotatingPointOffset,C.y-h*this.rotatingPointOffset);return this.oCoords={tl:m,tr:C,br:p,bl:x,ml:_,mt:u,mr:y,mb:g,mtr:w},this._setCornerCoords&&this._setCornerCoords(),this},fabric.Canvas.prototype._getRotatedCornerCursor=function(t,i,r){var e=Math.round(i.getAngle()%360/45),o={mt:0,tr:1,mr:2,br:3,mb:4,bl:5,ml:6,tl:7};switch(0>e&&(e+=8),e+=o[t],e%=8,t){case"tl":return i.copyable?"copy":"default";case"bl":return"pointer"}return this.cursorMap[e]},fabric.Textbox.prototype._wrapLine=function(t,i,r){for(var e=0,o=[],n="",s=i.split(" "),a="",h=0,c=" ",f=0,l=0,b=0,d=0,m=0;m<s.length;m++){if(a=s[m],f=this._measureText(t,a,r,h),e+=l,f>this.width){n+=c;for(var C=a.split("");C.length;)b=this._getWidthOfChar(t,C[0],r,h),e+b>this.width&&(o.push(n),n="",e=0),n+=C.shift(),h++,e+=b;a=""}else e+=f;e>=this.width&&""!==n&&(o.push(n),n="",e=f),(""!==n||1===m)&&(n+=c),n+=a,h+=a.length,l=this._measureText(t,c,r,h),h++}return m&&o.push(n),d>this.dynamicMinWidth&&(this.dynamicMinWidth=d),o},fabric.IText.prototype._isObjectMoved=function(t){if(this.canvas){var i=this.canvas.getPointer(t);return this.__mousedownX!==i.x||this.__mousedownY!==i.y}};
var FPDUtil={isIE:function(){var e=navigator.userAgent.toLowerCase();return-1!==e.indexOf("msie")?parseInt(e.split("msie")[1]):!1},rekeyDeprecatedKeys:function(e){for(var t=[{old:"x",replace:"left"},{old:"y",replace:"top"},{old:"degree",replace:"angle"},{old:"currentColor",replace:"fill"},{old:"filters",replace:"availableFilters"},{old:"textSize",replace:"fontSize"},{old:"font",replace:"fontFamily"},{old:"scale",replace:["scaleX","scaleY"]},{old:"uploadZoneScaleMode",replace:"scaleMode"}],r=0;r<t.length;++r)if(e.hasOwnProperty(t[r].old)&&!e.hasOwnProperty(t[r].replace)){var o=t[r].replace;if("object"==typeof o)for(var a=0;a<o.length;++a)e[o[a]]=e[t[r].old];else e[t[r].replace]=e[t[r].old];delete e[t[r].old]}return e},log:function(e,t){return"undefined"==typeof console?!1:void("info"===t?console.info(e):"error"===t?console.error(e):"warn"===t?console.warn(e):console.log(e))},isUrl:function(e){var t=/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;return t.test(e)},removeFromArray:function(e,t){var r=e.indexOf(t);return r>-1&&e.splice(r,1),e},isXML:function(e){try{return xmlDoc=jQuery.parseXML(e),!0}catch(t){return!1}},elementIsColorizable:function(e){if("text"===this.getType(e.type))return"text";var t=e.source.split(".");if(1==t.length)return-1==t[0].search("data:image/png;")?(e.fill=e.colors=!1,!1):"dataurl";var r=e.source;return r=r.split("?")[0],t=r.split("."),-1==$.inArray("png",t)&&-1==$.inArray("svg",t)?(e.fill=e.colors=!1,!1):-1==$.inArray("svg",t)?"png":"svg"},getType:function(e){return"text"===e||"i-text"===e||"curvedText"===e||"textbox"===e?"text":"image"},updateTooltip:function(e){$tooltips=e?e.find(".fpd-tooltip"):$(".fpd-tooltip"),$tooltips.each(function(e,t){var r=$(t);r.hasClass("tooltipstered")?r.tooltipster("reposition"):r.tooltipster({offsetY:0,position:"bottom",theme:".fpd-tooltip-theme",touchDevices:!1})})},arrayUnique:function(e){for(var t=e.concat(),r=0;r<t.length;++r)for(var o=r+1;o<t.length;++o)t[r]===t[o]&&t.splice(o--,1);return t},createScrollbar:function(e){e.hasClass("mCustomScrollbar")?e.mCustomScrollbar("scrollTo",0):e.mCustomScrollbar({scrollbarPosition:"outside",autoExpandScrollbar:!0,autoHideScrollbar:!0,scrollInertia:200,axis:"y",callbacks:{onTotalScrollOffset:100,onTotalScroll:function(){$(this).trigger("_sbOnTotalScroll"),FPDUtil.refreshLazyLoad($(this).find(".fpd-grid"),!0)}}})},notEmpty:function(e){return void 0===e||e===!1||0===e.length?!1:!0},showModal:function(e,t,r){r=void 0===r?"":r;var o=$("body").addClass("fpd-overflow-hidden"),a=t?"fpd-fullscreen":"";return html='<div class="fpd-modal-internal fpd-modal-overlay"><div class="fpd-modal-wrapper fpd-shadow-3"><div class="fpd-modal-close"><span class="fpd-icon-close"></span></div><div class="fpd-modal-content"></div></div></div>',0===$(".fpd-modal-internal").length&&o.append(html).children(".fpd-modal-internal:first").click(function(e){$target=$(e.target),$target.hasClass("fpd-modal-overlay")&&$target.find(".fpd-modal-close").click()}),"prompt"===r&&(e='<input placeholder="'+e+'" /><span class="fpd-btn"></span>'),o.children(".fpd-modal-internal").attr("data-type",r).removeClass("fpd-fullscreen").addClass(a).fadeIn(300).find(".fpd-modal-content").html(e),o.children(".fpd-modal-internal")},showMessage:function(e){var t,r=$("body");t=r.children(".fpd-snackbar-wrapper").length>0?r.children(".fpd-snackbar-wrapper"):r.append('<div class="fpd-snackbar-wrapper"></div>').children(".fpd-snackbar-wrapper");var o=$('<div class="fpd-snackbar fpd-shadow-1"><p></p></div>');o.children("p").html(e),o.appendTo(t),setTimeout(function(){o.addClass("fpd-show-up"),setTimeout(function(){o.remove()},5e3)},10)},loadGridImage:function(e,t){if(e.length>0&&t){e.addClass("fpd-on-loading");var r=new Image;r.src=t,r.onload=function(){e.attr("data-img","").data("originWidth",this.width).data("originHeight",this.height).removeClass("fpd-on-loading").fadeOut(0).stop().fadeIn(200).css("background-image",'url("'+this.src+'")')}}},refreshLazyLoad:function(e,t){if(e&&e.length>0&&e.is(":visible"))for(var r=e.children(".fpd-item.fpd-hidden:first"),o=0,a=t?15:0;(a>o||e.parent(".mCSB_container").height()-150<e.parents(".fpd-scroll-area:first").height())&&r.length>0;){var l=r.children("picture");r.removeClass("fpd-hidden"),FPDUtil.loadGridImage(l,l.data("img")),r=r.next(".fpd-item.fpd-hidden"),o++}},parseFabricObjectToFPDElement:function(e){if(!e)return{};var t=new FancyProductDesignerOptions,r=Object.keys(t.defaults.elementParameters),o="text"===FPDUtil.getType(e.type)?Object.keys(t.defaults.textParameters):Object.keys(t.defaults.imageParameters);r=$.merge(r,o);for(var a={},l=0;l<r.length;++l){var n=r[l];void 0!==e[n]&&(a[n]=e[n])}return{type:FPDUtil.getType(e.type),source:e.source,title:e.title,parameters:a}},popupBlockerAlert:function(e,t){(null==e||"undefined"==typeof e)&&FPDUtil.showModal(t.getTranslation("misc","popup_blocker_alert"))},getScalingByDimesions:function(e,t,r,o,a){a="undefined"==typeof a?"fit":a,r="number"!=typeof r?0:r,o="number"!=typeof o?0:o;var l=1,n=0!==r,i=0!==o;return"cover"===a?t>e?e>r&&(l=n?r/e:1):e==t?l=r>o?n?r/e:1:i?o/t:1:t>o&&(l=i?o/t:1):e>t?(e>r&&(l=n?r/e:1),l*t>o&&(l=i?o/t:1)):(t>o&&(l=i?o/t:1),l*e>r&&(l=n?r/e:1)),parseFloat(l.toFixed(2))},localStorageAvailable:function(){localStorageAvailable=!0;try{window.localStorage.length,window.localStorage.setItem("fpd-storage","just-testing")}catch(e){localStorageAvailable=!1}return localStorageAvailable},checkImageDimensions:function(e,t,r){var o=e.currentViewInstance.options.customImageParameters;if(t>o.maxW||t<o.minW||r>o.maxH||r<o.minH){e.mainBar&&e.mainBar.toggleDialog(!1);var a=e.getTranslation("misc","uploaded_image_size_alert").replace("%minW",o.minW).replace("%minH",o.minH).replace("%maxW",o.maxW).replace("%maxH",o.maxH);return FPDUtil.showModal(a),!1}return!0},elementHasColorSelection:function(e){return(Array.isArray(e.colors)||Boolean(e.colors)||e.colorLinkGroup)&&FPDUtil.elementIsColorizable(e)!==!1},elementAvailableColors:function(e,t){var r=[];if("path-group"==e.type){r=[];for(var o=0;o<e.paths.length;++o){var a=e.paths[o],l=tinycolor(a.fill);r.push(l.toHexString())}}else r=e.colorLinkGroup?t.colorLinkGroups[e.colorLinkGroup].colors:e.colors;return r},changePathColor:function(e,t,r){for(var o=[],a=0;a<e.paths.length;++a){var l=e.paths[a],n=tinycolor(l.fill);o.push(n.toHexString())}return o[t]=r.toHexString(),o},isHex:function(e){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e)},addThousandSep:function(e){var t=/(\d+)(\d{3})/;return String(e).replace(/^\d+/,function(e){for(;t.test(e);)e=e.replace(t,"$1"+thousandSeparator+"$2");return e})}};

var FancyProductDesignerOptions = function() { 
	this.defaults = {
		imageLoadTimestamp: false, 
		stageWidth: 900, 
		stageHeight: 600, 
		editorMode: false, 
		editorBoxParameters: ['left', 'top', 'angle', 'fill', 'width', 'height', 'fontSize', 'price'], 
		fonts: [{name: 'Helvetica'},{name: 'Times New Roman'}, {name: 'Arial'},{name: 'Roboto', url: 'google'},{name: 'Press Start 2P', url: 'google'},{name: 'Spirax', url: 'google'},{name: 'Open Sans', url: 'google'},{name: 'Lato', url: 'google'},{name: 'Slabo 27px', url: 'google'},{name: 'Macondo', url: 'google'},{name: 'Roboto Condensed', url: 'google'},{name: 'Oswald', url: 'google'},{name: 'Source Sans Pro', url: 'google'},{name: 'Montserrat', url: 'google'},{name: 'BioRhyme', url: 'google'},{name: 'Raleway', url: 'google'},{name: 'PT Sans', url: 'google'},{name: 'Roboto Slab', url: 'google'},{name: 'Merriweather', url: 'google'},{name: 'Open Sans Condensed', url: 'google'},{name: 'Lora', url: 'google'},{name: 'Droid Sans', url: 'google'},{name: 'Palanquin Dark', url: 'google'},{name: 'Ubuntu', url: 'google'},{name: 'Droid Serif', url: 'google'},{name: 'Playfair Display', url: 'google'},{name: 'Arimo', url: 'google'},{name: 'PT Serif', url: 'google'},{name: 'Pavanam', url: 'google'},{name: 'Noto Sans', url: 'google'},{name: 'Titillium Web', url: 'google'},{name: 'PT Sans Narrow', url: 'google'},{name: 'Muli', url: 'google'},{name: 'Indie Flower', url: 'google'},{name: 'Poppins', url: 'google'},{name: 'Bitter', url: 'google'},{name: 'Fjalla One', url: 'google'},{name: 'Inconsolata', url: 'google'},{name: 'Palanquin', url: 'google'},{name: 'Hind', url: 'google'},{name: 'Dosis', url: 'google'},{name: 'Oxygen', url: 'google'},{name: 'Catamaran', url: 'google'},{name: 'Anton', url: 'google'},{name: 'Noto Serif', url: 'google'},{name: 'Cabin', url: 'google'},{name: 'Arvo', url: 'google'},{name: 'Crimson Text', url: 'google'},{name: 'Lobster', url: 'google'},{name: 'Fira Sans', url: 'google'},{name: 'Arsenal', url: 'google'},{name: 'Nunito', url: 'google'},{name: 'Libre Baskerville', url: 'google'},{name: 'Yanone Kaffeesatz', url: 'google'},{name: 'Merriweather Sans', url: 'google'},{name: 'Bree Serif', url: 'google'},{name: 'Josefin Sans', url: 'google'},{name: 'Roboto Mono', url: 'google'},{name: 'Abril Fatface', url: 'google'},{name: 'Asap', url: 'google'},{name: 'Exo 2', url: 'google'},{name: 'Abel', url: 'google'},{name: 'Gloria Hallelujah', url: 'google'},{name: 'Revalia', url: 'google'},{name: 'Varela Round', url: 'google'},{name: 'Pacifico', url: 'google'},{name: 'Quicksand', url: 'google'},{name: 'Ubuntu Condensed', url: 'google'},{name: 'Rubik', url: 'google'},{name: 'Karla', url: 'google'},{name: 'Archivo Narrow', url: 'google'},{name: 'Amatic SC', url: 'google'},{name: 'Play', url: 'google'},{name: 'Dancing Script', url: 'google'},{name: 'Signika', url: 'google'},{name: 'Questrial', url: 'google'},{name: 'Cuprum', url: 'google'},{name: 'Bungee Hairline', url: 'google'},{name: 'Shadows Into Light', url: 'google'},{name: 'Work Sans', url: 'google'},{name: 'Alegreya', url: 'google'},{name: 'PT Sans Caption', url: 'google'},{name: 'Francois One', url: 'google'},{name: 'Vollkorn', url: 'google'},{name: 'Exo', url: 'google'},{name: 'Maven Pro', url: 'google'},{name: 'Orbitron', url: 'google'},{name: 'Rokkitt', url: 'google'},{name: 'Crete Round', url: 'google'},{name: 'Source Code Pro', url: 'google'},{name: 'Pathway Gothic One', url: 'google'},{name: 'Acme', url: 'google'},{name: 'Baloo Chettan', url: 'google'},{name: 'EB Garamond', url: 'google'},{name: 'Patua One', url: 'google'},{name: 'Ropa Sans', url: 'google'},{name: 'Source Serif Pro', url: 'google'},{name: 'Architects Daughter', url: 'google'},{name: 'Russo One', url: 'google'},{name: 'Josefin Slab', url: 'google'},{name: 'Comfortaa', url: 'google'},{name: 'Cinzel', url: 'google'},{name: 'Righteous', url: 'google'},{name: 'Alegreya Sans', url: 'google'},{name: 'News Cycle', url: 'google'},{name: 'Satisfy', url: 'google'},{name: 'Lobster Two', url: 'google'},{name: 'Concert One', url: 'google'}],
		templatesDirectory: 'https://printyuk.com/js/otfjs/html/',
		imagesDirectory: 'https://printyuk.com/js/otfjs/images/',
		facebookAppId: '1873566399547935',
		instagramClientId: 'a2ae905c0f5a4c6e97f9a0a7e26e8aa5', 
		instagramRedirectUri: 'https://printyuk.com/js/otfjs/html/instagram_auth.html',
		zoomStep: 0.2, 
		maxZoom: 3, 
		hexNames: {}, 
		selectedColor: '#f5f5f5', 
		boundingBoxColor: '#005ede', 
		outOfBoundaryColor: '#990000', 
		replaceInitialElements: false, 
		lazyLoad: true, 
		templatesType: 'html', 
		customImageAjaxSettings: { 
			url: 'https://printyuk.com/js/otfjs/php/custom-image-handler.php', 
			method: 'POST', 
			dataType: 'json', 
			data: {saveOnServer: 0,uploadsDir: './uploads',uploadsDirURL: 'https://printyuk.com/upload'}
		}, 
		improvedResizeQuality: false, 
		responsive: true, 
		cornerIconColor: '#000000',  
		langJSON: 'lang/default.json', 
		colorPickerPalette: [], 
		actions:  {'top': [],'right': [],'bottom': [],'left': []}, 
		mainBarModules: ['products', 'images', 'text', 'designs', 'manage-layers','saving','checkout','saved'], 
		initialActiveModule: '', 
		maxValues: {}, 
		watermark: false, 
		gridColumns: 2, 
		priceFormat: '&#36;%d', 
		mainBarContainer: false, 
		modalMode: false, 
		keyboardControl: true, 
		deselectActiveOnOutside: true, 
		uploadZonesTopped: true, 
		loadFirstProductInStage: true, 
		unsavedProductAlert: false, 
		hideDialogOnAdd: false, 
		toolbarPlacement: 'dynamic', 
		snapGridSize: [50, 50], 
		fabricCanvasOptions: {}, 
		namesNumbersDropdown: [], 
		namesNumbersEntryPrice: 0, 
		colorSelectionPlacement: '', 
		bulkVariationsPlacement: '', 
		bulkVariations: {}, 
		toolbarDynamicContext: 'body', 
		boundingBoxProps: {strokeWidth: 1}, 
		elementParameters: { 
			z: -1, 
			price: 0,  
			colors: false, 
			removable: false, 
			draggable: false, 
			rotatable: false, 
			resizable: false, 
			copyable: false, 
			zChangeable: false, 
			boundingBox: false, 
			boundingBoxMode: 'inside', 
			autoCenter: false, 
			replace: '', 
			replaceInAllViews: false, 
			autoSelect: false, 
			topped: false, 
			colorPrices: {}, 
			colorLinkGroup: false, 
			patterns: [], 
			sku: '',
			originX: 'center',
			originY: 'center',
			cornerSize: 24,
			fill: false,
			lockUniScaling: true,
			pattern: false,
			top: 0,
			left: 0,
			angle: 0,
			flipX: false,
			flipY: false,
			opacity: 1,
			scaleX: 1,
			scaleY: 1,
			excludeFromExport: false,
		}, 
		textParameters: { 
			maxLength: 0, 
			curved: false, 
			curvable: false, 
			curveSpacing: 10, 
			curveRadius: 80, 
			curveReverse: false, 
			maxLines: 0, 
			textBox: false, 
			textPlaceholder: false, 
			numberPlaceholder: false, 
			letterSpacing: 0,
			editable: true,
			fontFamily: "Arial",
			fontSize: 18,
			lineHeight: 1,
			fontWeight: 'normal', //set the font weight - bold or normal
			fontStyle: 'normal', //'normal', 'italic'
			textDecoration: 'normal', //'normal' or 'underline'
			padding: 10,
			textAlign: 'left',
			stroke: null,
			strokeWidth: 0,
			charSpacing: 0,
		}, 
		imageParameters: { 
			uploadZone: false, 
			filter: false, 
			availableFilters: [], 
			uniScalingUnlockable: false,
			scaleMode: 'fit', 
			resizeToW: 0, 
			resizeToH: 0,
			padding: 0,
			minScaleLimit: 0.01
		}, 
		customImageParameters: { 
			minW: 100, 
			minH: 100, 
			maxW: 15000, 
			maxH: 15000,
			minDPI: 72,
			maxSize: 10
		},
		customTextParameters: {

		},
		customAdds: {
			designs: true,
			uploads: true,
			texts: true,
			saving: true, 
			checkout: true, 
			saved: true,
			drawing: true
		},
		
		qrCodeProps: {
			autoCenter: true,
			draggable: true,
			removable: true,
			resizable: true
		}
	};
	
	this.merge = function(defaults, merge) {

		typeof merge === 'undefined' ? {} : merge;

		var options = $.extend({}, defaults, merge);
		options.elementParameters = $.extend({}, defaults.elementParameters, options.elementParameters);
		options.textParameters = $.extend({}, defaults.textParameters, options.textParameters);
		options.imageParameters = $.extend({}, defaults.imageParameters, options.imageParameters);
		options.customTextParameters = $.extend({}, defaults.customTextParameters, options.customTextParameters);
		options.customImageParameters = $.extend({}, defaults.customImageParameters, options.customImageParameters);
		options.customAdds = $.extend({}, defaults.customAdds, options.customAdds);
		options.customImageAjaxSettings = $.extend({}, defaults.customImageAjaxSettings, options.customImageAjaxSettings);
		options.qrCodeProps = $.extend({}, defaults.qrCodeProps, options.qrCodeProps);

		return options;

	};
	
	this.getParameterKeys = function() {

		var elementParametersKeys = Object.keys(this.defaults.elementParameters),
			imageParametersKeys = Object.keys(this.defaults.imageParameters),
			textParametersKeys = Object.keys(this.defaults.textParameters);

		elementParametersKeys = elementParametersKeys.concat(imageParametersKeys);
		elementParametersKeys = elementParametersKeys.concat(textParametersKeys);

		return elementParametersKeys;

	};

};
var FancyProductDesignerView = function($productStage, view, callback, fabricCanvasOptions) {

	fabricCanvasOptions = typeof fabricCanvasOptions === 'undefined' ? {} : fabricCanvasOptions;

	var $this = $(this),
		instance = this,
		mouseDownStage = false,
		initialElementsLoaded = false,
		tempModifiedParameters = null,
		modifiedType = null,
		limitModifyParameters = {},
		fpdOptions = new FancyProductDesignerOptions();

	var _initialize = function() {
		instance.title = view.title;
		instance.thumbnail = view.thumbnail;
		instance.elements = view.elements;
		instance.options = view.options;
		instance.undos = [];
		instance.redos = [];
		instance.totalPrice = 0;
		instance.zoom = 1;
		instance.responsiveScale = 1;
		instance.currentElement = null;
		instance.currentBoundingObject = null;
		instance.currentUploadZone = null;
		instance.stage = null;
		instance.propertiesToInclude = ['_isInitial', 'lockMovementX', 'lockMovementY', 'lockRotation', 'lockScalingX', 'lockScalingY', 'lockScalingFlip', 'lockUniScaling', 'resizeType', 'clipTo', 'clippingRect', 'boundingBox', 'boundingBoxMode', 'selectable', 'evented', 'title', 'editable', 'cornerColor', 'cornerIconColor', 'borderColor', 'isEditable', 'hasUploadZone'];
		instance.dragStage = false;

		//PLUS
		instance.textPlaceholder = null;
		instance.numberPlaceholder = null;
		instance.names_numbers = view.names_numbers ? view.names_numbers : null;

		//replace old width option with stageWidth
		if(instance.options.width) {
			instance.options.stageWidth = instance.options.width;
			delete instance.options['width'];
		}

		//add new canvas
		$productStage.append('<canvas></canvas>');

		$this.on('elementAdd', function(evt, element){

			if(!element) {
				return;
			}

			//check for other topped elements
			_bringToppedElementsToFront();

			if(element.isCustom && !element.hasUploadZone && !element.replace) {
				element.copyable = element.originParams.copyable = true;
				instance.stage.renderAll();
			}

		});

		//create fabric stage
		var canvas = $productStage.children('canvas:last').get(0),
			canvasOptions = $.extend({}, {
				containerClass: 'fpd-view-stage fpd-hidden',
				selection: false,
				hoverCursor: 'pointer',
				controlsAboveOverlay: true,
				centeredScaling: true,
				allowTouchScrolling: true,
				preserveObjectStacking: true
			}, fabricCanvasOptions);

		instance.stage = new fabric.Canvas(canvas, canvasOptions).on({
			'object:added': function(opts) {

				var element = opts.target,
					price = element.price;

				//if element is addded into upload zone, use upload zone price if one is set
				if((instance.currentUploadZone && instance.currentUploadZone != '')) {

					var uploadZoneObj = instance.getElementByTitle(instance.currentUploadZone);
					price = uploadZoneObj.price ? uploadZoneObj.price : price;

				}

				if(price !== undefined && price !== 0 && !element.uploadZone && element.type !== 'rect') {

					element.setCoords();
					instance.changePrice(price, '+');

				}

			},
			'object:removed': function(opts) {

				var element = opts.target;

				if(element.price !== undefined && element.price !== 0 && !element.uploadZone) {
					instance.changePrice(element.price, '-');
				}

			}
		});

		instance.stage.setDimensions({width: instance.options.stageWidth, height: instance.options.stageHeight});

	};

	var _afterSetup = function() {

		callback.call(callback, instance);

		initialElementsLoaded = true;

		if(instance.options.keyboardControl) {

			$(document).on('keydown', function(evt) {

				var $target = $(evt.target);

				if(instance.currentElement && !$target.is('textarea,input[type="text"],input[type="number"]')) {

					switch(evt.which) {
						case 8:
							//remove element
							if(instance.currentElement.removable) {
								instance.removeElement(instance.currentElement);
							}

						break;
				        case 37: // left

					        if(instance.currentElement.draggable) {
						        instance.setElementParameters({left: instance.currentElement.left - 1});
					        }

				        break;
				        case 38: // up

				        	if(instance.currentElement.draggable) {
						        instance.setElementParameters({top: instance.currentElement.top - 1});
					        }

				        break;
				        case 39: // right

				        	if(instance.currentElement.draggable) {
						        instance.setElementParameters({left: instance.currentElement.left + 1});
					        }

				        break;
				        case 40: // down

				        	if(instance.currentElement.draggable) {
						        instance.setElementParameters({top: instance.currentElement.top + 1});
					        }

				        break;

				        default: return; //other keys
				    }

				    evt.preventDefault();

				}

			});

		}

		//attach handlers to stage
		instance.stage.on({
			'mouse:over': function(opts) {

				if(instance.currentElement && instance.currentElement.draggable && opts.target === instance.currentElement) {
					instance.stage.hoverCursor = 'move';
				}
				else {
					instance.stage.hoverCursor = 'pointer';
				}

			},
			'mouse:down': function(opts) {

				mouseDownStage = true;

				if(opts.target == undefined) {
					instance.deselectElement();
				}

			},
			'mouse:up': function(opts) {

				var targetCorner = false;
				if(opts.target) {
					targetCorner = opts.target.__corner;
				}

				tempModifiedParameters = instance.getElementJSON();

				//remove element
				if(targetCorner == 'bl' && instance.currentElement.removable) {
					instance.removeElement(instance.currentElement);
				}

				//copy element
				if(targetCorner == 'tl' && instance.currentElement.copyable && !instance.currentElement.hasUploadZone) {

					var newOpts = instance.getElementJSON();
					newOpts.autoCenter = true;

					instance.addElement(
						FPDUtil.getType(instance.currentElement.type),
						instance.currentElement.source,
						'Copy '+instance.currentElement.title,
						newOpts
					);

				}

				mouseDownStage = false;

			},
			'mouse:move': function(opts) {

				if(mouseDownStage && instance.dragStage) {

					instance.stage.relativePan(new fabric.Point(opts.e.movementX, opts.e.movementY));

				}

			},
			'text:changed': function(opts) {

				instance.setElementParameters({text: opts.target.text});

			},
			'object:moving': function(opts) {

				modifiedType = 'moving';
				_checkContainment(opts.target);
				$this.trigger('elementChange', [modifiedType, opts.target]);

			},
			'object:scaling': function(opts) {

				modifiedType = 'scaling';
				_checkContainment(opts.target);

				$this.trigger('elementChange', [modifiedType, opts.target]);

			},
			'object:rotating': function(opts) {

				modifiedType = 'rotating';
				_checkContainment(opts.target);

				$this.trigger('elementChange', [modifiedType, opts.target]);

			},
			'object:modified': function(opts) {

				if(tempModifiedParameters) {

					_setUndoRedo({element: opts.target, parameters: tempModifiedParameters, interaction: 'modify'});
					tempModifiedParameters = null;

				}

				if(FPDUtil.getType(opts.target.type) === 'text' && opts.target.type !== 'curvedText') {

					var newFontSize = opts.target.fontSize * opts.target.scaleX;
					newFontSize = parseFloat(Number(newFontSize).toFixed(0));
					//newFontSize = newFontSize < opts.target.minFontSize ? opts.target.minFontSize : newFontSize;
		            opts.target.scaleX = 1;
		            opts.target.scaleY = 1;
		            opts.target._clearCache();
		            opts.target.fontSize = newFontSize;

				}

				if(modifiedType !== null) {

					var modifiedParameters = {};

					switch(modifiedType) {
						case 'moving':
							modifiedParameters.left = Number(opts.target.left);
							modifiedParameters.top = Number(opts.target.top);
						break;
						case 'scaling':
							if(FPDUtil.getType(opts.target.type) === 'text' && opts.target.type !== 'curvedText') {
								modifiedParameters.fontSize = parseInt(opts.target.fontSize);
							}
							else {
								modifiedParameters.scaleX = parseFloat(opts.target.scaleX);
								modifiedParameters.scaleY = parseFloat(opts.target.scaleY);
							}
						break;
						case 'rotating':
							modifiedParameters.angle = opts.target.angle;
						break;
					}
					
					$this.trigger('elementModify', [opts.target, modifiedParameters]);
				}

				modifiedType = null;

			},
			'object:selected': function(opts) {

				var selectedElement = opts.target;

				instance.deselectElement(false);

				//dont select anything when in dragging mode
				if(instance.dragStage) {
					instance.deselectElement();
					return false;
				}

				instance.currentElement = selectedElement;
				
				$this.trigger('elementSelect', [selectedElement]);

				selectedElement.setControlVisible('tr', false);
				selectedElement.set({
					borderColor: instance.options.selectedColor,
					rotatingPointOffset: 0
				});

				//change cursor to move when element is draggable
				selectedElement.draggable ? instance.stage.hoverCursor = 'move' : instance.stage.hoverCursor = 'pointer';

				//check for a boundingbox
				if(selectedElement.boundingBox && !instance.options.editorMode) {

					var bbCoords = instance.getBoundingBoxCoords(opts.target);
					if(bbCoords) {

						var boundingBoxProps = {
							left: bbCoords.left,
							top: bbCoords.top,
							width: bbCoords.width,
							height: bbCoords.height,
							stroke: instance.options.boundingBoxColor,
							strokeWidth: 1,
							strokeLineCap: 'square',
							strokeDashArray: [5, 5],
							fill: false,
							selectable: false,
							evented: false,
							originX: 'left',
							originY: 'top',
							name: "bounding-box",
							excludeFromExport: true
						};

						boundingBoxProps = $.extend({}, boundingBoxProps, instance.options.boundingBoxProps);
						instance.currentBoundingObject = new fabric.Rect(boundingBoxProps);

						instance.stage.add(instance.currentBoundingObject);
						instance.currentBoundingObject.bringToFront();
						
						$this.trigger('boundingBoxToggle', [instance.currentBoundingObject, true]);

					}

					_checkContainment(opts.target);
				}

			}
		});

	};

	var _setUndoRedo = function(undo, redo, trigger) {

		trigger = typeof trigger === 'undefined' ? true : trigger;

		if(undo) {
			instance.undos.push(undo);

			if(instance.undos.length > 20) {
				instance.undos.shift();
			}
		}

		if(redo) {
			instance.redos.push(redo);
		}

		if(trigger) {
		
			$this.trigger('undoRedoSet', [instance.undos, instance.redos]);

		}

	};

	//brings all topped elements to front
	var _bringToppedElementsToFront = function() {

		var objects = instance.stage.getObjects(),
			bringToFrontObj = [];

		for(var i = 0; i < objects.length; ++i) {
			var object = objects[i];
			if(object.topped || (object.uploadZone && instance.options.uploadZonesTopped)) {
				bringToFrontObj.push(object);
			}
		}

		for(var i = 0; i < bringToFrontObj.length; ++i) {
			bringToFrontObj[i].bringToFront();
		}
		

		if(instance.currentBoundingObject) {
			instance.currentBoundingObject.bringToFront();
		}

		var snapLinesGroup = instance.getElementByID('_snap_lines_group');
		if(snapLinesGroup) {
			snapLinesGroup.bringToFront();
		}

		instance.stage.renderAll();

	};

	//checks if an element is in its containment (bounding box)
	var _checkContainment = function(target) {

		if(instance.currentBoundingObject && !target.hasUploadZone) {

			target.setCoords();

			if(target.boundingBoxMode === 'limitModify') {

				var targetBoundingRect = target.getBoundingRect(),
					bbBoundingRect = instance.currentBoundingObject.getBoundingRect(),
					minX = bbBoundingRect.left,
					maxX = bbBoundingRect.left+bbBoundingRect.width-targetBoundingRect.width;
					minY = bbBoundingRect.top,
					maxY = bbBoundingRect.top+bbBoundingRect.height-targetBoundingRect.height;

				//check if target element is not contained within bb
			    if(!target.isContainedWithinObject(instance.currentBoundingObject)) {

					//check if no corner is used, 0 means its dragged
					if(target.__corner === 0) {
						if(targetBoundingRect.left > minX && targetBoundingRect.left < maxX) {
						   limitModifyParameters.left = target.left;
					    }

					    if(targetBoundingRect.top > minY && targetBoundingRect.top < maxY) {
						   limitModifyParameters.top = target.top;
					    }
					}

			        target.setOptions(limitModifyParameters);


			    } else {

				    limitModifyParameters = {left: target.left, top: target.top, angle: target.angle, scaleX: target.scaleX, scaleY: target.scaleY};

			    }
			    
			    $this.trigger('elementCheckContainemt', [target, 'limitModify']);

			}
			else if(target.boundingBoxMode === 'inside' || target.boundingBoxMode === 'clipping') {

				var isOut = false,
					tempIsOut = target.isOut;

					isOut = !target.isContainedWithinObject(instance.currentBoundingObject);

				if(isOut) {

					if(target.boundingBoxMode === 'inside') {
						target.borderColor = instance.options.outOfBoundaryColor;
					}

					target.isOut = true;

				}
				else {

					if(target.boundingBoxMode === 'inside') {
						target.borderColor = instance.options.selectedColor;
					}

					target.isOut = false;

				}

				if(tempIsOut != target.isOut && tempIsOut != undefined) {
					if(isOut) {

						/**
					     * Gets fired as soon as an element is outside of its bounding box.
					     *
					     * @event FancyProductDesignerView#elementOut
					     * @param {Event} event
					     */
						$this.trigger('elementOut', [target]);
					}
					else {

						/**
					     * Gets fired as soon as an element is inside of its bounding box again.
					     *
					     * @event FancyProductDesignerView#elementIn
					     * @param {Event} event
					     */
						$this.trigger('elementIn', [target]);
					}
				}

				$this.trigger('elementCheckContainemt', [target, target.boundingBoxMode]);

			}

		}

		instance.stage.renderAll();

	};

	//center object
	var _centerObject = function(object, hCenter, vCenter, boundingBox) {

		var cp = object.getCenterPoint(),
			left = cp.x,
			top = cp.y;

		if(hCenter) {

			if(boundingBox) {
				left = boundingBox.left + boundingBox.width * 0.5;
			}
			else {
				left = instance.options.stageWidth * 0.5;
			}

		}

		if(vCenter) {
			if(boundingBox) {
				top = boundingBox.top + boundingBox.height * 0.5;
			}
			else {
				top = instance.options.stageHeight * 0.5;
			}

		}

		object.setPositionByOrigin(new fabric.Point(left, top), 'center', 'center');

		instance.stage.renderAll();
		object.setCoords();

		_checkContainment(object);

	};

	//loads custom fonts
	var _renderOnFontLoaded = function(fontName, element) {

		WebFont.load({
			custom: {
			  families: [fontName]
			},
			fontactive: function(familyName, fvd) {

				//$('body').mouseup();
				instance.stage.renderAll();

				if(element) {

					//fix: reset font size, otherwise custom font is not displaying
					if(element._tempFontSize !== null) {
						element.setFontSize(element._tempFontSize);
					}
					else {
						var correctFontSize = element.fontSize;
						element.setFontSize(correctFontSize - 1);
						element.setFontSize(correctFontSize);
					}

					element.setCoords();
					instance.stage.renderAll();

					element._tempFontSize = null;
				}

			}
		});

	};

	//sets the price for the element if it has color prices
	var _setColorPrice = function(element, hex) {

		if(element.colorPrices && typeof element.colors === 'object' && element.colors.length > 1) {

			if(element.currentColorPrice !== undefined) {
				element.price -= element.currentColorPrice;
				instance.changePrice(element.currentColorPrice, '-');
			}

			if(typeof hex === 'string') {

				var hexKey = hex.replace('#', '');
				if(element.colorPrices.hasOwnProperty(hexKey) || element.colorPrices.hasOwnProperty(hexKey.toUpperCase())) {

					var elementColorPrice = element.colorPrices[hexKey] === undefined ? element.colorPrices[hexKey.toUpperCase()] : element.colorPrices[hexKey];

					element.currentColorPrice = elementColorPrice;
					element.price += element.currentColorPrice;
					instance.changePrice(element.currentColorPrice, '+');

				}
				else {
					element.currentColorPrice = 0;
				}

			}
			else {
				element.currentColorPrice = 0;
			}

		}

	};

	//sets the pattern for a svg image or text
	var _setPattern = function(element, url) {

		if(element.type == 'path-group') {

			if(url) {
				fabric.util.loadImage(url, function(img) {

					for(var i=0; i < element.paths.length; ++i) {
						element.paths[i].setFill(new fabric.Pattern({
							source: img,
							repeat: 'repeat'
						}));
					}

					instance.stage.renderAll();
				});
			}

		}
		else if(FPDUtil.getType(element.type) === 'text') {

			if(url) {
				fabric.util.loadImage(url, function(img) {

					element.setFill(new fabric.Pattern({
						source: img,
						repeat: 'repeat'
					}));
					instance.stage.renderAll();
				});
			}
			else {
				var color = element.fill ? element.fill : element.colors[0];
				color = color ? color : '#000000';
				element.setFill(color);
			}

		}

	};

	//defines the clipping area
	var _clipElement = function(element) {

		var bbCoords = instance.getBoundingBoxCoords(element) || element.clippingRect;
		if(bbCoords) {

			element.clippingRect = bbCoords;
			element.setClipTo(function(ctx) {
				_clipById(ctx, this);
			});

		}

	};

	//draws the clipping
	var _clipById = function (ctx, _this, scale) {

		scale = scale === undefined ? 1 : scale;

		var centerPoint = _this.getCenterPoint(),
			clipRect = _this.clippingRect,
			scaleXTo1 = (1 / _this.scaleX),
			scaleYTo1 = (1 / _this.scaleY);

	    ctx.save();
	    ctx.translate(0,0);
	    ctx.rotate(fabric.util.degreesToRadians(_this.angle * -1));
	    ctx.scale(scaleXTo1, scaleYTo1);
	    ctx.beginPath();
	    ctx.rect(
	        (clipRect.left) - centerPoint.x,
	        (clipRect.top) - centerPoint.y,
	        clipRect.width * scale,
	        clipRect.height * scale
	    );
	    ctx.fillStyle = 'transparent';
	    ctx.fill();
	    ctx.closePath();
	    ctx.restore();

	};

	//returns the fabrich filter
	var _getFabircFilter = function(type) {

		switch(type) {
			case 'grayscale':
				return new fabric.Image.filters.Grayscale();
			break;
			case 'sepia':
				return new fabric.Image.filters.Sepia();
			break;
			case 'sepia2':
				return new fabric.Image.filters.Sepia2();
			break;
		}

		return null;

	};

	var _elementHasUploadZone = function(element) {

		if(element && element.hasUploadZone) {

			//check if upload zone contains objects
			var objects = instance.stage.getObjects(),
				uploadZoneEmpty = true;

			for(var i=0; i < objects.length; ++i) {

				var object = objects[i];
				if(object.replace == element.replace) {
					uploadZoneEmpty = false;
					break;
				}

			}

			var uploadZoneObject = instance.getUploadZone(element.replace);
			if(uploadZoneObject) {
				uploadZoneObject.opacity = uploadZoneEmpty ? 1 : 0;
				uploadZoneObject.evented = uploadZoneEmpty;
			}

			instance.stage.renderAll();
		}

	};

	var _maxTextboxLines = function(textbox, text) {

		textbox.setText(text);
		
		while(textbox.__lineHeights.length > textbox.maxLines) {
			text = textbox.text;
			text = text.slice(0, -1);
			textbox.setText(text);
			
			if(textbox.__lineHeights.length <= textbox.maxLines) {
				textbox.exitEditing();
			}
		}

		return text;

	};
	
	this.getElementByID = function(id) {

		var objects = instance.stage.getObjects();
		for(var i=0; i < objects.length; ++i) {
			if(objects[i].id == id) {
				return objects[i];
				break;
			}
		}

		return false;

	};
	
	this.addElement = function(type, source, title, params) {

		if(type === undefined || source === undefined || title === undefined) {
			return;
		}

		params = typeof params !== 'undefined' ? params : {};
		if(type === 'text') {
			//strip HTML tags
			source = source.replace(/(<([^>]+)>)/ig,"");
			title = title.replace(/(<([^>]+)>)/ig,"");
		}

		if(typeof params != "object") {
			FPDUtil.showModal("The element "+title+" does not have a valid JSON object as parameters! Please check the syntax, maybe you set quotes wrong.");
			return false;
		}

		//check that fill is a string
		if(typeof params.fill !== 'string' && !$.isArray(params.fill)) {
			params.fill = false;
		}

		//replace depraceted keys
		params = FPDUtil.rekeyDeprecatedKeys(params);

		//merge default options
		if(FPDUtil.getType(type) === 'text') {
			params = $.extend({}, instance.options.elementParameters, instance.options.textParameters, params);
		}
		else {
			params = $.extend({}, instance.options.elementParameters, instance.options.imageParameters, params);
		}

		var pushTargetObject = false,
			targetObject = null;

		//store current color and convert colors in string to array
		if(params.colors && typeof params.colors == 'string') {

			//check if string contains hex color values
			if(params.colors.indexOf('#') == 0) {
				//convert string into array
				var colors = params.colors.replace(/\s+/g, '').split(',');
				params.colors = colors;
			}

		}

		params._isInitial = !initialElementsLoaded;

		if(FPDUtil.getType(type) === 'text') {
			var defaultTextColor = params.colors[0] ? params.colors[0] : '#000000';
			params.fill = params.fill ? params.fill : defaultTextColor;
		}

		var fabricParams = {
			source: source,
			title: title,
			id: String(new Date().getTime()),
			cornerColor: instance.options.cornerColor ? instance.options.cornerColor : instance.options.selectedColor,
			cornerIconColor: instance.options.cornerIconColor
		};

		params.__editorMode = instance.options.editorMode;
		if(instance.options.editorMode) {
			fabricParams.selectable = fabricParams.evented = fabricParams.draggable = fabricParams.removable = fabricParams.resizable = fabricParams.rotatable = fabricParams.zChangeable = fabricParams.copyable = fabricParams.lockUniScaling = true;

		}
		else {
			$.extend(fabricParams, {
				selectable: false,
				lockRotation: true,
				hasRotatingPoint: false,
				lockScalingX: true,
				lockScalingY: true,
				lockMovementX: true,
				lockMovementY: true,
				hasControls: false,
				evented: false,
			});
		}

		fabricParams = $.extend({}, params, fabricParams);

		if(type == 'image' || type == 'path' || type == 'path-group') {

			fabricParams.crossOrigin = '';
			fabricParams.lockUniScaling = instance.options.editorMode ? false : !fabricParams.uniScalingUnlockable;

			if(!FPDUtil.isXML(source)) {
				var splitURLParams = source.split('?'); //remove url parameters
				source = fabricParams.source = splitURLParams[0];
			}

			var _fabricImageLoaded = function(fabricImage, params, vectorImage, originParams) {

				if(fabricImage) {

					originParams = originParams === undefined ? {} : originParams;

					$.extend(params, {
						originParams: $.extend({}, params, originParams)
					});

					fabricImage.setOptions(params);
					instance.stage.add(fabricImage);
					instance.setElementParameters(params, fabricImage, false);

					fabricImage.originParams.angle = fabricImage.angle;
					fabricImage.originParams.z = instance.getZIndex(fabricImage);

					if(instance.options.improvedResizeQuality && !vectorImage) {

						fabricImage.resizeFilters.push(new fabric.Image.filters.Resize({
						    resizeType: 'hermite'
						}));

					}

					if(!fabricImage._isInitial) {
						_setUndoRedo({
							element: fabricImage,
							parameters: params,
							interaction: 'add'
						});
					}

				}
				else {
					FPDUtil.showModal("The image with the URL<br /><i style='font-size: 10px;'>"+params.source+"</i><br />can not be loaded into the canvas. <p><br />Troubleshooting<br/><ul><li>The URL is not correct!</li><li>The image has been blocked by <a href='https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS' target='_blank'>CORS policy</a>. You need to host the image under the same protocol and domain or enable 'Access-Control-Allow-Origin' on the server where you host the image. <a href='http://enable-cors.org/' target='_blank'>Read more about it here.</a></li></ul></p>");
				}

				/**
			     * Gets fired as soon as an element has beed added.
			     *
			     * @event FancyProductDesignerView#elementAdd
			     * @param {Event} event
			     * @param {fabric.Object} object - The fabric object.
			     */
				$this.trigger('elementAdd', [fabricImage]);

			};


			if(source === undefined || source.length === 0) {
				FPDUtil.log('No image source set for: '+ title);
				return;
			}

			//add SVG from XML document
			if(FPDUtil.isXML(source)) {

				fabric.loadSVGFromString(source, function(objects, options) {
					var svgGroup = fabric.util.groupSVGElements(objects, options);
					_fabricImageLoaded(svgGroup, fabricParams, true);
				});

			}
			//load svg from url
			else if($.inArray('svg', source.split('.')) != -1) {

				var timeStamp = Date.now().toString(),
					_loadFromScript = instance.options._loadFromScript ? instance.options._loadFromScript : '',
					url = _loadFromScript + source;

				if(instance.options.imageLoadTimestamp && !instance.options._loadFromScript) {
					url += '?'+timeStamp;
				}

				fabric.loadSVGFromURL(url, function(objects, options) {

					//if objects is null, svg is loaded from external server with cors disabled
					var svgGroup = objects ? fabric.util.groupSVGElements(objects, options) : null;

					if(objects && !params.fill) {
						params.colors = [];
						for(var i=0; i < objects.length; ++i) {
							var color = tinycolor(objects[i].fill);
							params.colors.push(color.toHexString());
						}
						params.svgFill = params.colors;
					}

					_fabricImageLoaded(svgGroup, fabricParams, true, {svgFill: params.svgFill});

				});

			}
			//load png/jpeg from url
			else {

				var timeStamp = Date.now().toString(),
					_loadFromScript = instance.options._loadFromScript ? instance.options._loadFromScript : '',
					url;

				if(source.indexOf('data:image/') == -1) {//do not add timestamp to data URI

					url = _loadFromScript + source;

					if(instance.options.imageLoadTimestamp && !instance.options._loadFromScript) {
						url += '?'+timeStamp;
					}

				}
				else {
					url = source;
				}

				new fabric.Image.fromURL(url, function(fabricImg, img) {

					//if src is empty, image is loaded from external server with cors disabled
					fabricImg = fabricImg.getSrc() === '' ? null : fabricImg;
					_fabricImageLoaded(fabricImg, fabricParams, false);

				}, {crossOrigin: 'anonymous'});

			}

		}
		else if(FPDUtil.getType(type) === 'text') {

			source = source.replace(/\\n/g, '\n');
			params.text = params.text ? params.text : source;

			$.extend(fabricParams, {
				spacing: params.curveSpacing,
				radius: params.curveRadius,
				reverse: params.curveReverse,
				originParams: $.extend({}, params)
			});


			//fix for correct boundary when using custom fonts
			var tempFontSize = fabricParams.fontSize;
			fabricParams._tempFontSize = tempFontSize;
			fabricParams.fontSize = tempFontSize + 0.01;

			//make text curved
			var fabricText;
			if(params.curved) {
				fabricText = new fabric.CurvedText(source, fabricParams);
			}
			//make text box
			else if(params.textBox) {
				fabricParams.lockUniScaling = !instance.options.editorMode;
				fabricText = new fabric.Textbox(source, fabricParams);
				fabricText.setControlVisible('bl', true);
			}
			//just interactive text
			else {
				fabricText = new fabric.IText(source, fabricParams);
			}

			if(fabricParams.textPlaceholder || fabricParams.numberPlaceholder) {

				if(fabricParams.textPlaceholder) {
					instance.textPlaceholder = fabricText;
					fabricParams.removable = false;
				}

				if(fabricParams.numberPlaceholder) {
					instance.numberPlaceholder = fabricText;
					fabricParams.removable = false;
				}

			}

			instance.stage.add(fabricText);
			instance.setElementParameters(fabricParams, fabricText, false);

			fabricText.originParams = $.extend({}, fabricText.toJSON(), fabricText.originParams);
			delete fabricText.originParams['clipTo'];
			fabricText.originParams.z = instance.getZIndex(fabricText);

			if(!fabricText._isInitial) {
				_setUndoRedo({
					element: fabricText,
					parameters: fabricParams,
					interaction: 'add'
				});
			}

			$this.trigger('elementAdd', [fabricText]);

		}
		else {

			FPDUtil.showModal('Sorry. This type of element is not allowed!');

		}

	};

	this.getElementByTitle = function(title) {

		var objects = instance.stage.getObjects();
		for(var i = 0; i < objects.length; ++i) {
			if(objects[i].title == title) {
				return objects[i];
				break;
			}
		}

	};
	
	this.deselectElement = function(discardActiveObject) {

		discardActiveObject = typeof discardActiveObject == 'undefined' ? true : discardActiveObject;

		if(instance.currentBoundingObject) {

			instance.currentBoundingObject.remove();
			$this.trigger('boundingBoxToggle', [instance.currentBoundingObject, false]);
			instance.currentBoundingObject = null;

		}

		if(discardActiveObject) {
			instance.stage.discardActiveObject();
		}

		instance.currentElement = null;
		instance.stage.renderAll().calcOffset();

		$this.trigger('elementSelect', [null]);

	};
	
	this.removeElement = function(element) {

		if(typeof element === 'string') {
			element = instance.getElementByTitle(element);
		}

		_setUndoRedo({
			element: element,
			parameters: instance.getElementJSON(element),
			interaction: 'remove'
		});

		instance.stage.remove(element);

		_elementHasUploadZone(element);
		
		$this.trigger('elementRemove', [element]);

		this.deselectElement();

	};
	
	this.setElementParameters = function(parameters, element, saveUndo) {

		element = typeof element === 'undefined' ? instance.stage.getActiveObject() : element;
		saveUndo = typeof saveUndo === 'undefined' ? true : saveUndo;

		if(!element || parameters === undefined) {
			return false;
		}

		//if element is string, get by title
		if(typeof element == 'string') {
			element = instance.getElementByTitle(element);
		}

		var elemType = FPDUtil.getType(element.type);

		//store undos
		if(saveUndo && initialElementsLoaded) {

			var undoParameters = instance.getElementJSON();

			if(element._tempFill) {
				undoParameters.fill = element._tempFill;
				element._tempFill = undefined;
			}

			_setUndoRedo({
				element: element,
				parameters: undoParameters,
				interaction: 'modify'
			});

		}

		//adds the element into a upload zone
		if((instance.currentUploadZone && instance.currentUploadZone != '')) {

			parameters.z = -1;
			var uploadZoneObj = instance.getElementByTitle(instance.currentUploadZone),
				scale = FPDUtil.getScalingByDimesions(
					element.width,
					element.height,
					uploadZoneObj.width * uploadZoneObj.scaleX,
					uploadZoneObj.height * uploadZoneObj.scaleY,
					uploadZoneObj.scaleMode
				);

			$.extend(parameters, {
					boundingBox: instance.currentUploadZone,
					boundingBoxMode: 'clipping',
					scaleX: scale,
					scaleY: scale,
					autoCenter: true,
					removable: true,
					zChangeable: false,
					autoSelect: false,
					rotatable: uploadZoneObj.rotatable,
					draggable: uploadZoneObj.draggable,
					resizable: uploadZoneObj.resizable,
					price: uploadZoneObj.price ? uploadZoneObj.price : parameters.price,
					replace: instance.currentUploadZone,
					hasUploadZone: true,
					z: instance.getZIndex(instance.getElementByTitle(instance.currentUploadZone))
				}
			);

		}

		//if topped, z-index can not be changed
		if(parameters.topped) {
			parameters.zChangeable = false;
		}

		//new element added
		if(	typeof parameters.colors === 'object' ||
			parameters.colors === true ||
			parameters.colors == 1 ||
			parameters.removable ||
			parameters.draggable ||
			parameters.resizable ||
			parameters.rotatable ||
			parameters.zChangeable ||
			parameters.editable
			|| parameters.uploadZone
			|| (parameters.colorLinkGroup && parameters.colorLinkGroup.length > 0)) {

			parameters.isEditable = parameters.evented = parameters.selectable = true;

		}

		//upload zones have no controls
		if(!parameters.uploadZone || instance.options.editorMode) {

			if(parameters.draggable) {
				parameters.lockMovementX = parameters.lockMovementY = false;
			}

			if(parameters.rotatable) {
				parameters.lockRotation = false;
				parameters.hasRotatingPoint = true;
			}

			if(parameters.resizable) {
				parameters.lockScalingX = parameters.lockScalingY = false;
			}

			if((parameters.resizable || parameters.rotatable || parameters.removable)) {
				parameters.hasControls = true;
			}

		}

		if(parameters.uploadZone) {
			parameters.lockRotation = true;
			parameters.hasRotatingPoint = false;
		}

		if(parameters.replace && parameters.replace != '') {

			var replacedElement = instance.getElementByReplace(parameters.replace);

			//element with replace in view found and replaced element is not the new element
			if(replacedElement !== null && replacedElement !== element ) {
				parameters.z = instance.getZIndex(replacedElement);
				parameters.left = replacedElement.left;
				parameters.top = replacedElement.top;
				parameters.autoCenter = false;
				instance.removeElement(replacedElement);
			}

		}

		//needs to before setOptions
		if(typeof parameters.text === 'string') {

			var text = parameters.text;
			if(element.maxLength != 0 && text.length > element.maxLength) {
				text = text.substr(0, element.maxLength);
				element.selectionStart = element.maxLength;
			}

			//check lines length
			if(element.maxLines != 0) {

				if(element.type == 'textbox' && element.__lineHeights) {
					text = _maxTextboxLines(element, text);
				}
				else if(text.split("\n").length > element.maxLines) {
					text = text.replace(/([\s\S]*)\n/, "$1");
					element.exitEditing(); //exit editing when max lines are reached
				}

			}

			element.setText(text);
			parameters.text = text;

		}

		if(elemType === 'text') {

			if(parameters.letterSpacing !== undefined) {
				parameters.charSpacing = parameters.letterSpacing * 100;
			}

		}

		delete parameters['paths']; //no paths in parameters
		element.setOptions(parameters);

		if(parameters.autoCenter) {
			instance.centerElement(true, true, element);
		}

		//change element color
		if(parameters.fill !== undefined || parameters.svgFill !== undefined) {
			var fill = parameters.svgFill !== undefined ? parameters.svgFill : parameters.fill;
			instance.changeColor(element, fill);
			element.pattern = undefined;
		}

		//set pattern
		if(parameters.pattern !== undefined) {
			_setPattern(element, parameters.pattern);
			_setColorPrice(element, parameters.pattern);
		}

		//set filter
		if(parameters.filter) {

			element.filters = [];
			var fabricFilter = _getFabircFilter(parameters.filter);
			if(fabricFilter != null) {
				element.filters.push(fabricFilter);
			}
			element.applyFilters(function() {
				instance.stage.renderAll();
			});
			

		}

		//clip element
		if((parameters.boundingBox && parameters.boundingBoxMode === 'clipping') || parameters.hasUploadZone) {
			_clipElement(element);
		}

		//set z position
		if(parameters.z >= 0) {
			element.moveTo(parameters.z);
			_bringToppedElementsToFront();
		}

		if(parameters.fontFamily !== undefined) {
			_renderOnFontLoaded(parameters.fontFamily, element);
		}

		if(element.curved) {

			if(parameters.curveRadius) {
				element.set('radius', parameters.curveRadius);
			}

			if(parameters.curveSpacing) {
				element.set('spacing', parameters.curveSpacing);
			}

			if(parameters.curveReverse !== undefined) {
				element.set('reverse', parameters.curveReverse);
			}

		}

		if(element.uploadZone) {
			element.evented = element.opacity !== 0;
		}

		//check if a upload zone contains an object
		var objects = instance.stage.getObjects();
		for(var i=0; i < objects.length; ++i) {

			var object = objects[i];

			if(object.uploadZone && object.title == parameters.replace) {
				object.opacity = 0;
				object.evented = false;
			}

		}

		element.setCoords();
		instance.stage.renderAll().calcOffset();

		$this.trigger('elementModify', [element, parameters]);

		_checkContainment(element);

		//select element
		if(parameters.autoSelect && element.isEditable && !instance.options.editorMode && $(instance.stage.getElement()).is(':visible')) {

			setTimeout(function() {
				instance.stage.setActiveObject(element);
				instance.stage.renderAll();
			}, 1);

		}

	};

	/**
	 * Returns the bounding box of an element.
	 *
	 * @method getBoundingBoxCoords
	 * @param {fabric.Object} element A fabric object
	 * @return {Object | Boolean} The bounding box object with x,y,width and height or false.
	 */
	this.getBoundingBoxCoords = function(element) {

		if(element.boundingBox || element.uploadZone) {

			if(typeof element.boundingBox == "object") {

				return {
					left: element.boundingBox.x,
					top: element.boundingBox.y,
					width: element.boundingBox.width,
					height: element.boundingBox.height
				};

			}
			else {

				var objects = instance.stage.getObjects();

				for(var i=0; i < objects.length; ++i) {

					//get all layers from first view
					var object = objects[i];
					if(element.boundingBox == object.title) {

						var topLeftPoint = object.getPointByOrigin('left', 'top');

						return {
							left: topLeftPoint.x,
							top: topLeftPoint.y,
							width: object.getWidth(),
							height: object.getHeight()
						};

						break;
					}

				}

			}

		}

		return false;

	};
	
	this.toDataURL = function(callback, backgroundColor, options, watermarkImg) {

		callback = typeof callback !== 'undefined' ? callback : function() {};
		backgroundColor = typeof backgroundColor !== 'undefined' ? backgroundColor : 'transparent';
		options = typeof options !== 'undefined' ? options : {};
		options.onlyExportable = typeof options.onlyExportable !== 'undefined' ? options.onlyExportable : false;
		watermarkImg = typeof watermarkImg !== 'undefined' ? watermarkImg : false;

		instance.stage.enableRetinaScaling = false;

		var invisibleObjs = ['_snap_lines_group', '_ruler_hor', '_ruler_ver'],
			hiddenObjs = [];

		instance.stage.getObjects().forEach(function(obj) {

				if(invisibleObjs.indexOf(obj.id) !== -1 || (obj.excludeFromExport && options.onlyExportable)) {

					obj.visible = false;
					hiddenObjs.push(obj);

				}

		});

		instance.deselectElement();
		instance.stage.setDimensions({width: instance.options.stageWidth, height: instance.options.stageHeight}).setZoom(1);

		instance.stage.setBackgroundColor(backgroundColor, function() {

			if(watermarkImg) {
				instance.stage.add(watermarkImg);
				watermarkImg.center();
				watermarkImg.bringToFront();
			}

			//get data url
			callback(instance.stage.toDataURL(options));

			instance.stage.enableRetinaScaling = true;

			if(watermarkImg) {
				instance.stage.remove(watermarkImg);
			}

			if($(instance.stage.wrapperEl).is(':visible')) {
				instance.resetCanvasSize();
			}

			instance.stage.setBackgroundColor('transparent', function() {
				instance.stage.renderAll();
			});

			for(var i=0; i<hiddenObjs.length; ++i) {
				hiddenObjs[i].visible = true;
			}

		});

	};

	/**
	 * Returns the view as SVG.
	 *
	 * @method toSVG
	 * @return {String} A XML representing a SVG.
	 */
	this.toSVG = function(options, reviver) {

		var svg;

		instance.deselectElement();
		instance.stage.setDimensions({width: instance.options.stageWidth, height: instance.options.stageHeight}).setZoom(1);

		//get data url

		svg = instance.stage.toSVG(options, reviver);

		if($(instance.stage.wrapperEl).is(':visible')) {
			instance.resetCanvasSize();
		}

		$svg = $(svg);

		$svg.children('rect').remove(); //remove bounding boxes
		$svg.children('g').children('[style*="visibility: hidden"]').parent('g').remove(); //remove hidden elements
		svg = $('<div>').append($svg.clone()).html().replace(/(?:\r\n|\r|\n)/g, ''); //replace all newlines

		return svg;

	};

	/**
	 * Removes the canvas and resets all relevant view properties.
	 *
	 * @method clear
	 */
	this.clear = function() {

		instance.undos = [];
		instance.redos = [];
		instance.elements = null;
		instance.totalPrice = 0;
		instance.stage.clear();
		instance.stage.wrapperEl.remove();

		$this.trigger('clear');
		$this.trigger('priceChange', [0, 0]);

	};

	/**
	 * Undo the last change.
	 *
	 * @method undo
	 */
	this.undo = function() {

		if(instance.undos.length > 0) {

			var last = instance.undos.pop();

			//check if element was removed
			if(last.interaction === 'remove') {

				instance.stage.add(last.element);
				last.interaction = 'add';
			}
			else if(last.interaction === 'add') {
				instance.stage.remove(last.element);
				last.interaction = 'remove';
			}

			_setUndoRedo(false, {
				element: last.element,
				parameters: instance.getElementJSON(last.element),
				interaction: last.interaction
			});

			instance.setElementParameters(last.parameters, last.element, false);

			this.deselectElement();
			_elementHasUploadZone(last.element);

		}

		return instance.undos;

	};
	
	this.redo = function() {

		if(instance.redos.length > 0) {

			var last = instance.redos.pop();

			if(last.interaction === 'remove') {
				instance.stage.add(last.element);
				last.interaction = 'add';
			}
			else if(last.interaction === 'add') {
				instance.stage.remove(last.element);
				last.interaction = 'remove';
			}

			_setUndoRedo({
				element: last.element,
				parameters: instance.getElementJSON(last.element),
				interaction: last.interaction
			});

			instance.setElementParameters(last.parameters, last.element, false);

			this.deselectElement();
			_elementHasUploadZone(last.element);

		}

		return instance.redos;

	};
	
	this.getJSON = function() {

		var parameterKeys = fpdOptions.getParameterKeys();

		parameterKeys = parameterKeys.concat(instance.propertiesToInclude);

		return instance.stage.toJSON(parameterKeys);

	};
	
	this.resetCanvasSize = function() {

		instance.responsiveScale = $productStage.outerWidth() < instance.options.stageWidth ? $productStage.outerWidth() / instance.options.stageWidth : 1;
		instance.responsiveScale = parseFloat(Number(instance.responsiveScale.toFixed(2)));
		instance.responsiveScale = instance.responsiveScale > 1 ? 1 : instance.responsiveScale;

		if(!instance.options.responsive) {
			instance.responsiveScale = 1;
		}

		instance.stage
		.setDimensions({
			width: $productStage.width(),
			height: instance.options.stageHeight * instance.responsiveScale
		})
		.setZoom(instance.responsiveScale)
		.calcOffset()
		.renderAll();

		$productStage.height(instance.stage.height);

		var $container = $productStage.parents('.fpd-container:first');
		if($container.length > 0) {
			$container.height($container.hasClass('fpd-sidebar') ? instance.stage.height : 'auto');
			$container.width($container.hasClass('fpd-topbar') ? instance.options.stageWidth : 'auto');
		}

		return instance.responsiveScale;

	};
	
	this.getElementByReplace = function(replaceValue) {

		var objects = instance.stage.getObjects();
		for(var i = 0; i < objects.length; ++i) {
			var object = objects[i];
			if(object.replace === replaceValue) {
				return object;
				break;
			}
		}

		return null;

	};
	
	this.getElementJSON = function(element, includeFabricProperties) {

		element = typeof element === 'undefined' ? instance.stage.getActiveObject() : element;
		includeFabricProperties = typeof includeFabricProperties === 'undefined' ? false : includeFabricProperties;

		if(!element) { return {}; }

		var properties = Object.keys(instance.options.elementParameters),
			additionalKeys  = FPDUtil.getType(element.type) === 'text' ? Object.keys(instance.options.textParameters) : Object.keys(instance.options.imageParameters);

		properties = $.merge(properties, additionalKeys);

		if(includeFabricProperties) {
			properties = $.merge(properties, instance.propertiesToInclude);
		}

		if(element.uploadZone) {
			properties.push('customAdds');
		}

		if(FPDUtil.getType(element.type) === 'text') {
			properties.push('text');
		}

		if(element.type === 'path-group') {
			properties.push('svgFill');
		}

		properties.push('width');
		properties.push('height');
		properties.push('isEditable');
		properties.push('hasUploadZone');
		properties.push('clippingRect');
		properties.push('evented');
		properties.push('isCustom');
		properties = properties.sort();

		if(includeFabricProperties) {

			return element.toJSON(properties);

		}
		else {

			var json = {};
			for(var i=0; i < properties.length; ++i) {
				var prop = properties[i];
				if(element[prop] !== undefined) {
					json[prop] = element[prop];
				}

			}

			return json;
		}

	};
	
	this.centerElement = function(h, v, element) {

		element = typeof element === 'undefined' ? instance.stage.getActiveObject() : element;

		_centerObject(element, h, v, instance.getBoundingBoxCoords(element));
		element.autoCenter = false;

	};
	
	this.alignElement = function(pos, element) {

		element = typeof element === 'undefined' ? instance.stage.getActiveObject() : element;

		var localPoint = element.getPointByOrigin('left', 'top'),
			boundingBox = instance.getBoundingBoxCoords(element),
			posOriginX = 'left',
			posOriginY = 'top';

		if(pos === 'left') {

			localPoint.x = boundingBox ? boundingBox.left : 0;
			localPoint.x += element.padding;
			localPoint.x += FPDUtil.getType(element.type) == 'text' ? 4 : 0;

		}
		else if(pos === 'top') {

			localPoint.y = boundingBox ? boundingBox.top : 0;
			localPoint.y += element.padding;
			localPoint.y += FPDUtil.getType(element.type) == 'text' ? 4 : 0;

		}
		else if(pos === 'right') {

			localPoint.x = boundingBox ? boundingBox.left + boundingBox.width - element.padding : instance.options.stageWidth - element.padding;
			localPoint.x -= FPDUtil.getType(element.type) == 'text' ? 4 : 0;
			posOriginX = 'right';

		}
		else {

			localPoint.y = boundingBox ? boundingBox.top + boundingBox.height - element.padding : instance.options.stageHeight;
			localPoint.y -= FPDUtil.getType(element.type) == 'text' ? 4 : 0;
			posOriginY = 'bottom';

		}

		element.setPositionByOrigin(localPoint, posOriginX, posOriginY);

		instance.stage.renderAll();
		element.setCoords();

		_checkContainment(element);

	};
	
	this.getZIndex = function(element) {

		element = typeof element === 'undefined' ? instance.stage.getActiveObject() : element;

		var objects = instance.stage.getObjects();
		return objects.indexOf(element);
	};
	
	this.changeColor = function(element, hex, temp, colorLinking) {

		temp = typeof temp === 'undefined' ? false : temp;
		colorLinking = typeof colorLinking === 'undefined' ? true : colorLinking;

		//check if hex color has only 4 digits, if yes, append 3 more
		if(typeof hex === 'string' && hex.length == 4) {
			hex += hex.substr(1, hex.length);
		}

		//text
		if(FPDUtil.getType(element.type) === 'text') {

			hex = hex === false ? '#000000' : hex;

			//set color of a text element
			element.setFill(hex);
			instance.stage.renderAll();

			if(temp == false) { element.pattern = null; element.fill = hex; }

		}
		//path groups (svg)
		else if(element.type == 'path-group' && typeof hex == 'object') {

			for(var i=0; i<hex.length; ++i) {
				element.paths[i].setFill(hex[i]);
			}

			instance.stage.renderAll();

			element.svgFill = hex;
			delete element['fill'];

		}
		//image
		else {

			var colorizable = FPDUtil.elementIsColorizable(element);
			//colorize png or dataurl image
			if(colorizable == 'png' || colorizable == 'dataurl') {

				element.filters = [];
				if(hex !== false) {
					element.filters.push(new fabric.Image.filters.Tint({color: hex}));
				}

				element.applyFilters(function() {
					instance.stage.renderAll();
				});

			}
			//colorize svg
			else if(colorizable == 'svg') {
				element.setFill(hex);
			}

			if(temp == false) { element.fill = hex; }

		}

		_setColorPrice(element, hex);
		
		$this.trigger('elementColorChange', [element, hex, colorLinking]);

	};
	
	this.getIndex = function() {

		return $productStage.children('.fpd-view-stage').index(instance.stage.wrapperEl);

	};
	
	this.getUploadZone = function(title) {

		var objects = instance.stage.getObjects();

		for(var i=0; i < objects.length; ++i) {

			if(objects[i].uploadZone && objects[i].title == title) {
				return objects[i];
				break;
			}

		}

	};
	
	this.changePrice = function(price, operator) {

		if(operator === '+') {
			instance.totalPrice += price;
		}
		else {
			instance.totalPrice -= price;
		}
		
		$this.trigger('priceChange', [price, instance.totalPrice]);

		return instance.totalPrice;

	};

	/**
	 * This method needs to be called after the instance of {{#crossLink "FancyProductDesignerView"}}{{/crossLink}} is set.
	 *
	 * @method setup
	 */
	this.setup = function() {

		function _removeNotValidElementObj(element) {

			if(element.type === undefined || element.source === undefined || element.title === undefined) {

				var removeInd = instance.elements.indexOf(element)
				if(removeInd !== -1) {
					instance.elements.splice(removeInd, 1);
					FPDUtil.log('Element index '+removeInd+' from instance.elements removed, its not a valid element object!', 'info');
					_onElementAdded();
					return true;
				}

			}

			return false;

		};

		var element = instance.elements[0];

		//check if view contains at least one element
		if(element) {

			var countElements = 0;
			//iterative function when element is added, add next one
			function _onElementAdded() {

				countElements++;

				//add all elements of a view
				if(countElements < instance.elements.length) {
					var element = instance.elements[countElements];
					if(!_removeNotValidElementObj(element)) {
						instance.addElement( element.type, element.source, element.title, element.parameters);
					}

				}
				//all elements are added
				else {

					$this.off('elementAdd', _onElementAdded);
					_afterSetup();

				}

			};

			//listen when element is added
			$this.on('elementAdd', _onElementAdded);
			//add first element of view
			if(!_removeNotValidElementObj(element)) {
				instance.addElement( element.type, element.source, element.title, element.parameters);
			}


		}
		//no elements in view, view is created without elements
		else {
			_afterSetup();
		}

	};

	_initialize();

};

var FPDToolbar = function($uiElementToolbar, fpdInstance) {

	var instance = this,
		$body = $('body'),
		$uiToolbarSub = $uiElementToolbar.children('.fpd-sub-panel'),
		$colorPicker = $uiElementToolbar.find('.fpd-color-wrapper'),
		$fontFamilyDropdown = $uiElementToolbar.find('.fpd-tool-font-family'),
		colorDragging = false;

	this.isTransforming = false; //is true, while transforming via slider
	this.placement = fpdInstance.mainOptions.toolbarPlacement;

	var _initialize = function() {

		instance.setPlacement(instance.placement);

		$body.on('mousedown touchstart', function(evt) { //check when transforming via slider

			if($(evt.target).parents('.fpd-range-slider').length > 0) {
				$(evt.target).parents('.fpd-range-slider').prev('input').change();
				instance.isTransforming = true;
			}

		})
		.on('mouseup touchend', function() {
			instance.isTransforming = false;
		});

		//set max values
		var maxValuesKeys = Object.keys(fpdInstance.mainOptions.maxValues);
		for(var i=0; i < maxValuesKeys.length; ++i) {

			var maxValueProp = maxValuesKeys[i];
			$uiElementToolbar.find('[data-control="'+maxValueProp+'"]').attr('max', fpdInstance.mainOptions.maxValues[maxValueProp]);

		}

		//first-level tools
		$uiElementToolbar.find('.fpd-row > div').click(function() {

			var $this = $(this);

			$uiElementToolbar.find('.fpd-row > div').not($this).removeClass('fpd-active');

			if($this.data('panel')) { //has a sub a panel

				$this.tooltipster('hide');

				$this.toggleClass('fpd-active'); //activate panel opener
				$uiToolbarSub.toggle($this.hasClass('fpd-active')) //display sub wrapper, if opener is active
				.children().removeClass('fpd-active') //hide all panels in sub wrapper
				.filter('.fpd-panel-'+$this.data('panel')).addClass('fpd-active'); //display related panel

				var element = fpdInstance.currentElement;

				if($this.data('panel') == 'fill') {

					if(FPDUtil.elementHasColorSelection(element)) {
						if(element.colorLinkGroup) {
							var availableColors = fpdInstance.colorLinkGroups[element.colorLinkGroup].colors;
						}
						else {
							var availableColors = element.colors;
						}

						$colorPicker.children('input').spectrum('destroy');
						$colorPicker.empty().removeClass('fpd-colorpicker-group');

						//path (svg)
						if(element.type == 'path-group') {

							for(var i=0; i<element.paths.length; ++i) {
								var path = element.paths[i],
									color = tinycolor(path.fill);

								$colorPicker.append('<input type="text" value="'+color.toHexString()+'" />');
							}

							$colorPicker.addClass('fpd-colorpicker-group').children('input').spectrum('destroy').spectrum({
								showPaletteOnly: $.isArray(element.colors),
								preferredFormat: "hex",
								showInput: true,
								showInitial: true,
								showButtons: false,
								showPalette: fpdInstance.mainOptions.colorPickerPalette && fpdInstance.mainOptions.colorPickerPalette.length > 0,
								palette: $.isArray(element.colors) ? element.colors : fpdInstance.mainOptions.colorPickerPalette,
								show: function(color) {

									var svgColors = FPDUtil.changePathColor(
										fpdInstance.currentElement,
										$colorPicker.children('input').index(this),
										color
									);

									element._tempFill = svgColors;

								},
								move: function(color) {

									var svgColors = FPDUtil.changePathColor(
										element,
										$colorPicker.children('input').index(this),
										color
									);

									//fpdInstance.currentViewInstance.changeColor(element, svgColors);
									fpdInstance.currentViewInstance.setElementParameters({fill: svgColors}, element);

								},
								change: function(color) {

									var svgColors = FPDUtil.changePathColor(
										element,
										$colorPicker.children('input').index(this),
										color
									);

									$(document).unbind("click.spectrum"); //fix, otherwise change is fired on every click
									fpdInstance.currentViewInstance.setElementParameters({fill: svgColors}, element);

								}
							});

						}
						//color list
						else if(availableColors.length > 1) {

							$colorPicker.html('<div class="fpd-color-palette fpd-grid"></div>');

							for(var i=0; i<availableColors.length; ++i) {

								var color = availableColors[i];
									colorName = fpdInstance.mainOptions.hexNames[color.replace('#', '')];

								colorName = colorName ? colorName : color;
								$colorPicker.children('.fpd-grid').append('<div class="fpd-item fpd-tooltip" title="'+colorName+'" style="background-color: '+color+';"></div>')
								.children('.fpd-item:last').click(function() {
									var color = tinycolor($(this).css('backgroundColor'));
									fpdInstance.currentViewInstance.setElementParameters({fill: color.toHexString()});
								});

							}

							FPDUtil.updateTooltip();

						}
						//colorwheel
						else {

							$colorPicker.html('<input type="text" value="'+(element.fill ? element.fill : availableColors[0])+'" />');

							$colorPicker.children('input').spectrum({
								flat: true,
								preferredFormat: "hex",
								showInput: true,
								showInitial: true,
								showPalette: fpdInstance.mainOptions.colorPickerPalette && fpdInstance.mainOptions.colorPickerPalette.length > 0,
								palette: fpdInstance.mainOptions.colorPickerPalette,
								show: function(color) {
									element._tempFill = color.toHexString();
								},
								move: function(color) {

									//only non-png images are chaning while dragging
									if(colorDragging === false || FPDUtil.elementIsColorizable(element) !== 'png') {
										_setElementColor(color.toHexString());
									}

								},
								change: function(color) {

									$(document).unbind("click.spectrum"); //fix, otherwise change is fired on every click
									fpdInstance.currentViewInstance.setElementParameters({fill: color.toHexString()}, element);

								}
							})
							.on('dragstart.spectrum', function() {
								colorDragging = true;
							})
							.on('dragstop.spectrum', function(evt, color) {
								colorDragging = false;
								_setElementColor(color.toHexString());
							});

						}
					}

					//patterns
					if((element.type === 'path-group' || FPDUtil.getType(element.type) === 'text') && element.patterns && element.patterns.length) {

						$uiToolbarSub.find('.fpd-patterns > .fpd-grid').empty();
						for(var i=0; i < element.patterns.length; ++i) {

							var patternUrl = element.patterns[i];
							$uiToolbarSub.find('.fpd-patterns > .fpd-grid').append('<div class="fpd-item" data-pattern="'+patternUrl+'"><picture style="background-image: url('+patternUrl+');"></picture></div>')
							.children(':last').click(function() {

								var patternUrl = $(this).data('pattern');
								$uiElementToolbar.find('.fpd-current-fill').css('background', 'url('+patternUrl+')');
								fpdInstance.currentViewInstance.setElementParameters( {pattern: patternUrl} );


							});

						}

					}

				}
				else if($this.data('panel') == 'stroke') {

					//stroke color
					var strokeColor = fpdInstance.currentElement.stroke ? fpdInstance.currentElement.stroke : '#000';
				    $uiToolbarSub.find('.fpd-stroke-color-picker input').spectrum('destroy').spectrum({
					    color: strokeColor,
						flat: true,
						preferredFormat: "hex",
						showInput: true,
						showInitial: true,
						showPalette: fpdInstance.mainOptions.colorPickerPalette && fpdInstance.mainOptions.colorPickerPalette.length > 0,
						palette: fpdInstance.mainOptions.colorPickerPalette,
						move: function(color) {
							instance.isTransforming = true;
							fpdInstance.currentViewInstance.setElementParameters( {stroke: color.toHexString()} );

						}
					});

				}

				$uiToolbarSub.css({
					top: $this.parent('.fpd-row').position().top+$this.position().top+$this.outerHeight(true),
					left: $this.parent().position().left - 5
				});

				instance.updatePosition(fpdInstance.currentElement);

			}
			else {

				$uiToolbarSub.hide();

			}

		});

		//create range slider
		$uiToolbarSub.find('.fpd-slider-range').rangeslider({
			polyfill: false,
			rangeClass: 'fpd-range-slider',
			disabledClass: 'fpd-range-slider--disabled',
			horizontalClass: 'fpd-range-slider--horizontal',
		    verticalClass: 'fpd-range-slider--vertical',
		    fillClass: 'fpd-range-slider__fill',
		    handleClass: 'fpd-range-slider__handle',
		    onSlide: function(pos, value) {

			    if(instance.isTransforming) {

				    this.$element.parent().prev('.fpd-slider-number').val(value).change();

				    //proportional scaling
				    if(this.$element.data('control') === 'scaleX' && fpdInstance.currentElement && fpdInstance.currentElement.lockUniScaling) {
					    $uiToolbarSub.find('.fpd-slider-number[data-control="scaleY"]').val(value).change();
				    }

			    }

		    },
		    onSlideEnd: function() {

			    instance.isTransforming = false;
			    instance.updatePosition(fpdInstance.currentElement);

		    }
		});

		//filters
		$uiToolbarSub.find('.fpd-filters .fpd-item').click(function() {

			var $this = $(this);
			$uiElementToolbar.find('.fpd-current-fill').css('background', $this.children('picture').css('background-image'));
			fpdInstance.currentViewInstance.setElementParameters( {filter: $this.data('filter')} );

		});

		//position
		$uiToolbarSub.find('.fpd-panel-position .fpd-icon-button-group > span').click(function() {

			var $this = $(this);
			if($this.hasClass('fpd-align-left')) {
				fpdInstance.currentViewInstance.alignElement('left');
			}
			else if($this.hasClass('fpd-align-top')) {
				fpdInstance.currentViewInstance.alignElement('top');
			}
			else if($this.hasClass('fpd-align-right')) {
				fpdInstance.currentViewInstance.alignElement('right');
			}
			else if($this.hasClass('fpd-align-bottom')) {
				fpdInstance.currentViewInstance.alignElement('bottom');
			}
			else if($this.hasClass('fpd-align-center-h')) {
				fpdInstance.currentViewInstance.centerElement(true, false);
			}
			else if($this.hasClass('fpd-align-center-v')) {
				fpdInstance.currentViewInstance.centerElement(false, true);
			}
			else if($this.hasClass('fpd-flip-h')) {
				fpdInstance.currentViewInstance.setElementParameters({flipX: !fpdInstance.currentElement.getFlipX()});
			}
			else if($this.hasClass('fpd-flip-v')) {
				fpdInstance.currentViewInstance.setElementParameters({flipY: !fpdInstance.currentElement.getFlipY()});
			}

			instance.updatePosition(fpdInstance.currentElement);

		});

		//move layer position
		$uiElementToolbar.find('.fpd-tool-move-up, .fpd-tool-move-down').click(function() {

			var currentZ = fpdInstance.currentViewInstance.getZIndex();

			currentZ = $(this).hasClass('fpd-tool-move-up') ? currentZ+1 : currentZ-1;
			currentZ = currentZ < 0 ? 0 : currentZ;

			fpdInstance.currentViewInstance.setElementParameters( {z: currentZ} );

	    });

		//reset element
	    $uiElementToolbar.find('.fpd-tool-reset').click(function() {

			$uiElementToolbar.find('.tooltipstered').tooltipster('destroy');
		    fpdInstance.currentViewInstance.setElementParameters( fpdInstance.currentElement.originParams );
		    fpdInstance.currentViewInstance.deselectElement();
			//instance.update(fpdInstance.currentElement);

			FPDUtil.updateTooltip();

		});

		//append fonts to dropdown
		if(fpdInstance.mainOptions.fonts && fpdInstance.mainOptions.fonts.length > 0) {

			//fonts array has objects
			if(typeof fpdInstance.mainOptions.fonts[0] === 'object') {
				fpdInstance.mainOptions.fonts.sort(function(a, b) {
					var nameA = a.name.toUpperCase(), // ignore upper and lowercase
						nameB = b.name.toUpperCase(); // ignore upper and lowercase
					if (nameA < nameB) {
						return -1;
					}
					if (nameA > nameB) {
						return 1;
					}

					//same
					return 0;
				});
			}
			else {
				fpdInstance.mainOptions.fonts.sort();
			}

			for(var i=0; i < fpdInstance.mainOptions.fonts.length; ++i) {

				var font = fpdInstance.mainOptions.fonts[i],
					fontName = font;

				if(typeof font == 'object') {
					fontName = font.name;
				}

				$fontFamilyDropdown.children('.fpd-dropdown-list')
				.append('<span class="fpd-item" data-value="'+fontName+'">'+fontName+'</span>')
				.children(':last').css('font-family', fontName);

			}

		}
		else {
			$fontFamilyDropdown.hide();
		}

		//edit text
		var tempFocusText = null;
	    $uiToolbarSub.find('.fpd-panel-edit-text textarea').keyup(function(evt) {

		    evt.stopPropagation;
		    evt.preventDefault();

		    var selectionStart = this.selectionStart,
			 	selectionEnd = this.selectionEnd;

			fpdInstance.currentViewInstance.currentElement.isEditing = true;
		    fpdInstance.currentViewInstance.setElementParameters( {text: this.value} );

		    this.selectionStart = selectionStart;
			this.selectionEnd = selectionEnd;

	    })
	    .focus(function() {
		    tempFocusText = fpdInstance.currentViewInstance.currentElement;
		    tempFocusText.isEditing = true;
	    })
	    .focusout(function() {
		    tempFocusText.isEditing = false;
		    tempFocusText = null;
	    });

		//call content in tab
		$uiToolbarSub.find('.fpd-panel-tabs > span').click(function() {

			var $this = $(this);

			$this.addClass('fpd-active').siblings().removeClass('fpd-active');
			$this.parent().nextAll('.fpd-panel-tabs-content').children('[data-id="'+this.id+'"]').addClass('fpd-active')
			.siblings().removeClass('fpd-active');

			$colorPicker.children('input').spectrum('hide');

		});


		$uiElementToolbar.find('.fpd-number').change(function() {

			var $this = $(this),
				numberParameters = {};

			if( this.value > Number($this.attr('max')) ) {
				this.value = Number($this.attr('max'));
			}

			if( this.value < Number($this.attr('min')) ) {
				this.value = Number($this.attr('min'));
			}

			var value = Number(this.value);

			if($this.hasClass('fpd-slider-number')) {

				$this.next('.fpd-range-wrapper').children('input').val(this.value)
				.rangeslider('update', true, false);

				if($this.data('control') === 'scaleX' && fpdInstance.currentElement && fpdInstance.currentElement.lockUniScaling) {
					$uiElementToolbar.find('[data-control="scaleY"]').val(value).change();
				}

			}

			numberParameters[$this.data('control')] = value;

			if(fpdInstance.currentViewInstance) {

				fpdInstance.currentViewInstance.setElementParameters(
					numberParameters,
					fpdInstance.currentViewInstance.currentElement,
					!instance.isTransforming
				);

			}

		});

		$uiElementToolbar.find('.fpd-toggle').click(function() {

			var $this = $(this).toggleClass('fpd-enabled'),
				toggleParameters = {};

			//ignore curved text switcher
			if(!$this.hasClass('fpd-curved-text-switcher')) {

				toggleParameters[$this.data('control')] = $this.hasClass('fpd-enabled') ? $this.data('enabled') : $this.data('disabled');

				if($this.hasClass('fpd-tool-uniscaling-locker')) {
					_lockUniScaling($this.hasClass('fpd-enabled'));
				}

				fpdInstance.currentViewInstance.setElementParameters(toggleParameters);

			}


		});

		$uiElementToolbar.find('.fpd-dropdown .fpd-item').click(function(evt) {

			evt.stopPropagation();

			var $this = $(this),
				$current = $this.parent().prevAll('.fpd-dropdown-current:first'),
				value = $this.data('value'),
				parameter = {};

			var control = $current.is('input') ? $current.val(value) : $current.html($this.clone()).data('value', value);

			parameter[$current.data('control')] = value;

			if($current.data('control') === 'fontFamily') {
				$current.css('font-family', value);
			}

			fpdInstance.currentViewInstance.setElementParameters(parameter);

			$this.siblings('.fpd-item').show();

		});

		$uiElementToolbar.find('.fpd-dropdown.fpd-search > input').keyup(function() {

			var $items = $(this).css('font-family', 'Helvetica').nextAll('.fpd-dropdown-list:first')
			.children('.fpd-item').hide();

			if(this.value.length === 0) {
				$items.show();
			}
			else {
				$items.filter(':containsCaseInsensitive("'+this.value+'")').show();
			}

		});

	};


	var _toggleUiTool = function(tool, showHide) {

		showHide = showHide === undefined ? true : showHide;

		var $tool = $uiElementToolbar.find('.fpd-tool-'+tool).toggle(showHide); //show tool
		$tool.parent('.fpd-row').toggle(Boolean($tool.parent('.fpd-row').children('div[style*="block"]').length > 0)); //show row if at least one visible tool in row

		return $tool;

	};

	var _toggleSubTool = function(panel, tool, showHide) {

		showHide = Boolean(showHide);

		return $uiToolbarSub.children('.fpd-panel-'+panel)
		.children('.fpd-tool-'+tool).toggle(showHide);
	};

	var _togglePanelTab = function(panel, tab, showHide) {

		$uiToolbarSub.children('.fpd-panel-'+panel)
		.find('.fpd-panel-tabs #'+tab).toggleClass('fpd-disabled', !showHide);

	};

	var _setElementColor = function(color) {

		$uiElementToolbar.find('.fpd-current-fill').css('background', color);
		fpdInstance.currentViewInstance.changeColor(fpdInstance.currentViewInstance.currentElement, color);

	};

	var _lockUniScaling = function(toggle) {

		 $uiToolbarSub.find('.fpd-tool-uniscaling-locker > span').removeClass().addClass(toggle ? 'fpd-icon-locked' : 'fpd-icon-unlocked');
		 $uiToolbarSub.find('.fpd-tool-scaleY').toggleClass('fpd-disabled', toggle);

	};

	this.update = function(element) {

		this.hideTools();

		_toggleUiTool('reset');

		if(element.availableFilters && element.availableFilters.length > 0 && element.type == 'image') {

			_toggleUiTool('fill');
			_togglePanelTab('fill', 'filter', true);

			$uiToolbarSub.find('.fpd-filters .fpd-item:not(.fpd-filter-none)').addClass('fpd-hidden');
			for(var i=0; i < element.availableFilters.length; ++i) {
				var filterName = element.availableFilters[i];
				$uiToolbarSub.find('.fpd-filter-'+filterName).removeClass('fpd-hidden');
			}

		}

		//colors array, true=svg colorization
		if(FPDUtil.elementHasColorSelection(element)) {

			_toggleUiTool('fill');
			_togglePanelTab('fill', 'color', true);

		}

		if((element.resizable && FPDUtil.getType(element.type) === 'image') || element.rotatable) {
			_toggleUiTool('transform');
			_toggleSubTool('transform', 'scale', (element.resizable && FPDUtil.getType(element.type) === 'image'));
			//uni scaling tools
			_lockUniScaling(element.lockUniScaling);
			_toggleSubTool('transform', 'uniscaling-locker', element.uniScalingUnlockable);
			_toggleSubTool('transform', 'angle', element.rotatable);
		}

		if(element.draggable || element.resizable) {
			_toggleUiTool('position');
		}

		if(element.zChangeable) {
			_toggleUiTool('move');
		}


		if((element.type === 'path-group' || FPDUtil.getType(element.type) === 'text') && element.patterns && element.patterns.length) {

			_toggleUiTool('fill');
			_togglePanelTab('fill', 'pattern', true);

		}

		//text options
		if(FPDUtil.getType(element.type) === 'text' && element.editable) {

			_toggleUiTool('font-family');
			_toggleUiTool('text-size', element.resizable);
			_toggleUiTool('text-line-height');
			_toggleUiTool('text-letter-spacing');
			_toggleUiTool('text-bold');
			_toggleUiTool('text-italic');
			_toggleUiTool('text-underline');
			_toggleUiTool('text-align');
			_toggleUiTool('text-stroke');
			if(element.curvable) {
				_toggleUiTool('curved-text');
			}

			$uiToolbarSub.find('.fpd-panel-edit-text textarea').val(element.getText());
			_toggleUiTool('edit-text', !element.textPlaceholder && !element.numberPlaceholder); //hide edit-text when element is used as placeholder for numbers&names

		}

		//display only enabled tabs and when tabs length > 1
		$uiToolbarSub.find('.fpd-panel-tabs').each(function(index, panelTabs) {

			var $panelTabs = $(panelTabs);
			$panelTabs.toggle($panelTabs.children(':not(.fpd-disabled)').length > 1);
			$panelTabs.children(':not(.fpd-disabled):first').addClass('fpd-active').click();

		});

		//set UI value by selected element
		$uiElementToolbar.find('[data-control]').each(function(index, uiElement) {

			var $uiElement = $(uiElement),
				parameter = $uiElement.data('control');

			if($uiElement.hasClass('fpd-number')) {

				if(element[parameter] !== undefined) {
					var numVal = $uiElement.attr('step') && $uiElement.attr('step').length > 1 ? parseFloat(element[parameter]).toFixed(2) : parseInt(element[parameter]);
					$uiElement.val(numVal);
				}

			}
			else if($uiElement.hasClass('fpd-toggle')) {

				$uiElement.toggleClass('fpd-enabled', element[parameter] === $uiElement.data('enabled'));

			}
			else if($uiElement.hasClass('fpd-current-fill')) {

				var currentFill = element[parameter];

				//fill: hex
				if(typeof currentFill === 'string') {
					$uiElement.css('background', currentFill);
				}
				//fill: pattern or svg fill
				else if(typeof currentFill === 'object') {

					if(currentFill.source) { //pattern
						currentFill = currentFill.source.src;
						$uiElement.css('background', 'url('+currentFill+')');
					}
					else { //svg has fill
						currentFill = currentFill[0];
						$uiElement.css('background', currentFill);
					}

				}
				//element: svg
				else if(element.colors === true && element.type === 'path-group') {
					currentFill = tinycolor(element.paths[0].fill);
					$uiElement.css('background', currentFill);
				}
				//no fill, only colors set
				else if(currentFill === false && element.colors && element.colors[0]) {
					currentFill = element.colors[0];

					$uiElement.css('background', currentFill);
				}
				//image that accepts only filters
				else if(element.filter) {
					$uiElement.css('background', $uiToolbarSub.find('.fpd-filter-'+element.filter+' picture').css('background-image'));
				}

			}
			else if($uiElement.hasClass('fpd-dropdown-current')) {

				if(element[parameter] !== undefined) {

					var value = $uiElement.nextAll('.fpd-dropdown-list:first').children('[data-value="'+element[parameter]+'"]').html();
					$uiElement.is('input') ? $uiElement.val(value) : $uiElement.html(value).data('value');

					if(parameter === 'fontFamily') {
						$uiElement.css('font-family', value);
					}
				}


			}


		});

		instance.updatePosition(element);
		/* maybe later
		setTimeout(function() {

		}, 10);*/

	};

	this.hideTools = function() {

		$uiElementToolbar.children('.fpd-row').hide() //hide row
		.children('div').hide().removeClass('fpd-active'); //hide tool in row

		$uiToolbarSub.hide()//hide sub toolbar
		.children().removeClass('fpd-active')//hide all sub panels in sub toolbar
		.find('.fpd-panel-tabs > span').addClass('fpd-disabled'); //disable all tabs

	};

	this.updatePosition = function(element, showHide) {

		showHide = typeof showHide === 'undefined' ? true : showHide;

		if(!element) {
			this.toggle(false);
			return;
		}

		var oCoords = element.oCoords,
			topOffset = oCoords.mb.y,
			designerOffset = fpdInstance.$productStage.offset(),
			mainWrapperOffset = fpdInstance.$mainWrapper.offset();

		if(instance.placement == 'inside-bottom' || instance.placement == 'inside-top') {

			var scrollTopOffset = fpdInstance.$container.parents('.fpd-modal-wrapper').length > 0 ? fpdInstance.$container.parents('.fpd-modal-wrapper').scrollTop() : document.body.scrollTop;

			if(instance.placement == 'inside-top') {

				if(fpdInstance.$container.parents('.fpd-modal-wrapper').length > 0) { //modal mode
					topOffset = scrollTopOffset ? Math.abs(mainWrapperOffset.top) : 0;
				}
				else {
					topOffset = scrollTopOffset > mainWrapperOffset.top ? scrollTopOffset - mainWrapperOffset.top : 0;
				}

			}
			else {

				if(fpdInstance.$container.parents('.fpd-modal-wrapper').length > 0) { //modal mode
					topOffset = scrollTopOffset ? Math.abs(mainWrapperOffset.top) : 0;
				}
				else {
					topOffset = scrollTopOffset > mainWrapperOffset.top ? scrollTopOffset - mainWrapperOffset.top : 0;
				}

			}

			$uiElementToolbar.css({
				top:topOffset
			});

		}
		else { //dynamic

			//set maximal width
			$uiElementToolbar.width(320);
			//calculate largest width of rows
			var maxWidth = Math.max.apply( null, $( $uiElementToolbar.children('.fpd-row') ).map( function () {
			    return $( this ).outerWidth( true );
			}).get() );
			//set new width
			$uiElementToolbar.width(maxWidth+2);

			topOffset = oCoords.tl.y > topOffset ? oCoords.tl.y : topOffset;
			topOffset = oCoords.tr.y > topOffset ? oCoords.tr.y : topOffset;
			topOffset = oCoords.bl.y > topOffset ? oCoords.bl.y : topOffset;
			topOffset = oCoords.br.y > topOffset ? oCoords.br.y : topOffset;
			topOffset = topOffset + element.padding + element.cornerSize + designerOffset.top;
			topOffset = topOffset > fpdInstance.$productStage.height() + designerOffset.top ? fpdInstance.$productStage.height() + designerOffset.top + 5 : topOffset;
			topOffset = topOffset + 400 > document.body.scrollHeight ? document.body.scrollHeight - 400 : topOffset;

			var posLeft = designerOffset.left + oCoords.mb.x,
				halfWidth =  $uiElementToolbar.outerWidth() * .5;

			posLeft = posLeft < halfWidth ? halfWidth : posLeft; //move toolbar not left outside of document
			posLeft = posLeft > $(window).width() - halfWidth ? $(window).width() - halfWidth : posLeft; //move toolbar not right outside of document

			$uiElementToolbar.css({
				left: posLeft,
				top: topOffset
			});

		}

		$uiElementToolbar.toggleClass('fpd-show', showHide);

	};

	this.updateUIValue = function(tool, value) {

		var $UIController = $uiElementToolbar.find('[data-control="'+tool+'"]');

		$UIController.val(value);
		$UIController.filter('.fpd-slider-range').rangeslider('update', true, false);

	};

	this.toggle = function(showHide) {

		$uiElementToolbar.toggleClass('fpd-show', showHide);

	};

	this.setPlacement = function(placement) {

		instance.placement = placement;

		//remove fpd-toolbar-placement-* class
		$uiElementToolbar.removeClass (function (index, css) {
		    return (css.match (/(^|\s)fpd-toolbar-placement-\S+/g) || []).join(' ');
		});

		$uiElementToolbar.addClass('fpd-toolbar-placement-'+placement);

		if(instance.placement == 'inside-bottom' || instance.placement == 'inside-top') {
			$uiElementToolbar.appendTo(fpdInstance.$mainWrapper);
		}
		else {
			$uiElementToolbar.appendTo(fpdInstance.mainOptions.toolbarDynamicContext);
		}



	}

	_initialize();

};

var FPDMainBar = function(fpdInstance, $mainBar, $modules, $draggableDialog) {

	var instance = this,
		$body = $('body'),
		$nav = $mainBar.children('.fpd-navigation'),
		$content;

	this.currentModules = fpdInstance.mainOptions.mainBarModules;
	this.$selectedModule = null;
	this.$container = $mainBar;
	this.mainBarShowing = true;

	var _initialize = function() {

		if(fpdInstance.$container.hasClass('fpd-topbar') && !fpdInstance.$container.hasClass('fpd-main-bar-container-enabled') && fpdInstance.$container.filter('[class*="fpd-off-canvas-"]').length === 0) { //draggable dialog

			$content = $draggableDialog.addClass('fpd-grid-columns-'+fpdInstance.mainOptions.gridColumns).append('<div class="fpd-content"></div>').children('.fpd-content');

		}
		else {
			$content = $mainBar.append('<div class="fpd-content"></div>').children('.fpd-content');
		}

		instance.$content = $content;

		if(fpdInstance.$container.filter('[class*="fpd-off-canvas-"]').length > 0) {

			var touchStart = 0,
				panX = 0,
				closeStartX = 0,
				$closeBtn = $mainBar.children('.fpd-close-off-canvas');

			$content.on('touchstart', function(evt) {

				touchStart = evt.originalEvent.touches[0].pageX;
				closeStartX = parseInt($closeBtn.css(fpdInstance.$container.hasClass('fpd-off-canvas-left') ? 'left' : 'right'));

			})
			.on('touchmove', function(evt) {

				evt.preventDefault();

				var moveX = evt.originalEvent.touches[0].pageX;
					panX = touchStart-moveX,
					targetPos = fpdInstance.$container.hasClass('fpd-off-canvas-left') ? 'left' : 'right';

				panX = Math.abs(panX) < 0 ? 0 : Math.abs(panX);
				$content.css(targetPos, -panX);
				$closeBtn.css(targetPos, closeStartX - panX);

			})
			.on('touchend', function(evt) {

				var targetPos = fpdInstance.$container.hasClass('fpd-off-canvas-left') ? 'left' : 'right';

				if(Math.abs(panX) > 100) {

					instance.toggleDialog(false);

				}
				else {
					$content.css(targetPos, 0);
					$closeBtn.css(targetPos, closeStartX);
				}

				panX = 0;

			});

		}

		//close off-canvas
		$mainBar.on('click', '.fpd-close-off-canvas', function(evt) {

			evt.stopPropagation();

			$nav.children('div').removeClass('fpd-active');
			instance.toggleDialog(false);

		});

		$body.append($draggableDialog);
		$draggableDialog.draggable({
			handle: $draggableDialog.find('.fpd-dialog-head'),
			containment: $body
		});

		//select module
		$nav.on('click', '> div', function(evt) {

			evt.stopPropagation();

			var $this = $(this);

			fpdInstance.deselectElement();

			if(fpdInstance.currentViewInstance) {
				fpdInstance.currentViewInstance.currentUploadZone = null;
			}

			$content.find('.fpd-manage-layers-panel')
			.find('.fpd-current-color, .fpd-path-colorpicker').spectrum('destroy');

			if(fpdInstance.$container.hasClass('fpd-topbar') && $this.hasClass('fpd-active')) {

				$this.removeClass('fpd-active');
				instance.toggleDialog(false);

			}
			else {

				instance.callModule($this.data('module'));

			}

		});

		//prevent document scrolling when in dialog content
		$body.on({
		    'mousewheel': function(evt) {

				var $target = $(evt.target);
		        if ($target.hasClass('fpd-draggable-dialog') || $target.parents('.fpd-draggable-dialog').length > 0) {
			    	evt.preventDefault();
				    evt.stopPropagation();
			    }

		    }
		});

		$content.on('click', '.fpd-bottom-nav > div', function() {

			var $this = $(this);

			$this.addClass('fpd-active').siblings().removeClass('fpd-active');

			var $selectedModule = $this.parent().next().children('[data-module="'+$this.data('module')+'"]').addClass('fpd-active');
			$selectedModule.siblings().removeClass('fpd-active');

			//short timeout, because fpd-grid must be visible
			setTimeout(function() {
				FPDUtil.refreshLazyLoad($selectedModule.find('.fpd-grid'), false);
			}, 10);


		});

		//close dialog
		$body.on('click', '.fpd-close-dialog', function() {

			instance.toggleDialog(false);

		});

		fpdInstance.$container.on('viewSelect', function() {

			if(instance.$selectedModule) {

				if(instance.$selectedModule.filter('[data-module="manage-layers"]').length > 0) {
					LayersModule.createList(fpdInstance, instance.$selectedModule);
				}
				//PLUS
				else if(typeof FPDNamesNumbersModule !== 'undefined' && instance.$selectedModule.filter('[data-module="names-numbers"]').length > 0) {
					FPDNamesNumbersModule.setup(fpdInstance, instance.$selectedModule);
				}

			}

		});

		fpdInstance.$container.on('elementAdd elementRemove', function() {

			if(fpdInstance.productCreated && instance.$selectedModule) {

				if(instance.$selectedModule.filter('[data-module="manage-layers"]').length > 0) {
					LayersModule.createList(fpdInstance, instance.$selectedModule);
				}

			}

		});

		instance.setup(instance.currentModules);

	}

	//call module by name
	this.callModule = function(name) {

		var $selectedNavItem = $nav.children('div').removeClass('fpd-active').filter('[data-module="'+name+'"]').addClass('fpd-active');
		instance.$selectedModule = $content.children('div').removeClass('fpd-active').filter('[data-module="'+name+'"]').addClass('fpd-active');

		if($content.parent('.fpd-draggable-dialog').length > 0) {

			if($draggableDialog.attr('style') === undefined || $draggableDialog.attr('style') === '') {
				$draggableDialog.css('top', $mainBar.offset().top + $mainBar.height());
			}
			$draggableDialog.addClass('fpd-active')
			.find('.fpd-dialog-title').text($selectedNavItem.find('.fpd-label').text());

		}

		if(name === 'text') {
			instance.$selectedModule.find('textarea').focus();
		}
		else if(name === 'saving') {
			instance.$selectedModule.find('input').focus();
		}
		else if(name === 'checkout') {
			instance.$selectedModule.find('input').focus();
		}
		else if(name === 'manage-layers') {

			if(fpdInstance.productCreated) {
				LayersModule.createList(fpdInstance, instance.$selectedModule);
			}

		}
		else if(typeof FPDNamesNumbersModule !== 'undefined' && name === 'names-numbers') {

			if(fpdInstance.productCreated) {
				FPDNamesNumbersModule.setup(fpdInstance, instance.$selectedModule);
			}

		}

		instance.toggleDialog(true);

		FPDUtil.refreshLazyLoad(instance.$selectedModule.find('.fpd-grid'), false);

	};

	this.callSecondary = function(className) {

		instance.callModule('secondary');

		$content.children('.fpd-secondary-module').children('.'+className).addClass('fpd-active')
		.siblings().removeClass('fpd-active');


		if(className === 'fpd-upload-zone-adds-panel') {
			$content.find('.fpd-upload-zone-adds-panel .fpd-bottom-nav > :not(.fpd-hidden)').first().click();
		}

	};

	this.setContentWrapper = function(wrapper) {

		$draggableDialog.removeClass('fpd-active');

		if(wrapper === 'sidebar') {

			if($nav.children('.fpd-active').length === 0) {
				$nav.children().first().addClass('fpd-active');
			}

			$content.appendTo($mainBar);

		}
		else if(wrapper === 'draggable-dialog') {

			$content.appendTo($draggableDialog);

		}

		//toogle tooltips
		$nav.children().each(function(i, navItem) {

			var $navItem = $(navItem);
			$navItem.filter('.fpd-tooltip').tooltipster('destroy');
			if(fpdInstance.$container.hasClass('fpd-sidebar')) {
				$navItem.addClass('fpd-tooltip').attr('title', $navItem.children('.fpd-label').text());
			}
			else {
				$navItem.removeClass('fpd-tooltip').removeAttr('title');
			}

		});

		FPDUtil.updateTooltip($nav);

		$nav.children('.fpd-active').click();

	};

	this.toggleDialog = function(toggle) {

		toggle = typeof toggle === 'undefined' ? true : toggle;

		//top bar is enabled
		if(fpdInstance.$container.hasClass('fpd-topbar') && fpdInstance.$container.filter('[class*="fpd-off-canvas-"]').length === 0) {

			$draggableDialog.toggleClass('fpd-active', toggle);

			if(!toggle) {
				$nav.children('.fpd-active').removeClass('fpd-active');
			}

			//deselect element when main bar is showing
			if(!toggle && instance.mainBarShowing) {
				fpdInstance.deselectElement();
			}

		}

		//off-canvas is enabled
		if(fpdInstance.$container.filter('[class*="fpd-off-canvas-"]').length > 0) {

			instance.$container.toggleClass('fpd-show', toggle)
			.children('.fpd-close-off-canvas').removeAttr('style');
			instance.$content.removeAttr('style')
			.height(fpdInstance.$mainWrapper.height());

			if($nav.children('div').length === 0) {
				instance.$content.css('top', 0);
			}
			else {
				instance.$content.css('top', $nav.height());
			}

			//deselect element when main bar is showing
			if(!toggle && instance.mainBarShowing) {
				fpdInstance.deselectElement();
			}

		}

		instance.mainBarShowing = toggle;

	};

	this.toggleUploadZonePanel = function(toggle) {

		toggle = typeof toggle === 'undefined' ? true : toggle;

		//do nothing when custom image is loading
		if(fpdInstance._loadingCustomImage) {
			return;
		}

		if(toggle) {

			instance.callSecondary('fpd-upload-zone-adds-panel');

		}
		else {

			fpdInstance.currentViewInstance.currentUploadZone = null;

			if(fpdInstance.$container.hasClass('fpd-sidebar')) {
				instance.callModule(fpdInstance.mainBar.currentModules[0]);
			}

		}

	};

	this.toggleUploadZoneAdds = function(customAdds) {

		var $uploadZoneAddsPanel = $content.find('.fpd-upload-zone-adds-panel');

		$uploadZoneAddsPanel.find('.fpd-add-image').toggleClass('fpd-hidden', !Boolean(customAdds.uploads));
		$uploadZoneAddsPanel.find('.fpd-add-text').toggleClass('fpd-hidden', !Boolean(customAdds.texts));
		$uploadZoneAddsPanel.find('.fpd-add-design').toggleClass('fpd-hidden', !Boolean(customAdds.designs));

		if(fpdInstance.currentElement.price) {
			var price = fpdInstance.mainOptions.priceFormat.replace('%d', fpdInstance.currentElement.price);
			$uploadZoneAddsPanel.find('[data-module="text"] .fpd-btn > .fpd-price').html(' - '+price);
		}
		else {
			$uploadZoneAddsPanel.find('[data-module="text"] .fpd-btn > .fpd-price').html('');
		}


		//select first visible add panel
		$uploadZoneAddsPanel.find('.fpd-off-canvas-nav > :not(.fpd-hidden)').first().click();

	};

	this.setup = function(modules) {

		instance.currentModules = modules;

		var selectedModule = fpdInstance.mainOptions.initialActiveModule;

		//if only modules exist, select it and hide nav
		if(instance.currentModules.length <= 1 && !fpdInstance.$container.hasClass('fpd-topbar')) {
			selectedModule = instance.currentModules[0] ? instance.currentModules[0] : '';
			$nav.addClass('fpd-hidden');
		}
		else {
			$nav.removeClass('fpd-hidden');
		}

		$nav.empty();
		$content.empty();

		//add selected modules
		for(var i=0; i < modules.length; ++i) {

			var module = modules[i],
				$module = $modules.children('[data-module="'+module+'"]'),
				$moduleClone = $module.clone(),
				navItemClass = fpdInstance.$container.hasClass('fpd-sidebar') ? 'class="fpd-tooltip"' : '',
				navItemTitle = fpdInstance.$container.hasClass('fpd-sidebar') ? 'title="'+$module.data('title')+'"' : '';

			$nav.append('<div data-module="'+module+'" '+navItemClass+' '+navItemTitle+'><span class="'+$module.data('moduleicon')+'"></span><span class="fpd-label">'+$module.data('title')+'</span></div>');
			$content.append($moduleClone);

			if(module === 'products') {
				new ProductsModule(fpdInstance, $moduleClone);
			}
			else if(module === 'text') {
				new TextModule(fpdInstance, $moduleClone);
			}
			else if(module === 'saving') {
				new SavingModule(fpdInstance, $moduleClone);
			} 
			else if(module === 'saved') {
				new SavedModule(fpdInstance, $moduleClone);
			} 
			else if(module === 'checkout') {
				new CheckoutModule(fpdInstance, $moduleClone);
			} 
			else if(module === 'designs') {
				new DesignsModule(fpdInstance, $moduleClone);
			}
			else if(module === 'images') {
				new ImagesModule(fpdInstance, $moduleClone);
			}
			//PLUS
			else if(typeof FPDDrawingModule !== 'undefined' && module === 'drawing') {
				new FPDDrawingModule(fpdInstance, $moduleClone);
			}

		}

		if($content.children('[data-module="manage-layers"]').length === 0) {
			$content.append($modules.children('[data-module="manage-layers"]').clone());
		}

		$content.append($modules.children('[data-module="secondary"]').clone());

		//add upload zone modules
		var uploadZoneModules = ['images', 'text', 'designs'];
		for(var i=0; i < uploadZoneModules.length; ++i) {

			var module = uploadZoneModules[i],
				$module = $modules.children('[data-module="'+module+'"]'),
				$moduleClone = $module.clone();

			$content.find('.fpd-upload-zone-content').append($moduleClone);

			if(module === 'text') {
				new TextModule(fpdInstance, $moduleClone);
			}
			else if(module === 'saving') {
				new SavingModule(fpdInstance, $moduleClone);
			} 
			else if(module === 'checkout') {
				new CheckoutModule(fpdInstance, $moduleClone);
			} 
			else if(module === 'saved') {
				new SavedModule(fpdInstance, $moduleClone);
			} 
			else if(module === 'designs') {
				new DesignsModule(fpdInstance, $moduleClone);
			}
			else if(module === 'images') {
				new ImagesModule(fpdInstance, $moduleClone);
			}

		}

		if(fpdInstance.$container.hasClass('fpd-sidebar') && selectedModule == '') {
			selectedModule = $nav.children().first().data('module');
		}
		$nav.children('[data-module="'+selectedModule+'"]').click();

	};

	_initialize();

};

FPDMainBar.availableModules = [
	'products',
	'images',
	'text',
	'designs',
	'manage-layers',
	'saving',
	'checkout',
	'saved'  
];

var FPDActions = function(fpdInstance, $actions){

	var instance = this,
		snapLinesGroup,
		valZoom = 1;

	this.currentActions = fpdInstance.mainOptions.actions;

	var _initialize = function() {

		//add set action buttons
		if($actions) {
			instance.setup(instance.currentActions);

			//action click handler
			fpdInstance.$mainWrapper.on('click', '.fpd-actions-wrapper .fpd-action-btn', function() {

				var $this = $(this);

				if($this.hasClass('tooltipstered')) {
					$this.tooltipster('hide');
				}

				instance.doAction($this);

			});

		}

		fpdInstance.$container.on('viewSelect', function() {

			instance.resetAllActions();

		});

	};

	//set action button to specific position
	var _setActionButtons = function(pos) {

		fpdInstance.$mainWrapper.append('<div class="fpd-actions-wrapper fpd-pos-'+pos+'"></div>');

		var posActions = instance.currentActions[pos];

		for(var i=0; i < posActions.length; ++i) {

			var actionName = posActions[i],
				$action = $actions.children('[data-action="'+actionName+'"]');

			fpdInstance.$mainWrapper.children('.fpd-actions-wrapper.fpd-pos-'+pos).append($action.clone());
		}

	};

	//returns an object with the saved products for the current showing product
	var _getSavedProducts = function() {

		return  FPDUtil.localStorageAvailable() ? JSON.parse(window.localStorage.getItem(fpdInstance.$container.attr('id'))) : false;

	};

	//add a saved product to the load dialog
	var _addSavedProduct = function(thumbnail, product, title) {

		title = title ? title : '';

		//create new list item
		var $gridWrapper = fpdInstance.mainBar.$content.find('.fpd-saved-designs-panel .fpd-grid'),
			htmlTitle = title !== '' ? 'title="'+title+'"' : '';

		$gridWrapper.append('<div class="fpd-item fpd-tooltip" '+htmlTitle+'><picture style="background-image: url('+thumbnail+')" ></picture><div class="fpd-remove-design"><span class="fpd-icon-remove"></span></div></div>')
		.children('.fpd-item:last').click(function(evt) {

			fpdInstance.loadProduct($(this).data('product'));
			fpdInstance.currentProductIndex = -1;

		}).data('product', product)
		.children('.fpd-remove-design').click(function(evt) {

			evt.stopPropagation();

			var $item = $(this).parent('.fpd-item'),
				index = $item.parent('.fpd-grid').children('.fpd-item').index($item.remove()),
				savedProducts = _getSavedProducts();

				savedProducts.splice(index, 1);

			window.localStorage.setItem(fpdInstance.$container.attr('id'), JSON.stringify(savedProducts));

		});

		FPDUtil.updateTooltip($gridWrapper);

	};

	//download png, jpeg or pdf
	this.downloadFile = function(type) { 
		//var fabricElement = fpdInstance.getElementByTitle('Base'); 
		//fabricElement.remove();
		
		if(type === 'jpeg' || type === 'png') {

			var a = document.createElement('a'),
				background = type === 'jpeg' ? '#fff' : 'transparent';

			if (typeof a.download !== 'undefined') {

				fpdInstance.getProductDataURL(function(dataURL) {

					fpdInstance.$container.find('.fpd-download-anchor').attr('href', dataURL)
					.attr('download', 'Product.'+type+'')[0].click();

				}, background, {format: type})

			}
			else {

				fpdInstance.createImage(true, true, background, {format: type});

			}
		}
		else {

			_createPDF = function(dataURLs) {

				var largestWidth = fpdInstance.viewInstances[0].options.stageWidth,
					largestHeight = fpdInstance.viewInstances[0].options.stageHeight;

				for(var i=1; i < fpdInstance.viewInstances.length; ++i) {

					var viewOptions = fpdInstance.viewInstances[i].options;
					if(viewOptions.stageWidth > largestWidth) {
						largestWidth = viewOptions.stageWidth;
					}

					if(viewOptions.stageHeight > largestHeight) {
						largestHeight = viewOptions.stageHeight;
					}

				}

				var orientation = fpdInstance.currentViewInstance.stage.getWidth() > fpdInstance.currentViewInstance.stage.getHeight() ? 'l' : 'p',
					doc = new jsPDF(orientation, 'mm', [largestWidth * 0.26, largestHeight * 0.26]);

				for(var i=0; i < dataURLs.length; ++i) {

					doc.addImage(dataURLs[i], 'JPEG', 0, 0);
					if(i < dataURLs.length-1) {
						doc.addPage();
					}

				}

				doc.save('Product.pdf');

			};

			fpdInstance.getViewsDataURL(_createPDF, '#ffffff', {format: 'jpeg'});

		}

	};

	this.setup = function(actions) {

		this.currentActions = actions;

		fpdInstance.$mainWrapper.children('.fpd-actions-wrapper').remove();

		var keys = Object.keys(actions);
		for(var i=0; i < keys.length; ++i) {

			var posActions = actions[keys[i]];
			if(typeof posActions === 'object' && posActions.length > 0) {
				_setActionButtons(keys[i]);
			}

		}

	};

	this.doAction = function($this) {

		var action = $this.data('action');

		fpdInstance.deselectElement();

		if(action === 'print') {

			fpdInstance.print();

		}
		else if(action === 'reset-product') {

			var confirmReset = confirm(fpdInstance.getTranslation('misc', 'reset_confirm'));
			if(confirmReset) {
				fpdInstance.loadProduct(fpdInstance.currentViews);
			}

		}
		else if(action === 'undo') {

			fpdInstance.currentViewInstance.undo();

		}
		else if(action === 'redo') {

			fpdInstance.currentViewInstance.redo();

		}
		else if(action === 'info') {

			FPDUtil.showModal($this.children('.fpd-info-content').text());

		}
		else if(action === 'preview-lightbox') { 
				
			fpdInstance.getProductCard(function(dataURL) { 
				
				var image = new Image();
				image.src = dataURL;  
				
				image.onload = function() {
					FPDUtil.showModal('<img src="'+this.src+'" download="product.png" style="display: block; margin-left: auto; margin-right: auto;" />', true);
				} 

			});

		}
		else if(action === 'save') {

			var $prompt = FPDUtil.showModal(fpdInstance.getTranslation('actions', 'save_placeholder'), false, 'prompt');
			$prompt.find('.fpd-btn').text(fpdInstance.getTranslation('actions', 'save')).click(function() {

				fpdInstance.doUnsavedAlert = false;

				var title = $(this).siblings('input:first').val();

				//get key and value
				var product = fpdInstance.getProduct(),
					scaling = FPDUtil.getScalingByDimesions(fpdInstance.currentViewInstance.options.stageWidth, fpdInstance.currentViewInstance.options.stageHeight, 200, 200),
					thumbnail = fpdInstance.currentViewInstance.stage.toDataURL({multiplier: scaling, format: 'png'});

				//check if there is an existing products array
				var savedProducts = _getSavedProducts();
				if(!savedProducts) {
					//create new
					savedProducts = new Array();
				}

				savedProducts.push({thumbnail: thumbnail, product: product, title: title});
				window.localStorage.setItem(fpdInstance.$container.attr('id'), JSON.stringify(savedProducts));

				FPDUtil.showMessage(fpdInstance.getTranslation('misc', 'product_saved'));
				$prompt.find('.fpd-modal-close').click();

			});



		}
		else if(action === 'load') {

			//load all saved products into list
			var savedProducts = _getSavedProducts();

			fpdInstance.mainBar.$content.find('.fpd-saved-designs-panel .fpd-grid').empty();

			if(savedProducts) {

				for(var i=0; i < savedProducts.length; ++i) {

					var savedProduct = savedProducts[i];
					_addSavedProduct(savedProduct.thumbnail, savedProduct.product, savedProduct.title);

				}

				FPDUtil.createScrollbar(fpdInstance.mainBar.$content.find('.fpd-saved-designs-panel .fpd-scroll-area'));

			}

			fpdInstance.mainBar.callSecondary('fpd-saved-designs-panel');


		}
		else if(action === 'manage-layers') {

			fpdInstance.mainBar.callModule('manage-layers');


		}
		else if(action === 'snap') {

			$this.toggleClass('fpd-active');

			fpdInstance.$mainWrapper.children('.fpd-snap-line-h, .fpd-snap-line-v').hide();

			if($this.hasClass('fpd-active')) {

				var lines = [],
					gridX = fpdInstance.mainOptions.snapGridSize[0] ? fpdInstance.mainOptions.snapGridSize[0] : 50,
					gridY = fpdInstance.mainOptions.snapGridSize[1] ? fpdInstance.mainOptions.snapGridSize[1] : 50,
					linesXNum = Math.ceil(fpdInstance.currentViewInstance.options.stageWidth / gridX),
					linesYNum = Math.ceil(fpdInstance.currentViewInstance.options.stageHeight / gridY);

				//add x-lines
				for(var i=0; i < linesXNum; ++i) {

					var lineX = new fabric.Rect({
						width: 1,
						height: fpdInstance.currentViewInstance.options.stageHeight,
						fill: '#ccc',
						opacity: 0.6,
						left: i * gridX,
						top: 0
					});

					lines.push(lineX);

				}

				//add y-lines
				for(var i=0; i < linesYNum; ++i) {

					var lineY = new fabric.Rect({
						width: fpdInstance.currentViewInstance.options.stageWidth,
						height: 1,
						fill: '#ccc',
						opacity: 0.6,
						top: i * gridY,
						left: 0
					});

					lines.push(lineY);

				}

				snapLinesGroup = new fabric.Group(lines, {id: '_snap_lines_group', left: 0, top: 0, evented: false, selectable: false});
				fpdInstance.currentViewInstance.stage.add(snapLinesGroup);

			}
			else {

				if(snapLinesGroup) {
					fpdInstance.currentViewInstance.stage.remove(snapLinesGroup);
				}

			}

		}
		else if(action === 'qr-code') {

			var $internalModal = FPDUtil.showModal($this.children('.fpd-modal-qrcode').clone());

			$colorPickers = $internalModal.find('.fpd-qrcode-colors input').spectrum({
				preferredFormat: "hex",
				showInput: true,
				showInitial: true,
				showButtons: false,
				replacerClassName: 'fpd-spectrum-replacer'
			});

			$internalModal.find('.fpd-add-qr-code').click(function() {

				var text = $internalModal.find('.fpd-modal-qrcode > input').val();

				if(text && text.length !== 0) {

					var $qrcodeWrapper = $internalModal.find('.fpd-qrcode-wrapper').empty(),
						qrcode = new QRCode($qrcodeWrapper .get(0), {
					    text: text,
					    width: 256,
					    height: 256,
					    colorDark : $colorPickers.filter('.fpd-qrcode-color-dark').spectrum('get').toHexString(),
					    colorLight : $colorPickers.filter('.fpd-qrcode-color-light').spectrum('get').toHexString(),
					    correctLevel : QRCode.CorrectLevel.H
					});

					$qrcodeWrapper.find('img').load(function() {

						fpdInstance.addElement(
							'image',
							this.src,
							'QR-Code - '+text,
							fpdInstance.currentViewInstance.options.qrCodeProps
						);

						$internalModal.find('.fpd-modal-close').click();

					});

				}

			});

		} 
		else if(action === 'zoom') {

			if(!$this.hasClass('fpd-active')) {

				if($this.hasClass('tooltipstered')) {
					$this.tooltipster('destroy');
				}

				$this.tooltipster({
					trigger: 'click',
					position: 'bottom',
					content: $this.find('.fpd-tooltip-content'),
					theme: 'fpd-sub-tooltip-theme fpd-zoom-tooltip',
					touchDevices: true,
					interactive: true,
					//autoClose: false,
					functionReady: function(origin, tooltip) {

						var startVal = fpdInstance.currentViewInstance.stage.getZoom() / fpdInstance.currentViewInstance.responsiveScale;

						tooltip.find('.fpd-zoom-slider').attr('step', fpdInstance.mainOptions.zoomStep).attr('max', fpdInstance.mainOptions.maxZoom)
						.val(startVal).rangeslider({
							polyfill: false,
							rangeClass: 'fpd-range-slider',
							disabledClass: 'fpd-range-slider--disabled',
							horizontalClass: 'fpd-range-slider--horizontal',
						    verticalClass: 'fpd-range-slider--vertical',
						    fillClass: 'fpd-range-slider__fill',
						    handleClass: 'fpd-range-slider__handle',
						    onSlide: function(pos, value) {
								fpdInstance.setZoom(value);
						    }
						});

						tooltip.find('.fpd-stage-pan').click(function() {

							fpdInstance.currentViewInstance.dragStage = fpdInstance.currentViewInstance.dragStage ? false : true;
							$(this).toggleClass('fpd-enabled');
							fpdInstance.$productStage.toggleClass('fpd-drag');

						}).toggleClass('fpd-enabled', fpdInstance.currentViewInstance.dragStage);

					},
					functionAfter: function(origin) {

						origin.removeClass('fpd-active')
						.tooltipster('destroy');

						origin.attr('title', origin.data('defaulttext'))
						.tooltipster({
							offsetY: 0,
							position: 'bottom',
							theme: '.fpd-tooltip-theme',
							touchDevices: false,
						});

					}
				});

				$this.tooltipster('show');

			}

			$this.toggleClass('fpd-active');

		}
		else if(action === 'zoom-in') {
		    temp = valZoom + 0.1;
            fpdInstance.setZoom(temp);
		    valZoom = temp;
		}
		else if(action === 'zoom-out') {
		    temp = valZoom - 0.1;
            fpdInstance.setZoom(temp);
		    valZoom = temp;
		}
		else if(action === 'download') {

			if(!$this.hasClass('fpd-active')) {

				if($this.hasClass('tooltipstered')) {
					$this.tooltipster('destroy');
				}

				$this.tooltipster({
					trigger: 'click',
					position: 'bottom',
					content: $this.find('.fpd-tooltip-content'),
					theme: 'fpd-sub-tooltip-theme',
					touchDevices: false,
					functionReady: function(origin, tooltip) {

						tooltip.find('.fpd-item').click(function() {
							instance.downloadFile($(this).data('value'))
						});

					},
					functionAfter: function(origin) {

						origin.removeClass('fpd-active')
						.tooltipster('destroy');

						origin.attr('title', origin.data('defaulttext'))
						.tooltipster({
							offsetY: 0,
							position: 'bottom',
							theme: '.fpd-tooltip-theme',
							touchDevices: false,
						});

					}
				});

				$this.tooltipster('show');

			}

			$this.toggleClass('fpd-active');

		}
		else if(action === 'magnify-glass') {

			fpdInstance.resetZoom();

			if($this.hasClass('fpd-active')) {

				$(".fpd-zoom-image,.zoomContainer").remove();
				fpdInstance.$productStage.children('.fpd-view-stage').eq(fpdInstance.currentViewIndex).removeClass('fpd-hidden');

			}
			else {

				fpdInstance.toggleSpinner();

				var scaling = Number(2000 / fpdInstance.currentViewInstance.options.stageWidth).toFixed(2);
					dataURL = fpdInstance.currentViewInstance.stage.toDataURL({multiplier: scaling, format: 'png'});

				fpdInstance.$productStage.append('<img src="'+dataURL+'" class="fpd-zoom-image" />')
				.children('.fpd-zoom-image').elevateZoom({
					scrollZoom: true,
					borderSize: 1,
					zoomType: "lens",
					lensShape: "round",
					lensSize: 200,
					responsive: true
				}).load(function() {
					fpdInstance.toggleSpinner(false);
				});

				fpdInstance.$productStage.children('.fpd-view-stage').addClass('fpd-hidden');

			}

			$this.toggleClass('fpd-active');

		}
		else if(action === 'ruler') {

			if($this.hasClass('fpd-active')) {

				var rulerHor = fpdInstance.currentViewInstance.getElementByID('_ruler_hor');
				if(rulerHor) {
					fpdInstance.currentViewInstance.stage.remove(rulerHor);
				}

				var rulerVer = fpdInstance.currentViewInstance.getElementByID('_ruler_ver');
				if(rulerVer) {
					fpdInstance.currentViewInstance.stage.remove(rulerVer);
				}

			}
			else {

				var pixelUnitsOptions = {
					fill: '#979797',
					fontSize: 10,
					fontFamily: 'Arial'
				};

				fabric.util.loadImage(FPDActions.rulerHorImg, function (img) {

					var groupRulerHor = new fabric.Group([], {
						left: 0,
						top: 0,
						originX: 'left',
						originY: 'top',
						evented: false,
						selectable: false,
						id: '_ruler_hor'
					});

					var rect = new fabric.Rect({
					    width: fpdInstance.currentViewInstance.options.stageWidth,
					    height: 30
					});

					rect.setPatternFill({
				        source: img,
				        repeat: 'repeat-x'
				    });

				    groupRulerHor.addWithUpdate(rect);

					var loopX = Math.ceil(fpdInstance.currentViewInstance.options.stageWidth / 100);
				    for(var i=1; i < loopX; ++i) {
					    var text = new fabric.Text(String(i*100), $.extend({}, pixelUnitsOptions, {top: 3, left: (i*100)+3}));
					    groupRulerHor.addWithUpdate(text);
					}

					fpdInstance.currentViewInstance.stage.add(groupRulerHor).renderAll();

				});

				fabric.util.loadImage(FPDActions.rulerVerImg, function (img) {

					var groupRulerVer = new fabric.Group([], {
						left: 0,
						top: 0,
						originX: 'left',
						originY: 'top',
						evented: false,
						selectable: false,
						id: '_ruler_ver'
					});

					var rect = new fabric.Rect({
					    width: 30,
					    height: fpdInstance.currentViewInstance.options.stageHeight
					});

					rect.setPatternFill({
				        source: img,
				        repeat: 'repeat-y'
				    });

				    groupRulerVer.addWithUpdate(rect);

					var loopX = Math.ceil(fpdInstance.currentViewInstance.options.stageWidth / 100);
				    for(var i=1; i < loopX; ++i) {
					    var text = new fabric.Text(String(i*100), $.extend({}, pixelUnitsOptions, {
						    top: (i*100)+3,
						    left: 12,
						    angle: 90,
						    originY: 'bottom'})
						);
					    groupRulerVer.addWithUpdate(text);
					}

					fpdInstance.currentViewInstance.stage.add(groupRulerVer).renderAll();

				});

			}

			$this.toggleClass('fpd-active');

		}

	};

	this.resetAllActions = function() {

		$(".fpd-zoom-image,.zoomContainer").remove();
		fpdInstance.$productStage.children('.fpd-view-stage').eq(fpdInstance.currentViewIndex).removeClass('fpd-hidden');

		fpdInstance.$mainWrapper.find('.fpd-action-btn').removeClass('fpd-active');

	};

	this.hideAllTooltips = function() {

		fpdInstance.$mainWrapper.find('.fpd-action-btn.tooltipstered').tooltipster('hide');

	};

	_initialize();

};

FPDActions.availableActions = [
	'print',
	'reset-product',
	'undo',
	'redo',
	'info',
	'save',
	'load',
	'manage-layers',
	'snap',
	'qr-code',
	'zoom',
	'download',
	'magnify-glass',
	'zoom-out',
	'zoom-in',
	'preview-lightbox',
	'ruler'
];

FPDActions.rulerHorImg = "https://printyuk.com/js/otfjs/images/rulerHorImg.png";
FPDActions.rulerVerImg = "https://printyuk.com/js/otfjs/images/rulerVerImg.png";

var DesignsModule = function(fpdInstance, $module) {

	var $head = $module.find('.fpd-head'),
		$scrollArea = $module.find('.fpd-scroll-area'),
		$designsGrid = $module.find('.fpd-grid'),
		lazyClass = fpdInstance.mainOptions.lazyLoad ? 'fpd-hidden' : '',
		$currentCategory = null,
		$lastCategory = null;

	var _initialize = function() {

		if(fpdInstance.$designs.length > 0) {

			//check if categories are used or first category also includes sub-cats
			if(fpdInstance.$designs.filter('.fpd-category').length > 1 || fpdInstance.$designs.filter('.fpd-category:first').children('.fpd-category').length > 0) {

				$currentCategory = fpdInstance.$designs;
				_displayCategories($currentCategory.filter('.fpd-category'));

			}
			else { //display single category or designs without categories
				_displayDesigns(fpdInstance.$designs);
			}

			fpdInstance.$designs.remove();
		}

		var searchInLabel = fpdInstance.getTranslation('modules', 'designs_search_in');
		$head.find('.fpd-toggle-search').click(function() {

			var $titleSearchCon = $(this).parent();

			$titleSearchCon.toggleClass('fpd-search-active')
			.children('.fpd-search').val('')
			.attr('placeholder', searchInLabel+' '+$titleSearchCon.children('.fpd-category-title').text());

			if($titleSearchCon.hasClass('fpd-search-active')) {
				$titleSearchCon.children('.fpd-search').focus();
			}
			else {
				$head.find('.fpd-search').val('').keyup();
			}

		});

		$head.find('.fpd-search').keyup(function() {

			if(this.value == '') { //no input, display all
				$designsGrid.children('.fpd-item').css('display', 'block');
			}
			else {
				//hide all items
				$designsGrid.children('.fpd-item').css('display', 'none');

				//only show by input value
			    var searchq = this.value.toLowerCase().trim().split(" ");

			    $designsGrid.children('.fpd-item').filter(function(){

			     	var fullsearchc = 0,
			     		self = this;

				 	$.each( searchq, function( index, value ){
					 	fullsearchc += $(self).is("[data-search*='"+value+"']");
					});

					if(fullsearchc==searchq.length) {return 1;}

			    }).css('display', 'block');
			}

		});

		$head.find('.fpd-back').click(function() {

			$head.find('.fpd-category-title-search').removeClass('fpd-search-active');

			if($lastCategory.parent('.fpd-category').length == 0) { //display first level categories

				$currentCategory = fpdInstance.$designs;
				$lastCategory = $currentCategory;
				$module.removeClass('fpd-head-visible');

			}
			else { //display parent categories

				$lastCategory = $lastCategory.parent('.fpd-category');
				$currentCategory = $lastCategory.children();

			}

			_displayCategories($currentCategory);

		});

	};

	var _displayCategories = function($categories) {

		$scrollArea.find('.fpd-grid').empty();
		$module.removeClass('fpd-designs-active').addClass('fpd-categories-active');

		$categories.each(function(i, cat) {

			var $cat = $(cat),
				catThumbnail = $cat.data('thumbnail');

			var catObj = {
				title: $cat.attr('title'),
				thumbnail: catThumbnail
			};

			_addDesignCategory(catObj);

		});

		FPDUtil.refreshLazyLoad($designsGrid, false);
		FPDUtil.createScrollbar($scrollArea);

	};

	var _addDesignCategory = function(category) {

		var thumbnailHTML = category.thumbnail ? '<picture data-img="'+category.thumbnail+'"></picture>' : '',
			itemClass = category.thumbnail ? lazyClass : lazyClass+' fpd-title-centered',
			$lastItem = $designsGrid.append('<div class="fpd-category fpd-item '+itemClass+'">'+thumbnailHTML+'<span>'+category.title+'</span></div>')
		.children('.fpd-item:last').click(function(evt) {

			var $this = $(this),
				index = $this.parent().children('.fpd-item').index($this),
				$children = $currentCategory.eq(index).children();

			$lastCategory = $currentCategory.eq(index);

			if($children.filter('.fpd-category').length > 0) {

				$currentCategory = $children;
				_displayCategories($children);

			}
			else {

				_displayDesigns($currentCategory.eq(index));
			}

			$module.addClass('fpd-head-visible');
			$head.find('.fpd-category-title').text($this.children('span').text());

		});

		if(lazyClass === '' && category.thumbnail) {
			FPDUtil.loadGridImage($lastItem.children('picture'), category.thumbnail);
		}

	};

	var _displayDesigns = function($designs) {

		$scrollArea.find('.fpd-grid').empty();
		$module.removeClass('fpd-categories-active').addClass('fpd-designs-active');

		var categoryParameters = {};

		if($designs.hasClass('fpd-category')) {

			categoryParameters = $designs.data('parameters') ? $designs.data('parameters') : {};
			$designs = $designs.children('img');

		}

		$designs.each(function(i, design) {

			var $design = $(design),
				designObj = {
					source: $design.data('src') === undefined ? $design.attr('src') : $design.data('src'),
					title: $design.attr('title'),
					parameters: $.extend({}, categoryParameters, $design.data('parameters')),
					thumbnail: $design.data('thumbnail')
				};

			_addGridDesign(designObj);

		});

		FPDUtil.refreshLazyLoad($designsGrid, false);
		FPDUtil.createScrollbar($scrollArea);
		FPDUtil.updateTooltip();


	};

	//adds a new design to the designs grid
	var _addGridDesign = function(design) {

		design.thumbnail = design.thumbnail === undefined ? design.source : design.thumbnail;

		var $lastItem = $designsGrid.append('<div class="fpd-item '+lazyClass+'" data-source="'+design.source+'" data-search="'+design.title.toLowerCase()+'" data-title="'+design.title+'"><picture data-img="'+design.thumbnail+'"></picture></div>')
		.children('.fpd-item:last').click(function(evt) {

			var $this = $(this),
				designParams = $this.data('parameters'),
				currentImageParameters = fpdInstance.currentViewInstance.options.imageParameters,
				params = $.extend({}, currentImageParameters, designParams);

			if(params.resizeToW || params.resizeToH) {

				var scaling = FPDUtil.getScalingByDimesions(
					$this.children('picture').data('originWidth'),
					$this.children('picture').data('originHeight'),
					params.resizeToW,
					params.resizeToH
				);
				designParams.scaleX = scaling;
				designParams.scaleY = scaling;

			}

			designParams.isCustom = true;

			fpdInstance.addElement('image', $this.data('source'), $this.data('title'), designParams);

		}).data('parameters', design.parameters);

		if(lazyClass === '') {
			FPDUtil.loadGridImage($lastItem.children('picture'), design.thumbnail);
		}

	};

	this.selectCategory = function(index) {

		$categoriesDropdown.children('input').val(fpdInstance.products[index].name);

		var obj = fpdInstance.products[index];
		for(var i=0; i <obj.products.length; ++i) {
			var views = obj.products[i];
			_addGridProduct(views);
		}

	};

	_initialize();

};

var ProductsModule = function(fpdInstance, $module) {

	var instance = this,
		currentCategoryIndex = 0,
		$categoriesDropdown = $module.find('.fpd-product-categories'),
		$scrollArea = $module.find('.fpd-scroll-area'),
		$gridWrapper = $module.find('.fpd-grid'),
		lazyClass = fpdInstance.mainOptions.lazyLoad ? 'fpd-hidden' : '';

	var _initialize = function() {

		if(fpdInstance.products.length === 0) {
			return;
		}

		if(fpdInstance.products.length > 1) { //categories are used
			$module.addClass('fpd-categories-enabled');

			for(var i=0; i < fpdInstance.products.length; ++i) {
				$categoriesDropdown.find('.fpd-dropdown-list').append('<span class="fpd-item" data-value="'+i+'">'+fpdInstance.products[i].name+'</span>');
			}
		}

		var $categoryItems = $categoriesDropdown.find('.fpd-dropdown-list .fpd-item');

		$categoriesDropdown.children('input').keyup(function() {

			$categoryItems.hide();

			if(this.value.length === 0) {
				$categoryItems.show();
			}
			else {
				$categoryItems.filter(':containsCaseInsensitive("'+this.value+'")').show();
			}

		});

		$categoriesDropdown.find('.fpd-dropdown-list .fpd-item').click(function() {

			var $this = $(this);

			currentCategoryIndex = $this.data('value');

			$this.parent().prevAll('.fpd-dropdown-current:first').val($this.text());
			instance.selectCategory(currentCategoryIndex);

			$this.siblings('.fpd-item').show();

			FPDUtil.refreshLazyLoad($scrollArea.find('.fpd-grid'), false);

		});

		instance.selectCategory(currentCategoryIndex);

	};

	//adds a new product to the products grid
	var _addGridProduct = function(views) {

		//load product by click
		var thumbnail = views[0].productThumbnail ? views[0].productThumbnail : views[0].thumbnail,
			productTitle = views[0].productTitle ? views[0].productTitle : views[0].title;

		var $lastItem = $gridWrapper.append('<div class="fpd-item fpd-tooltip '+lazyClass+'" title="'+productTitle+'"><picture data-img="'+thumbnail+'"></picture></div>')
		.children('.fpd-item:last').click(function(evt) {

			var $this = $(this),
				index = $gridWrapper.children('.fpd-item').index($this);

			fpdInstance.selectProduct(index, currentCategoryIndex);

			evt.preventDefault();

		}).data('views', views);


		if(lazyClass === '') {
			FPDUtil.loadGridImage($lastItem.children('picture'), thumbnail);
		}

	};

	this.selectCategory = function(index) {

		$scrollArea.find('.fpd-grid').empty();

		$categoriesDropdown.children('input').val(fpdInstance.products[index].name);

		var obj = fpdInstance.products[index];
		for(var i=0; i <obj.products.length; ++i) {
			var views = obj.products[i];
			_addGridProduct(views);
		}

		FPDUtil.createScrollbar($scrollArea);
		FPDUtil.updateTooltip();

	};

	_initialize();

};

var TextModule = function(fpdInstance, $module) {

	var currentViewOptions;

	var _initialize = function() {

		fpdInstance.$container.on('viewSelect', function(evt, index, viewInstance) {

			currentViewOptions = viewInstance.options;

			if(currentViewOptions.customTextParameters && currentViewOptions.customTextParameters.price) {
				var price = fpdInstance.mainOptions.priceFormat.replace('%d', currentViewOptions.customTextParameters.price);
				$module.find('.fpd-btn > .fpd-price').html(' - '+price);
			}
			else {
				$module.find('.fpd-btn > .fpd-price').html('');
			}

		});

		$module.on('click', '.fpd-btn', function() {

			var $input = $(this).prevAll('textarea:first'),
				text = $input.val();

			if(text && text.length > 0) {

				var textParams = $.extend({}, currentViewOptions.customTextParameters, {isCustom: true});
				fpdInstance.addElement('text',text,text,textParams);
			}

			$input.val('');

		});

		$module.on('keyup', 'textarea', function() {

			var text = this.value,
				maxLength = currentViewOptions ? currentViewOptions.customTextParameters.maxLength : 0,
				maxLines = currentViewOptions ? currentViewOptions.customTextParameters.maxLines : 0;

			if(maxLength != 0 && text.length > maxLength) {
				text = text.substr(0, maxLength);
			}

			if(maxLines != 0 && text.split("\n").length > maxLines) {
				text = text.replace(/([\s\S]*)\n/, "$1");
			}

			this.value = text;

		});

	};

	_initialize();

};

var SavingModule = function(fpdInstance, $module) {

	var currentViewOptions;

	var _initialize = function() { 

		$module.on('click', '.fpd-btn', function() {
			var product = JSON.stringify(fpdInstance.getProduct());
			var id_otf_template = $('#id_otf_template').val(); 
			$.ajax({
				type: "POST",
				url: "https://printyuk.com/webservice/json.php",
				data: { data: product,ids:id_otf_template,act : "product" },
				success: function(data) {  
					result = jQuery.parseJSON (data);
					var obj = result;
					if(obj){ 
						window.location.href = 'https://printyuk.com/adam575859/index.php?controller=AdminTemplate';
					} else {
						alert("Error while saving design...");
					}
				}
			 }); 
		}); 

	};

	_initialize();

};

var SavedModule = function(fpdInstance, $module) {

	var currentViewOptions;
	var id_s = idss;
	var _initialize = function() {  
			$.ajax({
				type: "POST",
				url: "https://printyuk.com/webservice/json.php",
				data: { ids:id_s,act : "getproduct" },
				success: function(data) {  
					var obj  = jQuery.parseJSON (data); 
					fpdInstance.mainBar.$content.find('.fpd-saved-panel .fpd-grid').empty();
					$.each( obj, function( key, value ) {

							title = value.title ? value.title : '';

							//create new list item
							var $gridWrapper = fpdInstance.mainBar.$content.find('.fpd-saved-panel .fpd-grid'),htmlTitle = title !== '' ? 'title="'+title+'"' : '';

							$gridWrapper.append('<div class="fpd-item fpd-tooltip" '+htmlTitle+'><picture style="background-image: url('+value.thumbnail+')" ></picture></div>')
							.children('.fpd-item:last').click(function(evt) {
var finalData = value.product.replace(/\\/g, "");

								fpdInstance.loadProduct(jQuery.parseJSON(finalData));
								fpdInstance.currentProductIndex = -1;

							});

							FPDUtil.updateTooltip($gridWrapper);

					});
					FPDUtil.createScrollbar(fpdInstance.mainBar.$content.find('.fpd-saved-panel .fpd-scroll-area')); 
				}
			 }); 

	};

	_initialize();

};

var CheckoutModule = function(fpdInstance, $module) {

	var currentViewOptions;

	var _initialize = function() { 
			
		$module.on('click', '.fpd-btn', function() { 
			var title = $(this).prevAll('input:first').val();  
			if(title && title.length > 0) { 
				fpdInstance.toggleSpinner();
				_createPDF = function(dataURLs) {

						var largestWidth = fpdInstance.viewInstances[0].options.stageWidth,
							largestHeight = fpdInstance.viewInstances[0].options.stageHeight;

						for(var i=1; i < fpdInstance.viewInstances.length; ++i) {

							var viewOptions = fpdInstance.viewInstances[i].options;
							if(viewOptions.stageWidth > largestWidth) {
								largestWidth = viewOptions.stageWidth;
							}

							if(viewOptions.stageHeight > largestHeight) {
								largestHeight = viewOptions.stageHeight;
							}

						}
						
						
            			
						var thumbnail = fpdInstance.currentViewInstance.stage.toDataURL({format: 'png'});
						var orientation = fpdInstance.currentViewInstance.stage.getWidth() > fpdInstance.currentViewInstance.stage.getHeight() ? 'l' : 'p',
							doc = new jsPDF(orientation, 'mm', [largestWidth * 0.26, largestHeight * 0.26]);

						for(var i=0; i < dataURLs.length; ++i) {

							doc.addImage(dataURLs[i], 'JPEG', 0, 0);
							if(i < dataURLs.length-1) {
								doc.addPage();
							}

						}
				
						var updf = btoa(doc.output()); 
						var uTm = new Date().getTime();
						var product = JSON.stringify(fpdInstance.getProduct());
						$.ajax({
							method: "POST",
							url: "https://printyuk.com/webservice/json.php",
							data: {pdf: updf,tm: uTm,product: product,title: title, thumbnail: thumbnail,act : "savedesign"},
						}).success(function(data){ 
							new_file_name = data; 
							$("#ctm_file").val(base_uri+"artwork/"+new_file_name);  
							$("#pdfArtwork").css("display","none"); 
							$("#imgArtwork").css("display","block");
						
							fpdInstance.getProductCard(function(dataURL) { 
				                $("#imgArtwork").attr("src",dataURL); 
                			});
						
							$("#mpickdesign").css("display","none"); 
							fpdInstance.toggleSpinner(false);
							$("#mpickproduct").css("display","block"); 
						});

						//doc.save('Product.pdf');

					};	 
					fpdInstance.getViewsDataURL(_createPDF, '#ffffff', {format: 'jpeg'});
			} else {
				alert("You must entry title for your design !");
			}
		}); 

	};


	_initialize();

};
 

var LayersModule = {

	createList : function(fpdInstance, $container) {

		var $currentColorList,
			colorDragging = false;

		$container.off();

		//append a list item to the layers list
		var _appendLayerItem = function(element) {

			var colorHtml = '<span></span>';
			if(FPDUtil.elementHasColorSelection(element)) {

				var availableColors = FPDUtil.elementAvailableColors(element, fpdInstance);

				var currentColor = '';
				if(element.uploadZone) {
					colorHtml = '<span></span>';
				}
				else if(element.type == 'path-group') {
					currentColor = availableColors[0];
					colorHtml = '<span class="fpd-current-color" style="background: '+currentColor+'"></span>';
				}
				else if(availableColors.length > 1) {
					currentColor = element.fill ? element.fill : availableColors[0];
					colorHtml = '<span class="fpd-current-color" style="background: '+currentColor+'" data-colors=""></span>';
				}
				else {
					currentColor = element.fill ? element.fill : availableColors[0];
					colorHtml = '<input class="fpd-current-color" type="text" value="'+currentColor+'" />'
				}

			}

			$container.find('.fpd-list').append('<div class="fpd-list-row" id="'+element.id+'"><div class="fpd-cell-0">'+colorHtml+'</div><div class="fpd-cell-1">'+element.title+'</div><div class="fpd-cell-2"></div></div>');

			var $lastItem = $container.find('.fpd-list-row:last')
				.data('element', element)
				.data('colors', availableColors);

			if(element.uploadZone) {
				$lastItem.addClass('fpd-add-layer')
				.find('.fpd-cell-2').append('<span><span class="fpd-icon-add"></span></span>');
			}
			else {

				var lockIcon = !element.evented ? 'fpd-icon-locked-full' : 'fpd-icon-unlocked',
					reorderHtml = element.zChangeable ? '<span class="fpd-icon-reorder"></span>' : '';

				$lastItem.find('.fpd-cell-2').append(reorderHtml+'<span class="fpd-lock-element"><span class="'+lockIcon+'"></span></span>');

				if(element.removable) {
					$lastItem.find('.fpd-lock-element').after('<span class="fpd-remove-element"><span class="fpd-icon-remove"></span></span>');
				}

				$lastItem.toggleClass('fpd-locked', !element.evented);

			}

		};

		//destroy all color pickers and empty list
		$container.find('.fpd-current-color').spectrum('destroy');
		$container.find('.fpd-list').empty();

		var viewElements = fpdInstance.getElements(fpdInstance.currentViewIndex);
		for(var i=0; i < viewElements.length; ++i) {

			var element = viewElements[i];

			if(element.isEditable) {
				_appendLayerItem(element);
			}

		}

		FPDUtil.createScrollbar($container.find('.fpd-scroll-area'));

		//sortable layers list
		var sortDir = 0;
		$container.find('.fpd-list').sortable({
			handle: '.fpd-icon-reorder',
			placeholder: 'fpd-list-row fpd-sortable-placeholder',
			scroll: false,
			axis: 'y',
			containment: 'parent',
			items: '.fpd-list-row:not(.fpd-locked)',
			start: function(evt, ui) {
				sortDir = ui.originalPosition.top;
			},
			change: function(evt, ui) {

				var targetElement = fpdInstance.getElementByID(ui.item.attr('id')),
					relatedItem;

				if(ui.position.top > sortDir) { //down
					relatedItem = ui.placeholder.prevAll(".fpd-list-row:not(.ui-sortable-helper)").first();
				}
				else { //up
					relatedItem = ui.placeholder.nextAll(".fpd-list-row:not(.ui-sortable-helper)").first();
				}

				var fabricElem = fpdInstance.currentViewInstance.getElementByID(relatedItem.attr('id')),
					index = fpdInstance.currentViewInstance.getZIndex(fabricElem);

				fpdInstance.setElementParameters({z: index}, targetElement);

				sortDir = ui.position.top;

			}
		});

		$container.find('input.fpd-current-color').spectrum('destroy').spectrum({
			flat: false,
			preferredFormat: "hex",
			showInput: true,
			showInitial: true,
			showPalette: fpdInstance.mainOptions.colorPickerPalette && fpdInstance.mainOptions.colorPickerPalette.length > 0,
			palette: fpdInstance.mainOptions.colorPickerPalette,
			showButtons: false,
			show: function(color) {
				var element = $(this).parents('.fpd-list-row:first').data('element');
				element._tempFill = color.toHexString();
			},
			move: function(color) {

				var element = $(this).parents('.fpd-list-row:first').data('element');
				//only non-png images are chaning while dragging
				if(colorDragging === false || FPDUtil.elementIsColorizable(element) !== 'png') {
					fpdInstance.currentViewInstance.changeColor(element, color.toHexString());
				}

			},
			change: function(color) {

				$(document).unbind("click.spectrum"); //fix, otherwise change is fired on every click
				var element = $(this).parents('.fpd-list-row:first').data('element');
				fpdInstance.currentViewInstance.setElementParameters({fill: color.toHexString()}, element);

			}
		})
		.on('beforeShow.spectrum', function(e, tinycolor) {
			if($currentColorList) {
				$currentColorList.remove();
				$currentColorList = null;
			}
		})
		.on('dragstart.spectrum', function() {
			colorDragging = true;
		})
		.on('dragstop.spectrum', function(evt, color) {
			colorDragging = false;
			var element = $(this).parents('.fpd-list-row:first').data('element');
			fpdInstance.currentViewInstance.changeColor(element, color.toHexString());
		});

		$container.off('click', '.fpd-current-color') //unregister click, otherwise triggers multi-times when changing view
		.on('click', '.fpd-current-color', function(evt) { //open sub

			evt.stopPropagation();

			$container.find('.fpd-path-colorpicker').spectrum('destroy');
			$container.find('input.fpd-current-color').spectrum('hide');

			var $listItem = $(this).parents('.fpd-list-row'),
				element = $listItem.data('element'),
				availableColors = $listItem.data('colors');

			//clicked on opened sub colors, just close it
			if($currentColorList && $listItem.children('.fpd-scroll-area').length > 0) {
				$currentColorList.slideUp(200, function(){ $(this).remove(); });
				$currentColorList = null;
				return;
			}

			//close another sub colors
			if($currentColorList) {
				$currentColorList.slideUp(200, function(){ $(this).remove(); });
				$currentColorList = null;
			}

			if(availableColors.length > 0) {

				$listItem.append('<div class="fpd-scroll-area"><div class="fpd-color-palette fpd-grid"></div></div>');

				for(var i=0; i < availableColors.length; ++i) {

					var item;
					if(element.type === 'path-group') {

						item = '<input class="fpd-path-colorpicker" type="text" value="'+availableColors[i]+'" />';

					}
					else {

						var tooltipTitle = fpdInstance.mainOptions.hexNames[availableColors[i].replace('#', '')];
						tooltipTitle = tooltipTitle ? tooltipTitle : availableColors[i];

						item = '<div class="fpd-item fpd-tooltip" title="'+tooltipTitle+'" style="background-color: '+availableColors[i]+'" data-color="'+availableColors[i]+'"></div>';

					}

					$listItem.find('.fpd-color-palette').append(item);
				}

				FPDUtil.updateTooltip($listItem);

				if(element.type === 'path-group') {

					$listItem.find('.fpd-path-colorpicker').spectrum({
						showPaletteOnly: $.isArray(element.colors),
						preferredFormat: "hex",
						showInput: true,
						showInitial: true,
						showButtons: false,
						showPalette: fpdInstance.mainOptions.colorPickerPalette && fpdInstance.mainOptions.colorPickerPalette.length > 0,
						palette: $.isArray(element.colors) ? element.colors : fpdInstance.mainOptions.colorPickerPalette,
						show: function(color) {

							var $listItem = $(this).parents('.fpd-list-row'),
								element = $listItem.data('element');

							var svgColors = FPDUtil.changePathColor(
								element,
								$listItem.find('.fpd-path-colorpicker').index(this),
								color
							);

							element._tempFill = svgColors;

						},
						move: function(color) {

							var $listItem = $(this).parents('.fpd-list-row'),
								element = $listItem.data('element');

							var svgColors = FPDUtil.changePathColor(
								element,
								$listItem.find('.fpd-path-colorpicker').index(this),
								color
							);

							fpdInstance.currentViewInstance.changeColor(element, svgColors);

						},
						change: function(color) {

							var $listItem = $(this).parents('.fpd-list-row'),
								element = $listItem.data('element');

							var svgColors = FPDUtil.changePathColor(
								element,
								$listItem.find('.fpd-path-colorpicker').index(this),
								color
							);

							$(document).unbind("click.spectrum"); //fix, otherwise change is fired on every click
							fpdInstance.currentViewInstance.setElementParameters({fill: svgColors}, element);

						}
					});

				}

				$currentColorList = $listItem.children('.fpd-scroll-area').slideDown(300);

			}

		});

		//select color from color palette
		$container.on('click', '.fpd-color-palette .fpd-item', function(evt) {

			evt.stopPropagation();

			var $this = $(this),
				$listItem = $this.parents('.fpd-list-row'),
				element = $listItem.data('element'),
				newColor = $this.data('color');

			$listItem.find('.fpd-current-color').css('background', newColor);
			fpdInstance.currentViewInstance.setElementParameters({fill: newColor}, element);

		});

		//select associated element on stage when choosing one from the layers list
		$container.on('click', '.fpd-list-row', function() {

			if($(this).hasClass('fpd-locked')) {
				return;
			}

			var targetElement = fpdInstance.getElementByID(this.id);
			if(targetElement) {
				targetElement.canvas.setActiveObject(targetElement).renderAll();
			}

		});

		//lock element
		$container.on('click', '.fpd-lock-element',function(evt) {

			evt.stopPropagation();

			var $this = $(this),
				element = $this.parents('.fpd-list-row').data('element');

			if($currentColorList) {
				$currentColorList.slideUp(200, function(){ $(this).remove(); });
				$currentColorList = null;
			}

			element.evented = !element.evented;

			$this.children('span').toggleClass('fpd-icon-unlocked', element.evented)
			.toggleClass('fpd-icon-locked-full', !element.evented);

			$this.parents('.fpd-list-row').toggleClass('fpd-locked', !element.evented);
			$this.parents('.fpd-list:first').sortable( 'refresh' );

		});

		//remove element
		$container.on('click', '.fpd-remove-element',function(evt) {

			evt.stopPropagation();

			var $listItem = $(this).parents('.fpd-list-row');

			fpdInstance.currentViewInstance.removeElement($listItem.data('element'));

		});

	},

};

var ImagesModule = function(fpdInstance, $module) {

	var lazyClass = fpdInstance.mainOptions.lazyLoad ? 'fpd-hidden' : '',
		$imageInput = $module.find('.fpd-input-image'),
		$uploadScrollArea = $module.find('[data-context="upload"] .fpd-scroll-area'),
		$uploadGrid = $uploadScrollArea.find('.fpd-grid'),
		$fbAlbumDropdown = $module.find('.fpd-facebook-albums'),
		$fbScrollArea = $module.find('[data-context="facebook"] .fpd-scroll-area'),
		$fbGrid = $fbScrollArea.find('.fpd-grid'),
		$instaScrollArea = $module.find('[data-context="instagram"] .fpd-scroll-area'),
		$instaGrid = $instaScrollArea.find('.fpd-grid')
		facebookAppId = fpdInstance.mainOptions.facebookAppId,
		instagramClientId = fpdInstance.mainOptions.instagramClientId,
		instagramRedirectUri = fpdInstance.mainOptions.instagramRedirectUri,
		instaAccessToken = null,
		instaLoadingStack = false,
		instaNextStack = null,
		localStorageAvailable = FPDUtil.localStorageAvailable(),
		loadingImageLabel = fpdInstance.getTranslation('misc', 'loading_image'),
		ajaxSettings = fpdInstance.mainOptions.customImageAjaxSettings,
		saveOnServer = ajaxSettings.data && ajaxSettings.data.saveOnServer ? 1 : 0,
		uploadsDir = (ajaxSettings.data && ajaxSettings.data.uploadsDir) ? ajaxSettings.data.uploadsDir : '',
		uploadsDirURL = (ajaxSettings.data && ajaxSettings.data.uploadsDirURL) ? ajaxSettings.data.uploadsDirURL : '';

	var _initialize = function() {

		var $uploadZone = $module.find('.fpd-upload-zone');

		$uploadZone.click(function(evt) {

			evt.preventDefault();
			$imageInput.click();

		})
		.on('dragover dragleave', function(evt) {

			evt.stopPropagation();
			evt.preventDefault();

			$(this).toggleClass('fpd-hover', evt.type === 'dragover');

		});

		var _parseFiles = function(evt) {

			evt.stopPropagation();
			evt.preventDefault();

			if(window.FileReader) {

				var files = evt.target.files || evt.dataTransfer.files,
					addFirstToStage = true;
					fileTypes = ['jpg', 'jpeg', 'png', 'svg'];

				for(var i=0; i < files.length; ++i) {

					var extension = files[i].name.split('.').pop().toLowerCase();

					if(fileTypes.indexOf(extension) > -1) {
						_addUploadedImage(files[i], addFirstToStage);
						addFirstToStage = false;
					}

				}

			}

			$uploadZone.removeClass('fpd-hover');
			$imageInput.val('');

		};

		if($uploadZone.get(0)) {
			$uploadZone.get(0).addEventListener('drop', _parseFiles, false);
		}

		$module.find('.fpd-upload-form').on('change', _parseFiles);


		if(facebookAppId && facebookAppId.length > 5) {

			$module.find('.fpd-module-tabs [data-context="facebook"]').removeClass('fpd-hidden');

			_initFacebook();

		}

		if(instagramClientId && instagramClientId.length > 5) {

			$module.find('.fpd-module-tabs [data-context="instagram"]').removeClass('fpd-hidden');

			$module.find('.fpd-module-tabs [data-context="instagram"]').on('click', function() {

				if($instaGrid.children('.fpd-item').length > 0) {
					return;
				}

				//check if access token is stored in browser
				//window.localStorage.removeItem('fpd_instagram_access_token')
				instaAccessToken = window.localStorage.getItem('fpd_instagram_access_token');

				var endpoint = 'recent';
				if(!localStorageAvailable || instaAccessToken == null) {

					_authenticateInstagram(function() {
						_loadInstaImages(endpoint);
					});

				}
				//load images by requested endpoint
				else {

					_loadInstaImages(endpoint);

				}

			});

			$module.find('.fpd-insta-recent-images, .fpd-insta-liked-images').click(function() {

				var $this = $(this).addClass('fpd-active'),
					endpoint = $this.hasClass('fpd-insta-recent-images') ? 'recent' : 'liked';

				$this.siblings().removeClass('fpd-active');

			});

			$instaScrollArea.on('_sbOnTotalScroll', function() {

				if(instaNextStack !== null && !instaLoadingStack) {

					_loadInstaImages(instaNextStack, false);

				}

			});

		}

		$module.children('.fpd-module-tabs').children('div:not(.fpd-hidden):first').click();

	};

	var _addUploadedImage = function(file, addToStage) {

		//check maximum allowed size
		var maxSizeBytes = fpdInstance.mainOptions.customImageParameters.maxSize * 1024 * 1024;
		if(file.size > maxSizeBytes) {
			FPDUtil.showMessage(fpdInstance.getTranslation('misc', 'maximum_size_info').replace('%filename', file.name).replace('%mb', fpdInstance.mainOptions.customImageParameters.maxSize));
			return;
		}

		//load image with FileReader
		var reader = new FileReader();
    	reader.onload = function (evt) {

			//check image resolution of jpeg
	    	if(file.type === 'image/jpeg') {

		    	var jpeg = new JpegMeta.JpegFile(atob(this.result.replace(/^.*?,/,'')), file.name);

		    	if(jpeg.tiff && jpeg.tiff.XResolution && jpeg.tiff.XResolution.value) {

			    	var xResDen = jpeg.tiff.XResolution.value.den,
			    		xResNum = jpeg.tiff.XResolution.value.num,
			    		realRes = xResNum / xResDen;

					FPDUtil.log(file.name+', Density: '+ xResDen + ' Number: '+ xResNum + ' Real Resolution: '+ realRes, 'info');

					if(realRes < fpdInstance.mainOptions.customImageParameters.minDPI) {
						FPDUtil.showModal(fpdInstance.getTranslation('misc', 'minimum_dpi_info').replace('%dpi', fpdInstance.mainOptions.customImageParameters.minDPI));
						return false;
					}

		    	}
		    	else {
			    	FPDUtil.log(file.name + ': Resolution is not accessible.', 'info');
		    	}

	    	}

	    	var image = this.result,
				$lastItem = $uploadGrid.append('<div class="fpd-item" data-title="'+file.name+'"><picture data-img="'+image+'"></picture></div>')
			.children('.fpd-item:last').data('file', file).click(function(evt) {

				var $this = $(this);

				fpdInstance._loadingCustomImage = true;

				//save custom image on server
				if(saveOnServer) {

					fpdInstance.toggleSpinner(true, loadingImageLabel);

					var formDataAjaxSettings = $.extend({}, ajaxSettings),
						formdata = new FormData();
					formdata.append('uploadsDir', uploadsDir);
					formdata.append('uploadsDirURL', uploadsDirURL);
					formdata.append('images[]', $this.data('file'));

					formDataAjaxSettings.data = formdata;
					formDataAjaxSettings.processData = false;
					formDataAjaxSettings.contentType = false;
					formDataAjaxSettings.success = function(data) {

						if(data && data.error == undefined) {

							fpdInstance.addCustomImage( data.image_src, data.filename );

						}
						else {

							fpdInstance.toggleSpinner(false);
							FPDUtil.showModal(data.error);

						}

					};

					//ajax post
					$.ajax(formDataAjaxSettings)
					.fail(function(evt) {

						fpdInstance.toggleSpinner(false);
						FPDUtil.showModal(evt.statusText);

					});

				}
				//add data uri to canvas
				else {
					fpdInstance.addCustomImage( $this.data('source'), $this.data('title') );
				}

			});

			//check image dimensions
			var checkDimImage = new Image();
			checkDimImage.onload = function() {

				var imageH = this.height,
					imageW = this.width,
					currentCustomImageParameters = fpdInstance.currentViewInstance.options.customImageParameters;

				if(FPDUtil.checkImageDimensions(fpdInstance, imageW, imageH)) {
					$lastItem.data('source', image);
					FPDUtil.loadGridImage($lastItem.children('picture'), this.src);
					FPDUtil.createScrollbar($uploadScrollArea);

					if(addToStage) {
						$lastItem.click();
					}

				}
				else {
					$lastItem.remove();
				}

			};
			checkDimImage.src = image;

		}

		//add file to start loading
		reader.readAsDataURL(file);

	};

	var _initFacebook = function() {

		var $albumItems = $fbAlbumDropdown.find('.fpd-dropdown-list .fpd-item');

		$fbAlbumDropdown.children('input').keyup(function() {

			$albumItems.hide();

			if(this.value.length === 0) {
				$albumItems.show();
			}
			else {
				$albumItems.filter(':containsCaseInsensitive("'+this.value+'")').show();
			}

		});

		$fbAlbumDropdown.on('click', '.fpd-dropdown-list .fpd-item', function() {

			var $this = $(this);

			albumID = $this.data('value');

			$this.parent().prevAll('.fpd-dropdown-current:first').val($this.text());
			$this.siblings('.fpd-item').show();

			_selectAlbum(albumID);

		});

		var _selectAlbum = function(albumID) {

			$fbGrid.empty();
			$fbAlbumDropdown.addClass('fpd-on-loading');

			FB.api('/'+albumID+'?fields=count', function(response) {

				var albumCount = response.count;

				FB.api('/'+albumID+'?fields=photos.limit('+albumCount+').fields(source,images)', function(response) {

					$fbAlbumDropdown.removeClass('fpd-on-loading');

					if(!response.error) {

						var photos = response.photos.data;

						for(var i=0; i < photos.length; ++i) {
							var photo = photos[i],
								photoLargest = photo.images[0] ? photo.images[0].source : photo.source;
								photoThumbnail = photo.images[photo.images.length-1] ? photo.images[photo.images.length-1].source : photo.source;
							var $lastItem = $fbGrid.append('<div class="fpd-item '+lazyClass+'" data-title="'+photo.id+'" data-source="'+photo.source+'"><picture data-img="'+photoLargest+'"></picture></div>')
							.children('.fpd-item:last').click(function(evt) {

								fpdInstance.toggleSpinner(true, loadingImageLabel);

								var $this = $(this);

								fpdInstance._loadingCustomImage = true;

								ajaxSettings.data = {url: $this.data('source'), uploadsDir: uploadsDir, uploadsDirURL: uploadsDirURL, saveOnServer: saveOnServer};
								ajaxSettings.success = function(data) {

									if(data && data.error == undefined) {

										var picture = new Image();
										picture.src = data.image_src;
										picture.onload = function() {

											fpdInstance.addCustomImage( this.src, $this.data('title') );
										};

									}
									else {

										fpdInstance.toggleSpinner(false);
										FPDUtil.showModal(data.error);

									}

								};

								//ajax post
								$.ajax(ajaxSettings)
								.fail(function(evt) {

									fpdInstance.toggleSpinner(false);
									FPDUtil.showModal(evt.statusText);

								});

							});

							if(lazyClass === '') {
								FPDUtil.loadGridImage($lastItem.children('picture'), photoThumbnail);
							}

						}


						FPDUtil.createScrollbar($fbScrollArea);
						FPDUtil.refreshLazyLoad($fbGrid, false);

					}

					fpdInstance.toggleSpinner(false);

				});

			});

		};

		$.ajaxSetup({ cache: true });
		$.getScript('//connect.facebook.com/en_US/sdk.js', function(){

			//init facebook
			FB.init({
				appId: facebookAppId,
				status: true,
				cookie: true,
				xfbml: true,
				version: 'v2.5'
			});

			FB.Event.subscribe('auth.statusChange', function(response) {

				if (response.status === 'connected') {
					// the user is logged in and has authenticated your app

					$module.addClass('fpd-facebook-logged-in');

					FB.api('/me/albums?fields=name,count,id', function(response) {

						var albums = response.data;
						//add all albums to select
						for(var i=0; i < albums.length; ++i) {

							var album = albums[i];
							if(album.count > 0) {
								$fbAlbumDropdown.find('.fpd-dropdown-list').append('<span class="fpd-item" data-value="'+album.id+'">'+album.name+'</span>');
							}

						}

						$albumItems = $fbAlbumDropdown.find('.fpd-dropdown-list .fpd-item');

						$fbAlbumDropdown.removeClass('fpd-on-loading');

					});

				}

			});

		});

	};

	//log into instagram via a popup
	var _authenticateInstagram = function(callback) {

		var popupLeft = (window.screen.width - 700) / 2,
			popupTop = (window.screen.height - 500) / 2;

		var popup = window.open(fpdInstance.mainOptions.templatesDirectory+'/instagram_auth.'+fpdInstance.mainOptions.templatesType, '', 'width=700,height=500,left='+popupLeft+',top='+popupTop+'');
		FPDUtil.popupBlockerAlert(popup, fpdInstance);

		popup.onload = new function() {

			if(window.location.hash.length == 0) {

				popup.open('https://instagram.com/oauth/authorize/?client_id='+instagramClientId+'&redirect_uri='+instagramRedirectUri+'&response_type=token', '_self');

			}

			var interval = setInterval(function() {

				try {
					if(popup.location.hash.length) {

						clearInterval(interval);
						instaAccessToken = popup.location.hash.slice(14);
						if(localStorageAvailable) {
							window.localStorage.setItem('fpd_instagram_access_token', instaAccessToken);
						}
						popup.close();
						if(callback != undefined && typeof callback == 'function') callback();

					}
				}
				catch(evt) {
					//permission denied
				}

			}, 100);
		}

	};

	//load photos from instagram using an endpoint
	var _loadInstaImages = function(endpoint, emptyGrid) {

		emptyGrid = typeof emptyGrid === 'undefined' ? true : emptyGrid;

		instaLoadingStack = true;

		var endpointUrl;

		switch(endpoint) {
			case 'liked':
				endpointUrl = 'https://api.instagram.com/v1/users/self/media/liked?access_token='+instaAccessToken;
			break;
			case 'recent':
				endpointUrl = 'https://api.instagram.com/v1/users/self/media/recent?access_token='+instaAccessToken;
			break;
			default:
				endpointUrl = endpoint;
		}

		if(emptyGrid) {
			$instaGrid.empty();
		}

		$.ajax({
	        method: 'GET',
	        url: endpointUrl,
	        dataType: 'jsonp',
	        jsonp: 'callback',
	        jsonpCallback: 'jsonpcallback',
	        cache: false,
	        success: function(data) {

	        	if(data.data) {

		        	instaNextStack = (data.pagination && data.pagination.next_url) ? data.pagination.next_url : null;

		        	$.each(data.data, function(i, item) {

		        		if(item.type == 'image') {

			        		var imageWidth = String(item.images.standard_resolution.width),
			        			imageHeight = item.images.standard_resolution.height,
			        			//get high-resolution image by replacing /s640x640 in url
			        			regexImageSize = new RegExp('/s'+imageWidth+'x'+imageHeight, 'g'),
			        			image = item.images.standard_resolution.url.replace(regexImageSize,''),
			        			$lastItem = $instaGrid.append('<div class="fpd-item '+lazyClass+'" data-title="'+item.id+'" data-source="'+image+'"><picture data-img="'+image+'"></picture></div>')
			        		.children('.fpd-item:last').click(function(evt) {

								fpdInstance.toggleSpinner(true, loadingImageLabel);

								var $this = $(this);
								fpdInstance._loadingCustomImage = true;

								ajaxSettings.data = {url: $this.data('source'), uploadsDir: uploadsDir, uploadsDirURL: uploadsDirURL, saveOnServer: saveOnServer};
								ajaxSettings.success = function(data) {

									if(data && data.error == undefined) {

										var picture = new Image();
										picture.src = data.image_src;
										picture.onload = function() {

											fpdInstance.addCustomImage( this.src, $this.data('title') );
										};

									}
									else {

										fpdInstance.toggleSpinner(false);
										FPDUtil.showModal(data.error);

									}

								};

								//ajax post
								$.ajax(ajaxSettings)
								.fail(function(evt) {

									fpdInstance.toggleSpinner(false);
									FPDUtil.showModal(evt.statusText);

								});

							});

		        		}

		        		if(lazyClass === '') {
							FPDUtil.loadGridImage($lastItem.children('picture'), image);
						}

		            });

					if(emptyGrid) {
						FPDUtil.createScrollbar($instaScrollArea);
						FPDUtil.refreshLazyLoad($instaGrid, false);
					}



	        	}
	        	else {

		        	window.localStorage.removeItem('fpd_instagram_access_token');
		        	if(data.meta && data.meta.error_message) {
			        	FPDUtil.showModal('<strong>Instagram Error</strong><p>'+data.meta.error_message+'</p>');
		        	}

	        	}

	        	instaLoadingStack = false;

	        },
	        error: function(jqXHR, textStatus, errorThrown) {

		        instaLoadingStack = false;
	            FPDUtil.showModal("Could not load data from instagram. Please try again!");

	        }
	    });

	};

	_initialize();

};

var FancyProductDesigner = function(elem, opts) {

	$ = jQuery;

	var instance = this,
		$window = $(window),
		$body = $('body'),
		$products,
		$elem,
		$mainBar,
		$stageLoader,
		$uiElements,
		$modules,
		$editorBox = null,
		$thumbnailPreview = null,
		nonInitials = [],
		_viewInstances = [];
		stageCleared = false;
		productIsCustomized = false,
		zoomReseted = false,
		initCSSClasses = '',
		anonymFuncs = {};


	this.products = [];
	
	this.plainProducts = [];
	
	this.currentCategoryIndex = 0;
	
	this.currentProductIndex = 0;
	
	this.currentViewIndex = 0;
	
	this.currentPrice = 0;
	
	this.currentViews = null;
	
	this.currentViewInstance = null;
	
	this.currentElement = null;
	
	this.langJson = null;
	
	this.mainOptions;
	
	this.$productStage = null;
	
	this.$elementTooltip = null;
	
	this.watermarkImg = null;
	
	this.productCreated = false;
	
	this.doUnsavedAlert = false;
	
	this.viewInstances = [];
	
	this.colorLinkGroups = {};
	
	this.singleProductPrice = 0;
	this.languageJSON = {
		"toolbar": {},
		"actions": {},
		"modules": {},
		"misc": {},
		"plus": {}
	};

	this.mainElement = null;
	
	this.orderQuantity = 1;

	this._order = {};
	this._loadingCustomImage = false;

	var fpdOptions = new FancyProductDesignerOptions(),
		options = fpdOptions.merge(fpdOptions.defaults, opts);

	this.mainOptions = options;

	var _initialize = function() {

		// @@include('../envato/evilDomain.js')

		//create custom jquery expression to ignore case when filtering
		$.expr[":"].containsCaseInsensitive = $.expr.createPseudo(function(arg) {
		    return function( elem ) {
		        return $(elem).text().toUpperCase().indexOf(arg.toUpperCase()) >= 0;
		    };
		});

		//check if element is a jquery object
		if(elem instanceof jQuery) {
			$elem = elem;
		}
		else {
			$elem = $(elem);
		}

		initCSSClasses = $elem.attr('class');
		options.mainBarContainer = options.modalMode !== false ? false : options.mainBarContainer;

		//force sidebar when main bar container is set
		if(options.mainBarContainer) {
			$elem.removeClass('fpd-topbar').addClass('fpd-sidebar');
		}

		instance.$container = $elem.data('instance', instance);

		//save products and designs HTML
		$products = $elem.children('.fpd-category').length > 0 ? $elem.children('.fpd-category').remove() : $elem.children('.fpd-product').remove();
		instance.$designs = $elem.find('.fpd-design > .fpd-category').length > 0 ? $elem.find('.fpd-design > .fpd-category') : $elem.find('.fpd-design > img');
		$elem.children('.fpd-design').remove();

		//add product designer into modal
		if(options.modalMode) {

			$elem.removeClass('fpd-hidden');
			$body.addClass('fpd-modal-mode-active');

			var $modalProductDesigner = $elem.wrap('<div class="fpd-modal-product-designer fpd-modal-overlay fpd-fullscreen"><div class="fpd-modal-wrapper"></div></div>').parents('.fpd-modal-overlay:first'),
				modalProductDesignerOnceOpened = false;

			$modalProductDesigner.children()
			.append('<div class="fpd-done fpd-btn" data-defaulttext="Done">misc.modal_done</div><div class="fpd-modal-close"><span class="fpd-icon-close"></span></div>');

			$(options.modalMode).addClass('fpd-modal-mode-btn').click(function(evt) {

				evt.preventDefault();

				$body.addClass('fpd-overflow-hidden').removeClass('fpd-modal-mode-active');

				$modalProductDesigner.addClass('fpd-fullscreen').fadeIn(300);
				if(instance.currentViewInstance) {
					instance.currentViewInstance.resetCanvasSize();
				}

				var $selectedModule = $mainBar.children('.fpd-navigation').children('.fpd-active');
				if($selectedModule.length > 0) {
					instance.mainBar.callModule($selectedModule.data('module'));
				}

				//auto-select
				var autoSelectElement = null;
				if(!modalProductDesignerOnceOpened && !instance.mainOptions.editorMode && instance.currentViewInstance) {
					var viewElements = instance.currentViewInstance.stage.getObjects();
					for(var i=0; i < viewElements.length; ++i) {
						var obj = viewElements[i];

						 if(obj.autoSelect && !obj.hasUploadZone) {
							 autoSelectElement = obj;

						 }

					}
				}

				setTimeout(function() {

					if(autoSelectElement) {
						instance.currentViewInstance.stage.setActiveObject(autoSelectElement);
						instance.currentViewInstance.stage.renderAll();
					}

				}, 300);

				modalProductDesignerOnceOpened = true;

			});

			$modalProductDesigner.find('.fpd-done').click(function() {

				$modalProductDesigner.find('.fpd-modal-close').click();

			});

		}

		//test if browser is supported (safari, chrome, opera, firefox IE>9)
		var canvasTest = document.createElement('canvas'),
			canvasIsSupported = Boolean(canvasTest.getContext && canvasTest.getContext('2d')),
			minIE = options.templatesDirectory ? 9 : 8;

		if(!canvasIsSupported || (FPDUtil.isIE() && Number(FPDUtil.isIE()) <= minIE)) {

			anonymFuncs.loadCanvasError = function(html) {

				$elem.append($.parseHTML(html)).fadeIn(300);

				/**
			     * Gets fired as soon as a template has been loaded.
			     *
			     * @event FancyProductDesigner#templateLoad
			     * @param {Event} event
			     * @param {string} URL - The URL of the loaded template.
			     */
				$elem.trigger('templateLoad', [this.url]);

			};
			$.get(options.templatesDirectory+'canvaserror.'+options.templatesType, anonymFuncs.loadCanvasError);

			/**
		     * Gets fired when the browser does not support HTML5 canvas.
		     *
		     * @event FancyProductDesigner#canvasFail
		     * @param {Event} event
		     */
			$elem.trigger('canvasFail');

			return false;
		}

		//lowercase all keys in hexNames
		var key,
			keys = Object.keys(options.hexNames),
			n = keys.length,
			newHexNames = {};

		while (n--) {
		  key = keys[n];
		  newHexNames[key.toLowerCase()] = options.hexNames[key];
		}
		options.hexNames = newHexNames;

		//PLUS
		if(typeof FancyProductDesignerPlus !== 'undefined') {
			FancyProductDesignerPlus.setup($elem, instance);
		}


		//load language JSON
		if(options.langJSON !== false) {

			if(typeof options.langJSON === 'object') {

				instance.langJson = options.langJSON;

				$elem.trigger('langJSONLoad', [instance.langJson]);

				_initProductStage();

			}
			else {

				$.getJSON(options.langJSON).done(function(data) {

					instance.langJson = data;

					/**
				     * Gets fired when the language JSON is loaded.
				     *
				     * @event FancyProductDesigner#langJSONLoad
				     * @param {Event} event
				     * @param {Object} langJSON - A JSON containing the translation.
				     */
					$elem.trigger('langJSONLoad', [instance.langJson]);

					_initProductStage();

				})
				.fail(function(data) {

					FPDUtil.showModal('Language JSON "'+options.langJSON+'" could not be loaded or is not valid. Make sure you set the correct URL in the options and the JSON is valid!');

					$elem.trigger('langJSONLoad', [instance.langJson]);
				});

			}


		}
		else {
			_initProductStage();
		}


	}; //init end

	//init the product stage
	var _initProductStage = function() {

		var loaderHTML = '<div class="fpd-loader-wrapper"><div class="fpd-loader"><div class="fpd-loader-circle"></div><span class="fpd-loader-text" data-defaulttext="Initializing Product Designer">misc.initializing</span></div></div>',
			tooltipHtml = '<div class="fpd-element-tooltip" style="display: none;">misc.out_of_bounding_box</div>';

		//add init loader
		instance.$mainWrapper = $elem.addClass('fpd-container fpd-clearfix fpd-grid-columns-'+options.gridColumns).html(loaderHTML+'<div class="fpd-main-wrapper">'+tooltipHtml+'<div class="fpd-snap-line-h"></div><div class="fpd-snap-line-v"></div><div class="fpd-product-stage" style="width:'+options.stageWidth+'px;height: '+options.stageHeight+'px;"></div></div>').children('.fpd-main-wrapper');

		$elem.after('<div class="fpd-device-info">'+instance.getTranslation('misc', 'not_supported_device_info')+'</div>');


		instance.$productStage  = instance.$mainWrapper.children('.fpd-product-stage')
		instance.$elementTooltip = instance.$mainWrapper.children('.fpd-element-tooltip');
		$stageLoader = $elem.children('.fpd-loader-wrapper');

		_translateElement($stageLoader.find('.fpd-loader-text'));
		_translateElement(instance.$elementTooltip);
		if(options.modalMode) {
			_translateElement($body.find('.fpd-modal-overlay .fpd-done'));
		}

		//load editor box if requested
		if(typeof options.editorMode === 'string') {

			$editorBox = $('<div class="fpd-editor-box"><h5></h5><div class="fpd-clearfix"></div></div>');
			$(options.editorMode).append($editorBox);

		}

		//window resize handler
		var device = 'desktop';
		$window.resize(function() {

			if(instance.currentElement && instance.currentElement.isEditing) {
				return;
			}

			if(instance.actions) {
				instance.actions.hideAllTooltips();
				if(!zoomReseted) {
					instance.resetZoom();
				}
			}

			//deselect element if one is selected and active element is not input (FB browser fix)
			if(instance.currentElement && $(document.activeElement).is(':not(input)')) {
				instance.deselectElement();
			}

			if($window.width() < 568 && !instance.$container.hasClass('fpd-topbar')) {
				instance.$container.removeClass('fpd-sidebar').addClass('fpd-topbar');
				if(instance.mainBar && !options.mainBarContainer) {
					instance.mainBar.setContentWrapper('draggable-dialog');
				}

				device = 'smartphone';
			}
			else if(device === 'smartphone' && $window.width() > 568 && initCSSClasses.search('fpd-topbar') === -1 && instance.$container.hasClass('fpd-topbar')) {
				instance.$container.removeClass('fpd-topbar').addClass('fpd-sidebar');
				if(instance.mainBar && !options.mainBarContainer) {
					instance.mainBar.setContentWrapper('sidebar');
				}

				device = 'monitor';
			}

			if(instance.currentViewInstance) {
				instance.currentViewInstance.resetCanvasSize();
			}

			if(instance.$container.filter('[class*="fpd-off-canvas-"]').length > 0) {
				instance.mainBar.$content.height(instance.$mainWrapper.height());
			}



		});

		//check if categories are used
		if($products.is('.fpd-category') && $products.filter('.fpd-category').length > 1) {

			//loop through all categories
			$products.each(function(i, cat) {
				var $cat = $(cat);
				_createProductsFromHTML($cat.children('.fpd-product'), $cat.attr('title'));
			});

		}
		else {

			//no categories are used
			$products = $products.filter('.fpd-category').length === 0 ? $products : $products.children('.fpd-product');
			_createProductsFromHTML($products, false);

		}

		options.templatesDirectory ? _loadUIElements() : _ready();

	};

	//now load UI elements from external HTML file
	var _loadUIElements = function() {

		_checkProductsLength();

		anonymFuncs.loadProductDesignerTemplate = function(html) {

			/**
		     * Gets fired as soon as a template has been loaded.
		     *
		     * @event FancyProductDesigner#templateLoad
		     * @param {Event} event
		     * @param {string} URL - The URL of the loaded template.
		     */
			$elem.trigger('templateLoad', [this.url]);

			$uiElements = $(html);

			$uiElements.find('[data-defaulttext]').each(function(index, uiElement) {

				_translateElement($(uiElement));

			});

			if(options.mainBarContainer) {

				$elem.addClass('fpd-main-bar-container-enabled');
				$mainBar = $(options.mainBarContainer).addClass('fpd-container fpd-main-bar-container fpd-tabs fpd-tabs-top fpd-sidebar fpd-grid-columns-'+options.gridColumns).html($uiElements.children('.fpd-mainbar')).children('.fpd-mainbar');

			}
			else {
				$mainBar = $elem.prepend($uiElements.children('.fpd-mainbar')).children('.fpd-mainbar');
			}

			$modules = $uiElements.children('.fpd-modules');

			if($elem.hasClass('fpd-sidebar')) {
				$elem.height(options.stageHeight);
			}
			else {
				$elem.width(options.stageWidth);
			}

			//show tabs content
			$body.on('click', '.fpd-module-tabs > div', function() {

				var $this = $(this),
					context = $(this).data('context');

				$this.addClass('fpd-active').siblings().removeClass('fpd-active');
				$this.parent().next('.fpd-module-tabs-content').children().hide().filter('[data-context="'+context+'"]').show();

			});

			//add modules
			if(options.mainBarModules) {

				instance.mainBar = new FPDMainBar(
					instance,
					$mainBar,
					$modules,
					$uiElements.children('.fpd-draggable-dialog')
				);

			}

			//init Actions
			if(options.actions) {

				instance.actions = new FPDActions(instance, $uiElements.children('.fpd-actions'));

			}

			//init Toolbar
			instance.toolbar = new FPDToolbar($uiElements.children('.fpd-element-toolbar'), instance);

			$elem.on('elementSelect', function(evt, element) {

				if(element && instance.currentViewInstance) {

					//upload zone is selected
					if(element.uploadZone && !instance.mainOptions.editorMode) {

						element.set('borderColor', 'transparent');

						var customAdds = $.extend({}, instance.currentViewInstance.options.customAdds, element.customAdds ? element.customAdds : {});

						instance.mainBar.toggleUploadZoneAdds(customAdds);
						instance.mainBar.toggleUploadZonePanel();
						instance.currentViewInstance.currentUploadZone = element.title;

						return;
					}
					//if element has no upload zone and an upload zone is selected, close dialogs and call first module
					else if(instance.currentViewInstance.currentUploadZone) {

						instance.mainBar.toggleDialog(false);
						instance.mainBar.toggleUploadZonePanel(false);

					}

					instance.toolbar.update(element);
					_updateEditorBox(element);

				}
				else {

					instance.toolbar.toggle(false);
					$body.children('.fpd-element-toolbar').find('input').spectrum('destroy');

				}

			})
			.on('elementChange', function(evt, type, element) {

				instance.toolbar.toggle(false);

			})
			.on('elementModify', function(evt, element, parameters) {

				if(instance.productCreated && !instance.toolbar.isTransforming) {

					if(parameters.fontSize !== undefined) {
						instance.toolbar.updateUIValue('fontSize', Number(parameters.fontSize));
					}
					if(parameters.scaleX !== undefined) {
						instance.toolbar.updateUIValue('scaleX', parseFloat(Number(parameters.scaleX).toFixed(2)));
					}
					if(parameters.scaleY !== undefined) {
						instance.toolbar.updateUIValue('scaleY', parseFloat(Number(parameters.scaleY).toFixed(2)));
					}
					if(parameters.angle !== undefined) {
						instance.toolbar.updateUIValue('angle', parseInt(parameters.angle));
					}
					if(parameters.text !== undefined) {
						instance.toolbar.updateUIValue('text', parameters.text);
					}

					if(instance.currentElement && !instance.currentElement.uploadZone) {
						instance.toolbar.updatePosition(instance.currentElement);
					}

				}

			});

			//switchers
			$('.fpd-switch-container').click(function() {

				var $this = $(this);

				if($this.hasClass('fpd-curved-text-switcher')) {

					var z = instance.currentViewInstance.getZIndex(instance.currentElement),
						defaultText = instance.currentElement.getText(),
						parameters = instance.currentViewInstance.getElementJSON(instance.currentElement);

					parameters.z = z;
					parameters.curved = instance.currentElement.type == 'i-text';
					parameters.textAlign = 'center';

					function _onTextModeChanged(evt, textElement) {
						instance.currentViewInstance.stage.setActiveObject(textElement);
						$elem.off('elementAdd', _onTextModeChanged);

						setTimeout(function() {
							$('.fpd-tool-curved-text').click();
						}, 100);

					};
					$elem.on('elementAdd', _onTextModeChanged);

					instance.currentViewInstance.removeElement(instance.currentElement);
					instance.currentViewInstance.addElement('text', defaultText, defaultText, parameters);

				}
			});

			$('.fpd-dropdown').click(function() {

				$(this).toggleClass('fpd-active');

			});

			_ready();

		};

		$.get(options.templatesDirectory+'productdesigner.'+options.templatesType, anonymFuncs.loadProductDesignerTemplate);

	};

	var _ready = function() {

		if(instance.mainOptions.fonts && instance.mainOptions.fonts.length > 0 && typeof instance.mainOptions.fonts[0] === 'object') {

			var googleFonts = [];

			var $customFontsStyle = $('<style type="text/css" id="fpd-custom-fonts"></style>');
			instance.$container.before($customFontsStyle);

			instance.mainOptions.fonts.forEach(function(fontItem) {

				if(fontItem.hasOwnProperty('url')) {

					if(fontItem.url == 'google') { //from google fonts
						googleFonts.push(fontItem.name);
					}
					else { //custom fonts

						var fontFormat = fontItem.url.search('.woff') !== -1 ? 'woff' : 'TrueType';

						$customFontsStyle.append('@font-face {font-family:"'+fontItem.name+'"; src:url("'+fontItem.url+'") format("'+fontFormat+'");}');

					}

				}

			});

			if(googleFonts.length > 0) {

				WebFont.load({
					google: {
				    	families: googleFonts
				    }
				});

			}

		}

		//load watermark image
		if(instance.mainOptions.watermark && instance.mainOptions.watermark.length > 3) {

			fabric.Image.fromURL(instance.mainOptions.watermark, function(oImg) {
				instance.watermarkImg = oImg;
			});

		}

		if(instance.mainOptions.unsavedProductAlert) {

			window.onbeforeunload = function () {

				if(instance.doUnsavedAlert) {
					return '';
				}

			};

		}

		//store a boolean to detect if the text in textarea (toolbar) was selected, then dont deselect
		var _fixSelectionTextarea = false;

		//general close handler for modal
		$body.on('click', '.fpd-modal-close', function(evt) {

			var $this = $(this);

			if($this.parents('.fpd-modal-product-designer').length) {
				$body.addClass('fpd-modal-mode-active');
			}

			$this.parents('.fpd-modal-overlay').fadeOut(200, function() {
				$this.removeClass('fpd-fullscreen');
			});

			$body.removeClass('fpd-overflow-hidden');

			//modal product designer is closing
			if($this.parents('.fpd-modal-product-designer:first').length > 0) {
				instance.deselectElement();
			}

		})
		.on('mouseup touchend', function(evt) {

			var $target = $(evt.target);

			//deselect element if click outside of a fpd-container
			if($target.closest('.fpd-container, .fpd-element-toolbar, .sp-container').length === 0 &&
			   instance.mainOptions.deselectActiveOnOutside && !_fixSelectionTextarea) {
				   instance.deselectElement();
			}

			//close upload zone panel if click outside of fpd-container, needed otherwise elements can be added to upload zone e.g. mspc
			if($target.closest('.fpd-container').length === 0 && instance.currentViewInstance && instance.currentViewInstance.currentUploadZone && $stageLoader.is(':hidden')) {
				instance.mainBar.toggleUploadZonePanel(false);
			}

			_fixSelectionTextarea = false;

		})
		//thumbnail preview effect
		.on('mouseover mouseout mousemove', '[data-module="designs"] .fpd-item, [data-module="images"] .fpd-item', function(evt) {

			var $this = $(this),
				price = null;

			if(instance.currentViewInstance && instance.currentViewInstance.currentUploadZone && $(evt.target).parents('.fpd-upload-zone-adds-panel').length > 0) {
				var uploadZone = instance.currentViewInstance.getUploadZone(instance.currentViewInstance.currentUploadZone);
				if(uploadZone && uploadZone.price) {
					price = uploadZone.price;
				}
			}

			if(evt.type === 'mouseover' && $this.data('source')) {

				$thumbnailPreview = $('<div class="fpd-thumbnail-preview")"><picture></picture></div>');
				FPDUtil.loadGridImage($thumbnailPreview.children('picture'), $this.data('source'));

				//thumbnails in images module
				if($this.parents('[data-module="images"]:first').length > 0 && price === null) {

					if(instance.currentViewInstance && instance.currentViewInstance.options.customImageParameters.price) {
						price = instance.currentViewInstance.options.customImageParameters.price;
					}

				}
				//thumbnails in designs module
				else {

					if($this.data('title')) {
						$thumbnailPreview.addClass('fpd-title-enabled');
						$thumbnailPreview.append('<div class="fpd-preview-title">'+$this.data('title')+'</div>');
					}

					if($this.data('parameters') && $this.data('parameters').price && price === null) {
						price = $this.data('parameters').price;
					}

				}

				if(price) {
					var priceFormatted = instance.mainOptions.priceFormat.replace('%d', price);
					$thumbnailPreview.append('<div class="fpd-preview-price">'+priceFormatted+'</div>');
				}

				$body.append($thumbnailPreview);

			}
			else if($thumbnailPreview !== null && evt.type === 'mousemove') {

				var leftPos = evt.pageX + 10 + $thumbnailPreview.outerWidth() > $window.width() ? $window.width() - $thumbnailPreview.outerWidth() : evt.pageX + 10;
				$thumbnailPreview.css({left: leftPos, top: evt.pageY + 10})

			}
			else if($thumbnailPreview !== null && evt.type === 'mouseout') {

				$thumbnailPreview.siblings('.fpd-thumbnail-preview').remove();
				$thumbnailPreview.remove();

			}

		}).
		on('mousedown', function(evt) {

			var $target = $(evt.target);

			_fixSelectionTextarea = $target.is('textarea') && $target.data('control') ? true : false;

		});

		//load first product
		if(instance.mainOptions.loadFirstProductInStage && instance.products.length > 0 && !stageCleared) {
			instance.selectProduct(0);
		}
		else {
			instance.toggleSpinner(false);
		}
		
		$elem.trigger('ready');
		$window.resize();

	};

	//creates all products from HTML markup
	var _createProductsFromHTML = function($products, category) {

		var views = [];
		for(var i=0; i < $products.length; ++i) {

			//get other views
			views = $($products.get(i)).children('.fpd-product');
			//get first view
			views.splice(0,0,$products.get(i));

			var viewsArr = [];
			views.each(function(j, view) {

				var $view = $(view);
				var viewObj = {
					title: view.title,
					thumbnail: $view.data('thumbnail'),
					elements: [],
					options: $view.data('options') === undefined && typeof $view.data('options') !== 'object' ? options : fpdOptions.merge(options, $view.data('options'))
				};

				if(j === 0) {

					//get product thumbnail from first view
					if($view.data('producttitle')) {
						viewObj.productTitle = $view.data('producttitle');
					}

					//get product thumbnail from first view
					if($view.data('productthumbnail')) {
						viewObj.productThumbnail = $view.data('productthumbnail');
					}

					//PLUS: Store main element of the product
					viewObj.mainElement = $view.data('mainelement') ? $view.data('mainelement') : null;

				}

				$view.children('img,span').each(function(k, element) {

					var $element = $(element),
						source;

					if($element.is('img')) {
						source = $element.data('src') == undefined ? $element.attr('src') : $element.data('src');
					}
					else {
						source = $element.text()
					}

					var elementObj = {
						type: $element.is('img') ? 'image' : 'text', //type
						source: source, //source
						title: $element.attr('title'),  //title
						parameters: $element.data('parameters') == undefined || $element.data('parameters').length <= 2 ? {} : $element.data('parameters')  //parameters
					};

					viewObj.elements.push(elementObj);

				});

				viewsArr.push(viewObj);

			});

			instance.addProduct(viewsArr, category);

		}

	};

	var _snapToGrid = function(element) {

		if($('[data-action="snap"]').hasClass('fpd-active')) {

			var gridX = instance.mainOptions.snapGridSize[0] ? instance.mainOptions.snapGridSize[0] : 50,
				gridY = instance.mainOptions.snapGridSize[1] ? instance.mainOptions.snapGridSize[1] : 50,
				currentPosPoint = element.getPointByOrigin('left', 'top');
				point = new fabric.Point(element.padding + (Math.round(currentPosPoint.x / gridX) * gridX), element.padding + (Math.round(currentPosPoint.y / gridY) * gridY));

				element.setPositionByOrigin(point, 'left', 'top');

		}

	};

	//snap element to center
	var _snapToCenter = function(element) {

		if($('[data-action="snap"]').hasClass('fpd-active')) {

			var edgeDetectionX = instance.mainOptions.snapGridSize[0] ? instance.mainOptions.snapGridSize[0] : 50,
				edgeDetectionY = instance.mainOptions.snapGridSize[1] ? instance.mainOptions.snapGridSize[1] : 50,
				elementCenter = element.getCenterPoint(),
				stageCenter = {x: instance.currentViewInstance.options.stageWidth * .5, y: instance.currentViewInstance.options.stageHeight * .5};

			if(Math.abs(elementCenter.x - stageCenter.x) < edgeDetectionX) {

				element.setPositionByOrigin(new fabric.Point(stageCenter.x, elementCenter.y), 'center', 'center');
		       	instance.$mainWrapper.children('.fpd-snap-line-v').css('left', '50%' ).show();

		    }
		    else {
			     instance.$mainWrapper.children('.fpd-snap-line-v').hide();
		    }
		    if (Math.abs(elementCenter.y - stageCenter.y) < edgeDetectionY) {

			    elementCenter = element.getCenterPoint();
				element.setPositionByOrigin(new fabric.Point(elementCenter.x, stageCenter.y), 'center', 'center');
		        instance.$mainWrapper.children('.fpd-snap-line-h').css('top', '50%' ).show();

		    }
		    else {
			    instance.$mainWrapper.children('.fpd-snap-line-h').hide();
		    }

		}

	};

	//get category index by category name
	var _getCategoryIndexInTemplates = function(catName) {

		for(var i=0; i < instance.products.length; ++i) {

			if(instance.products[i].name === catName) {
				return i;
				break;
			}

		}

		return false;

	};

	//translates a HTML element
	var _translateElement = function($tag) {

		if(instance.langJson) {

			var objString = '';

			if($tag.attr('placeholder') !== undefined) {
				objString = $tag.attr('placeholder');
			}
			else if($tag.attr('title') !== undefined) {
				objString = $tag.attr('title');
			}
			else if($tag.data('title') !== undefined) {
				objString = $tag.data('title');
			}
			else {
				objString = $tag.text();
			}

			var keys = objString.split('.'),
				firstObject = instance.langJson[keys[0]],
				label = '';

			if(firstObject) { //check if object exists

				label = firstObject[keys[1]];

				if(label === undefined) { //if label does not exist in JSON, take default text
					label = $tag.data('defaulttext');
				}

			}
			else {
				label = $tag.data('defaulttext');
			}

			//store all translatable labels in json
			var sectionObj = instance.languageJSON[keys[0]];
			sectionObj[keys[1]] = label;

		}
		else {
			label = $tag.data('defaulttext');
		}

		if($tag.attr('placeholder') !== undefined) {
			$tag.attr('placeholder', label).text('');
		}
		else if($tag.attr('title') !== undefined) {
			$tag.attr('title', label);
		}
		else if($tag.data('title') !== undefined) {
			$tag.data('title', label);
		}
		else {
			$tag.text(label);
		}

	};

	var _toggleUndoRedoBtn = function(undos, redos) {

		if(undos.length === 0) {
		  	instance.$mainWrapper.find('[data-action="undo"]').addClass('fpd-disabled');
  		}
  		else {
	  		instance.$mainWrapper.find('[data-action="undo"]').removeClass('fpd-disabled');
  		}

  		if(redos.length === 0) {
	  		instance.$mainWrapper.find('[data-action="redo"]').addClass('fpd-disabled');
  		}
  		else {
	  		instance.$mainWrapper.find('[data-action="redo"]').removeClass('fpd-disabled');
  		}

	};

	var _updateEditorBox = function(element) {

		if($editorBox === null) {
			return;
		}

		$editorBox.children('div').empty();
		$editorBox.children('h5').text(element.title);

		for(var i=0; i < instance.mainOptions.editorBoxParameters.length; ++i) {

			var parameter = instance.mainOptions.editorBoxParameters[i],
				value = element[parameter];

			if(value !== undefined) {

				value = typeof value === 'number' ? value.toFixed(2) : value;
				value = (typeof value === 'object' && value.source) ? value.source.src : value;
				if(parameter === 'fill' && element.type === 'path-group') {
					value = element.svgFill;
				}

				$editorBox.children('div').append('<p><i>'+parameter+'</i>: <input type="text" value="'+value+'" readonly /></p>');

			}

		}

	};

	var _checkProductsLength = function() {

		if(instance.mainOptions.editorMode) { return; }

		if(instance.plainProducts.length === 0 || instance.plainProducts.length === 1) {
			instance.$container.addClass('fpd-products-module-hidden');
		}
		else {
			instance.$container.removeClass('fpd-products-module-hidden');
		}

	};

	var _onViewCreated = function() {

		//add all views of product till views end is reached
		if(instance.viewInstances.length < instance.currentViews.length) {
			instance.addView(instance.currentViews[instance.viewInstances.length]);

		}
		//all views added
		else {

			$elem.off('viewCreate', _onViewCreated);

			instance.toggleSpinner(false);
			instance.selectView(0);

			//search for object with auto-select
			if(!instance.mainOptions.editorMode && instance.currentViewInstance && $(instance.currentViewInstance.stage.getElement()).is(':visible')) {
				var viewElements = instance.currentViewInstance.stage.getObjects(),
					selectElement = null;

				for(var i=0; i < viewElements.length; ++i) {
					var obj = viewElements[i];

					 if(obj.autoSelect && !obj.hasUploadZone) {
					 	selectElement = obj;
					 }

				}
			}

			if(selectElement && instance.currentViewInstance) {
				setTimeout(function() {

					instance.currentViewInstance.stage.setActiveObject(selectElement);
					selectElement.setCoords();
					instance.currentViewInstance.stage.renderAll();

				}, 10);
			}


			instance.productCreated = true;
			
			$elem.trigger('productCreate', [instance.currentViews]);

		}

	};
	
	this.addProduct = function(views, category) {

		var catIndex = _getCategoryIndexInTemplates(category);

		if(catIndex === false) {

			catIndex = instance.products.length;
			instance.products[catIndex] = {name: category, products: []};
			instance.products[catIndex].products.push(views);

		}
		else {

			instance.products[catIndex].products.push(views);

		}

		this.plainProducts.push(views);

		_checkProductsLength();

	};
	
	this.selectProduct = function(index, categoryIndex) {

		instance.currentCategoryIndex = typeof categoryIndex === 'undefined' ? instance.currentCategoryIndex : categoryIndex;

		var category = instance.products[instance.currentCategoryIndex];

		instance.currentProductIndex = index;
		if(index < 0) { currentProductIndex = 0; }
		else if(index > category.products.length-1) { instance.currentProductIndex = category.products.length-1; }

		var product = category.products[instance.currentProductIndex];
		
		$elem.trigger('productSelect', [index, categoryIndex, product]);

		instance.loadProduct(product, options.replaceInitialElements);

	};
	
	
	this.loadProduct = function(views, replaceInitialElements) {

		replaceInitialElements = typeof replaceInitialElements !== 'undefined' ? replaceInitialElements : false;

		if($stageLoader.is(':hidden')) {
			instance.toggleSpinner(true);
		}

		//reset when loading a product
		instance.productCreated = productIsCustomized = false;
		instance.colorLinkGroups = {};

		if(replaceInitialElements) {

			nonInitials = [];
			nonInitials = instance.getCustomElements();

		}
		else {
			instance.doUnsavedAlert = false;
		}

		instance.clear();
		instance.currentViews = views;

		var viewSelectionHtml = '<div class="fpd-views-selection fpd-grid-contain fpd-clearfix"></div>';

		if($elem.hasClass('fpd-views-outside')) {
			instance.$viewSelectionWrapper = $elem.after(viewSelectionHtml).nextAll('.fpd-views-selection:first');
		}
		else {
			instance.$viewSelectionWrapper = instance.$mainWrapper.append(viewSelectionHtml).children('.fpd-views-selection:first');
		}

		$elem.on('viewCreate', _onViewCreated);

		if(instance.currentViews) {
			instance.addView(instance.currentViews[0]);
		}

	};
	
	this.addView = function(view) {

		instance.$viewSelectionWrapper.append('<div class="fpd-shadow-1 fpd-item fpd-tooltip" title="'+view.title+'"><picture style="background-image: url('+view.thumbnail+');"></picture></div>')
		.children('div:last').click(function(evt) {

			instance.selectView(instance.$viewSelectionWrapper.children('div').index($(this)));

		});

		view.options = $.extend({}, instance.mainOptions, view.options);
		var viewInstance = new FancyProductDesignerView(instance.$productStage, view, function(viewInstance) {

			//remove view instance if not added to product container
			if($(viewInstance.stage.wrapperEl).parent().length === 0) {
				viewInstance.clear();
				return;
			}

			if(instance.viewInstances.length == 0) {
				viewInstance.resetCanvasSize();
			}

			if(nonInitials.length > 0) {

				for(var i=0; i < nonInitials.length; ++i) {
					var object = nonInitials[i];
					if(object.viewIndex === instance.viewInstances.length) {

						var fpdElement = object.element;
						viewInstance.addElement(
							FPDUtil.getType(fpdElement.type),
							fpdElement.source,
							fpdElement.title,
							viewInstance.getElementJSON(fpdElement)
						);

					}

				}

			}

			instance.viewInstances.push(viewInstance);
			
			$elem.trigger('viewCreate', [viewInstance]);

		}, instance.mainOptions.fabricCanvasOptions);

		viewInstance.stage.on({

			'object:moving': function(opts) {

				var element = opts.target;

				if(!element.lockMovementX || !element.lockMovementY) {
					_snapToGrid(element);
					_snapToCenter(element);
				}

			}

		});

		_viewInstances.push(viewInstance);

		$(viewInstance)
		.on('elementAdd', function(evt, element) {

			if(!element) {
				return;
			}
			
			if(element.colorLinkGroup && element.colorLinkGroup.length > 0) {

				var viewIndex = this.getIndex();

				if(instance.colorLinkGroups.hasOwnProperty(element.colorLinkGroup)) {
				
					instance.colorLinkGroups[element.colorLinkGroup].elements.push({id: element.id, viewIndex: viewIndex});

					if(typeof element.colors === 'object') {
					
						var concatArray = instance.colorLinkGroups[element.colorLinkGroup].colors.concat(element.colors);
						
						instance.colorLinkGroups[element.colorLinkGroup].colors = FPDUtil.arrayUnique(concatArray);

					}

				}
				else {
				
					instance.colorLinkGroups[element.colorLinkGroup] = {elements: [{id:element.id, viewIndex: viewIndex}], colors: []};

					if(typeof element.colors === 'object') {

						instance.colorLinkGroups[element.colorLinkGroup].colors = element.colors;

					}

				}

			}
			
			if(instance.productCreated && instance.mainOptions.hideDialogOnAdd && instance.$container.hasClass('fpd-topbar') && instance.mainBar) {

				instance.mainBar.toggleDialog(false);

			}
			
			$elem.trigger('elementAdd', [element]);

		})
		.on('boundingBoxToggle', function(evt, currentBoundingObject, addRemove) {
		
			$elem.trigger('boundingBoxToggle', [currentBoundingObject, addRemove]);

		})
		.on('elementSelect', function(evt, element) {

			instance.currentElement = element;

			if(element) {

			}
			else {

				if(instance.$elementTooltip) {
					instance.$elementTooltip.hide();
				}

				instance.$mainWrapper.children('.fpd-snap-line-h, .fpd-snap-line-v').hide();

			}
			
			$elem.trigger('elementSelect', [element]);

		})
		.on('elementChange', function(evt, type, element) {

			_updateEditorBox(element.getBoundingRect());
			
			$elem.trigger('elementChange', [type, element]);

		})
		.on('elementModify', function(evt, element, parameters) {
		
			$elem.trigger('elementModify', [element, parameters]);

		})
		.on('undoRedoSet', function(evt, undos, redos) {

			instance.doUnsavedAlert = productIsCustomized = true;
			_toggleUndoRedoBtn(undos, redos);
			
			$elem.trigger('undoRedoSet', [undos, redos]);

		})
		.on('priceChange', function(evt, price, viewPrice) {

			instance.currentPrice = instance.singleProductPrice = 0;
			
			for(var i=0; i < _viewInstances.length; ++i) {

				instance.singleProductPrice += _viewInstances[i].totalPrice;

			}

			instance.currentPrice = instance.singleProductPrice * instance.orderQuantity;
			
			$elem.trigger('priceChange', [price, instance.currentPrice, instance.singleProductPrice]);

		})
		.on('elementCheckContainemt', function(evt, element, boundingBoxMode) {

			if(boundingBoxMode === 'inside') {

				if(element.isOut) {

					instance.$elementTooltip.css({
						left: element.oCoords.mb.x,
						top: element.oCoords.tl.y - instance.$elementTooltip.outerHeight() - 20 + instance.$productStage.position().top
					}).show();

				}
				else {
					instance.$elementTooltip.hide();
				}

			}


		})
		.on('elementColorChange', function(evt, element, hex, colorLinking) {

			if(instance.productCreated && colorLinking && element.colorLinkGroup && element.colorLinkGroup.length > 0 && element.type !== 'path-group') {

				var group = instance.colorLinkGroups[element.colorLinkGroup];
				if(group && group.elements) {
					for(var i=0; i < group.elements.length; ++i) {

						var id = group.elements[i].id,
							viewIndex = group.elements[i].viewIndex,
							target = instance.getElementByID(id, viewIndex);

						if(target && target !== element && hex) {
							instance.viewInstances[viewIndex].changeColor(target, hex, false, false);
						}

					}
				}

			}

		})
		.on('elementRemove', function(evt, element) {
		
			$elem.trigger('elementRemove', [element]);

		});

		viewInstance.setup();

		FPDUtil.updateTooltip();

		instance.$viewSelectionWrapper.children().length > 1 ? instance.$viewSelectionWrapper.show() : instance.$viewSelectionWrapper.hide();

	};
	
	this.selectView = function(index) {

		if(instance.currentViews === null) {return;}

		instance.currentViewIndex = index;
		if(index < 0) { instance.currentViewIndex = 0; }
		else if(index > instance.currentViews.length-1) { instance.currentViewIndex = instance.currentViews.length-1; }

		instance.$viewSelectionWrapper.children('div').removeClass('fpd-view-active')
		.eq(index).addClass('fpd-view-active');

		instance.$mainWrapper.children('.fpd-ruler').remove();

		if(instance.currentViewInstance) {
			//delete all undos/redos
			instance.currentViewInstance.undos = [];
			instance.currentViewInstance.redos = [];

			//remove some objects
			var removeObjs = ['_snap_lines_group', '_ruler_hor', '_ruler_ver'];
			for(var i=0; i<removeObjs.length; ++i) {
				var removeObj = instance.currentViewInstance.getElementByID(removeObjs[i]);
				if(removeObj) {
					instance.currentViewInstance.stage.remove(removeObj);
				}
			}

		}

		instance.currentViewInstance = instance.viewInstances[instance.currentViewIndex];

		instance.deselectElement();

		//select view wrapper and render stage of view
		instance.$productStage.children('.fpd-view-stage').addClass('fpd-hidden').eq(instance.currentViewIndex).removeClass('fpd-hidden');
		instance.currentViewInstance.stage.renderAll();

		//toggle custom adds
		if($mainBar && $mainBar.find('.fpd-navigation').length) {
			var viewOpts = instance.currentViewInstance.options,
				$nav = $mainBar.find('.fpd-navigation');

			$nav.children('[data-module="designs"]').toggleClass('fpd-disabled', !viewOpts.customAdds.designs);
			$nav.children('[data-module="images"]').toggleClass('fpd-disabled', !viewOpts.customAdds.uploads);
			$nav.children('[data-module="text"]').toggleClass('fpd-disabled', !viewOpts.customAdds.texts);

			//PLUS
			if(typeof FPDNamesNumbersModule !== 'undefined') {
				$nav.children('[data-module="names-numbers"]').toggleClass('fpd-disabled', !instance.currentViewInstance.textPlaceholder && !instance.currentViewInstance.numberPlaceholder);
			}
			$nav.children('[data-module="drawing"]').toggleClass('fpd-disabled', !viewOpts.customAdds.drawing);


			//select nav item, if topbar layout is not used, no active item is set and active item is not disabled
			if((!$elem.hasClass('fpd-topbar') && $nav.children('.fpd-active').length === 0) || $nav.children('.fpd-active').hasClass('fpd-disabled')) {
				$nav.children(':not(.fpd-disabled)').first().click();
			}

			//if products module is hidden and selected, select next
			if(instance.$container.hasClass('fpd-products-module-hidden') && $nav.children('.fpd-active').filter('[data-module="products"]').length > 0) {
				$nav.children(':not(.fpd-disabled)').eq(1).click();
			}

		}
		
		
		instance.$productStage.width(instance.currentViewInstance.options.stageWidth);
		instance.currentViewInstance.resetCanvasSize();

		if(instance.$container.filter('[class*="fpd-off-canvas-"]').length > 0) {
			instance.mainBar.$content.height(instance.$mainWrapper.height());
		}

		_toggleUndoRedoBtn(instance.currentViewInstance.undos, instance.currentViewInstance.redos);
		
		$elem.trigger('viewSelect', [instance.currentViewIndex, instance.currentViewInstance]);

	};
	
	this.addElement = function(type, source, title, parameters, viewIndex) {

		viewIndex = typeof viewIndex !== 'undefined' ? viewIndex : instance.currentViewIndex;
		parameters = typeof parameters !== 'undefined' ? parameters : {};

		instance.viewInstances[viewIndex].addElement(type, source, title, parameters);

		//element should be replaced in all views
		if(parameters.replace && parameters.replaceInAllViews) {

			for(var i=0; i < instance.viewInstances.length; ++i) {

				var viewInstance = instance.viewInstances[i];
				//check if not current view and view has at least one element with the replace value
				if(viewIndex !== i && viewInstance.getElementByReplace(parameters.replace) !== null) {
					viewInstance.addElement(type, source, title, parameters, i);
				}

			}

		}

	};
	
	this.setElementParameters = function(parameters, element, viewIndex) {

		element = typeof element === 'undefined' ? instance.stage.getActiveObject() : element;

		if(!element || parameters === undefined) {
			return false;
		}

		viewIndex = typeof viewIndex === 'undefined' ? instance.currentViewIndex : viewIndex;

		instance.viewInstances[viewIndex].setElementParameters(parameters, element);

	};
	
	this.clear = function() {

		if(instance.currentViews === null) { return; }

		$elem.off('viewCreate', _onViewCreated);

		instance.deselectElement();
		instance.resetZoom();
		instance.currentViewIndex = instance.currentPrice = instance.singleProductPrice = 0;
		instance.currentViewInstance = instance.currentViews = instance.currentElement = null;

		instance.$mainWrapper.find('.fpd-view-stage').remove();
		$body.find('.fpd-views-selection').remove();

		instance.viewInstances = [];
		_viewInstances = [];
		
		$elem.trigger('clear');
		$elem.trigger('priceChange', [0, 0, 0]);
		stageCleared = true;

	}; 
	this.deselectElement = function() {

		if(instance.currentViewInstance) {

			instance.currentViewInstance.deselectElement();

		}

	}; 
	this.getProductDataURL = function(callback, backgroundColor, options) {

		callback = typeof callback !== 'undefined' ? callback : function() {};
		backgroundColor = typeof backgroundColor !== 'undefined' ? backgroundColor : 'transparent';
		options = typeof options !== 'undefined' ? options : {};
		options.onlyExportable = typeof options.onlyExportable !== 'undefined' ? options.onlyExportable : false;

		//check
		if(instance.viewInstances.length === 0) { callback('') }

		$body.append('<canvas id="fpd-hidden-canvas"></canvas>');

		var printCanvas = new fabric.Canvas('fpd-hidden-canvas', {
				containerClass: 'fpd-hidden fpd-hidden-canvas',
				enableRetinaScaling: false
			}),
			viewCount = 0;

		function _addCanvasImage(viewInstance) {

			if(viewInstance.options.stageWidth > printCanvas.getWidth()) {
				printCanvas.setDimensions({width: viewInstance.options.stageWidth});
			}

			viewInstance.toDataURL(function(dataURL) {

				fabric.Image.fromURL(dataURL, function(img) {

					printCanvas.add(img);

					if(viewCount > 0) {
						img.setTop(printCanvas.getHeight());
						printCanvas.setDimensions({height: (printCanvas.getHeight() + viewInstance.options.stageHeight)});
					}

					viewCount++;
					if(viewCount < instance.viewInstances.length) {
						_addCanvasImage(instance.viewInstances[viewCount]);
					}
					else {
						callback(printCanvas.toDataURL(options)); 
					}

				});

			}, backgroundColor, {onlyExportable: options.onlyExportable}, instance.watermarkImg);

		};

		var firstView = instance.viewInstances[0];
		printCanvas.setDimensions({width: firstView.options.stageWidth, height: firstView.options.stageHeight});
		_addCanvasImage(firstView);

	};
	
	this.getProductCard = function(callback, backgroundColor, options) {

		callback = typeof callback !== 'undefined' ? callback : function() {};
		backgroundColor = typeof backgroundColor !== 'undefined' ? backgroundColor : 'transparent';
		options = typeof options !== 'undefined' ? options : {};
		options.onlyExportable = typeof options.onlyExportable !== 'undefined' ? options.onlyExportable : false;

		//check
		if(instance.viewInstances.length === 0) { callback('') }

		$body.append('<canvas id="fpd-hidden-canvas"></canvas>');

		var printCanvas = new fabric.Canvas('fpd-hidden-canvas', {
				containerClass: 'fpd-hidden fpd-hidden-canvas',
				enableRetinaScaling: false
			}),
			viewCount = 0,leftView = 20; 
		
		var handL = "https://printyuk.com/js/otfjs/images/handL.png";
		var handR = "https://printyuk.com/js/otfjs/images/handR.png";
	
		var shadow = {
            color: 'rgba(0,0,0,0.6)',
            blur: 20,    
            offsetX: 10,
            offsetY: 10,
            opacity: 0.6,
            fillShadow: true, 
            strokeShadow: true 
        }
        
		function _addCanvasImage(viewInstance) { 

			viewInstance.toDataURL(function(dataURL) {
                
        		if(instance.viewInstances.length == 1){
        		    
    				fabric.Image.fromURL(dataURL, function(img) {
    				    var scaleImg;
    				    if(img.width > img.height){
                            img.scaleToWidth(650);
    				    } else {
                            img.scaleToHeight(450);  
    				    }
                        
                        img.setShadow(shadow);
    					printCanvas.add(img); 
    				    
                        printCanvas.centerObject(img);  
    				    
    				    var poswidth = img.getWidth();
    				    var posHeight = img.getHeight(); 
    				    var pullLeft1 = 500 - (poswidth/2) - 185, pullLeft2 = 500 + (poswidth/2)- 63;  
                        
                        
    					fabric.Image.fromURL(handL, function(imgs) {  
                            imgs.scaleToWidth(250).set({left: pullLeft1,top: posHeight});    
                		   	printCanvas.add(imgs);   
                		}); 
    					fabric.Image.fromURL(handR, function(imgx) {  
                            imgx.scaleToWidth(250).set({left: pullLeft2,top: posHeight});    
                			printCanvas.add(imgx);  
                			
                            printCanvas.renderAll();
        					callback(printCanvas.toDataURL(options));  
                		}); 
                			
    
    				});
        		} else if(instance.viewInstances.length == 2){ 
        		    
    				fabric.Image.fromURL(dataURL, function(img) {  
    				    var posOpt = {left: 100,top: 100};
    				    if(viewCount > 0){
    				        posOpt = {left: 550,top: 100};
    				    }  
    				    
    				    if(img.width > img.height){
                            img.scaleToWidth(350).set(posOpt);  
    				    } else {
                            img.scaleToHeight(350).set(posOpt);
                            
    				    }
                        img.setShadow(shadow);
    					printCanvas.add(img); 
    				    
    				    var poswidth = img.getWidth();
    				    var posHeight = img.getHeight();
    				    
    				    var pullLeft = 838;
    				    if(img.width < img.height){
    				        pullLeft = 550 + poswidth - 62; 
                            
    				    }
       
    					viewCount++;
    					if(viewCount < instance.viewInstances.length) { 
    						_addCanvasImage(instance.viewInstances[viewCount]);
    					}
    					else {  
    					    fabric.Image.fromURL(handL, function(imgs) {  
                                imgs.scaleToWidth(250).set({left: -86,top: posHeight});    
                		    	printCanvas.add(imgs);   
                			}); 
    					    fabric.Image.fromURL(handR, function(imgx) {  
                                imgx.scaleToWidth(250).set({left: pullLeft,top: posHeight});    
                				printCanvas.add(imgx);   
    				            callback(printCanvas.toDataURL(options)); 
                			}); 
    					}
    
    				});
    				
    				
        		} else {
        		    
    				fabric.Image.fromURL(dataURL, function(img) {   
        				
        				var leftR = instance.viewInstances.length * 20;
        				var widthR = ((1000 - leftR)/instance.viewInstances.length);
        				leftView = leftView + (widthR * viewCount);
        				var posOpt = {left: leftView,top: 100}; 
        				    
                        img.scaleToWidth(widthR).set(posOpt);   
                        img.setShadow(shadow);
    					printCanvas.add(img); 
    
    					viewCount++;
    					if(viewCount < instance.viewInstances.length) {
    						_addCanvasImage(instance.viewInstances[viewCount]);
    					}
    					else {
    					    printCanvas.renderAll();
    				        callback(printCanvas.toDataURL(options)); 
    					}
    
    				});
        		    
        		}

			}, backgroundColor, {onlyExportable: options.onlyExportable}, instance.watermarkImg);

		};

		var firstView = instance.viewInstances[0];
        printCanvas.setDimensions({width: 1000,height: 583}); 
        fabric.Image.fromURL("https://printyuk.com/js/otfjs/images/canvasbg.jpeg", function(img) {
			printCanvas.add(img);   
		}); 
		_addCanvasImage(firstView);

	}; 
	
	this.getViewsDataURL = function(callback, backgroundColor, options) {

		callback = typeof callback !== 'undefined' ? callback : function() {};
		backgroundColor = typeof backgroundColor !== 'undefined' ? backgroundColor : 'transparent';
		options = typeof options !== 'undefined' ? options : {};

		var dataURLs = [];

		for(var i=0; i < instance.viewInstances.length; ++i) {

			instance.viewInstances[i].toDataURL(function(dataURL) {

				dataURLs.push(dataURL);

				if(dataURLs.length === instance.viewInstances.length) {
					callback(dataURLs);
				}

			}, backgroundColor, options, instance.watermarkImg);

		}

	};


	this.getViewsSVG = function(options, reviver) {

		var SVGs = [];

		for(var i=0; i < instance.viewInstances.length; ++i) {
			SVGs.push(instance.viewInstances[i].toSVG(options, reviver));
		}

		return SVGs;

	};

	this.toggleSpinner = function(state, msg) {

		state = typeof state === 'undefined' ? true : state;
		msg = typeof msg === 'undefined' ? '' : msg;

		if(state) {

			$stageLoader.fadeIn(300).find('.fpd-loader-text').text(msg);

		}
		else {

			$stageLoader.stop().fadeOut(300);

		}

	};


	this.getElementByTitle = function(title, viewIndex) {

		if(typeof viewIndex === 'undefined') {
			//scans all view instances
			for(var i=0; i < instance.viewInstances.length; ++i) {
				var objects = instance.viewInstances[i].stage.getObjects();
				for(var j = 0; j < objects.length; ++j) {
					if(objects[j].title == title) {
						return objects[j];
						break;
					}
				}
			}

		}
		else {
			//scans the view instance by index
			var objects = instance.viewInstances[viewIndex].stage.getObjects();
			for(var i = 0; i < objects.length; ++i) {
				if(objects[i].title == title) {
					return objects[i];
					break;
				}
			}

		}

	};


	this.getElements = function(viewIndex) {

		this.deselectElement();

		if(typeof viewIndex === 'undefined') {

			var allElements = [];

			for(var i=0; i < instance.viewInstances.length; ++i) {
				allElements.push(instance.viewInstances[i].stage.getObjects());
			}

			return allElements;

		}
		else {

			return instance.viewInstances[viewIndex].stage.getObjects();

		}

	};

	this.print = function() {

		_createPopupImage = function(dataURLs) {

			var images = new Array(),
				imageLoop = 0;

			//load all images first
			for(var i=0; i < dataURLs.length; ++i) {

				var image = new Image();
				image.src = dataURLs[i];
				image.onload = function() {

					images.push(this);
					imageLoop++;

					//add images to popup and print popup
					if(imageLoop == dataURLs.length) {

						var popup = window.open('','','width='+images[0].width+',height='+(images[0].height*dataURLs.length)+',location=no,menubar=no,scrollbars=yes,status=no,toolbar=no');
						FPDUtil.popupBlockerAlert(popup, instance);

						popup.document.title = "Print Image";
						for(var j=0; j < images.length; ++j) {
							$(popup.document.body).append('<img src="'+images[j].src+'" />');
						}

						setTimeout(function() {
							popup.print();
						}, 1000);

					}
				}

			}

		};

		instance.getViewsDataURL(_createPopupImage);

	};


	this.createImage = function(openInBlankPage, forceDownload, backgroundColor, options) {

		if(typeof(openInBlankPage)==='undefined') openInBlankPage = true;
		if(typeof(forceDownload)==='undefined') forceDownload = false;
		backgroundColor = typeof backgroundColor !== 'undefined' ? backgroundColor : 'transparent';
		options = typeof options !== 'undefined' ? options : {};
		format = options.format === undefined ? 'png' : options.format;

		instance.getProductDataURL(function(dataURL) {

			var image = new Image();
			image.src = dataURL;

			image.onload = function() {

				if(openInBlankPage) {

					var popup = window.open('','_blank');
					FPDUtil.popupBlockerAlert(popup, instance);

					popup.document.title = "Product Image";
					$(popup.document.body).append('<img src="'+this.src+'" download="product.'+format+'" />');

					if(forceDownload) {
						window.location.href = popup.document.getElementsByTagName('img')[0].src.replace('image/'+format+'', 'image/octet-stream');
					}
				}

			}

		}, backgroundColor, options);


	};

	this.setZoom = function(value) {

		zoomReseted = false;
		this.deselectElement();

		if(instance.currentViewInstance) {

			var responsiveScale = instance.currentViewInstance.responsiveScale;

			var point = new fabric.Point(instance.currentViewInstance.stage.getWidth() * 0.5, instance.currentViewInstance.stage.getHeight() * 0.5);

			instance.currentViewInstance.stage.zoomToPoint(point, value * responsiveScale);

			if(value == 1) {
				instance.resetZoom();
			}

		}


	};
 
	this.resetZoom = function() {

		zoomReseted = true;
		this.deselectElement();

		if(instance.currentViewInstance) {

			var responsiveScale = instance.currentViewInstance.responsiveScale;

			instance.currentViewInstance.stage.zoomToPoint(new fabric.Point(0, 0), responsiveScale);
			instance.currentViewInstance.stage.absolutePan(new fabric.Point(0, 0));

		}

	};

 
	this.getElementByID = function(id, viewIndex) {

		viewIndex = typeof viewIndex === 'undefined' ? instance.currentViewIndex : viewIndex;

		return instance.viewInstances[viewIndex].getElementByID(id);

	};

 
	this.getProduct = function(onlyEditableElements, customizationRequired) {

		onlyEditableElements = typeof onlyEditableElements !== 'undefined' ? onlyEditableElements : false;
		customizationRequired = typeof customizationRequired !== 'undefined' ? customizationRequired : false;

		if(customizationRequired && !productIsCustomized) {
			FPDUtil.showModal(instance.getTranslation('misc', 'customization_required_info'));
			return false;
		}

		this.deselectElement();
		this.resetZoom();

		instance.doUnsavedAlert = false;

		//check if an element is out of his containment
		var viewElements = this.getElements();
		for(var i=0; i < viewElements.length; ++i) {

			for(var j=0; j < viewElements[i].length; ++j) {

				var element = viewElements[i][j];
				if(element.isOut && element.boundingBoxMode === 'inside') {
					FPDUtil.showModal(element.title+': '+instance.getTranslation('misc', 'out_of_bounding_box'));
					return false;
				}

			}

		}

		var product = [];
		//add views
		for(var i=0; i < instance.viewInstances.length; ++i) {
			var viewInstance = instance.viewInstances[i],
				relevantViewOpts = {
					stageWidth: viewInstance.options.stageWidth,
					stageHeight: viewInstance.options.stageHeight,
					customAdds: viewInstance.options.customAdds
				};
				var scaling = FPDUtil.getScalingByDimesions(viewInstance.options.stageWidth, viewInstance.options.stageHeight, 200, 200);
				var thumbnail = viewInstance.stage.toDataURL({multiplier: scaling, format: 'png'});

			product.push({
				title: viewInstance.title,
				thumbnail: thumbnail,
				elements: [],
				options: relevantViewOpts,
				names_numbers: viewInstance.names_numbers
			});
		}

		for(var i=0; i < viewElements.length; ++i) {

			for(var j=0; j < viewElements[i].length; ++j) {
				var element = viewElements[i][j];

				if(element.title !== undefined && element.source !== undefined) {
					var jsonItem = {
						title: element.title,
						source: element.source,
						parameters: instance.viewInstances[i].getElementJSON(element),
						type: FPDUtil.getType(element.type)
					};

					if(onlyEditableElements) {
						if(element.isEditable) {
							product[i].elements.push(jsonItem);
						}
					}
					else {
						product[i].elements.push(jsonItem);
					}
				}
			}
		}

		//returns an array with all views
		return product;

	};

 
	this.getTranslation = function(section, label) {

		if(instance.langJson) {

			section = instance.langJson[section];

			if(section) {
				return section[label];
			}

		}

		return '';

	};

 
	this.getCustomElements = function(type) {

		type = typeof type === 'undefined' ? 'all' : type;

		var views = this.getElements(),
			customElements = [];

		for(var i=0; i< views.length; ++i) {
			var elements = views[i];

			for(var j=0; j < elements.length; ++j) {
				var element = elements[j],
					fpdElement = null;

				if(element.isCustom) {

					if(type === 'image' || type === 'text') { //only image or text elements

						if(FPDUtil.getType(element.type) === type) {
							customElements.push({element: element, viewIndex: i});
						}

					}
					else { //get all custom added elements
						customElements.push({element: element, viewIndex: i});
					}

				}

			}


		}

		return customElements;

	};
 
	this.addCustomImage = function(source, title) {

		var image = new Image;
    		image.src = source;

    	this.toggleSpinner();

		image.onload = function() {

			instance._loadingCustomImage = false;

			var imageH = this.height,
				imageW = this.width,
				currentCustomImageParameters = instance.currentViewInstance.options.customImageParameters,
				imageParts = this.src.split('.'),
				scaling = 1;

			if(!FPDUtil.checkImageDimensions(instance, imageW, imageH)) {
				instance.toggleSpinner(false);
    			return false;
			}

			scaling = FPDUtil.getScalingByDimesions(
				imageW,
				imageH,
				currentCustomImageParameters.resizeToW,
				currentCustomImageParameters.resizeToH
			);

			var fixedParams = {
				scaleX: scaling,
				scaleY: scaling,
				isCustom: true
			};

			if($.inArray('svg', imageParts) != -1) {
				fixedParams.colors = true;
			}

			instance.addElement(
    			'image',
    			source,
    			title,
	    		$.extend({}, currentCustomImageParameters, fixedParams)
    		);


    		instance.toggleSpinner(false);
    		FPDUtil.showMessage(instance.getTranslation('misc', 'image_added'));

		}

		image.onerror = function(evt) {
			FPDUtil.showModal('Image could not be loaded!');
		}

	};
 
	this.setDimensions = function(width, height) {

		options.stageWidth = instance.mainOptions.stageWidth = width;
		options.stageHeight = instance.mainOptions.stageHeight = height;

		instance.$container.find('.fpd-product-stage').width(width);
		for(var i=0; i < instance.viewInstances.length; ++i) {

			instance.viewInstances[i].options.stageWidth = width;
			instance.viewInstances[i].options.stageHeight = height;
			instance.viewInstances[i].resetCanvasSize();

		}

		if(instance.$container.filter('[class*="fpd-off-canvas-"]').length > 0) {
			instance.mainBar.$content.height(instance.$mainWrapper.height());
		}

	}; 
	
	this.setOrderQuantity = function(quantity) {

		quantity = quantity == '' || quantity < 0 ? 1 : quantity;
		instance.orderQuantity = quantity;
		instance.currentPrice = instance.singleProductPrice * instance.orderQuantity;

		$elem.trigger('priceChange', [null, instance.currentPrice, instance.singleProductPrice]);

	}; 
	
	this.getOrder = function(options) {

		options = typeof options === 'undefined' ? {} : options;

		instance._order.product = instance.getProduct(
			options.onlyEditableElements || false,
			options.customizationRequired || false
		);

		instance._order.usedFonts = instance.getUsedFonts();

		$elem.trigger('getOrder');

		return instance._order;

	}; 
	
	this.getUsedFonts = function() {

		var views = this.getElements(),
			_usedFonts = [], //temp to check if already included
			usedFonts = [];

		for(var i=0; i< views.length; ++i) {
			var elements = views[i];

			for(var j=0; j < elements.length; ++j) {
				var element = elements[j];

				if(FPDUtil.getType(element.type) === 'text') {

					if(_usedFonts.indexOf(element.fontFamily) === -1) {

						var fontObj = {name: element.fontFamily},
							//grep font entry
							result = $.grep(instance.mainOptions.fonts, function(e){
								return e.name == element.fontFamily;
							});

						//check if result contains props and url prop
						if(result.length > 0 && result[0].url) {
							fontObj.url = result[0].url;
						}

						_usedFonts.push(element.fontFamily);
						usedFonts.push(fontObj);


					}

				}

			}


		}

		return usedFonts;

	};

	_initialize();

}; 
if(this.JpegMeta)throw Error("Library included multiple times");var JpegMeta={};JpegMeta.stringIsClean=function(e){for(var t=0;t<e.length;t++)if(e.charCodeAt(t)<32)return!1;return!0},JpegMeta.parseNum=function(e,t,i,a){var r,n,o=">"===e;for(void 0===i&&(i=0),void 0===a&&(a=t.length-i),r=o?i:i+a-1;o?i+a>r:r>=i;o?r++:r--)n<<=8,n+=t.charCodeAt(r);return n},JpegMeta.parseSnum=function(e,t,i,a){var r,n,o,s=">"===e;for(void 0===i&&(i=0),void 0===a&&(a=t.length-i),r=s?i:i+a-1;s?i+a>r:r>=i;s?r++:r--)void 0===o&&(o=128===(128&t.charCodeAt(r))),n<<=8,n+=o?255&~t.charCodeAt(r):t.charCodeAt(r);return o&&(n+=1,n*=-1),n},JpegMeta.Rational=function(e,t){return this.num=e,this.den=t||1,this},JpegMeta.Rational.prototype.toString=function(){return 0===this.num?""+this.num:1===this.den?""+this.num:1===this.num?this.num+" / "+this.den:this.num/this.den},JpegMeta.Rational.prototype.asFloat=function(){return this.num/this.den},JpegMeta.MetaGroup=function(e,t){return this.fieldName=e,this.description=t,this.metaProps={},this},JpegMeta.MetaGroup.prototype._addProperty=function(e,t,i){var a=new JpegMeta.MetaProp(e,t,i);this[a.fieldName]=a,this.metaProps[a.fieldName]=a},JpegMeta.MetaGroup.prototype.toString=function(){return"[MetaGroup "+this.description+"]"},JpegMeta.MetaProp=function(e,t,i){return this.fieldName=e,this.description=t,this.value=i,this},JpegMeta.MetaProp.prototype.toString=function(){return""+this.value},this.JpegMeta.JpegFile=function(e,t){var i=this._SOS;this.metaGroups={},this._binary_data=e,this.filename=t;var a,r,n,o,s,l,p,u=0,d=0;if(this._binary_data.slice(0,2)!==this._SOI_MARKER)throw new Error("Doesn't look like a JPEG file. First two bytes are "+this._binary_data.charCodeAt(0)+","+this._binary_data.charCodeAt(1)+".");for(u+=2;u<this._binary_data.length&&(a=this._binary_data.charCodeAt(u++),r=this._binary_data.charCodeAt(u++),d=u,a==this._DELIM)&&r!==i;){for(s=JpegMeta.parseNum(">",this._binary_data,u,2),u+=s;u<this._binary_data.length;)if(a=this._binary_data.charCodeAt(u++),a==this._DELIM&&(n=this._binary_data.charCodeAt(u++),0!=n)){u-=2;break}o=u-d,this._markers[r]?(l=this._markers[r][0],p=this._markers[r][1]):(l="UNKN",p=void 0),p&&this[p](r,d+2,o-2)}if(void 0===this.general)throw Error("Invalid JPEG file.");return this},this.JpegMeta.JpegFile.prototype.toString=function(){return"[JpegFile "+this.filename+" "+this.general.type+" "+this.general.pixelWidth+"x"+this.general.pixelHeight+" Depth: "+this.general.depth+"]"},this.JpegMeta.JpegFile.prototype._SOI_MARKER="ÿØ",this.JpegMeta.JpegFile.prototype._DELIM=255,this.JpegMeta.JpegFile.prototype._EOI=217,this.JpegMeta.JpegFile.prototype._SOS=218,this.JpegMeta.JpegFile.prototype._sofHandler=function(e,t){if(void 0!==this.general)throw Error("Unexpected multiple-frame image");this._addMetaGroup("general","General"),this.general._addProperty("depth","Depth",JpegMeta.parseNum(">",this._binary_data,t,1)),this.general._addProperty("pixelHeight","Pixel Height",JpegMeta.parseNum(">",this._binary_data,t+1,2)),this.general._addProperty("pixelWidth","Pixel Width",JpegMeta.parseNum(">",this._binary_data,t+3,2)),this.general._addProperty("type","Type",this._markers[e][2])},this.JpegMeta.JpegFile.prototype._commentHandler=function(e,t,i){var a,r;for(t++,i--,a=t,r="";t+i>a;)r+=String.fromCharCode(this._binary_data.charCodeAt(a)),a++;this._addMetaGroup("comment","Comment"),this.comment._addProperty("comment","Comment",r)},this.JpegMeta.JpegFile.prototype._JFIF_IDENT="JFIF\x00",this.JpegMeta.JpegFile.prototype._JFXX_IDENT="JFXX\x00",this.JpegMeta.JpegFile.prototype._EXIF_IDENT="Exif\x00",this.JpegMeta.JpegFile.prototype._types={1:["BYTE",1],2:["ASCII",1],3:["SHORT",2],4:["LONG",4],5:["RATIONAL",8],6:["SBYTE",1],7:["UNDEFINED",1],8:["SSHORT",2],9:["SLONG",4],10:["SRATIONAL",8],11:["FLOAT",4],12:["DOUBLE",8]},this.JpegMeta.JpegFile.prototype._tifftags={256:["Image width","ImageWidth"],257:["Image height","ImageLength"],258:["Number of bits per component","BitsPerSample"],259:["Compression scheme","Compression",{1:"uncompressed",6:"JPEG compression"}],262:["Pixel composition","PhotmetricInerpretation",{2:"RGB",6:"YCbCr"}],274:["Orientation of image","Orientation",{1:"Normal",2:"Reverse?",3:"Upside-down",4:"Upside-down Reverse",5:"90 degree CW",6:"90 degree CW reverse",7:"90 degree CCW",8:"90 degree CCW reverse"}],277:["Number of components","SamplesPerPixel"],284:["Image data arrangement","PlanarConfiguration",{1:"chunky format",2:"planar format"}],530:["Subsampling ratio of Y to C","YCbCrSubSampling"],531:["Y and C positioning","YCbCrPositioning",{1:"centered",2:"co-sited"}],282:["X Resolution","XResolution"],283:["Y Resolution","YResolution"],296:["Resolution Unit","ResolutionUnit",{2:"inches",3:"centimeters"}],273:["Image data location","StripOffsets"],278:["Number of rows per strip","RowsPerStrip"],279:["Bytes per compressed strip","StripByteCounts"],513:["Offset to JPEG SOI","JPEGInterchangeFormat"],514:["Bytes of JPEG Data","JPEGInterchangeFormatLength"],301:["Transfer function","TransferFunction"],318:["White point chromaticity","WhitePoint"],319:["Chromaticities of primaries","PrimaryChromaticities"],529:["Color space transformation matrix coefficients","YCbCrCoefficients"],532:["Pair of black and white reference values","ReferenceBlackWhite"],306:["Date and time","DateTime"],270:["Image title","ImageDescription"],271:["Make","Make"],272:["Model","Model"],305:["Software","Software"],315:["Person who created the image","Artist"],316:["Host Computer","HostComputer"],33432:["Copyright holder","Copyright"],34665:["Exif tag","ExifIfdPointer"],34853:["GPS tag","GPSInfoIfdPointer"]},this.JpegMeta.JpegFile.prototype._exiftags={36864:["Exif Version","ExifVersion"],40960:["FlashPix Version","FlashpixVersion"],40961:["Color Space","ColorSpace"],37121:["Meaning of each component","ComponentsConfiguration"],37122:["Compressed Bits Per Pixel","CompressedBitsPerPixel"],40962:["Pixel X Dimension","PixelXDimension"],40963:["Pixel Y Dimension","PixelYDimension"],37500:["Manufacturer notes","MakerNote"],37510:["User comments","UserComment"],40964:["Related audio file","RelatedSoundFile"],36867:["Date Time Original","DateTimeOriginal"],36868:["Date Time Digitized","DateTimeDigitized"],37520:["DateTime subseconds","SubSecTime"],37521:["DateTimeOriginal subseconds","SubSecTimeOriginal"],37522:["DateTimeDigitized subseconds","SubSecTimeDigitized"],33434:["Exposure time","ExposureTime"],33437:["FNumber","FNumber"],34850:["Exposure program","ExposureProgram"],34852:["Spectral sensitivity","SpectralSensitivity"],34855:["ISO Speed Ratings","ISOSpeedRatings"],34856:["Optoelectric coefficient","OECF"],37377:["Shutter Speed","ShutterSpeedValue"],37378:["Aperture Value","ApertureValue"],37379:["Brightness","BrightnessValue"],37380:["Exposure Bias Value","ExposureBiasValue"],37381:["Max Aperture Value","MaxApertureValue"],37382:["Subject Distance","SubjectDistance"],37383:["Metering Mode","MeteringMode"],37384:["Light Source","LightSource"],37385:["Flash","Flash"],37386:["Focal Length","FocalLength"],37396:["Subject Area","SubjectArea"],41483:["Flash Energy","FlashEnergy"],41484:["Spatial Frequency Response","SpatialFrequencyResponse"],41486:["Focal Plane X Resolution","FocalPlaneXResolution"],41487:["Focal Plane Y Resolution","FocalPlaneYResolution"],41488:["Focal Plane Resolution Unit","FocalPlaneResolutionUnit"],41492:["Subject Location","SubjectLocation"],41493:["Exposure Index","ExposureIndex"],41495:["Sensing Method","SensingMethod"],41728:["File Source","FileSource"],41729:["Scene Type","SceneType"],41730:["CFA Pattern","CFAPattern"],41985:["Custom Rendered","CustomRendered"],41986:["Exposure Mode","Exposure Mode"],41987:["White Balance","WhiteBalance"],41988:["Digital Zoom Ratio","DigitalZoomRatio"],41989:["Focal length in 35 mm film","FocalLengthIn35mmFilm"],41990:["Scene Capture Type","SceneCaptureType"],41991:["Gain Control","GainControl"],41992:["Contrast","Contrast"],41993:["Saturation","Saturation"],41994:["Sharpness","Sharpness"],41995:["Device settings description","DeviceSettingDescription"],41996:["Subject distance range","SubjectDistanceRange"],42016:["Unique image ID","ImageUniqueID"],40965:["Interoperability tag","InteroperabilityIFDPointer"]},this.JpegMeta.JpegFile.prototype._gpstags={0:["GPS tag version","GPSVersionID"],1:["North or South Latitude","GPSLatitudeRef"],2:["Latitude","GPSLatitude"],3:["East or West Longitude","GPSLongitudeRef"],4:["Longitude","GPSLongitude"],5:["Altitude reference","GPSAltitudeRef"],6:["Altitude","GPSAltitude"],7:["GPS time (atomic clock)","GPSTimeStamp"],8:["GPS satellites usedd for measurement","GPSSatellites"],9:["GPS receiver status","GPSStatus"],10:["GPS mesaurement mode","GPSMeasureMode"],11:["Measurement precision","GPSDOP"],12:["Speed unit","GPSSpeedRef"],13:["Speed of GPS receiver","GPSSpeed"],14:["Reference for direction of movement","GPSTrackRef"],15:["Direction of movement","GPSTrack"],16:["Reference for direction of image","GPSImgDirectionRef"],17:["Direction of image","GPSImgDirection"],18:["Geodetic survey data used","GPSMapDatum"],19:["Reference for latitude of destination","GPSDestLatitudeRef"],20:["Latitude of destination","GPSDestLatitude"],21:["Reference for longitude of destination","GPSDestLongitudeRef"],22:["Longitude of destination","GPSDestLongitude"],23:["Reference for bearing of destination","GPSDestBearingRef"],24:["Bearing of destination","GPSDestBearing"],25:["Reference for distance to destination","GPSDestDistanceRef"],26:["Distance to destination","GPSDestDistance"],27:["Name of GPS processing method","GPSProcessingMethod"],28:["Name of GPS area","GPSAreaInformation"],29:["GPS Date","GPSDateStamp"],30:["GPS differential correction","GPSDifferential"]},this.JpegMeta.JpegFile.prototype._iptctags={0:["Record Version","recordVersion"],3:["Object Type Reference","objectType"],4:["Object Attribute Reference","objectAttribute"],5:["Object Name","objectName"],7:["Edit Status","editStatus"],8:["Editorial Update","editorialUpdate"],10:["Urgency","urgency"],12:["Subject Reference","subjectRef"],15:["Category","category"],20:["Supplemental Category","supplCategory"],22:["Fixture Identifier","fixtureID"],25:["Keywords","keywords"],26:["Content Location Code","contentLocCode"],27:["Content Location Name","contentLocName"],30:["Release Date","releaseDate"],35:["Release Time","releaseTime"],37:["Expiration Date","expirationDate"],38:["Expiration Time","expirationTime"],40:["Special Instructions","specialInstructions"],42:["Action Advised","actionAdvised"],45:["Reference Service","refService"],47:["Reference Date","refDate"],50:["Reference Number","refNumber"],55:["Date Created","dateCreated"],60:["Time Created","timeCreated"],62:["Digital Creation Date","digitalCreationDate"],63:["Digital Creation Time","digitalCreationTime"],65:["Originating Program","originatingProgram"],70:["Program Version","programVersion"],75:["Object Cycle","objectCycle"],80:["By-line","byline"],85:["By-line Title","bylineTitle"],90:["City","city"],92:["Sub-location","sublocation"],95:["Province/State","state"],100:["Country Code","countryCode"],101:["Country Name","countryName"],103:["Original Transmission Reference","origTransRef"],105:["Headline","headline"],110:["Credit","credit"],115:["Source","source"],116:["Copyright Notice","copyrightNotice"],118:["Contact","contact"],120:["Caption/Abstract","caption"],122:["Writer/Editor","writerEditor"],125:["Rasterized Caption","rasterizedCaption"],130:["Image Type","imageType"],131:["Image Orientation","imageOrientation"],135:["Language Identifier","languageID"],150:["Audio Type","audioType"],151:["Audio Sampling Rate","audioSamplingRate"],152:["Audio Sampling Resolution","audioSamplingRes"],153:["Audio Duration","audioDuration"],154:["Audio Outcue","audioOutcue"],200:["Preview File Format","previewFileFormat"],201:["Preview File Format Version","previewFileFormatVer"],202:["Preview Data","previewData"]},this.JpegMeta.JpegFile.prototype._markers={192:["SOF0","_sofHandler","Baseline DCT"],193:["SOF1","_sofHandler","Extended sequential DCT"],194:["SOF2","_sofHandler","Progressive DCT"],195:["SOF3","_sofHandler","Lossless (sequential)"],197:["SOF5","_sofHandler","Differential sequential DCT"],198:["SOF6","_sofHandler","Differential progressive DCT"],199:["SOF7","_sofHandler","Differential lossless (sequential)"],200:["JPG",null,"Reserved for JPEG extensions"],201:["SOF9","_sofHandler","Extended sequential DCT"],202:["SOF10","_sofHandler","Progressive DCT"],203:["SOF11","_sofHandler","Lossless (sequential)"],205:["SOF13","_sofHandler","Differential sequential DCT"],206:["SOF14","_sofHandler","Differential progressive DCT"],207:["SOF15","_sofHandler","Differential lossless (sequential)"],196:["DHT",null,"Define Huffman table(s)"],204:["DAC",null,"Define arithmetic coding conditioning(s)"],208:["RST0",null,"Restart with modulo 8 count �0�"],209:["RST1",null,"Restart with modulo 8 count �1�"],210:["RST2",null,"Restart with modulo 8 count �2�"],211:["RST3",null,"Restart with modulo 8 count �3�"],212:["RST4",null,"Restart with modulo 8 count �4�"],213:["RST5",null,"Restart with modulo 8 count �5�"],214:["RST6",null,"Restart with modulo 8 count �6�"],215:["RST7",null,"Restart with modulo 8 count �7�"],216:["SOI",null,"Start of image"],217:["EOI",null,"End of image"],218:["SOS",null,"Start of scan"],219:["DQT",null,"Define quantization table(s)"],220:["DNL",null,"Define number of lines"],221:["DRI",null,"Define restart interval"],222:["DHP",null,"Define hierarchical progression"],223:["EXP",null,"Expand reference component(s)"],224:["APP0","_app0Handler","Reserved for application segments"],225:["APP1","_app1Handler"],226:["APP2",null],227:["APP3",null],228:["APP4",null],229:["APP5",null],230:["APP6",null],231:["APP7",null],232:["APP8",null],233:["APP9",null],234:["APP10",null],235:["APP11",null],236:["APP12",null],237:["IPTC","_iptcHandler","IPTC Photo Metadata"],238:["APP14",null],239:["APP15",null],240:["JPG0",null],241:["JPG1",null],242:["JPG2",null],243:["JPG3",null],244:["JPG4",null],245:["JPG5",null],246:["JPG6",null],247:["JPG7",null],248:["JPG8",null],249:["JPG9",null],250:["JPG10",null],251:["JPG11",null],252:["JPG12",null],253:["JPG13",null],254:["COM","_commentHandler","Comment"],1:["JPG13",null]},this.JpegMeta.JpegFile.prototype._addMetaGroup=function(e,t){var i=new JpegMeta.MetaGroup(e,t);return this[i.fieldName]=i,this.metaGroups[i.fieldName]=i,i},this.JpegMeta.JpegFile.prototype._parseIfd=function(e,t,i,a,r,n,o){var s,l,p,u,d,g,c,m,h,f,S,P=JpegMeta.parseNum(e,t,i+a,2);S=this._addMetaGroup(n,o);for(var _=0;P>_;_++)if(s=i+a+2+12*_,l=JpegMeta.parseNum(e,t,s,2),u=JpegMeta.parseNum(e,t,s+2,2),g=JpegMeta.parseNum(e,t,s+4,4),c=JpegMeta.parseNum(e,t,s+8,4),void 0!==this._types[u]){if(p=this._types[u][0],d=this._types[u][1],c=4>=d*g?s+8:i+c,"UNDEFINED"==p)m=void 0;else if("ASCII"==p)m=t.slice(c,c+g),m=m.split("\x00")[0],JpegMeta.stringIsClean(m)||(m="");else{m=new Array;for(var y=0;g>y;y++,c+=d)("BYTE"==p||"SHORT"==p||"LONG"==p)&&m.push(JpegMeta.parseNum(e,t,c,d)),("SBYTE"==p||"SSHORT"==p||"SLONG"==p)&&m.push(JpegMeta.parseSnum(e,t,c,d)),"RATIONAL"==p&&(h=JpegMeta.parseNum(e,t,c,4),f=JpegMeta.parseNum(e,t,c+4,4),m.push(new JpegMeta.Rational(h,f))),"SRATIONAL"==p&&(h=JpegMeta.parseSnum(e,t,c,4),f=JpegMeta.parseSnum(e,t,c+4,4),m.push(new JpegMeta.Rational(h,f))),m.push();1===g&&(m=m[0])}r.hasOwnProperty(l)?S._addProperty(r[l][1],r[l][0],m):console.log("WARNING(jpegmeta.js): Unknown tag: ",l)}},this.JpegMeta.JpegFile.prototype._jfifHandler=function(e,t){if(void 0!==this.jfif)throw Error("Multiple JFIF segments found");this._addMetaGroup("jfif","JFIF"),this.jfif._addProperty("version_major","Version Major",this._binary_data.charCodeAt(t+5)),this.jfif._addProperty("version_minor","Version Minor",this._binary_data.charCodeAt(t+6)),this.jfif._addProperty("version","JFIF Version",this.jfif.version_major.value+"."+this.jfif.version_minor.value),this.jfif._addProperty("units","Density Unit",this._binary_data.charCodeAt(t+7)),this.jfif._addProperty("Xdensity","X density",JpegMeta.parseNum(">",this._binary_data,t+8,2)),this.jfif._addProperty("Ydensity","Y Density",JpegMeta.parseNum(">",this._binary_data,t+10,2)),this.jfif._addProperty("Xthumbnail","X Thumbnail",JpegMeta.parseNum(">",this._binary_data,t+12,1)),this.jfif._addProperty("Ythumbnail","Y Thumbnail",JpegMeta.parseNum(">",this._binary_data,t+13,1))},this.JpegMeta.JpegFile.prototype._app0Handler=function(e,t){var i=this._binary_data.slice(t,t+5);i==this._JFIF_IDENT?this._jfifHandler(e,t):i==this._JFXX_IDENT},this.JpegMeta.JpegFile.prototype._app1Handler=function(e,t){var i=this._binary_data.slice(t,t+5);i==this._EXIF_IDENT&&this._exifHandler(e,t+6)};
JpegMeta.JpegFile.prototype._exifHandler=function(t,i){if(void 0!==this.exif)throw new Error("Multiple JFIF segments found");var a,e,s,f=this._binary_data.slice(i,i+2);if("II"===f)a="<";else{if("MM"!==f)throw new Error("Malformed TIFF meta-data. Unknown endianess: "+f);a=">"}if(e=JpegMeta.parseNum(a,this._binary_data,i+2,2),42!==e)throw new Error("Malformed TIFF meta-data. Bad magic: "+e);if(s=JpegMeta.parseNum(a,this._binary_data,i+4,4),this._parseIfd(a,this._binary_data,i,s,this._tifftags,"tiff","TIFF"),this.tiff.ExifIfdPointer&&this._parseIfd(a,this._binary_data,i,this.tiff.ExifIfdPointer.value,this._exiftags,"exif","Exif"),this.tiff.GPSInfoIfdPointer){if(this._parseIfd(a,this._binary_data,i,this.tiff.GPSInfoIfdPointer.value,this._gpstags,"gps","GPS"),this.gps.GPSLatitude){var d;d=this.gps.GPSLatitude.value[0].asFloat()+1/60*this.gps.GPSLatitude.value[1].asFloat()+1/3600*this.gps.GPSLatitude.value[2].asFloat(),"S"===this.gps.GPSLatitudeRef.value&&(d=-d),this.gps._addProperty("latitude","Dec. Latitude",d)}if(this.gps.GPSLongitude){var r;r=this.gps.GPSLongitude.value[0].asFloat()+1/60*this.gps.GPSLongitude.value[1].asFloat()+1/3600*this.gps.GPSLongitude.value[2].asFloat(),"W"===this.gps.GPSLongitudeRef.value&&(r=-r),this.gps._addProperty("longitude","Dec. Longitude",r)}}};
this.JpegMeta.JpegFile.prototype._iptcHandler=function(a,t,e){this._addMetaGroup("iptc","IPTC");for(var i,p,r,s,_="<",d=JpegMeta.parseNum(_,this._binary_data,t+4,1),c=28,n=2,g=0;e>g;g++)if(p=t+g,JpegMeta.parseNum(_,this._binary_data,p,1)==n){if(s=JpegMeta.parseNum(_,this._binary_data,p+1,1),tag_desc=this._iptctags[s],!tag_desc)continue;for(d=0,i=2;e>i&&JpegMeta.parseNum(_,this._binary_data,p+i,1)!=c&&JpegMeta.parseNum(_,this._binary_data,p+i+1,1)!=n;)i++,d++;if(!d)continue;r=this._binary_data.slice(t+g+2,t+g+2+d),r=r.replace("\x00","").trim(),this.iptc._addProperty(tag_desc[1],tag_desc[0],r),g+=d-1}};
"function"!=typeof Object.create&&(Object.create=function(o){function e(){}return e.prototype=o,new e}),function($,o,e,i){var t={init:function(o,e){var i=this;i.elem=e,i.$elem=$(e),i.imageSrc=i.$elem.data("zoom-image")?i.$elem.data("zoom-image"):i.$elem.attr("src"),i.options=$.extend({},$.fn.elevateZoom.options,o),i.options.tint&&(i.options.lensColour="none",i.options.lensOpacity="1"),"inner"==i.options.zoomType&&(i.options.showLens=!1),i.$elem.parent().removeAttr("title").removeAttr("alt"),i.zoomImage=i.imageSrc,i.refresh(1),$("#"+i.options.gallery+" a").click(function(o){return i.options.galleryActiveClass&&($("#"+i.options.gallery+" a").removeClass(i.options.galleryActiveClass),$(this).addClass(i.options.galleryActiveClass)),o.preventDefault(),$(this).data("zoom-image")?i.zoomImagePre=$(this).data("zoom-image"):i.zoomImagePre=$(this).data("image"),i.swaptheimage($(this).data("image"),i.zoomImagePre),!1})},refresh:function(o){var e=this;setTimeout(function(){e.fetch(e.imageSrc)},o||e.options.refresh)},fetch:function(o){var e=this,i=new Image;i.onload=function(){e.largeWidth=i.width,e.largeHeight=i.height,e.startZoom(),e.currentImage=e.imageSrc,e.options.onZoomedImageLoaded(e.$elem)},i.src=o},startZoom:function(){var o=this;if(o.nzWidth=o.$elem.width(),o.nzHeight=o.$elem.height(),o.isWindowActive=!1,o.isLensActive=!1,o.isTintActive=!1,o.overWindow=!1,o.options.imageCrossfade&&(o.zoomWrap=o.$elem.wrap('<div style="height:'+o.nzHeight+"px;width:"+o.nzWidth+'px;" class="zoomWrapper" />'),o.$elem.css("position","absolute")),o.zoomLock=1,o.scrollingLock=!1,o.changeBgSize=!1,o.currentZoomLevel=o.options.zoomLevel,o.nzOffset=o.$elem.offset(),o.widthRatio=o.largeWidth/o.currentZoomLevel/o.nzWidth,o.heightRatio=o.largeHeight/o.currentZoomLevel/o.nzHeight,"window"==o.options.zoomType&&(o.zoomWindowStyle="overflow: hidden;background-position: 0px 0px;text-align:center;background-color: "+String(o.options.zoomWindowBgColour)+";width: "+String(o.options.zoomWindowWidth)+"px;height: "+String(o.options.zoomWindowHeight)+"px;float: left;background-size: "+o.largeWidth/o.currentZoomLevel+"px "+o.largeHeight/o.currentZoomLevel+"px;display: none;z-index:100;border: "+String(o.options.borderSize)+"px solid "+o.options.borderColour+";background-repeat: no-repeat;position: absolute;"),"inner"==o.options.zoomType){var e=o.$elem.css("border-left-width");o.zoomWindowStyle="overflow: hidden;margin-left: "+String(e)+";margin-top: "+String(e)+";background-position: 0px 0px;width: "+String(o.nzWidth)+"px;height: "+String(o.nzHeight)+"px;px;float: left;display: none;cursor:"+o.options.cursor+";px solid "+o.options.borderColour+";background-repeat: no-repeat;position: absolute;"}"window"==o.options.zoomType&&(o.nzHeight<o.options.zoomWindowWidth/o.widthRatio?lensHeight=o.nzHeight:lensHeight=String(o.options.zoomWindowHeight/o.heightRatio),o.largeWidth<o.options.zoomWindowWidth?lensWidth=o.nzWidth:lensWidth=o.options.zoomWindowWidth/o.widthRatio,o.lensStyle="background-position: 0px 0px;width: "+String(o.options.zoomWindowWidth/o.widthRatio)+"px;height: "+String(o.options.zoomWindowHeight/o.heightRatio)+"px;float: right;display: none;overflow: hidden;z-index: 999;-webkit-transform: translateZ(0);opacity:"+o.options.lensOpacity+";filter: alpha(opacity = "+100*o.options.lensOpacity+"); zoom:1;width:"+lensWidth+"px;height:"+lensHeight+"px;background-color:"+o.options.lensColour+";cursor:"+o.options.cursor+";border: "+o.options.lensBorderSize+"px solid "+o.options.lensBorderColour+";background-repeat: no-repeat;position: absolute;"),o.tintStyle="display: block;position: absolute;background-color: "+o.options.tintColour+";filter:alpha(opacity=0);opacity: 0;width: "+o.nzWidth+"px;height: "+o.nzHeight+"px;",o.lensRound="","lens"==o.options.zoomType&&(o.lensStyle="background-position: 0px 0px;float: left;display: none;border: "+String(o.options.borderSize)+"px solid "+o.options.borderColour+";width:"+String(o.options.lensSize)+"px;height:"+String(o.options.lensSize)+"px;background-repeat: no-repeat;position: absolute;"),"round"==o.options.lensShape&&(o.lensRound="border-top-left-radius: "+String(o.options.lensSize/2+o.options.borderSize)+"px;border-top-right-radius: "+String(o.options.lensSize/2+o.options.borderSize)+"px;border-bottom-left-radius: "+String(o.options.lensSize/2+o.options.borderSize)+"px;border-bottom-right-radius: "+String(o.options.lensSize/2+o.options.borderSize)+"px;"),o.zoomContainer=$('<div class="zoomContainer" style="-webkit-transform: translateZ(0);position:absolute;left:'+o.nzOffset.left+"px;top:"+o.nzOffset.top+"px;height:"+o.nzHeight+"px;width:"+o.nzWidth+'px;"></div>'),$("body").append(o.zoomContainer),o.options.containLensZoom&&"lens"==o.options.zoomType&&o.zoomContainer.css("overflow","hidden"),"inner"!=o.options.zoomType&&(o.zoomLens=$("<div class='zoomLens' style='"+o.lensStyle+o.lensRound+"'>&nbsp;</div>").appendTo(o.zoomContainer).click(function(){o.$elem.trigger("click")}),o.options.tint&&(o.tintContainer=$("<div/>").addClass("tintContainer"),o.zoomTint=$("<div class='zoomTint' style='"+o.tintStyle+"'></div>"),o.zoomLens.wrap(o.tintContainer),o.zoomTintcss=o.zoomLens.after(o.zoomTint),o.zoomTintImage=$('<img style="position: absolute; left: 0px; top: 0px; max-width: none; width: '+o.nzWidth+"px; height: "+o.nzHeight+'px;" src="'+o.imageSrc+'">').appendTo(o.zoomLens).click(function(){o.$elem.trigger("click")}))),isNaN(o.options.zoomWindowPosition)?o.zoomWindow=$("<div style='z-index:999;left:"+o.windowOffsetLeft+"px;top:"+o.windowOffsetTop+"px;"+o.zoomWindowStyle+"' class='zoomWindow'>&nbsp;</div>").appendTo("body").click(function(){o.$elem.trigger("click")}):o.zoomWindow=$("<div style='z-index:999;left:"+o.windowOffsetLeft+"px;top:"+o.windowOffsetTop+"px;"+o.zoomWindowStyle+"' class='zoomWindow'>&nbsp;</div>").appendTo(o.zoomContainer).click(function(){o.$elem.trigger("click")}),o.zoomWindowContainer=$("<div/>").addClass("zoomWindowContainer").css("width",o.options.zoomWindowWidth),o.zoomWindow.wrap(o.zoomWindowContainer),"lens"==o.options.zoomType&&o.zoomLens.css({backgroundImage:"url('"+o.imageSrc+"')"}),"window"==o.options.zoomType&&o.zoomWindow.css({backgroundImage:"url('"+o.imageSrc+"')"}),"inner"==o.options.zoomType&&o.zoomWindow.css({backgroundImage:"url('"+o.imageSrc+"')"}),o.$elem.bind("touchmove",function(e){e.preventDefault();var i=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0];o.setPosition(i)}),o.zoomContainer.bind("touchmove",function(e){"inner"==o.options.zoomType&&o.showHideWindow("show"),e.preventDefault();var i=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0];o.setPosition(i)}),o.zoomContainer.bind("touchend",function(e){o.showHideWindow("hide"),o.options.showLens&&o.showHideLens("hide"),o.options.tint&&"inner"!=o.options.zoomType&&o.showHideTint("hide")}),o.$elem.bind("touchend",function(e){o.showHideWindow("hide"),o.options.showLens&&o.showHideLens("hide"),o.options.tint&&"inner"!=o.options.zoomType&&o.showHideTint("hide")}),o.options.showLens&&(o.zoomLens.bind("touchmove",function(e){e.preventDefault();var i=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0];o.setPosition(i)}),o.zoomLens.bind("touchend",function(e){o.showHideWindow("hide"),o.options.showLens&&o.showHideLens("hide"),o.options.tint&&"inner"!=o.options.zoomType&&o.showHideTint("hide")})),o.$elem.bind("mousemove",function(e){0==o.overWindow&&o.setElements("show"),(o.lastX!==e.clientX||o.lastY!==e.clientY)&&(o.setPosition(e),o.currentLoc=e),o.lastX=e.clientX,o.lastY=e.clientY}),o.zoomContainer.bind("mousemove",function(e){0==o.overWindow&&o.setElements("show"),(o.lastX!==e.clientX||o.lastY!==e.clientY)&&(o.setPosition(e),o.currentLoc=e),o.lastX=e.clientX,o.lastY=e.clientY}),"inner"!=o.options.zoomType&&o.zoomLens.bind("mousemove",function(e){(o.lastX!==e.clientX||o.lastY!==e.clientY)&&(o.setPosition(e),o.currentLoc=e),o.lastX=e.clientX,o.lastY=e.clientY}),o.options.tint&&"inner"!=o.options.zoomType&&o.zoomTint.bind("mousemove",function(e){(o.lastX!==e.clientX||o.lastY!==e.clientY)&&(o.setPosition(e),o.currentLoc=e),o.lastX=e.clientX,o.lastY=e.clientY}),"inner"==o.options.zoomType&&o.zoomWindow.bind("mousemove",function(e){(o.lastX!==e.clientX||o.lastY!==e.clientY)&&(o.setPosition(e),o.currentLoc=e),o.lastX=e.clientX,o.lastY=e.clientY}),o.zoomContainer.add(o.$elem).mouseenter(function(){0==o.overWindow&&o.setElements("show")}).mouseleave(function(){o.scrollLock||(o.setElements("hide"),o.options.onDestroy(o.$elem))}),"inner"!=o.options.zoomType&&o.zoomWindow.mouseenter(function(){o.overWindow=!0,o.setElements("hide")}).mouseleave(function(){o.overWindow=!1}),1!=o.options.zoomLevel,o.options.minZoomLevel?o.minZoomLevel=o.options.minZoomLevel:o.minZoomLevel=2*o.options.scrollZoomIncrement,o.options.scrollZoom&&o.zoomContainer.add(o.$elem).bind("mousewheel DOMMouseScroll MozMousePixelScroll",function(e){o.scrollLock=!0,clearTimeout($.data(this,"timer")),$.data(this,"timer",setTimeout(function(){o.scrollLock=!1},250));var i=e.originalEvent.wheelDelta||-1*e.originalEvent.detail;return e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault(),i/120>0?o.currentZoomLevel>=o.minZoomLevel&&o.changeZoomLevel(o.currentZoomLevel-o.options.scrollZoomIncrement):o.options.maxZoomLevel?o.currentZoomLevel<=o.options.maxZoomLevel&&o.changeZoomLevel(parseFloat(o.currentZoomLevel)+o.options.scrollZoomIncrement):o.changeZoomLevel(parseFloat(o.currentZoomLevel)+o.options.scrollZoomIncrement),!1})},setElements:function(o){var e=this;return e.options.zoomEnabled?("show"==o&&e.isWindowSet&&("inner"==e.options.zoomType&&e.showHideWindow("show"),"window"==e.options.zoomType&&e.showHideWindow("show"),e.options.showLens&&e.showHideLens("show"),e.options.tint&&"inner"!=e.options.zoomType&&e.showHideTint("show")),void("hide"==o&&("window"==e.options.zoomType&&e.showHideWindow("hide"),e.options.tint||e.showHideWindow("hide"),e.options.showLens&&e.showHideLens("hide"),e.options.tint&&e.showHideTint("hide")))):!1},setPosition:function(o){var e=this;return e.options.zoomEnabled?(e.nzHeight=e.$elem.height(),e.nzWidth=e.$elem.width(),e.nzOffset=e.$elem.offset(),e.options.tint&&"inner"!=e.options.zoomType&&(e.zoomTint.css({top:0}),e.zoomTint.css({left:0})),e.options.responsive&&!e.options.scrollZoom&&e.options.showLens&&(e.nzHeight<e.options.zoomWindowWidth/e.widthRatio?lensHeight=e.nzHeight:lensHeight=String(e.options.zoomWindowHeight/e.heightRatio),e.largeWidth<e.options.zoomWindowWidth?lensWidth=e.nzWidth:lensWidth=e.options.zoomWindowWidth/e.widthRatio,e.widthRatio=e.largeWidth/e.nzWidth,e.heightRatio=e.largeHeight/e.nzHeight,"lens"!=e.options.zoomType&&(e.nzHeight<e.options.zoomWindowWidth/e.widthRatio?lensHeight=e.nzHeight:lensHeight=String(e.options.zoomWindowHeight/e.heightRatio),e.nzWidth<e.options.zoomWindowHeight/e.heightRatio?lensWidth=e.nzWidth:lensWidth=String(e.options.zoomWindowWidth/e.widthRatio),e.zoomLens.css("width",lensWidth),e.zoomLens.css("height",lensHeight),e.options.tint&&(e.zoomTintImage.css("width",e.nzWidth),e.zoomTintImage.css("height",e.nzHeight))),"lens"==e.options.zoomType&&e.zoomLens.css({width:String(e.options.lensSize)+"px",height:String(e.options.lensSize)+"px"})),e.zoomContainer.css({top:e.nzOffset.top}),e.zoomContainer.css({left:e.nzOffset.left}),e.mouseLeft=parseInt(o.pageX-e.nzOffset.left),e.mouseTop=parseInt(o.pageY-e.nzOffset.top),"window"==e.options.zoomType&&(e.Etoppos=e.mouseTop<e.zoomLens.height()/2,e.Eboppos=e.mouseTop>e.nzHeight-e.zoomLens.height()/2-2*e.options.lensBorderSize,e.Eloppos=e.mouseLeft<0+e.zoomLens.width()/2,e.Eroppos=e.mouseLeft>e.nzWidth-e.zoomLens.width()/2-2*e.options.lensBorderSize),"inner"==e.options.zoomType&&(e.Etoppos=e.mouseTop<e.nzHeight/2/e.heightRatio,e.Eboppos=e.mouseTop>e.nzHeight-e.nzHeight/2/e.heightRatio,e.Eloppos=e.mouseLeft<0+e.nzWidth/2/e.widthRatio,e.Eroppos=e.mouseLeft>e.nzWidth-e.nzWidth/2/e.widthRatio-2*e.options.lensBorderSize),e.mouseLeft<0||e.mouseTop<0||e.mouseLeft>e.nzWidth||e.mouseTop>e.nzHeight?void e.setElements("hide"):(e.options.showLens&&(e.lensLeftPos=String(Math.floor(e.mouseLeft-e.zoomLens.width()/2)),e.lensTopPos=String(Math.floor(e.mouseTop-e.zoomLens.height()/2))),e.Etoppos&&(e.lensTopPos=0),e.Eloppos&&(e.windowLeftPos=0,e.lensLeftPos=0,e.tintpos=0),"window"==e.options.zoomType&&(e.Eboppos&&(e.lensTopPos=Math.max(e.nzHeight-e.zoomLens.height()-2*e.options.lensBorderSize,0)),e.Eroppos&&(e.lensLeftPos=e.nzWidth-e.zoomLens.width()-2*e.options.lensBorderSize)),"inner"==e.options.zoomType&&(e.Eboppos&&(e.lensTopPos=Math.max(e.nzHeight-2*e.options.lensBorderSize,0)),e.Eroppos&&(e.lensLeftPos=e.nzWidth-e.nzWidth-2*e.options.lensBorderSize)),"lens"==e.options.zoomType&&(e.windowLeftPos=String(-1*((o.pageX-e.nzOffset.left)*e.widthRatio-e.zoomLens.width()/2)),e.windowTopPos=String(-1*((o.pageY-e.nzOffset.top)*e.heightRatio-e.zoomLens.height()/2)),e.zoomLens.css({backgroundPosition:e.windowLeftPos+"px "+e.windowTopPos+"px"}),e.changeBgSize&&(e.nzHeight>e.nzWidth?("lens"==e.options.zoomType&&e.zoomLens.css({"background-size":e.largeWidth/e.newvalueheight+"px "+e.largeHeight/e.newvalueheight+"px"}),e.zoomWindow.css({"background-size":e.largeWidth/e.newvalueheight+"px "+e.largeHeight/e.newvalueheight+"px"})):("lens"==e.options.zoomType&&e.zoomLens.css({"background-size":e.largeWidth/e.newvaluewidth+"px "+e.largeHeight/e.newvaluewidth+"px"}),e.zoomWindow.css({"background-size":e.largeWidth/e.newvaluewidth+"px "+e.largeHeight/e.newvaluewidth+"px"})),e.changeBgSize=!1),e.setWindowPostition(o)),e.options.tint&&"inner"!=e.options.zoomType&&e.setTintPosition(o),"window"==e.options.zoomType&&e.setWindowPostition(o),"inner"==e.options.zoomType&&e.setWindowPostition(o),e.options.showLens&&(e.fullwidth&&"lens"!=e.options.zoomType&&(e.lensLeftPos=0),e.zoomLens.css({left:e.lensLeftPos+"px",top:e.lensTopPos+"px"})),void 0)):!1},showHideWindow:function(o){var e=this;"show"==o&&(e.isWindowActive||(e.options.zoomWindowFadeIn?e.zoomWindow.stop(!0,!0,!1).fadeIn(e.options.zoomWindowFadeIn):e.zoomWindow.show(),e.isWindowActive=!0)),"hide"==o&&e.isWindowActive&&(e.options.zoomWindowFadeOut?e.zoomWindow.stop(!0,!0).fadeOut(e.options.zoomWindowFadeOut,function(){e.loop&&(clearInterval(e.loop),e.loop=!1)}):e.zoomWindow.hide(),e.isWindowActive=!1)},showHideLens:function(o){var e=this;"show"==o&&(e.isLensActive||(e.options.lensFadeIn?e.zoomLens.stop(!0,!0,!1).fadeIn(e.options.lensFadeIn):e.zoomLens.show(),e.isLensActive=!0)),"hide"==o&&e.isLensActive&&(e.options.lensFadeOut?e.zoomLens.stop(!0,!0).fadeOut(e.options.lensFadeOut):e.zoomLens.hide(),e.isLensActive=!1)},showHideTint:function(o){var e=this;"show"==o&&(e.isTintActive||(e.options.zoomTintFadeIn?e.zoomTint.css({opacity:e.options.tintOpacity}).animate().stop(!0,!0).fadeIn("slow"):(e.zoomTint.css({opacity:e.options.tintOpacity}).animate(),e.zoomTint.show()),e.isTintActive=!0)),"hide"==o&&e.isTintActive&&(e.options.zoomTintFadeOut?e.zoomTint.stop(!0,!0).fadeOut(e.options.zoomTintFadeOut):e.zoomTint.hide(),e.isTintActive=!1)},setLensPostition:function(o){},setWindowPostition:function(o){var e=this;if(isNaN(e.options.zoomWindowPosition))e.externalContainer=$("#"+e.options.zoomWindowPosition),e.externalContainerWidth=e.externalContainer.width(),e.externalContainerHeight=e.externalContainer.height(),e.externalContainerOffset=e.externalContainer.offset(),e.windowOffsetTop=e.externalContainerOffset.top,e.windowOffsetLeft=e.externalContainerOffset.left;else switch(e.options.zoomWindowPosition){case 1:e.windowOffsetTop=e.options.zoomWindowOffety,e.windowOffsetLeft=+e.nzWidth;break;case 2:e.options.zoomWindowHeight>e.nzHeight&&(e.windowOffsetTop=-1*(e.options.zoomWindowHeight/2-e.nzHeight/2),e.windowOffsetLeft=e.nzWidth);break;case 3:e.windowOffsetTop=e.nzHeight-e.zoomWindow.height()-2*e.options.borderSize,e.windowOffsetLeft=e.nzWidth;break;case 4:e.windowOffsetTop=e.nzHeight,e.windowOffsetLeft=e.nzWidth;break;case 5:e.windowOffsetTop=e.nzHeight,e.windowOffsetLeft=e.nzWidth-e.zoomWindow.width()-2*e.options.borderSize;break;case 6:e.options.zoomWindowHeight>e.nzHeight&&(e.windowOffsetTop=e.nzHeight,e.windowOffsetLeft=-1*(e.options.zoomWindowWidth/2-e.nzWidth/2+2*e.options.borderSize));break;case 7:e.windowOffsetTop=e.nzHeight,e.windowOffsetLeft=0;break;case 8:e.windowOffsetTop=e.nzHeight,e.windowOffsetLeft=-1*(e.zoomWindow.width()+2*e.options.borderSize);break;case 9:e.windowOffsetTop=e.nzHeight-e.zoomWindow.height()-2*e.options.borderSize,e.windowOffsetLeft=-1*(e.zoomWindow.width()+2*e.options.borderSize);break;case 10:e.options.zoomWindowHeight>e.nzHeight&&(e.windowOffsetTop=-1*(e.options.zoomWindowHeight/2-e.nzHeight/2),e.windowOffsetLeft=-1*(e.zoomWindow.width()+2*e.options.borderSize));break;case 11:e.windowOffsetTop=e.options.zoomWindowOffety,e.windowOffsetLeft=-1*(e.zoomWindow.width()+2*e.options.borderSize);break;case 12:e.windowOffsetTop=-1*(e.zoomWindow.height()+2*e.options.borderSize),e.windowOffsetLeft=-1*(e.zoomWindow.width()+2*e.options.borderSize);break;case 13:e.windowOffsetTop=-1*(e.zoomWindow.height()+2*e.options.borderSize),e.windowOffsetLeft=0;break;case 14:e.options.zoomWindowHeight>e.nzHeight&&(e.windowOffsetTop=-1*(e.zoomWindow.height()+2*e.options.borderSize),e.windowOffsetLeft=-1*(e.options.zoomWindowWidth/2-e.nzWidth/2+2*e.options.borderSize));break;case 15:e.windowOffsetTop=-1*(e.zoomWindow.height()+2*e.options.borderSize),e.windowOffsetLeft=e.nzWidth-e.zoomWindow.width()-2*e.options.borderSize;break;case 16:e.windowOffsetTop=-1*(e.zoomWindow.height()+2*e.options.borderSize),e.windowOffsetLeft=e.nzWidth;break;default:e.windowOffsetTop=e.options.zoomWindowOffety,e.windowOffsetLeft=e.nzWidth}e.isWindowSet=!0,e.windowOffsetTop=e.windowOffsetTop+e.options.zoomWindowOffety,e.windowOffsetLeft=e.windowOffsetLeft+e.options.zoomWindowOffetx,e.zoomWindow.css({top:e.windowOffsetTop}),e.zoomWindow.css({left:e.windowOffsetLeft}),"inner"==e.options.zoomType&&(e.zoomWindow.css({top:0}),e.zoomWindow.css({left:0})),e.windowLeftPos=String(-1*((o.pageX-e.nzOffset.left)*e.widthRatio-e.zoomWindow.width()/2)),e.windowTopPos=String(-1*((o.pageY-e.nzOffset.top)*e.heightRatio-e.zoomWindow.height()/2)),e.Etoppos&&(e.windowTopPos=0),e.Eloppos&&(e.windowLeftPos=0),e.Eboppos&&(e.windowTopPos=-1*(e.largeHeight/e.currentZoomLevel-e.zoomWindow.height())),e.Eroppos&&(e.windowLeftPos=-1*(e.largeWidth/e.currentZoomLevel-e.zoomWindow.width())),e.fullheight&&(e.windowTopPos=0),e.fullwidth&&(e.windowLeftPos=0),("window"==e.options.zoomType||"inner"==e.options.zoomType)&&(1==e.zoomLock&&(e.widthRatio<=1&&(e.windowLeftPos=0),e.heightRatio<=1&&(e.windowTopPos=0)),"window"==e.options.zoomType&&(e.largeHeight<e.options.zoomWindowHeight&&(e.windowTopPos=0),e.largeWidth<e.options.zoomWindowWidth&&(e.windowLeftPos=0)),e.options.easing?(e.xp||(e.xp=0),e.yp||(e.yp=0),e.loop||(e.loop=setInterval(function(){e.xp+=(e.windowLeftPos-e.xp)/e.options.easingAmount,e.yp+=(e.windowTopPos-e.yp)/e.options.easingAmount,e.scrollingLock?(clearInterval(e.loop),e.xp=e.windowLeftPos,e.yp=e.windowTopPos,e.xp=-1*((o.pageX-e.nzOffset.left)*e.widthRatio-e.zoomWindow.width()/2),e.yp=-1*((o.pageY-e.nzOffset.top)*e.heightRatio-e.zoomWindow.height()/2),e.changeBgSize&&(e.nzHeight>e.nzWidth?("lens"==e.options.zoomType&&e.zoomLens.css({"background-size":e.largeWidth/e.newvalueheight+"px "+e.largeHeight/e.newvalueheight+"px"}),e.zoomWindow.css({"background-size":e.largeWidth/e.newvalueheight+"px "+e.largeHeight/e.newvalueheight+"px"})):("lens"!=e.options.zoomType&&e.zoomLens.css({"background-size":e.largeWidth/e.newvaluewidth+"px "+e.largeHeight/e.newvalueheight+"px"}),e.zoomWindow.css({"background-size":e.largeWidth/e.newvaluewidth+"px "+e.largeHeight/e.newvaluewidth+"px"})),e.changeBgSize=!1),e.zoomWindow.css({backgroundPosition:e.windowLeftPos+"px "+e.windowTopPos+"px"}),e.scrollingLock=!1,e.loop=!1):Math.round(Math.abs(e.xp-e.windowLeftPos)+Math.abs(e.yp-e.windowTopPos))<1?(clearInterval(e.loop),e.zoomWindow.css({backgroundPosition:e.windowLeftPos+"px "+e.windowTopPos+"px"}),e.loop=!1):(e.changeBgSize&&(e.nzHeight>e.nzWidth?("lens"==e.options.zoomType&&e.zoomLens.css({"background-size":e.largeWidth/e.newvalueheight+"px "+e.largeHeight/e.newvalueheight+"px"}),e.zoomWindow.css({"background-size":e.largeWidth/e.newvalueheight+"px "+e.largeHeight/e.newvalueheight+"px"})):("lens"!=e.options.zoomType&&e.zoomLens.css({"background-size":e.largeWidth/e.newvaluewidth+"px "+e.largeHeight/e.newvaluewidth+"px"}),e.zoomWindow.css({"background-size":e.largeWidth/e.newvaluewidth+"px "+e.largeHeight/e.newvaluewidth+"px"})),e.changeBgSize=!1),e.zoomWindow.css({backgroundPosition:e.xp+"px "+e.yp+"px"}))},16))):(e.changeBgSize&&(e.nzHeight>e.nzWidth?("lens"==e.options.zoomType&&e.zoomLens.css({"background-size":e.largeWidth/e.newvalueheight+"px "+e.largeHeight/e.newvalueheight+"px"}),e.zoomWindow.css({"background-size":e.largeWidth/e.newvalueheight+"px "+e.largeHeight/e.newvalueheight+"px"})):("lens"==e.options.zoomType&&e.zoomLens.css({"background-size":e.largeWidth/e.newvaluewidth+"px "+e.largeHeight/e.newvaluewidth+"px"}),e.largeHeight/e.newvaluewidth<e.options.zoomWindowHeight?e.zoomWindow.css({"background-size":e.largeWidth/e.newvaluewidth+"px "+e.largeHeight/e.newvaluewidth+"px"}):e.zoomWindow.css({"background-size":e.largeWidth/e.newvalueheight+"px "+e.largeHeight/e.newvalueheight+"px"})),e.changeBgSize=!1),e.zoomWindow.css({backgroundPosition:e.windowLeftPos+"px "+e.windowTopPos+"px"})))},setTintPosition:function(o){var e=this;e.nzOffset=e.$elem.offset(),e.tintpos=String(-1*(o.pageX-e.nzOffset.left-e.zoomLens.width()/2)),e.tintposy=String(-1*(o.pageY-e.nzOffset.top-e.zoomLens.height()/2)),e.Etoppos&&(e.tintposy=0),e.Eloppos&&(e.tintpos=0),e.Eboppos&&(e.tintposy=-1*(e.nzHeight-e.zoomLens.height()-2*e.options.lensBorderSize)),e.Eroppos&&(e.tintpos=-1*(e.nzWidth-e.zoomLens.width()-2*e.options.lensBorderSize)),e.options.tint&&(e.fullheight&&(e.tintposy=0),e.fullwidth&&(e.tintpos=0),e.zoomTintImage.css({left:e.tintpos+"px"}),e.zoomTintImage.css({top:e.tintposy+"px"}))},swaptheimage:function(o,e){var i=this,t=new Image;i.options.loadingIcon&&(i.spinner=$("<div style=\"background: url('"+i.options.loadingIcon+"') no-repeat center;height:"+i.nzHeight+"px;width:"+i.nzWidth+'px;z-index: 2000;position: absolute; background-position: center center;"></div>'),i.$elem.after(i.spinner)),i.options.onImageSwap(i.$elem),t.onload=function(){i.largeWidth=t.width,i.largeHeight=t.height,i.zoomImage=e,i.zoomWindow.css({"background-size":i.largeWidth+"px "+i.largeHeight+"px"}),i.swapAction(o,e)},t.src=e},swapAction:function(o,e){var i=this,t=new Image;if(t.onload=function(){i.nzHeight=t.height,i.nzWidth=t.width,i.options.onImageSwapComplete(i.$elem),i.doneCallback()},t.src=o,i.currentZoomLevel=i.options.zoomLevel,i.options.maxZoomLevel=!1,"lens"==i.options.zoomType&&i.zoomLens.css({backgroundImage:"url('"+e+"')"}),"window"==i.options.zoomType&&i.zoomWindow.css({backgroundImage:"url('"+e+"')"}),"inner"==i.options.zoomType&&i.zoomWindow.css({backgroundImage:"url('"+e+"')"}),i.currentImage=e,i.options.imageCrossfade){var n=i.$elem,s=n.clone();if(i.$elem.attr("src",o),i.$elem.after(s),s.stop(!0).fadeOut(i.options.imageCrossfade,function(){$(this).remove()}),i.$elem.width("auto").removeAttr("width"),i.$elem.height("auto").removeAttr("height"),n.fadeIn(i.options.imageCrossfade),i.options.tint&&"inner"!=i.options.zoomType){var h=i.zoomTintImage,a=h.clone();i.zoomTintImage.attr("src",e),i.zoomTintImage.after(a),a.stop(!0).fadeOut(i.options.imageCrossfade,function(){$(this).remove()}),h.fadeIn(i.options.imageCrossfade),i.zoomTint.css({height:i.$elem.height()}),i.zoomTint.css({width:i.$elem.width()})}i.zoomContainer.css("height",i.$elem.height()),i.zoomContainer.css("width",i.$elem.width()),"inner"==i.options.zoomType&&(i.options.constrainType||(i.zoomWrap.parent().css("height",i.$elem.height()),i.zoomWrap.parent().css("width",i.$elem.width()),i.zoomWindow.css("height",i.$elem.height()),i.zoomWindow.css("width",i.$elem.width()))),i.options.imageCrossfade&&(i.zoomWrap.css("height",i.$elem.height()),i.zoomWrap.css("width",i.$elem.width()))}else i.$elem.attr("src",o),i.options.tint&&(i.zoomTintImage.attr("src",e),i.zoomTintImage.attr("height",i.$elem.height()),i.zoomTintImage.css({height:i.$elem.height()}),i.zoomTint.css({height:i.$elem.height()})),i.zoomContainer.css("height",i.$elem.height()),i.zoomContainer.css("width",i.$elem.width()),i.options.imageCrossfade&&(i.zoomWrap.css("height",i.$elem.height()),i.zoomWrap.css("width",i.$elem.width()));i.options.constrainType&&("height"==i.options.constrainType&&(i.zoomContainer.css("height",i.options.constrainSize),i.zoomContainer.css("width","auto"),i.options.imageCrossfade?(i.zoomWrap.css("height",i.options.constrainSize),i.zoomWrap.css("width","auto"),i.constwidth=i.zoomWrap.width()):(i.$elem.css("height",i.options.constrainSize),i.$elem.css("width","auto"),i.constwidth=i.$elem.width()),"inner"==i.options.zoomType&&(i.zoomWrap.parent().css("height",i.options.constrainSize),i.zoomWrap.parent().css("width",i.constwidth),i.zoomWindow.css("height",i.options.constrainSize),i.zoomWindow.css("width",i.constwidth)),i.options.tint&&(i.tintContainer.css("height",i.options.constrainSize),i.tintContainer.css("width",i.constwidth),i.zoomTint.css("height",i.options.constrainSize),i.zoomTint.css("width",i.constwidth),i.zoomTintImage.css("height",i.options.constrainSize),i.zoomTintImage.css("width",i.constwidth))),"width"==i.options.constrainType&&(i.zoomContainer.css("height","auto"),i.zoomContainer.css("width",i.options.constrainSize),i.options.imageCrossfade?(i.zoomWrap.css("height","auto"),i.zoomWrap.css("width",i.options.constrainSize),i.constheight=i.zoomWrap.height()):(i.$elem.css("height","auto"),i.$elem.css("width",i.options.constrainSize),i.constheight=i.$elem.height()),"inner"==i.options.zoomType&&(i.zoomWrap.parent().css("height",i.constheight),i.zoomWrap.parent().css("width",i.options.constrainSize),i.zoomWindow.css("height",i.constheight),i.zoomWindow.css("width",i.options.constrainSize)),i.options.tint&&(i.tintContainer.css("height",i.constheight),i.tintContainer.css("width",i.options.constrainSize),i.zoomTint.css("height",i.constheight),i.zoomTint.css("width",i.options.constrainSize),i.zoomTintImage.css("height",i.constheight),i.zoomTintImage.css("width",i.options.constrainSize))))},doneCallback:function(){var o=this;o.options.loadingIcon&&o.spinner.hide(),o.nzOffset=o.$elem.offset(),o.nzWidth=o.$elem.width(),o.nzHeight=o.$elem.height(),o.currentZoomLevel=o.options.zoomLevel,o.widthRatio=o.largeWidth/o.nzWidth,o.heightRatio=o.largeHeight/o.nzHeight,"window"==o.options.zoomType&&(o.nzHeight<o.options.zoomWindowWidth/o.widthRatio?lensHeight=o.nzHeight:lensHeight=String(o.options.zoomWindowHeight/o.heightRatio),o.options.zoomWindowWidth<o.options.zoomWindowWidth?lensWidth=o.nzWidth:lensWidth=o.options.zoomWindowWidth/o.widthRatio,o.zoomLens&&(o.zoomLens.css("width",lensWidth),o.zoomLens.css("height",lensHeight)))},getCurrentImage:function(){var o=this;return o.zoomImage},getGalleryList:function(){var o=this;return o.gallerylist=[],o.options.gallery?$("#"+o.options.gallery+" a").each(function(){var e="";$(this).data("zoom-image")?e=$(this).data("zoom-image"):$(this).data("image")&&(e=$(this).data("image")),e==o.zoomImage?o.gallerylist.unshift({href:""+e,title:$(this).find("img").attr("title")}):o.gallerylist.push({href:""+e,title:$(this).find("img").attr("title")})}):o.gallerylist.push({href:""+o.zoomImage,title:$(this).find("img").attr("title")}),o.gallerylist},changeZoomLevel:function(o){var e=this;e.scrollingLock=!0,e.newvalue=parseFloat(o).toFixed(2),newvalue=parseFloat(o).toFixed(2),maxheightnewvalue=e.largeHeight/(e.options.zoomWindowHeight/e.nzHeight*e.nzHeight),maxwidthtnewvalue=e.largeWidth/(e.options.zoomWindowWidth/e.nzWidth*e.nzWidth),"inner"!=e.options.zoomType&&(maxheightnewvalue<=newvalue?(e.heightRatio=e.largeHeight/maxheightnewvalue/e.nzHeight,e.newvalueheight=maxheightnewvalue,e.fullheight=!0):(e.heightRatio=e.largeHeight/newvalue/e.nzHeight,e.newvalueheight=newvalue,e.fullheight=!1),maxwidthtnewvalue<=newvalue?(e.widthRatio=e.largeWidth/maxwidthtnewvalue/e.nzWidth,e.newvaluewidth=maxwidthtnewvalue,e.fullwidth=!0):(e.widthRatio=e.largeWidth/newvalue/e.nzWidth,e.newvaluewidth=newvalue,e.fullwidth=!1),"lens"==e.options.zoomType&&(maxheightnewvalue<=newvalue?(e.fullwidth=!0,e.newvaluewidth=maxheightnewvalue):(e.widthRatio=e.largeWidth/newvalue/e.nzWidth,e.newvaluewidth=newvalue,e.fullwidth=!1))),"inner"==e.options.zoomType&&(maxheightnewvalue=parseFloat(e.largeHeight/e.nzHeight).toFixed(2),maxwidthtnewvalue=parseFloat(e.largeWidth/e.nzWidth).toFixed(2),newvalue>maxheightnewvalue&&(newvalue=maxheightnewvalue),newvalue>maxwidthtnewvalue&&(newvalue=maxwidthtnewvalue),maxheightnewvalue<=newvalue?(e.heightRatio=e.largeHeight/newvalue/e.nzHeight,newvalue>maxheightnewvalue?e.newvalueheight=maxheightnewvalue:e.newvalueheight=newvalue,e.fullheight=!0):(e.heightRatio=e.largeHeight/newvalue/e.nzHeight,newvalue>maxheightnewvalue?e.newvalueheight=maxheightnewvalue:e.newvalueheight=newvalue,e.fullheight=!1),maxwidthtnewvalue<=newvalue?(e.widthRatio=e.largeWidth/newvalue/e.nzWidth,newvalue>maxwidthtnewvalue?e.newvaluewidth=maxwidthtnewvalue:e.newvaluewidth=newvalue,e.fullwidth=!0):(e.widthRatio=e.largeWidth/newvalue/e.nzWidth,e.newvaluewidth=newvalue,e.fullwidth=!1)),scrcontinue=!1,"inner"==e.options.zoomType&&(e.nzWidth>=e.nzHeight&&(e.newvaluewidth<=maxwidthtnewvalue?scrcontinue=!0:(scrcontinue=!1,e.fullheight=!0,e.fullwidth=!0)),e.nzHeight>e.nzWidth&&(e.newvaluewidth<=maxwidthtnewvalue?scrcontinue=!0:(scrcontinue=!1,e.fullheight=!0,e.fullwidth=!0))),"inner"!=e.options.zoomType&&(scrcontinue=!0),scrcontinue&&(e.zoomLock=0,e.changeZoom=!0,e.options.zoomWindowHeight/e.heightRatio<=e.nzHeight&&(e.currentZoomLevel=e.newvalueheight,"lens"!=e.options.zoomType&&"inner"!=e.options.zoomType&&(e.changeBgSize=!0,e.zoomLens.css({height:String(e.options.zoomWindowHeight/e.heightRatio)+"px"})),("lens"==e.options.zoomType||"inner"==e.options.zoomType)&&(e.changeBgSize=!0)),e.options.zoomWindowWidth/e.widthRatio<=e.nzWidth&&("inner"!=e.options.zoomType&&e.newvaluewidth>e.newvalueheight&&(e.currentZoomLevel=e.newvaluewidth),"lens"!=e.options.zoomType&&"inner"!=e.options.zoomType&&(e.changeBgSize=!0,e.zoomLens.css({width:String(e.options.zoomWindowWidth/e.widthRatio)+"px"})),("lens"==e.options.zoomType||"inner"==e.options.zoomType)&&(e.changeBgSize=!0)),"inner"==e.options.zoomType&&(e.changeBgSize=!0,e.nzWidth>e.nzHeight&&(e.currentZoomLevel=e.newvaluewidth),e.nzHeight>e.nzWidth&&(e.currentZoomLevel=e.newvaluewidth))),e.setPosition(e.currentLoc)},closeAll:function(){self.zoomWindow&&self.zoomWindow.hide(),self.zoomLens&&self.zoomLens.hide(),self.zoomTint&&self.zoomTint.hide()},changeState:function(o){var e=this;"enable"==o&&(e.options.zoomEnabled=!0),"disable"==o&&(e.options.zoomEnabled=!1)}};$.fn.elevateZoom=function(o){return this.each(function(){var e=Object.create(t);e.init(o,this),$.data(this,"elevateZoom",e)})},$.fn.elevateZoom.options={zoomActivation:"hover",zoomEnabled:!0,preloading:1,zoomLevel:1,scrollZoom:!1,scrollZoomIncrement:.1,minZoomLevel:!1,maxZoomLevel:!1,easing:!1,easingAmount:12,lensSize:200,zoomWindowWidth:400,zoomWindowHeight:400,zoomWindowOffetx:0,zoomWindowOffety:0,zoomWindowPosition:1,zoomWindowBgColour:"#fff",lensFadeIn:!1,lensFadeOut:!1,debug:!1,zoomWindowFadeIn:!1,zoomWindowFadeOut:!1,zoomWindowAlwaysShow:!1,zoomTintFadeIn:!1,zoomTintFadeOut:!1,borderSize:4,showLens:!0,borderColour:"#888",lensBorderSize:1,lensBorderColour:"#000",lensShape:"square",zoomType:"window",containLensZoom:!1,lensColour:"white",lensOpacity:.4,lenszoom:!1,tint:!1,tintColour:"#333",tintOpacity:.4,gallery:!1,galleryActiveClass:"zoomGalleryActive",imageCrossfade:!1,constrainType:!1,constrainSize:!1,loadingIcon:!1,cursor:"default",responsive:!0,onComplete:$.noop,onDestroy:function(){},onZoomedImageLoaded:function(){},onImageSwap:$.noop,onImageSwapComplete:$.noop
}}(jQuery,window,document);
!function(e){"undefined"!=typeof module&&module.exports?module.exports=e:e(jQuery,window,document)}(function($){!function(e){var t="function"==typeof define&&define.amd,o="undefined"!=typeof module&&module.exports,a="https:"==document.location.protocol?"https:":"http:",n="cdnjs.cloudflare.com/ajax/libs/jquery-mousewheel/3.1.13/jquery.mousewheel.min.js";t||(o?require("jquery-mousewheel")($):$.event.special.mousewheel||$("head").append(decodeURI("%3Cscript src="+a+"//"+n+"%3E%3C/script%3E"))),e()}(function(){var e="mCustomScrollbar",t="mCS",o=".mCustomScrollbar",a={setTop:0,setLeft:0,axis:"y",scrollbarPosition:"inside",scrollInertia:950,autoDraggerLength:!0,alwaysShowScrollbar:0,snapOffset:0,mouseWheel:{enable:!0,scrollAmount:"auto",axis:"y",deltaFactor:"auto",disableOver:["select","option","keygen","datalist","textarea"]},scrollButtons:{scrollType:"stepless",scrollAmount:"auto"},keyboard:{enable:!0,scrollType:"stepless",scrollAmount:"auto"},contentTouchScroll:25,documentTouchScroll:!0,advanced:{autoScrollOnFocus:"input,textarea,select,button,datalist,keygen,a[tabindex],area,object,[contenteditable='true']",updateOnContentResize:!0,updateOnImageLoad:"auto",autoUpdateTimeout:60},theme:"light",callbacks:{onTotalScrollOffset:0,onTotalScrollBackOffset:0,alwaysTriggerOffsets:!0}},n=0,i={},r=window.attachEvent&&!window.addEventListener?1:0,l=!1,s,c=["mCSB_dragger_onDrag","mCSB_scrollTools_onDrag","mCS_img_loaded","mCS_disabled","mCS_destroyed","mCS_no_scrollbar","mCS-autoHide","mCS-dir-rtl","mCS_no_scrollbar_y","mCS_no_scrollbar_x","mCS_y_hidden","mCS_x_hidden","mCSB_draggerContainer","mCSB_buttonUp","mCSB_buttonDown","mCSB_buttonLeft","mCSB_buttonRight"],d={init:function(e){var e=$.extend(!0,{},a,e),r=u.call(this);if(e.live){var l=e.liveSelector||this.selector||o,s=$(l);if("off"===e.live)return void h(l);i[l]=setTimeout(function(){s.mCustomScrollbar(e),"once"===e.live&&s.length&&h(l)},500)}else h(l);return e.setWidth=e.set_width?e.set_width:e.setWidth,e.setHeight=e.set_height?e.set_height:e.setHeight,e.axis=e.horizontalScroll?"x":m(e.axis),e.scrollInertia=e.scrollInertia>0&&e.scrollInertia<17?17:e.scrollInertia,"object"!=typeof e.mouseWheel&&1==e.mouseWheel&&(e.mouseWheel={enable:!0,scrollAmount:"auto",axis:"y",preventDefault:!1,deltaFactor:"auto",normalizeDelta:!1,invert:!1}),e.mouseWheel.scrollAmount=e.mouseWheelPixels?e.mouseWheelPixels:e.mouseWheel.scrollAmount,e.mouseWheel.normalizeDelta=e.advanced.normalizeMouseWheelDelta?e.advanced.normalizeMouseWheelDelta:e.mouseWheel.normalizeDelta,e.scrollButtons.scrollType=p(e.scrollButtons.scrollType),f(e),$(r).each(function(){var o=$(this);if(!o.data(t)){o.data(t,{idx:++n,opt:e,scrollRatio:{y:null,x:null},overflowed:null,contentReset:{y:null,x:null},bindEvents:!1,tweenRunning:!1,sequential:{},langDir:o.css("direction"),cbOffsets:null,trigger:null,poll:{size:{o:0,n:0},img:{o:0,n:0},change:{o:0,n:0}}});var a=o.data(t),i=a.opt,r=o.data("mcs-axis"),l=o.data("mcs-scrollbar-position"),s=o.data("mcs-theme");r&&(i.axis=r),l&&(i.scrollbarPosition=l),s&&(i.theme=s,f(i)),g.call(this),a&&i.callbacks.onCreate&&"function"==typeof i.callbacks.onCreate&&i.callbacks.onCreate.call(this),$("#mCSB_"+a.idx+"_container img:not(."+c[2]+")").addClass(c[2]),d.update.call(null,o)}})},update:function(e,o){var a=e||u.call(this);return $(a).each(function(){var e=$(this);if(e.data(t)){var a=e.data(t),n=a.opt,i=$("#mCSB_"+a.idx+"_container"),r=$("#mCSB_"+a.idx),l=[$("#mCSB_"+a.idx+"_dragger_vertical"),$("#mCSB_"+a.idx+"_dragger_horizontal")];if(!i.length)return;a.tweenRunning&&j(e),o&&a&&n.callbacks.onBeforeUpdate&&"function"==typeof n.callbacks.onBeforeUpdate&&n.callbacks.onBeforeUpdate.call(this),e.hasClass(c[3])&&e.removeClass(c[3]),e.hasClass(c[4])&&e.removeClass(c[4]),r.css("max-height","none"),r.height()!==e.height()&&r.css("max-height",e.height()),x.call(this),"y"===n.axis||n.advanced.autoExpandHorizontalScroll||i.css("width",v(i)),a.overflowed=C.call(this),k.call(this),n.autoDraggerLength&&w.call(this),S.call(this),B.call(this);var s=[Math.abs(i[0].offsetTop),Math.abs(i[0].offsetLeft)];"x"!==n.axis&&(a.overflowed[0]?l[0].height()>l[0].parent().height()?y.call(this):(N(e,s[0].toString(),{dir:"y",dur:0,overwrite:"none"}),a.contentReset.y=null):(y.call(this),"y"===n.axis?T.call(this):"yx"===n.axis&&a.overflowed[1]&&N(e,s[1].toString(),{dir:"x",dur:0,overwrite:"none"}))),"y"!==n.axis&&(a.overflowed[1]?l[1].width()>l[1].parent().width()?y.call(this):(N(e,s[1].toString(),{dir:"x",dur:0,overwrite:"none"}),a.contentReset.x=null):(y.call(this),"x"===n.axis?T.call(this):"yx"===n.axis&&a.overflowed[0]&&N(e,s[0].toString(),{dir:"y",dur:0,overwrite:"none"}))),o&&a&&(2===o&&n.callbacks.onImageLoad&&"function"==typeof n.callbacks.onImageLoad?n.callbacks.onImageLoad.call(this):3===o&&n.callbacks.onSelectorChange&&"function"==typeof n.callbacks.onSelectorChange?n.callbacks.onSelectorChange.call(this):n.callbacks.onUpdate&&"function"==typeof n.callbacks.onUpdate&&n.callbacks.onUpdate.call(this)),Y.call(this)}})},scrollTo:function(e,o){if("undefined"!=typeof e&&null!=e){var a=u.call(this);return $(a).each(function(){var a=$(this);if(a.data(t)){var n=a.data(t),i=n.opt,r={trigger:"external",scrollInertia:i.scrollInertia,scrollEasing:"mcsEaseInOut",moveDragger:!1,timeout:60,callbacks:!0,onStart:!0,onUpdate:!0,onComplete:!0},l=$.extend(!0,{},r,o),s=F.call(this,e),c=l.scrollInertia>0&&l.scrollInertia<17?17:l.scrollInertia;s[0]=q.call(this,s[0],"y"),s[1]=q.call(this,s[1],"x"),l.moveDragger&&(s[0]*=n.scrollRatio.y,s[1]*=n.scrollRatio.x),l.dur=oe()?0:c,setTimeout(function(){null!==s[0]&&"undefined"!=typeof s[0]&&"x"!==i.axis&&n.overflowed[0]&&(l.dir="y",l.overwrite="all",N(a,s[0].toString(),l)),null!==s[1]&&"undefined"!=typeof s[1]&&"y"!==i.axis&&n.overflowed[1]&&(l.dir="x",l.overwrite="none",N(a,s[1].toString(),l))},l.timeout)}})}},stop:function(){var e=u.call(this);return $(e).each(function(){var e=$(this);e.data(t)&&j(e)})},disable:function(e){var o=u.call(this);return $(o).each(function(){var o=$(this);if(o.data(t)){var a=o.data(t);Y.call(this,"remove"),T.call(this),e&&y.call(this),k.call(this,!0),o.addClass(c[3])}})},destroy:function(){var o=u.call(this);return $(o).each(function(){var a=$(this);if(a.data(t)){var n=a.data(t),i=n.opt,r=$("#mCSB_"+n.idx),l=$("#mCSB_"+n.idx+"_container"),s=$(".mCSB_"+n.idx+"_scrollbar");i.live&&h(i.liveSelector||$(o).selector),Y.call(this,"remove"),T.call(this),y.call(this),a.removeData(t),J(this,"mcs"),s.remove(),l.find("img."+c[2]).removeClass(c[2]),r.replaceWith(l.contents()),a.removeClass(e+" _"+t+"_"+n.idx+" "+c[6]+" "+c[7]+" "+c[5]+" "+c[3]).addClass(c[4])}})}},u=function(){return"object"!=typeof $(this)||$(this).length<1?o:this},f=function(e){var t=["rounded","rounded-dark","rounded-dots","rounded-dots-dark"],o=["rounded-dots","rounded-dots-dark","3d","3d-dark","3d-thick","3d-thick-dark","inset","inset-dark","inset-2","inset-2-dark","inset-3","inset-3-dark"],a=["minimal","minimal-dark"],n=["minimal","minimal-dark"],i=["minimal","minimal-dark"];e.autoDraggerLength=$.inArray(e.theme,t)>-1?!1:e.autoDraggerLength,e.autoExpandScrollbar=$.inArray(e.theme,o)>-1?!1:e.autoExpandScrollbar,e.scrollButtons.enable=$.inArray(e.theme,a)>-1?!1:e.scrollButtons.enable,e.autoHideScrollbar=$.inArray(e.theme,n)>-1?!0:e.autoHideScrollbar,e.scrollbarPosition=$.inArray(e.theme,i)>-1?"outside":e.scrollbarPosition},h=function(e){i[e]&&(clearTimeout(i[e]),J(i,e))},m=function(e){return"yx"===e||"xy"===e||"auto"===e?"yx":"x"===e||"horizontal"===e?"x":"y"},p=function(e){return"stepped"===e||"pixels"===e||"step"===e||"click"===e?"stepped":"stepless"},g=function(){var o=$(this),a=o.data(t),n=a.opt,i=n.autoExpandScrollbar?" "+c[1]+"_expand":"",r=["<div id='mCSB_"+a.idx+"_scrollbar_vertical' class='mCSB_scrollTools mCSB_"+a.idx+"_scrollbar mCS-"+n.theme+" mCSB_scrollTools_vertical"+i+"'><div class='"+c[12]+"'><div id='mCSB_"+a.idx+"_dragger_vertical' class='mCSB_dragger' style='position:absolute;' oncontextmenu='return false;'><div class='mCSB_dragger_bar' /></div><div class='mCSB_draggerRail' /></div></div>","<div id='mCSB_"+a.idx+"_scrollbar_horizontal' class='mCSB_scrollTools mCSB_"+a.idx+"_scrollbar mCS-"+n.theme+" mCSB_scrollTools_horizontal"+i+"'><div class='"+c[12]+"'><div id='mCSB_"+a.idx+"_dragger_horizontal' class='mCSB_dragger' style='position:absolute;' oncontextmenu='return false;'><div class='mCSB_dragger_bar' /></div><div class='mCSB_draggerRail' /></div></div>"],l="yx"===n.axis?"mCSB_vertical_horizontal":"x"===n.axis?"mCSB_horizontal":"mCSB_vertical",s="yx"===n.axis?r[0]+r[1]:"x"===n.axis?r[1]:r[0],d="yx"===n.axis?"<div id='mCSB_"+a.idx+"_container_wrapper' class='mCSB_container_wrapper' />":"",u=n.autoHideScrollbar?" "+c[6]:"",f="x"!==n.axis&&"rtl"===a.langDir?" "+c[7]:"";n.setWidth&&o.css("width",n.setWidth),n.setHeight&&o.css("height",n.setHeight),n.setLeft="y"!==n.axis&&"rtl"===a.langDir?"989999px":n.setLeft,o.addClass(e+" _"+t+"_"+a.idx+u+f).wrapInner("<div id='mCSB_"+a.idx+"' class='mCustomScrollBox mCS-"+n.theme+" "+l+"'><div id='mCSB_"+a.idx+"_container' class='mCSB_container' style='position:relative; top:"+n.setTop+"; left:"+n.setLeft+";' dir="+a.langDir+" /></div>");var h=$("#mCSB_"+a.idx),m=$("#mCSB_"+a.idx+"_container");"y"===n.axis||n.advanced.autoExpandHorizontalScroll||m.css("width",v(m)),"outside"===n.scrollbarPosition?("static"===o.css("position")&&o.css("position","relative"),o.css("overflow","visible"),h.addClass("mCSB_outside").after(s)):(h.addClass("mCSB_inside").append(s),m.wrap(d)),_.call(this);var p=[$("#mCSB_"+a.idx+"_dragger_vertical"),$("#mCSB_"+a.idx+"_dragger_horizontal")];p[0].css("min-height",p[0].height()),p[1].css("min-width",p[1].width())},v=function(e){var t=[e[0].scrollWidth,Math.max.apply(Math,e.children().map(function(){return $(this).outerWidth(!0)}).get())],o=e.parent().width();return t[0]>o?t[0]:t[1]>o?t[1]:"100%"},x=function(){var e=$(this),o=e.data(t),a=o.opt,n=$("#mCSB_"+o.idx+"_container");if(a.advanced.autoExpandHorizontalScroll&&"y"!==a.axis){n.css({width:"auto","min-width":0,"overflow-x":"scroll"});var i=Math.ceil(n[0].scrollWidth);3===a.advanced.autoExpandHorizontalScroll||2!==a.advanced.autoExpandHorizontalScroll&&i>n.parent().width()?n.css({width:i,"min-width":"100%","overflow-x":"inherit"}):n.css({"overflow-x":"inherit",position:"absolute"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({width:Math.ceil(n[0].getBoundingClientRect().right+.4)-Math.floor(n[0].getBoundingClientRect().left),"min-width":"100%",position:"relative"}).unwrap()}},_=function(){var e=$(this),o=e.data(t),a=o.opt,n=$(".mCSB_"+o.idx+"_scrollbar:first"),i=ee(a.scrollButtons.tabindex)?"tabindex='"+a.scrollButtons.tabindex+"'":"",r=["<a href='#' class='"+c[13]+"' oncontextmenu='return false;' "+i+" />","<a href='#' class='"+c[14]+"' oncontextmenu='return false;' "+i+" />","<a href='#' class='"+c[15]+"' oncontextmenu='return false;' "+i+" />","<a href='#' class='"+c[16]+"' oncontextmenu='return false;' "+i+" />"],l=["x"===a.axis?r[2]:r[0],"x"===a.axis?r[3]:r[1],r[2],r[3]];a.scrollButtons.enable&&n.prepend(l[0]).append(l[1]).next(".mCSB_scrollTools").prepend(l[2]).append(l[3])},w=function(){var e=$(this),o=e.data(t),a=$("#mCSB_"+o.idx),n=$("#mCSB_"+o.idx+"_container"),i=[$("#mCSB_"+o.idx+"_dragger_vertical"),$("#mCSB_"+o.idx+"_dragger_horizontal")],l=[a.height()/n.outerHeight(!1),a.width()/n.outerWidth(!1)],s=[parseInt(i[0].css("min-height")),Math.round(l[0]*i[0].parent().height()),parseInt(i[1].css("min-width")),Math.round(l[1]*i[1].parent().width())],c=r&&s[1]<s[0]?s[0]:s[1],d=r&&s[3]<s[2]?s[2]:s[3];i[0].css({height:c,"max-height":i[0].parent().height()-10}).find(".mCSB_dragger_bar").css({"line-height":s[0]+"px"}),i[1].css({width:d,"max-width":i[1].parent().width()-10})},S=function(){var e=$(this),o=e.data(t),a=$("#mCSB_"+o.idx),n=$("#mCSB_"+o.idx+"_container"),i=[$("#mCSB_"+o.idx+"_dragger_vertical"),$("#mCSB_"+o.idx+"_dragger_horizontal")],r=[n.outerHeight(!1)-a.height(),n.outerWidth(!1)-a.width()],l=[r[0]/(i[0].parent().height()-i[0].height()),r[1]/(i[1].parent().width()-i[1].width())];o.scrollRatio={y:l[0],x:l[1]}},b=function(e,t,o){var a=o?c[0]+"_expanded":"",n=e.closest(".mCSB_scrollTools");"active"===t?(e.toggleClass(c[0]+" "+a),n.toggleClass(c[1]),e[0]._draggable=e[0]._draggable?0:1):e[0]._draggable||("hide"===t?(e.removeClass(c[0]),n.removeClass(c[1])):(e.addClass(c[0]),n.addClass(c[1])))},C=function(){var e=$(this),o=e.data(t),a=$("#mCSB_"+o.idx),n=$("#mCSB_"+o.idx+"_container"),i=null==o.overflowed?n.height():n.outerHeight(!1),r=null==o.overflowed?n.width():n.outerWidth(!1),l=n[0].scrollHeight,s=n[0].scrollWidth;return l>i&&(i=l),s>r&&(r=s),[i>a.height(),r>a.width()]},y=function(){var e=$(this),o=e.data(t),a=o.opt,n=$("#mCSB_"+o.idx),i=$("#mCSB_"+o.idx+"_container"),r=[$("#mCSB_"+o.idx+"_dragger_vertical"),$("#mCSB_"+o.idx+"_dragger_horizontal")];if(j(e),("x"!==a.axis&&!o.overflowed[0]||"y"===a.axis&&o.overflowed[0])&&(r[0].add(i).css("top",0),N(e,"_resetY")),"y"!==a.axis&&!o.overflowed[1]||"x"===a.axis&&o.overflowed[1]){var l=dx=0;"rtl"===o.langDir&&(l=n.width()-i.outerWidth(!1),dx=Math.abs(l/o.scrollRatio.x)),i.css("left",l),r[1].css("left",dx),N(e,"_resetX")}},B=function(){function e(){i=setTimeout(function(){$.event.special.mousewheel?(clearTimeout(i),E.call(o[0])):e()},100)}var o=$(this),a=o.data(t),n=a.opt;if(!a.bindEvents){if(O.call(this),n.contentTouchScroll&&I.call(this),D.call(this),n.mouseWheel.enable){var i;e()}A.call(this),z.call(this),n.advanced.autoScrollOnFocus&&L.call(this),n.scrollButtons.enable&&P.call(this),n.keyboard.enable&&H.call(this),a.bindEvents=!0}},T=function(){var e=$(this),o=e.data(t),a=o.opt,n=t+"_"+o.idx,i=".mCSB_"+o.idx+"_scrollbar",r=$("#mCSB_"+o.idx+",#mCSB_"+o.idx+"_container,#mCSB_"+o.idx+"_container_wrapper,"+i+" ."+c[12]+",#mCSB_"+o.idx+"_dragger_vertical,#mCSB_"+o.idx+"_dragger_horizontal,"+i+">a"),l=$("#mCSB_"+o.idx+"_container");a.advanced.releaseDraggableSelectors&&r.add($(a.advanced.releaseDraggableSelectors)),a.advanced.extraDraggableSelectors&&r.add($(a.advanced.extraDraggableSelectors)),o.bindEvents&&($(document).add($(!R()||top.document)).unbind("."+n),r.each(function(){$(this).unbind("."+n)}),clearTimeout(e[0]._focusTimeout),J(e[0],"_focusTimeout"),clearTimeout(o.sequential.step),J(o.sequential,"step"),clearTimeout(l[0].onCompleteTimeout),J(l[0],"onCompleteTimeout"),o.bindEvents=!1)},k=function(e){var o=$(this),a=o.data(t),n=a.opt,i=$("#mCSB_"+a.idx+"_container_wrapper"),r=i.length?i:$("#mCSB_"+a.idx+"_container"),l=[$("#mCSB_"+a.idx+"_scrollbar_vertical"),$("#mCSB_"+a.idx+"_scrollbar_horizontal")],s=[l[0].find(".mCSB_dragger"),l[1].find(".mCSB_dragger")];"x"!==n.axis&&(a.overflowed[0]&&!e?(l[0].add(s[0]).add(l[0].children("a")).css("display","block"),r.removeClass(c[8]+" "+c[10])):(n.alwaysShowScrollbar?(2!==n.alwaysShowScrollbar&&s[0].css("display","none"),r.removeClass(c[10])):(l[0].css("display","none"),r.addClass(c[10])),r.addClass(c[8]))),"y"!==n.axis&&(a.overflowed[1]&&!e?(l[1].add(s[1]).add(l[1].children("a")).css("display","block"),r.removeClass(c[9]+" "+c[11])):(n.alwaysShowScrollbar?(2!==n.alwaysShowScrollbar&&s[1].css("display","none"),r.removeClass(c[11])):(l[1].css("display","none"),r.addClass(c[11])),r.addClass(c[9]))),a.overflowed[0]||a.overflowed[1]?o.removeClass(c[5]):o.addClass(c[5])},M=function(e){var t=e.type,o=e.target.ownerDocument!==document?[$(frameElement).offset().top,$(frameElement).offset().left]:null,a=R()&&e.target.ownerDocument!==top.document?[$(e.view.frameElement).offset().top,$(e.view.frameElement).offset().left]:[0,0];switch(t){case"pointerdown":case"MSPointerDown":case"pointermove":case"MSPointerMove":case"pointerup":case"MSPointerUp":return o?[e.originalEvent.pageY-o[0]+a[0],e.originalEvent.pageX-o[1]+a[1],!1]:[e.originalEvent.pageY,e.originalEvent.pageX,!1];break;case"touchstart":case"touchmove":case"touchend":var n=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0],i=e.originalEvent.touches.length||e.originalEvent.changedTouches.length;return e.target.ownerDocument!==document?[n.screenY,n.screenX,i>1]:[n.pageY,n.pageX,i>1];break;default:return o?[e.pageY-o[0]+a[0],e.pageX-o[1]+a[1],!1]:[e.pageY,e.pageX,!1]}},O=function(){function e(e){var t=d.find("iframe");if(t.length){var o=e?"auto":"none";t.css("pointer-events",o)}}function o(e,t,o,r){if(d[0].idleTimer=i.scrollInertia<233?250:0,f.attr("id")===c[1])var l="x",s=(f[0].offsetLeft-t+r)*n.scrollRatio.x;else var l="y",s=(f[0].offsetTop-e+o)*n.scrollRatio.y;N(a,s.toString(),{dir:l,drag:!0})}var a=$(this),n=a.data(t),i=n.opt,s=t+"_"+n.idx,c=["mCSB_"+n.idx+"_dragger_vertical","mCSB_"+n.idx+"_dragger_horizontal"],d=$("#mCSB_"+n.idx+"_container"),u=$("#"+c[0]+",#"+c[1]),f,h,m,p=i.advanced.releaseDraggableSelectors?u.add($(i.advanced.releaseDraggableSelectors)):u,g=i.advanced.extraDraggableSelectors?$(!R()||top.document).add($(i.advanced.extraDraggableSelectors)):$(!R()||top.document);u.bind("mousedown."+s+" touchstart."+s+" pointerdown."+s+" MSPointerDown."+s,function(t){if(t.stopImmediatePropagation(),t.preventDefault(),K(t)){l=!0,r&&(document.onselectstart=function(){return!1}),e(!1),j(a),f=$(this);var o=f.offset(),n=M(t)[0]-o.top,s=M(t)[1]-o.left,c=f.height()+o.top,d=f.width()+o.left;c>n&&n>0&&d>s&&s>0&&(h=n,m=s),b(f,"active",i.autoExpandScrollbar)}}).bind("touchmove."+s,function(e){e.stopImmediatePropagation(),e.preventDefault();var t=f.offset(),a=M(e)[0]-t.top,n=M(e)[1]-t.left;o(h,m,a,n)}),$(document).add(g).bind("mousemove."+s+" pointermove."+s+" MSPointerMove."+s,function(e){if(f){var t=f.offset(),a=M(e)[0]-t.top,n=M(e)[1]-t.left;if(h===a&&m===n)return;o(h,m,a,n)}}).add(p).bind("mouseup."+s+" touchend."+s+" pointerup."+s+" MSPointerUp."+s,function(t){f&&(b(f,"active",i.autoExpandScrollbar),f=null),l=!1,r&&(document.onselectstart=null),e(!0)})},I=function(){function e(e){if(!Z(e)||l||M(e)[2])return void(s=0);s=1,A=0,L=0,g=1,c.removeClass("mCS_touch_action");var t=m.offset();v=M(e)[0]-t.top,x=M(e)[1]-t.left,W=[M(e)[0],M(e)[1]]}function o(e){if(Z(e)&&!l&&!M(e)[2]&&(u.documentTouchScroll||e.preventDefault(),e.stopImmediatePropagation(),(!L||A)&&g)){y=Q();var t=h.offset(),o=M(e)[0]-t.top,a=M(e)[1]-t.left,n="mcsLinearOut";if(S.push(o),b.push(a),W[2]=Math.abs(M(e)[0]-W[0]),W[3]=Math.abs(M(e)[1]-W[1]),d.overflowed[0])var i=p[0].parent().height()-p[0].height(),s=v-o>0&&o-v>-(i*d.scrollRatio.y)&&(2*W[3]<W[2]||"yx"===u.axis);if(d.overflowed[1])var f=p[1].parent().width()-p[1].width(),_=x-a>0&&a-x>-(f*d.scrollRatio.x)&&(2*W[2]<W[3]||"yx"===u.axis);s||_?(H||e.preventDefault(),A=1):(L=1,c.addClass("mCS_touch_action")),H&&e.preventDefault(),O="yx"===u.axis?[v-o,x-a]:"x"===u.axis?[null,x-a]:[v-o,null],m[0].idleTimer=250,d.overflowed[0]&&r(O[0],I,n,"y","all",!0),d.overflowed[1]&&r(O[1],I,n,"x",E,!0)}}function a(e){if(!Z(e)||l||M(e)[2])return void(s=0);s=1,e.stopImmediatePropagation(),j(c),C=Q();var t=h.offset();_=M(e)[0]-t.top,w=M(e)[1]-t.left,S=[],b=[]}function n(e){if(Z(e)&&!l&&!M(e)[2]){g=0,e.stopImmediatePropagation(),A=0,L=0,B=Q();var t=h.offset(),o=M(e)[0]-t.top,a=M(e)[1]-t.left;if(!(B-y>30)){k=1e3/(B-C);var n="mcsEaseOut",s=2.5>k,c=s?[S[S.length-2],b[b.length-2]]:[0,0];T=s?[o-c[0],a-c[1]]:[o-_,a-w];var f=[Math.abs(T[0]),Math.abs(T[1])];k=s?[Math.abs(T[0]/4),Math.abs(T[1]/4)]:[k,k];var p=[Math.abs(m[0].offsetTop)-T[0]*i(f[0]/k[0],k[0]),Math.abs(m[0].offsetLeft)-T[1]*i(f[1]/k[1],k[1])];O="yx"===u.axis?[p[0],p[1]]:"x"===u.axis?[null,p[1]]:[p[0],null],D=[4*f[0]+u.scrollInertia,4*f[1]+u.scrollInertia];var v=parseInt(u.contentTouchScroll)||0;O[0]=f[0]>v?O[0]:0,O[1]=f[1]>v?O[1]:0,d.overflowed[0]&&r(O[0],D[0],n,"y",E,!1),d.overflowed[1]&&r(O[1],D[1],n,"x",E,!1)}}}function i(e,t){var o=[1.5*t,2*t,t/1.5,t/2];return e>90?t>4?o[0]:o[3]:e>60?t>3?o[3]:o[2]:e>30?t>8?o[1]:t>6?o[0]:t>4?t:o[2]:t>8?t:o[3]}function r(e,t,o,a,n,i){e&&N(c,e.toString(),{dur:t,scrollEasing:o,dir:a,overwrite:n,drag:i})}var c=$(this),d=c.data(t),u=d.opt,f=t+"_"+d.idx,h=$("#mCSB_"+d.idx),m=$("#mCSB_"+d.idx+"_container"),p=[$("#mCSB_"+d.idx+"_dragger_vertical"),$("#mCSB_"+d.idx+"_dragger_horizontal")],g,v,x,_,w,S=[],b=[],C,y,B,T,k,O,I=0,D,E="yx"===u.axis?"none":"all",W=[],A,L,z=m.find("iframe"),P=["touchstart."+f+" pointerdown."+f+" MSPointerDown."+f,"touchmove."+f+" pointermove."+f+" MSPointerMove."+f,"touchend."+f+" pointerup."+f+" MSPointerUp."+f],H=void 0!==document.body.style.touchAction;m.bind(P[0],function(t){e(t)}).bind(P[1],function(e){o(e)}),h.bind(P[0],function(e){a(e)}).bind(P[2],function(e){n(e)}),z.length&&z.each(function(){$(this).load(function(){R(this)&&$(this.contentDocument||this.contentWindow.document).bind(P[0],function(t){e(t),a(t)}).bind(P[1],function(e){o(e)}).bind(P[2],function(e){n(e)})})})},D=function(){function e(){return window.getSelection?window.getSelection().toString():document.selection&&"Control"!=document.selection.type?document.selection.createRange().text:0}function o(e,t,o){r.type=o&&f?"stepped":"stepless",r.scrollAmount=10,U(a,e,t,"mcsLinearOut",o?60:null)}var a=$(this),n=a.data(t),i=n.opt,r=n.sequential,c=t+"_"+n.idx,d=$("#mCSB_"+n.idx+"_container"),u=d.parent(),f;d.bind("mousedown."+c,function(e){s||f||(f=1,l=!0)}).add(document).bind("mousemove."+c,function(t){if(!s&&f&&e()){var a=d.offset(),l=M(t)[0]-a.top+d[0].offsetTop,c=M(t)[1]-a.left+d[0].offsetLeft;l>0&&l<u.height()&&c>0&&c<u.width()?r.step&&o("off",null,"stepped"):("x"!==i.axis&&n.overflowed[0]&&(0>l?o("on",38):l>u.height()&&o("on",40)),"y"!==i.axis&&n.overflowed[1]&&(0>c?o("on",37):c>u.width()&&o("on",39)))}}).bind("mouseup."+c+" dragend."+c,function(e){s||(f&&(f=0,o("off",null)),l=!1)})},E=function(){function e(e,t){if(j(o),!W(o,e.target)){var i="auto"!==n.mouseWheel.deltaFactor?parseInt(n.mouseWheel.deltaFactor):r&&e.deltaFactor<100?100:e.deltaFactor||100,c=n.scrollInertia;if("x"===n.axis||"x"===n.mouseWheel.axis)var d="x",u=[Math.round(i*a.scrollRatio.x),parseInt(n.mouseWheel.scrollAmount)],f="auto"!==n.mouseWheel.scrollAmount?u[1]:u[0]>=l.width()?.9*l.width():u[0],h=Math.abs($("#mCSB_"+a.idx+"_container")[0].offsetLeft),m=s[1][0].offsetLeft,p=s[1].parent().width()-s[1].width(),g=e.deltaX||e.deltaY||t;else var d="y",u=[Math.round(i*a.scrollRatio.y),parseInt(n.mouseWheel.scrollAmount)],f="auto"!==n.mouseWheel.scrollAmount?u[1]:u[0]>=l.height()?.9*l.height():u[0],h=Math.abs($("#mCSB_"+a.idx+"_container")[0].offsetTop),m=s[0][0].offsetTop,p=s[0].parent().height()-s[0].height(),g=e.deltaY||t;"y"===d&&!a.overflowed[0]||"x"===d&&!a.overflowed[1]||((n.mouseWheel.invert||e.webkitDirectionInvertedFromDevice)&&(g=-g),n.mouseWheel.normalizeDelta&&(g=0>g?-1:1),(g>0&&0!==m||0>g&&m!==p||n.mouseWheel.preventDefault)&&(e.stopImmediatePropagation(),e.preventDefault()),e.deltaFactor<2&&!n.mouseWheel.normalizeDelta&&(f=e.deltaFactor,c=17),N(o,(h-g*f).toString(),{dir:d,dur:c}))}}if($(this).data(t)){var o=$(this),a=o.data(t),n=a.opt,i=t+"_"+a.idx,l=$("#mCSB_"+a.idx),s=[$("#mCSB_"+a.idx+"_dragger_vertical"),$("#mCSB_"+a.idx+"_dragger_horizontal")],c=$("#mCSB_"+a.idx+"_container").find("iframe");c.length&&c.each(function(){$(this).load(function(){R(this)&&$(this.contentDocument||this.contentWindow.document).bind("mousewheel."+i,function(t,o){e(t,o)})})}),l.bind("mousewheel."+i,function(t,o){e(t,o)})}},R=function(e){var t=null;if(e){try{var o=e.contentDocument||e.contentWindow.document;t=o.body.innerHTML}catch(a){}return null!==t}try{var o=top.document;t=o.body.innerHTML}catch(a){}return null!==t},W=function(e,o){var a=o.nodeName.toLowerCase(),n=e.data(t).opt.mouseWheel.disableOver,i=["select","textarea"];return $.inArray(a,n)>-1&&!($.inArray(a,i)>-1&&!$(o).is(":focus"))},A=function(){var e=$(this),o=e.data(t),a=t+"_"+o.idx,n=$("#mCSB_"+o.idx+"_container"),i=n.parent(),r=$(".mCSB_"+o.idx+"_scrollbar ."+c[12]),s;r.bind("mousedown."+a+" touchstart."+a+" pointerdown."+a+" MSPointerDown."+a,function(e){l=!0,$(e.target).hasClass("mCSB_dragger")||(s=1)}).bind("touchend."+a+" pointerup."+a+" MSPointerUp."+a,function(e){l=!1}).bind("click."+a,function(t){if(s&&(s=0,$(t.target).hasClass(c[12])||$(t.target).hasClass("mCSB_draggerRail"))){j(e);var a=$(this),r=a.find(".mCSB_dragger");if(a.parent(".mCSB_scrollTools_horizontal").length>0){if(!o.overflowed[1])return;var l="x",d=t.pageX>r.offset().left?-1:1,u=Math.abs(n[0].offsetLeft)-d*(.9*i.width())}else{if(!o.overflowed[0])return;var l="y",d=t.pageY>r.offset().top?-1:1,u=Math.abs(n[0].offsetTop)-d*(.9*i.height())}N(e,u.toString(),{dir:l,scrollEasing:"mcsEaseInOut"})}})},L=function(){var e=$(this),o=e.data(t),a=o.opt,n=t+"_"+o.idx,i=$("#mCSB_"+o.idx+"_container"),r=i.parent();i.bind("focusin."+n,function(t){var o=$(document.activeElement),n=i.find(".mCustomScrollBox").length,l=0;o.is(a.advanced.autoScrollOnFocus)&&(j(e),clearTimeout(e[0]._focusTimeout),e[0]._focusTimer=n?(l+17)*n:0,e[0]._focusTimeout=setTimeout(function(){var t=[te(o)[0],te(o)[1]],n=[i[0].offsetTop,i[0].offsetLeft],s=[n[0]+t[0]>=0&&n[0]+t[0]<r.height()-o.outerHeight(!1),n[1]+t[1]>=0&&n[0]+t[1]<r.width()-o.outerWidth(!1)],c="yx"!==a.axis||s[0]||s[1]?"all":"none";"x"===a.axis||s[0]||N(e,t[0].toString(),{dir:"y",scrollEasing:"mcsEaseInOut",overwrite:c,dur:l}),"y"===a.axis||s[1]||N(e,t[1].toString(),{dir:"x",scrollEasing:"mcsEaseInOut",overwrite:c,dur:l})},e[0]._focusTimer))})},z=function(){var e=$(this),o=e.data(t),a=t+"_"+o.idx,n=$("#mCSB_"+o.idx+"_container").parent();n.bind("scroll."+a,function(e){(0!==n.scrollTop()||0!==n.scrollLeft())&&$(".mCSB_"+o.idx+"_scrollbar").css("visibility","hidden")})},P=function(){var e=$(this),o=e.data(t),a=o.opt,n=o.sequential,i=t+"_"+o.idx,r=".mCSB_"+o.idx+"_scrollbar",s=$(r+">a");s.bind("mousedown."+i+" touchstart."+i+" pointerdown."+i+" MSPointerDown."+i+" mouseup."+i+" touchend."+i+" pointerup."+i+" MSPointerUp."+i+" mouseout."+i+" pointerout."+i+" MSPointerOut."+i+" click."+i,function(t){function i(t,o){n.scrollAmount=a.scrollButtons.scrollAmount,U(e,t,o)}if(t.preventDefault(),K(t)){var r=$(this).attr("class");switch(n.type=a.scrollButtons.scrollType,t.type){case"mousedown":case"touchstart":case"pointerdown":case"MSPointerDown":if("stepped"===n.type)return;l=!0,o.tweenRunning=!1,i("on",r);break;case"mouseup":case"touchend":case"pointerup":case"MSPointerUp":case"mouseout":case"pointerout":case"MSPointerOut":if("stepped"===n.type)return;l=!1,n.dir&&i("off",r);break;case"click":if("stepped"!==n.type||o.tweenRunning)return;i("on",r)}}})},H=function(){function e(e){function t(e,t){i.type=n.keyboard.scrollType,i.scrollAmount=n.keyboard.scrollAmount,"stepped"===i.type&&a.tweenRunning||U(o,e,t)}switch(e.type){case"blur":a.tweenRunning&&i.dir&&t("off",null);break;case"keydown":case"keyup":var r=e.keyCode?e.keyCode:e.which,l="on";if("x"!==n.axis&&(38===r||40===r)||"y"!==n.axis&&(37===r||39===r)){if((38===r||40===r)&&!a.overflowed[0]||(37===r||39===r)&&!a.overflowed[1])return;"keyup"===e.type&&(l="off"),$(document.activeElement).is(d)||(e.preventDefault(),e.stopImmediatePropagation(),t(l,r))}else if(33===r||34===r){if((a.overflowed[0]||a.overflowed[1])&&(e.preventDefault(),e.stopImmediatePropagation()),"keyup"===e.type){j(o);var u=34===r?-1:1;if("x"===n.axis||"yx"===n.axis&&a.overflowed[1]&&!a.overflowed[0])var f="x",h=Math.abs(s[0].offsetLeft)-u*(.9*c.width());else var f="y",h=Math.abs(s[0].offsetTop)-u*(.9*c.height());N(o,h.toString(),{dir:f,scrollEasing:"mcsEaseInOut"})}}else if((35===r||36===r)&&!$(document.activeElement).is(d)&&((a.overflowed[0]||a.overflowed[1])&&(e.preventDefault(),e.stopImmediatePropagation()),"keyup"===e.type)){if("x"===n.axis||"yx"===n.axis&&a.overflowed[1]&&!a.overflowed[0])var f="x",h=35===r?Math.abs(c.width()-s.outerWidth(!1)):0;else var f="y",h=35===r?Math.abs(c.height()-s.outerHeight(!1)):0;N(o,h.toString(),{dir:f,scrollEasing:"mcsEaseInOut"})}}}var o=$(this),a=o.data(t),n=a.opt,i=a.sequential,r=t+"_"+a.idx,l=$("#mCSB_"+a.idx),s=$("#mCSB_"+a.idx+"_container"),c=s.parent(),d="input,textarea,select,datalist,keygen,[contenteditable='true']",u=s.find("iframe"),f=["blur."+r+" keydown."+r+" keyup."+r];u.length&&u.each(function(){$(this).load(function(){R(this)&&$(this.contentDocument||this.contentWindow.document).bind(f[0],function(t){e(t)})})}),l.attr("tabindex","0").bind(f[0],function(t){e(t)})},U=function(e,o,a,n,i){function r(t){d.snapAmount&&(u.scrollAmount=d.snapAmount instanceof Array?"x"===u.dir[0]?d.snapAmount[1]:d.snapAmount[0]:d.snapAmount);var o="stepped"!==u.type,a=i?i:t?o?m/1.5:p:1e3/60,l=t?o?7.5:40:2.5,c=[Math.abs(f[0].offsetTop),Math.abs(f[0].offsetLeft)],h=[s.scrollRatio.y>10?10:s.scrollRatio.y,s.scrollRatio.x>10?10:s.scrollRatio.x],g="x"===u.dir[0]?c[1]+u.dir[1]*(h[1]*l):c[0]+u.dir[1]*(h[0]*l),v="x"===u.dir[0]?c[1]+u.dir[1]*parseInt(u.scrollAmount):c[0]+u.dir[1]*parseInt(u.scrollAmount),x="auto"!==u.scrollAmount?v:g,_=n?n:t?o?"mcsLinearOut":"mcsEaseInOut":"mcsLinear",w=t?!0:!1;return t&&17>a&&(x="x"===u.dir[0]?c[1]:c[0]),N(e,x.toString(),{dir:u.dir[0],scrollEasing:_,dur:a,onComplete:w}),t?void(u.dir=!1):(clearTimeout(u.step),void(u.step=setTimeout(function(){r()},a)))}function l(){clearTimeout(u.step),J(u,"step"),j(e)}var s=e.data(t),d=s.opt,u=s.sequential,f=$("#mCSB_"+s.idx+"_container"),h="stepped"===u.type?!0:!1,m=d.scrollInertia<26?26:d.scrollInertia,p=d.scrollInertia<1?17:d.scrollInertia;switch(o){case"on":if(u.dir=[a===c[16]||a===c[15]||39===a||37===a?"x":"y",a===c[13]||a===c[15]||38===a||37===a?-1:1],j(e),ee(a)&&"stepped"===u.type)return;r(h);break;case"off":l(),(h||s.tweenRunning&&u.dir)&&r(!0)}},F=function(e){var o=$(this).data(t).opt,a=[];return"function"==typeof e&&(e=e()),e instanceof Array?a=e.length>1?[e[0],e[1]]:"x"===o.axis?[null,e[0]]:[e[0],null]:(a[0]=e.y?e.y:e.x||"x"===o.axis?null:e,a[1]=e.x?e.x:e.y||"y"===o.axis?null:e),"function"==typeof a[0]&&(a[0]=a[0]()),"function"==typeof a[1]&&(a[1]=a[1]()),a},q=function(e,o){if(null!=e&&"undefined"!=typeof e){var a=$(this),n=a.data(t),i=n.opt,r=$("#mCSB_"+n.idx+"_container"),l=r.parent(),s=typeof e;o||(o="x"===i.axis?"x":"y");var c="x"===o?r.outerWidth(!1):r.outerHeight(!1),u="x"===o?r[0].offsetLeft:r[0].offsetTop,f="x"===o?"left":"top";switch(s){case"function":return e();break;case"object":var h=e.jquery?e:$(e);if(!h.length)return;return"x"===o?te(h)[1]:te(h)[0];break;case"string":case"number":if(ee(e))return Math.abs(e);if(-1!==e.indexOf("%"))return Math.abs(c*parseInt(e)/100);if(-1!==e.indexOf("-="))return Math.abs(u-parseInt(e.split("-=")[1]));if(-1!==e.indexOf("+=")){var m=u+parseInt(e.split("+=")[1]);return m>=0?0:Math.abs(m)}if(-1!==e.indexOf("px")&&ee(e.split("px")[0]))return Math.abs(e.split("px")[0]);if("top"===e||"left"===e)return 0;if("bottom"===e)return Math.abs(l.height()-r.outerHeight(!1));if("right"===e)return Math.abs(l.width()-r.outerWidth(!1));if("first"===e||"last"===e){var h=r.find(":"+e);return"x"===o?te(h)[1]:te(h)[0]}return $(e).length?"x"===o?te($(e))[1]:te($(e))[0]:(r.css(f,e),void d.update.call(null,a[0]))}}},Y=function(e){function o(){return clearTimeout(u[0].autoUpdate),0===r.parents("html").length?void(r=null):void(u[0].autoUpdate=setTimeout(function(){return s.advanced.updateOnSelectorChange&&(l.poll.change.n=n(),l.poll.change.n!==l.poll.change.o)?(l.poll.change.o=l.poll.change.n,void i(3)):s.advanced.updateOnContentResize&&(l.poll.size.n=r[0].scrollHeight+r[0].scrollWidth+u[0].offsetHeight+r[0].offsetHeight+r[0].offsetWidth,l.poll.size.n!==l.poll.size.o)?(l.poll.size.o=l.poll.size.n,void i(1)):!s.advanced.updateOnImageLoad||"auto"===s.advanced.updateOnImageLoad&&"y"===s.axis||(l.poll.img.n=u.find("img").length,l.poll.img.n===l.poll.img.o)?void((s.advanced.updateOnSelectorChange||s.advanced.updateOnContentResize||s.advanced.updateOnImageLoad)&&o()):(l.poll.img.o=l.poll.img.n,void u.find("img").each(function(){a(this)}))},s.advanced.autoUpdateTimeout))}function a(e){function t(e,t){return function(){return t.apply(e,arguments)}}function o(){this.onload=null,$(e).addClass(c[2]),i(2)}if($(e).hasClass(c[2]))return void i();var a=new Image;a.onload=t(a,o),a.src=e.src}function n(){s.advanced.updateOnSelectorChange===!0&&(s.advanced.updateOnSelectorChange="*");var e=0,t=u.find(s.advanced.updateOnSelectorChange);
return s.advanced.updateOnSelectorChange&&t.length>0&&t.each(function(){e+=this.offsetHeight+this.offsetWidth}),e}function i(e){clearTimeout(u[0].autoUpdate),d.update.call(null,r[0],e)}var r=$(this),l=r.data(t),s=l.opt,u=$("#mCSB_"+l.idx+"_container");return e?(clearTimeout(u[0].autoUpdate),void J(u[0],"autoUpdate")):void o()},X=function(e,t,o){return Math.round(e/t)*t-o},j=function(e){var o=e.data(t),a=$("#mCSB_"+o.idx+"_container,#mCSB_"+o.idx+"_container_wrapper,#mCSB_"+o.idx+"_dragger_vertical,#mCSB_"+o.idx+"_dragger_horizontal");a.each(function(){G.call(this)})},N=function(e,o,a){function n(e){return l&&s.callbacks[e]&&"function"==typeof s.callbacks[e]}function i(){return[s.callbacks.alwaysTriggerOffsets||_>=w[0]+C,s.callbacks.alwaysTriggerOffsets||-y>=_]}function r(){var t=[f[0].offsetTop,f[0].offsetLeft],o=[v[0].offsetTop,v[0].offsetLeft],n=[f.outerHeight(!1),f.outerWidth(!1)],i=[u.height(),u.width()];e[0].mcs={content:f,top:t[0],left:t[1],draggerTop:o[0],draggerLeft:o[1],topPct:Math.round(100*Math.abs(t[0])/(Math.abs(n[0])-i[0])),leftPct:Math.round(100*Math.abs(t[1])/(Math.abs(n[1])-i[1])),direction:a.dir}}var l=e.data(t),s=l.opt,c={trigger:"internal",dir:"y",scrollEasing:"mcsEaseOut",drag:!1,dur:s.scrollInertia,overwrite:"all",callbacks:!0,onStart:!0,onUpdate:!0,onComplete:!0},a=$.extend(c,a),d=[a.dur,a.drag?0:a.dur],u=$("#mCSB_"+l.idx),f=$("#mCSB_"+l.idx+"_container"),h=f.parent(),m=s.callbacks.onTotalScrollOffset?F.call(e,s.callbacks.onTotalScrollOffset):[0,0],p=s.callbacks.onTotalScrollBackOffset?F.call(e,s.callbacks.onTotalScrollBackOffset):[0,0];if(l.trigger=a.trigger,(0!==h.scrollTop()||0!==h.scrollLeft())&&($(".mCSB_"+l.idx+"_scrollbar").css("visibility","visible"),h.scrollTop(0).scrollLeft(0)),"_resetY"!==o||l.contentReset.y||(n("onOverflowYNone")&&s.callbacks.onOverflowYNone.call(e[0]),l.contentReset.y=1),"_resetX"!==o||l.contentReset.x||(n("onOverflowXNone")&&s.callbacks.onOverflowXNone.call(e[0]),l.contentReset.x=1),"_resetY"!==o&&"_resetX"!==o){if(!l.contentReset.y&&e[0].mcs||!l.overflowed[0]||(n("onOverflowY")&&s.callbacks.onOverflowY.call(e[0]),l.contentReset.x=null),!l.contentReset.x&&e[0].mcs||!l.overflowed[1]||(n("onOverflowX")&&s.callbacks.onOverflowX.call(e[0]),l.contentReset.x=null),s.snapAmount){var g=s.snapAmount instanceof Array?"x"===a.dir?s.snapAmount[1]:s.snapAmount[0]:s.snapAmount;o=X(o,g,s.snapOffset)}switch(a.dir){case"x":var v=$("#mCSB_"+l.idx+"_dragger_horizontal"),x="left",_=f[0].offsetLeft,w=[u.width()-f.outerWidth(!1),v.parent().width()-v.width()],S=[o,0===o?0:o/l.scrollRatio.x],C=m[1],y=p[1],B=C>0?C/l.scrollRatio.x:0,T=y>0?y/l.scrollRatio.x:0;break;case"y":var v=$("#mCSB_"+l.idx+"_dragger_vertical"),x="top",_=f[0].offsetTop,w=[u.height()-f.outerHeight(!1),v.parent().height()-v.height()],S=[o,0===o?0:o/l.scrollRatio.y],C=m[0],y=p[0],B=C>0?C/l.scrollRatio.y:0,T=y>0?y/l.scrollRatio.y:0}S[1]<0||0===S[0]&&0===S[1]?S=[0,0]:S[1]>=w[1]?S=[w[0],w[1]]:S[0]=-S[0],e[0].mcs||(r(),n("onInit")&&s.callbacks.onInit.call(e[0])),clearTimeout(f[0].onCompleteTimeout),V(v[0],x,Math.round(S[1]),d[1],a.scrollEasing),(l.tweenRunning||!(0===_&&S[0]>=0||_===w[0]&&S[0]<=w[0]))&&V(f[0],x,Math.round(S[0]),d[0],a.scrollEasing,a.overwrite,{onStart:function(){a.callbacks&&a.onStart&&!l.tweenRunning&&(n("onScrollStart")&&(r(),s.callbacks.onScrollStart.call(e[0])),l.tweenRunning=!0,b(v),l.cbOffsets=i())},onUpdate:function(){a.callbacks&&a.onUpdate&&n("whileScrolling")&&(r(),s.callbacks.whileScrolling.call(e[0]))},onComplete:function(){if(a.callbacks&&a.onComplete){"yx"===s.axis&&clearTimeout(f[0].onCompleteTimeout);var t=f[0].idleTimer||0;f[0].onCompleteTimeout=setTimeout(function(){n("onScroll")&&(r(),s.callbacks.onScroll.call(e[0])),n("onTotalScroll")&&S[1]>=w[1]-B&&l.cbOffsets[0]&&(r(),s.callbacks.onTotalScroll.call(e[0])),n("onTotalScrollBack")&&S[1]<=T&&l.cbOffsets[1]&&(r(),s.callbacks.onTotalScrollBack.call(e[0])),l.tweenRunning=!1,f[0].idleTimer=0,b(v,"hide")},t)}}})}},V=function(e,t,o,a,n,i,r){function l(){S.stop||(v||f.call(),v=Q()-p,s(),v>=S.time&&(S.time=v>S.time?v+g-(v-S.time):v+g-1,S.time<v+1&&(S.time=v+1)),S.time<a?S.id=w(l):m.call())}function s(){a>0?(S.currVal=u(S.time,x,b,a,n),_[t]=Math.round(S.currVal)+"px"):_[t]=o+"px",h.call()}function c(){g=1e3/60,S.time=v+g,w=window.requestAnimationFrame?window.requestAnimationFrame:function(e){return s(),setTimeout(e,.01)},S.id=w(l)}function d(){null!=S.id&&(window.requestAnimationFrame?window.cancelAnimationFrame(S.id):clearTimeout(S.id),S.id=null)}function u(e,t,o,a,n){switch(n){case"linear":case"mcsLinear":return o*e/a+t;break;case"mcsLinearOut":return e/=a,e--,o*Math.sqrt(1-e*e)+t;break;case"easeInOutSmooth":return e/=a/2,1>e?o/2*e*e+t:(e--,-o/2*(e*(e-2)-1)+t);break;case"easeInOutStrong":return e/=a/2,1>e?o/2*Math.pow(2,10*(e-1))+t:(e--,o/2*(-Math.pow(2,-10*e)+2)+t);break;case"easeInOut":case"mcsEaseInOut":return e/=a/2,1>e?o/2*e*e*e+t:(e-=2,o/2*(e*e*e+2)+t);break;case"easeOutSmooth":return e/=a,e--,-o*(e*e*e*e-1)+t;break;case"easeOutStrong":return o*(-Math.pow(2,-10*e/a)+1)+t;break;case"easeOut":case"mcsEaseOut":default:var i=(e/=a)*e,r=i*e;return t+o*(.499999999999997*r*i+-2.5*i*i+5.5*r+-6.5*i+4*e)}}e._mTween||(e._mTween={top:{},left:{}});var r=r||{},f=r.onStart||function(){},h=r.onUpdate||function(){},m=r.onComplete||function(){},p=Q(),g,v=0,x=e.offsetTop,_=e.style,w,S=e._mTween[t];"left"===t&&(x=e.offsetLeft);var b=o-x;S.stop=0,"none"!==i&&d(),c()},Q=function(){return window.performance&&window.performance.now?window.performance.now():window.performance&&window.performance.webkitNow?window.performance.webkitNow():Date.now?Date.now():(new Date).getTime()},G=function(){var e=this;e._mTween||(e._mTween={top:{},left:{}});for(var t=["top","left"],o=0;o<t.length;o++){var a=t[o];e._mTween[a].id&&(window.requestAnimationFrame?window.cancelAnimationFrame(e._mTween[a].id):clearTimeout(e._mTween[a].id),e._mTween[a].id=null,e._mTween[a].stop=1)}},J=function(e,t){try{delete e[t]}catch(o){e[t]=null}},K=function(e){return!(e.which&&1!==e.which)},Z=function(e){var t=e.originalEvent.pointerType;return!(t&&"touch"!==t&&2!==t)},ee=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},te=function(e){var t=e.parents(".mCSB_container");return[e.offset().top-t.offset().top,e.offset().left-t.offset().left]},oe=function(){function e(){var e=["webkit","moz","ms","o"];if("hidden"in document)return"hidden";for(var t=0;t<e.length;t++)if(e[t]+"Hidden"in document)return e[t]+"Hidden";return null}var t=e();return t?document[t]:!1};$.fn[e]=function(e){return d[e]?d[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist"):d.init.apply(this,arguments)},$[e]=function(e){return d[e]?d[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist"):d.init.apply(this,arguments)},$[e].defaults=a,window[e]=!0,$(window).load(function(){$(o)[e](),$.extend($.expr[":"],{mcsInView:$.expr[":"].mcsInView||function(e){var t=$(e),o=t.parents(".mCSB_container"),a,n;if(o.length)return a=o.parent(),n=[o[0].offsetTop,o[0].offsetLeft],n[0]+te(t)[0]>=0&&n[0]+te(t)[0]<a.height()-t.outerHeight(!1)&&n[1]+te(t)[1]>=0&&n[1]+te(t)[1]<a.width()-t.outerWidth(!1)},mcsOverflow:$.expr[":"].mcsOverflow||function(e){var o=$(e).data(t);if(o)return o.overflowed[0]||o.overflowed[1]}})})})});
!function(t,o,e){function i(o,e){this.bodyOverflowX,this.callbacks={hide:[],show:[]},this.checkInterval=null,this.Content,this.$el=t(o),this.$elProxy,this.elProxyPosition,this.enabled=!0,this.options=t.extend({},l,e),this.mouseIsOverProxy=!1,this.namespace="tooltipster-"+Math.round(1e5*Math.random()),this.Status="hidden",this.timerHide=null,this.timerShow=null,this.$tooltip,this.options.iconTheme=this.options.iconTheme.replace(".",""),this.options.theme=this.options.theme.replace(".",""),this._init()}function n(o,e){var i=!0;return t.each(o,function(t,n){return"undefined"==typeof e[t]||o[t]!==e[t]?(i=!1,!1):void 0}),i}function s(){return!f&&p}function r(){var t=e.body||e.documentElement,o=t.style,i="transition";if("string"==typeof o[i])return!0;v=["Moz","Webkit","Khtml","O","ms"],i=i.charAt(0).toUpperCase()+i.substr(1);for(var n=0;n<v.length;n++)if("string"==typeof o[v[n]+i])return!0;return!1}var a="tooltipster",l={animation:"fade",arrow:!0,arrowColor:"",autoClose:!0,content:null,contentAsHTML:!1,contentCloning:!0,debug:!0,delay:200,minWidth:0,maxWidth:null,functionInit:function(t,o){},functionBefore:function(t,o){o()},functionReady:function(t,o){},functionAfter:function(t){},hideOnClick:!1,icon:"(?)",iconCloning:!0,iconDesktop:!1,iconTouch:!1,iconTheme:"tooltipster-icon",interactive:!1,interactiveTolerance:350,multiple:!1,offsetX:0,offsetY:0,onlyOne:!1,position:"top",positionTracker:!1,positionTrackerCallback:function(t){"hover"==this.option("trigger")&&this.option("autoClose")&&this.hide()},restoration:"current",speed:350,timer:0,theme:"tooltipster-default",touchDevices:!0,trigger:"hover",updateAnimation:!0};i.prototype={_init:function(){var o=this;if(e.querySelector){var i=null;void 0===o.$el.data("tooltipster-initialTitle")&&(i=o.$el.attr("title"),void 0===i&&(i=null),o.$el.data("tooltipster-initialTitle",i)),null!==o.options.content?o._content_set(o.options.content):o._content_set(i);var n=o.options.functionInit.call(o.$el,o.$el,o.Content);"undefined"!=typeof n&&o._content_set(n),o.$el.removeAttr("title").addClass("tooltipstered"),!p&&o.options.iconDesktop||p&&o.options.iconTouch?("string"==typeof o.options.icon?(o.$elProxy=t('<span class="'+o.options.iconTheme+'"></span>'),o.$elProxy.text(o.options.icon)):o.options.iconCloning?o.$elProxy=o.options.icon.clone(!0):o.$elProxy=o.options.icon,o.$elProxy.insertAfter(o.$el)):o.$elProxy=o.$el,"hover"==o.options.trigger?(o.$elProxy.on("mouseenter."+o.namespace,function(){(!s()||o.options.touchDevices)&&(o.mouseIsOverProxy=!0,o._show())}).on("mouseleave."+o.namespace,function(){(!s()||o.options.touchDevices)&&(o.mouseIsOverProxy=!1)}),p&&o.options.touchDevices&&o.$elProxy.on("touchstart."+o.namespace,function(){o._showNow()})):"click"==o.options.trigger&&o.$elProxy.on("click."+o.namespace,function(){(!s()||o.options.touchDevices)&&o._show()})}},_show:function(){var t=this;"shown"!=t.Status&&"appearing"!=t.Status&&(t.options.delay?t.timerShow=setTimeout(function(){("click"==t.options.trigger||"hover"==t.options.trigger&&t.mouseIsOverProxy)&&t._showNow()},t.options.delay):t._showNow())},_showNow:function(e){var i=this;i.options.functionBefore.call(i.$el,i.$el,function(){if(i.enabled&&null!==i.Content){e&&i.callbacks.show.push(e),i.callbacks.hide=[],clearTimeout(i.timerShow),i.timerShow=null,clearTimeout(i.timerHide),i.timerHide=null,i.options.onlyOne&&t(".tooltipstered").not(i.$el).each(function(o,e){var i=t(e),n=i.data("tooltipster-ns");t.each(n,function(t,o){var e=i.data(o),n=e.status(),s=e.option("autoClose");"hidden"!==n&&"disappearing"!==n&&s&&e.hide()})});var n=function(){i.Status="shown",t.each(i.callbacks.show,function(t,o){o.call(i.$el)}),i.callbacks.show=[]};if("hidden"!==i.Status){var s=0;"disappearing"===i.Status?(i.Status="appearing",r()?(i.$tooltip.clearQueue().removeClass("tooltipster-dying").addClass("tooltipster-"+i.options.animation+"-show"),i.options.speed>0&&i.$tooltip.delay(i.options.speed),i.$tooltip.queue(n)):i.$tooltip.stop().fadeIn(n)):"shown"===i.Status&&n()}else{i.Status="appearing";var s=i.options.speed;i.bodyOverflowX=t("body").css("overflow-x"),t("body").css("overflow-x","hidden");var a="tooltipster-"+i.options.animation,l="-webkit-transition-duration: "+i.options.speed+"ms; -webkit-animation-duration: "+i.options.speed+"ms; -moz-transition-duration: "+i.options.speed+"ms; -moz-animation-duration: "+i.options.speed+"ms; -o-transition-duration: "+i.options.speed+"ms; -o-animation-duration: "+i.options.speed+"ms; -ms-transition-duration: "+i.options.speed+"ms; -ms-animation-duration: "+i.options.speed+"ms; transition-duration: "+i.options.speed+"ms; animation-duration: "+i.options.speed+"ms;",f=i.options.minWidth?"min-width:"+Math.round(i.options.minWidth)+"px;":"",d=i.options.maxWidth?"max-width:"+Math.round(i.options.maxWidth)+"px;":"",c=i.options.interactive?"pointer-events: auto;":"";if(i.$tooltip=t('<div class="tooltipster-base '+i.options.theme+'" style="'+f+" "+d+" "+c+" "+l+'"><div class="tooltipster-content"></div></div>'),r()&&i.$tooltip.addClass(a),i._content_insert(),i.$tooltip.appendTo("body"),i.reposition(),i.options.functionReady.call(i.$el,i.$el,i.$tooltip),r()?(i.$tooltip.addClass(a+"-show"),i.options.speed>0&&i.$tooltip.delay(i.options.speed),i.$tooltip.queue(n)):i.$tooltip.css("display","none").fadeIn(i.options.speed,n),i._interval_set(),t(o).on("scroll."+i.namespace+" resize."+i.namespace,function(){i.reposition()}),i.options.autoClose)if(t("body").off("."+i.namespace),"hover"==i.options.trigger){if(p&&setTimeout(function(){t("body").on("touchstart."+i.namespace,function(){i.hide()})},0),i.options.interactive){p&&i.$tooltip.on("touchstart."+i.namespace,function(t){t.stopPropagation()});var h=null;i.$elProxy.add(i.$tooltip).on("mouseleave."+i.namespace+"-autoClose",function(){clearTimeout(h),h=setTimeout(function(){i.hide()},i.options.interactiveTolerance)}).on("mouseenter."+i.namespace+"-autoClose",function(){clearTimeout(h)})}else i.$elProxy.on("mouseleave."+i.namespace+"-autoClose",function(){i.hide()});i.options.hideOnClick&&i.$elProxy.on("click."+i.namespace+"-autoClose",function(){i.hide()})}else"click"==i.options.trigger&&(setTimeout(function(){t("body").on("click."+i.namespace+" touchstart."+i.namespace,function(){i.hide()})},0),i.options.interactive&&i.$tooltip.on("click."+i.namespace+" touchstart."+i.namespace,function(t){t.stopPropagation()}))}i.options.timer>0&&(i.timerHide=setTimeout(function(){i.timerHide=null,i.hide()},i.options.timer+s))}})},_interval_set:function(){var o=this;o.checkInterval=setInterval(function(){if(0===t("body").find(o.$el).length||0===t("body").find(o.$elProxy).length||"hidden"==o.Status||0===t("body").find(o.$tooltip).length)("shown"==o.Status||"appearing"==o.Status)&&o.hide(),o._interval_cancel();else if(o.options.positionTracker){var e=o._repositionInfo(o.$elProxy),i=!1;n(e.dimension,o.elProxyPosition.dimension)&&("fixed"===o.$elProxy.css("position")?n(e.position,o.elProxyPosition.position)&&(i=!0):n(e.offset,o.elProxyPosition.offset)&&(i=!0)),i||(o.reposition(),o.options.positionTrackerCallback.call(o,o.$el))}},200)},_interval_cancel:function(){clearInterval(this.checkInterval),this.checkInterval=null},_content_set:function(t){"object"==typeof t&&null!==t&&this.options.contentCloning&&(t=t.clone(!0)),this.Content=t},_content_insert:function(){var t=this,o=this.$tooltip.find(".tooltipster-content");"string"!=typeof t.Content||t.options.contentAsHTML?o.empty().append(t.Content):o.text(t.Content)},_update:function(t){var o=this;o._content_set(t),null!==o.Content?"hidden"!==o.Status&&(o._content_insert(),o.reposition(),o.options.updateAnimation&&(r()?(o.$tooltip.css({width:"","-webkit-transition":"all "+o.options.speed+"ms, width 0ms, height 0ms, left 0ms, top 0ms","-moz-transition":"all "+o.options.speed+"ms, width 0ms, height 0ms, left 0ms, top 0ms","-o-transition":"all "+o.options.speed+"ms, width 0ms, height 0ms, left 0ms, top 0ms","-ms-transition":"all "+o.options.speed+"ms, width 0ms, height 0ms, left 0ms, top 0ms",transition:"all "+o.options.speed+"ms, width 0ms, height 0ms, left 0ms, top 0ms"}).addClass("tooltipster-content-changing"),setTimeout(function(){"hidden"!=o.Status&&(o.$tooltip.removeClass("tooltipster-content-changing"),setTimeout(function(){"hidden"!==o.Status&&o.$tooltip.css({"-webkit-transition":o.options.speed+"ms","-moz-transition":o.options.speed+"ms","-o-transition":o.options.speed+"ms","-ms-transition":o.options.speed+"ms",transition:o.options.speed+"ms"})},o.options.speed))},o.options.speed)):o.$tooltip.fadeTo(o.options.speed,.5,function(){"hidden"!=o.Status&&o.$tooltip.fadeTo(o.options.speed,1)}))):o.hide()},_repositionInfo:function(t){return{dimension:{height:t.outerHeight(!1),width:t.outerWidth(!1)},offset:t.offset(),position:{left:parseInt(t.css("left")),top:parseInt(t.css("top"))}}},hide:function(e){var i=this;e&&i.callbacks.hide.push(e),i.callbacks.show=[],clearTimeout(i.timerShow),i.timerShow=null,clearTimeout(i.timerHide),i.timerHide=null;var n=function(){t.each(i.callbacks.hide,function(t,o){o.call(i.$el)}),i.callbacks.hide=[]};if("shown"==i.Status||"appearing"==i.Status){i.Status="disappearing";var s=function(){i.Status="hidden","object"==typeof i.Content&&null!==i.Content&&i.Content.detach(),i.$tooltip.remove(),i.$tooltip=null,t(o).off("."+i.namespace),t("body").off("."+i.namespace).css("overflow-x",i.bodyOverflowX),t("body").off("."+i.namespace),i.$elProxy.off("."+i.namespace+"-autoClose"),i.options.functionAfter.call(i.$el,i.$el),n()};r()?(i.$tooltip.clearQueue().removeClass("tooltipster-"+i.options.animation+"-show").addClass("tooltipster-dying"),i.options.speed>0&&i.$tooltip.delay(i.options.speed),i.$tooltip.queue(s)):i.$tooltip.stop().fadeOut(i.options.speed,s)}else"hidden"==i.Status&&n();return i},show:function(t){return this._showNow(t),this},update:function(t){return this.content(t)},content:function(t){return"undefined"==typeof t?this.Content:(this._update(t),this)},reposition:function(){function e(){var e=t(o).scrollLeft();0>M-e&&(s=M-e,M=e),M+l-e>r&&(s=M-(r+e-l),M=r+e-l)}function i(e,i){a.offset.top-t(o).scrollTop()-f-A-12<0&&i.indexOf("top")>-1&&(F=e),a.offset.top+a.dimension.height+f+12+A>t(o).scrollTop()+t(o).height()&&i.indexOf("bottom")>-1&&(F=e,W=a.offset.top-f-A-12)}var n=this;if(0!==t("body").find(n.$tooltip).length){n.$tooltip.css("width",""),n.elProxyPosition=n._repositionInfo(n.$elProxy);var s=null,r=t(o).width(),a=n.elProxyPosition,l=n.$tooltip.outerWidth(!1),p=n.$tooltip.innerWidth()+1,f=n.$tooltip.outerHeight(!1);if(n.$elProxy.is("area")){var d=n.$elProxy.attr("shape"),c=n.$elProxy.parent().attr("name"),h=t('img[usemap="#'+c+'"]'),u=h.offset().left,m=h.offset().top,v=void 0!==n.$elProxy.attr("coords")?n.$elProxy.attr("coords").split(","):void 0;if("circle"==d){var g=parseInt(v[0]),y=parseInt(v[1]),w=parseInt(v[2]);a.dimension.height=2*w,a.dimension.width=2*w,a.offset.top=m+y-w,a.offset.left=u+g-w}else if("rect"==d){var g=parseInt(v[0]),y=parseInt(v[1]),b=parseInt(v[2]),x=parseInt(v[3]);a.dimension.height=x-y,a.dimension.width=b-g,a.offset.top=m+y,a.offset.left=u+g}else if("poly"==d){for(var C=[],P=[],T=0,_=0,k=0,I=0,S="even",O=0;O<v.length;O++){var H=parseInt(v[O]);"even"==S?(H>k&&(k=H,0===O&&(T=k)),T>H&&(T=H),S="odd"):(H>I&&(I=H,1==O&&(_=I)),_>H&&(_=H),S="even")}a.dimension.height=I-_,a.dimension.width=k-T,a.offset.top=m+_,a.offset.left=u+T}else a.dimension.height=h.outerHeight(!1),a.dimension.width=h.outerWidth(!1),a.offset.top=m,a.offset.left=u}var M=0,D=0,W=0,A=parseInt(n.options.offsetY),z=parseInt(n.options.offsetX),F=n.options.position;if("top"==F){var N=a.offset.left+l-(a.offset.left+a.dimension.width);M=a.offset.left+z-N/2,W=a.offset.top-f-A-12,e(),i("bottom","top")}if("top-left"==F&&(M=a.offset.left+z,W=a.offset.top-f-A-12,e(),i("bottom-left","top-left")),"top-right"==F&&(M=a.offset.left+a.dimension.width+z-l,W=a.offset.top-f-A-12,e(),i("bottom-right","top-right")),"bottom"==F){var N=a.offset.left+l-(a.offset.left+a.dimension.width);M=a.offset.left-N/2+z,W=a.offset.top+a.dimension.height+A+12,e(),i("top","bottom")}if("bottom-left"==F&&(M=a.offset.left+z,W=a.offset.top+a.dimension.height+A+12,e(),i("top-left","bottom-left")),"bottom-right"==F&&(M=a.offset.left+a.dimension.width+z-l,W=a.offset.top+a.dimension.height+A+12,e(),i("top-right","bottom-right")),"left"==F){M=a.offset.left-z-l-12,D=a.offset.left+z+a.dimension.width+12;var X=a.offset.top+f-(a.offset.top+a.dimension.height);if(W=a.offset.top-X/2-A,0>M&&D+l>r){var q=2*parseFloat(n.$tooltip.css("border-width")),j=l+M-q;n.$tooltip.css("width",j+"px"),f=n.$tooltip.outerHeight(!1),M=a.offset.left-z-j-12-q,X=a.offset.top+f-(a.offset.top+a.dimension.height),W=a.offset.top-X/2-A}else 0>M&&(M=a.offset.left+z+a.dimension.width+12,s="left")}if("right"==F){M=a.offset.left+z+a.dimension.width+12,D=a.offset.left-z-l-12;var X=a.offset.top+f-(a.offset.top+a.dimension.height);if(W=a.offset.top-X/2-A,M+l>r&&0>D){var q=2*parseFloat(n.$tooltip.css("border-width")),j=r-M-q;n.$tooltip.css("width",j+"px"),f=n.$tooltip.outerHeight(!1),X=a.offset.top+f-(a.offset.top+a.dimension.height),W=a.offset.top-X/2-A}else M+l>r&&(M=a.offset.left-z-l-12,s="right")}if(n.options.arrow){var E="tooltipster-arrow-"+F;if(n.options.arrowColor.length<1)var L=n.$tooltip.css("background-color");else var L=n.options.arrowColor;if(s?"left"==s?(E="tooltipster-arrow-right",s=""):"right"==s?(E="tooltipster-arrow-left",s=""):s="left:"+Math.round(s)+"px;":s="","top"==F||"top-left"==F||"top-right"==F)var Q=parseFloat(n.$tooltip.css("border-bottom-width")),U=n.$tooltip.css("border-bottom-color");else if("bottom"==F||"bottom-left"==F||"bottom-right"==F)var Q=parseFloat(n.$tooltip.css("border-top-width")),U=n.$tooltip.css("border-top-color");else if("left"==F)var Q=parseFloat(n.$tooltip.css("border-right-width")),U=n.$tooltip.css("border-right-color");else if("right"==F)var Q=parseFloat(n.$tooltip.css("border-left-width")),U=n.$tooltip.css("border-left-color");else var Q=parseFloat(n.$tooltip.css("border-bottom-width")),U=n.$tooltip.css("border-bottom-color");Q>1&&Q++;var Y="";if(0!==Q){var B="",R="border-color: "+U+";";-1!==E.indexOf("bottom")?B="margin-top: -"+Math.round(Q)+"px;":-1!==E.indexOf("top")?B="margin-bottom: -"+Math.round(Q)+"px;":-1!==E.indexOf("left")?B="margin-right: -"+Math.round(Q)+"px;":-1!==E.indexOf("right")&&(B="margin-left: -"+Math.round(Q)+"px;"),Y='<span class="tooltipster-arrow-border" style="'+B+" "+R+';"></span>'}n.$tooltip.find(".tooltipster-arrow").remove();var K='<div class="'+E+' tooltipster-arrow" style="'+s+'">'+Y+'<span style="border-color:'+L+';"></span></div>';n.$tooltip.append(K)}n.$tooltip.css({top:Math.round(W)+"px",left:Math.round(M)+"px"})}return n},enable:function(){return this.enabled=!0,this},disable:function(){return this.hide(),this.enabled=!1,this},destroy:function(){var o=this;o.hide(),o.$el[0]!==o.$elProxy[0]&&o.$elProxy.remove(),o.$el.removeData(o.namespace).off("."+o.namespace);var e=o.$el.data("tooltipster-ns");if(1===e.length){var i=null;"previous"===o.options.restoration?i=o.$el.data("tooltipster-initialTitle"):"current"===o.options.restoration&&(i="string"==typeof o.Content?o.Content:t("<div></div>").append(o.Content).html()),i&&o.$el.attr("title",i),o.$el.removeClass("tooltipstered").removeData("tooltipster-ns").removeData("tooltipster-initialTitle")}else e=t.grep(e,function(t,e){return t!==o.namespace}),o.$el.data("tooltipster-ns",e);return o},elementIcon:function(){return this.$el[0]!==this.$elProxy[0]?this.$elProxy[0]:void 0},elementTooltip:function(){return this.$tooltip?this.$tooltip[0]:void 0},option:function(t,o){return"undefined"==typeof o?this.options[t]:(this.options[t]=o,this)},status:function(){return this.Status}},t.fn[a]=function(){var o=arguments;if(0===this.length){if("string"==typeof o[0]){var e=!0;switch(o[0]){case"setDefaults":t.extend(l,o[1]);break;default:e=!1}return e?!0:this}return this}if("string"==typeof o[0]){var n="#*$~&";return this.each(function(){var e=t(this).data("tooltipster-ns"),i=e?t(this).data(e[0]):null;if(!i)throw new Error("You called Tooltipster's \""+o[0]+'" method on an uninitialized element');if("function"!=typeof i[o[0]])throw new Error('Unknown method .tooltipster("'+o[0]+'")');var s=i[o[0]](o[1],o[2]);return s!==i?(n=s,!1):void 0}),"#*$~&"!==n?n:this}var s=[],r=o[0]&&"undefined"!=typeof o[0].multiple,a=r&&o[0].multiple||!r&&l.multiple,p=o[0]&&"undefined"!=typeof o[0].debug,f=p&&o[0].debug||!p&&l.debug;return this.each(function(){var e=!1,n=t(this).data("tooltipster-ns"),r=null;n?a?e=!0:f&&console.log('Tooltipster: one or more tooltips are already attached to this element: ignoring. Use the "multiple" option to attach more tooltips.'):e=!0,e&&(r=new i(this,o[0]),n||(n=[]),n.push(r.namespace),t(this).data("tooltipster-ns",n),t(this).data(r.namespace,r)),s.push(r)}),a?s:this};var p=!!("ontouchstart"in o),f=!1;t("body").one("mousemove",function(){f=!0})}(jQuery,window,document);
!function(o){function t(o,t){if(!(o.originalEvent.touches.length>1)){o.preventDefault();var e=o.originalEvent.changedTouches[0],u=document.createEvent("MouseEvents");u.initMouseEvent(t,!0,!0,window,1,e.screenX,e.screenY,e.clientX,e.clientY,!1,!1,!1,!1,0,null),o.target.dispatchEvent(u)}}if(o.support.touch="ontouchend"in document,o.support.touch){var e,u=o.ui.mouse.prototype,n=u._mouseInit,c=u._mouseDestroy;u._touchStart=function(o){var u=this;!e&&u._mouseCapture(o.originalEvent.changedTouches[0])&&(e=!0,u._touchMoved=!1,t(o,"mouseover"),t(o,"mousemove"),t(o,"mousedown"))},u._touchMove=function(o){e&&(this._touchMoved=!0,t(o,"mousemove"))},u._touchEnd=function(o){e&&(t(o,"mouseup"),t(o,"mouseout"),this._touchMoved||t(o,"click"),e=!1)},u._mouseInit=function(){var t=this;t.element.bind({touchstart:o.proxy(t,"_touchStart"),touchmove:o.proxy(t,"_touchMove"),touchend:o.proxy(t,"_touchEnd")}),n.call(t)},u._mouseDestroy=function(){var t=this;t.element.unbind({touchstart:o.proxy(t,"_touchStart"),touchmove:o.proxy(t,"_touchMove"),touchend:o.proxy(t,"_touchEnd")}),c.call(t)}}}(jQuery);
function Tree(){var t=this;t.build_tree=function(e){var s=t.dyn_tree,r=t.stat_desc.static_tree,n=t.stat_desc.elems,o,i=-1,a;for(e.heap_len=0,e.heap_max=HEAP_SIZE,o=0;n>o;o++)0!==s[2*o]?(e.heap[++e.heap_len]=i=o,e.depth[o]=0):s[2*o+1]=0;for(;2>e.heap_len;)a=e.heap[++e.heap_len]=2>i?++i:0,s[2*a]=1,e.depth[a]=0,e.opt_len--,r&&(e.static_len-=r[2*a+1]);for(t.max_code=i,o=Math.floor(e.heap_len/2);o>=1;o--)e.pqdownheap(s,o);a=n;do o=e.heap[1],e.heap[1]=e.heap[e.heap_len--],e.pqdownheap(s,1),r=e.heap[1],e.heap[--e.heap_max]=o,e.heap[--e.heap_max]=r,s[2*a]=s[2*o]+s[2*r],e.depth[a]=Math.max(e.depth[o],e.depth[r])+1,s[2*o+1]=s[2*r+1]=a,e.heap[1]=a++,e.pqdownheap(s,1);while(2<=e.heap_len);e.heap[--e.heap_max]=e.heap[1],o=t.dyn_tree;for(var i=t.stat_desc.static_tree,u=t.stat_desc.extra_bits,c=t.stat_desc.extra_base,l=t.stat_desc.max_length,f,d,w=0,n=0;MAX_BITS>=n;n++)e.bl_count[n]=0;for(o[2*e.heap[e.heap_max]+1]=0,a=e.heap_max+1;HEAP_SIZE>a;a++)r=e.heap[a],n=o[2*o[2*r+1]+1]+1,n>l&&(n=l,w++),o[2*r+1]=n,r>t.max_code||(e.bl_count[n]++,f=0,r>=c&&(f=u[r-c]),d=o[2*r],e.opt_len+=d*(n+f),i&&(e.static_len+=d*(i[2*r+1]+f)));if(0!==w){do{for(n=l-1;0===e.bl_count[n];)n--;e.bl_count[n]--,e.bl_count[n+1]+=2,e.bl_count[l]--,w-=2}while(w>0);for(n=l;0!==n;n--)for(r=e.bl_count[n];0!==r;)i=e.heap[--a],i>t.max_code||(o[2*i+1]!=n&&(e.opt_len+=(n-o[2*i+1])*o[2*i],o[2*i+1]=n),r--)}for(o=t.max_code,a=e.bl_count,e=[],r=0,n=1;MAX_BITS>=n;n++)e[n]=r=r+a[n-1]<<1;for(a=0;o>=a;a++)if(u=s[2*a+1],0!==u){r=s,n=2*a,i=e[u]++,c=0;do c|=1&i,i>>>=1,c<<=1;while(0<--u);r[n]=c>>>1}}}function StaticTree(t,e,s,r,n){this.static_tree=t,this.extra_bits=e,this.extra_base=s,this.elems=r,this.max_length=n}function Config(t,e,s,r,n){this.good_length=t,this.max_lazy=e,this.nice_length=s,this.max_chain=r,this.func=n}function smaller(t,e,s,r){var n=t[2*e];return t=t[2*s],t>n||n==t&&r[e]<=r[s]}function Deflate(){function t(){var t;for(t=0;L_CODES>t;t++)G[2*t]=0;for(t=0;D_CODES>t;t++)Y[2*t]=0;for(t=0;BL_CODES>t;t++)J[2*t]=0;G[2*END_BLOCK]=1,rt=ot=y.opt_len=y.static_len=0}function e(t,e){var s,r=-1,n,o=t[1],i=0,a=7,u=4;for(0===o&&(a=138,u=3),t[2*(e+1)+1]=65535,s=0;e>=s;s++)n=o,o=t[2*(s+1)+1],++i<a&&n==o||(u>i?J[2*n]+=i:0!==n?(n!=r&&J[2*n]++,J[2*REP_3_6]++):10>=i?J[2*REPZ_3_10]++:J[2*REPZ_11_138]++,i=0,r=n,0===o?(a=138,u=3):n==o?(a=6,u=3):(a=7,u=4))}function s(t){y.pending_buf[y.pending++]=t}function r(t){s(255&t),s(t>>>8&255)}function n(t,e){ut>Buf_size-e?(at|=t<<ut&65535,r(at),at=t>>>Buf_size-ut,ut+=e-Buf_size):(at|=t<<ut&65535,ut+=e)}function o(t,e){var s=2*t;n(65535&e[s],65535&e[s+1])}function i(t,e){var s,r=-1,i,a=t[1],u=0,c=7,l=4;for(0===a&&(c=138,l=3),s=0;e>=s;s++)if(i=a,a=t[2*(s+1)+1],!(++u<c&&i==a)){if(l>u){do o(i,J);while(0!==--u)}else 0!==i?(i!=r&&(o(i,J),u--),o(REP_3_6,J),n(u-3,2)):10>=u?(o(REPZ_3_10,J),n(u-3,3)):(o(REPZ_11_138,J),n(u-11,7));u=0,r=i,0===a?(c=138,l=3):i==a?(c=6,l=3):(c=7,l=4)}}function a(){16==ut?(r(at),ut=at=0):ut>=8&&(s(255&at),at>>>=8,ut-=8)}function u(t,e){var s,r,n;if(y.pending_buf[nt+2*rt]=t>>>8&255,y.pending_buf[nt+2*rt+1]=255&t,y.pending_buf[et+rt]=255&e,rt++,0===t?G[2*e]++:(ot++,t--,G[2*(Tree._length_code[e]+LITERALS+1)]++,Y[2*Tree.d_code(t)]++),0===(8191&rt)&&Z>2){for(s=8*rt,r=L-z,n=0;D_CODES>n;n++)s+=Y[2*n]*(5+Tree.extra_dbits[n]);if(ot<Math.floor(rt/2)&&s>>>3<Math.floor(r/2))return!0}return rt==st-1}function c(t,e){var s,r,i=0,a,u;if(0!==rt)do s=y.pending_buf[nt+2*i]<<8&65280|255&y.pending_buf[nt+2*i+1],r=255&y.pending_buf[et+i],i++,0===s?o(r,t):(a=Tree._length_code[r],o(a+LITERALS+1,t),u=Tree.extra_lbits[a],0!==u&&(r-=Tree.base_length[a],n(r,u)),s--,a=Tree.d_code(s),o(a,e),u=Tree.extra_dbits[a],0!==u&&(s-=Tree.base_dist[a],n(s,u)));while(rt>i);o(END_BLOCK,t),it=t[2*END_BLOCK+1]}function l(){ut>8?r(at):ut>0&&s(255&at),ut=at=0}function f(t,e,s){n((STORED_BLOCK<<1)+(s?1:0),3),l(),it=8,r(e),r(~e),y.pending_buf.set(S.subarray(t,t+e),y.pending),y.pending+=e}function d(s){var r=z>=0?z:-1,o=L-z,a,u,d=0;if(Z>0){for(V.build_tree(y),Q.build_tree(y),e(G,V.max_code),e(Y,Q.max_code),tt.build_tree(y),d=BL_CODES-1;d>=3&&0===J[2*Tree.bl_order[d]+1];d--);y.opt_len+=3*(d+1)+14,a=y.opt_len+3+7>>>3,u=y.static_len+3+7>>>3,a>=u&&(a=u)}else a=u=o+5;if(a>=o+4&&-1!=r)f(r,o,s);else if(u==a)n((STATIC_TREES<<1)+(s?1:0),3),c(StaticTree.static_ltree,StaticTree.static_dtree);else{for(n((DYN_TREES<<1)+(s?1:0),3),r=V.max_code+1,o=Q.max_code+1,d+=1,n(r-257,5),n(o-1,5),n(d-4,4),a=0;d>a;a++)n(J[2*Tree.bl_order[a]+1],3);i(G,r-1),i(Y,o-1),c(G,Y)}t(),s&&l(),z=L,v.flush_pending()}function w(){var t,e,s,r;do{if(r=T-B-L,0===r&&0===L&&0===B)r=x;else if(-1==r)r--;else if(L>=x+x-MIN_LOOKAHEAD){S.set(S.subarray(x,x+x),0),H-=x,L-=x,z-=x,s=t=F;do e=65535&E[--s],E[s]=e>=x?e-x:0;while(0!==--t);s=t=x;do e=65535&A[--s],A[s]=e>=x?e-x:0;while(0!==--t);r+=x}if(0===v.avail_in)break;t=v.read_buf(S,L+B,r),B+=t,B>=MIN_MATCH&&(R=255&S[L],R=(R<<O^255&S[L+1])&C)}while(MIN_LOOKAHEAD>B&&0!==v.avail_in)}function m(t){var e=65535,s;for(e>g-5&&(e=g-5);;){if(1>=B){if(w(),0===B&&t==Z_NO_FLUSH)return NeedMore;if(0===B)break}if(L+=B,B=0,s=z+e,(0===L||L>=s)&&(B=L-s,L=s,d(!1),0===v.avail_out))return NeedMore;if(L-z>=x-MIN_LOOKAHEAD&&(d(!1),0===v.avail_out))return NeedMore}return d(t==Z_FINISH),0===v.avail_out?t==Z_FINISH?FinishStarted:NeedMore:t==Z_FINISH?FinishDone:BlockDone}function h(t){var e=P,s=L,r,n=U,o=L>x-MIN_LOOKAHEAD?L-(x-MIN_LOOKAHEAD):0,i=X,a=k,u=L+MAX_MATCH,c=S[s+n-1],l=S[s+n];U>=W&&(e>>=2),i>B&&(i=B);do if(r=t,S[r+n]==l&&S[r+n-1]==c&&S[r]==S[s]&&S[++r]==S[s+1]){s+=2,r++;do;while(S[++s]==S[++r]&&S[++s]==S[++r]&&S[++s]==S[++r]&&S[++s]==S[++r]&&S[++s]==S[++r]&&S[++s]==S[++r]&&S[++s]==S[++r]&&S[++s]==S[++r]&&u>s);if(r=MAX_MATCH-(u-s),s=u-MAX_MATCH,r>n){if(H=t,n=r,r>=i)break;c=S[s+n-1],l=S[s+n]}}while((t=65535&A[t&a])>o&&0!==--e);return B>=n?n:B}function p(t){for(var e=0,s,r;;){if(MIN_LOOKAHEAD>B){if(w(),MIN_LOOKAHEAD>B&&t==Z_NO_FLUSH)return NeedMore;if(0===B)break}if(B>=MIN_MATCH&&(R=(R<<O^255&S[L+(MIN_MATCH-1)])&C,e=65535&E[R],A[L&k]=E[R],E[R]=L),U=N,M=H,N=MIN_MATCH-1,0!==e&&j>U&&x-MIN_LOOKAHEAD>=(L-e&65535)&&(K!=Z_HUFFMAN_ONLY&&(N=h(e)),5>=N&&(K==Z_FILTERED||N==MIN_MATCH&&L-H>4096)&&(N=MIN_MATCH-1)),U>=MIN_MATCH&&U>=N){r=L+B-MIN_MATCH,s=u(L-1-M,U-MIN_MATCH),B-=U-1,U-=2;do++L<=r&&(R=(R<<O^255&S[L+(MIN_MATCH-1)])&C,e=65535&E[R],A[L&k]=E[R],E[R]=L);while(0!==--U);if(D=0,N=MIN_MATCH-1,L++,s&&(d(!1),0===v.avail_out))return NeedMore}else if(0!==D){if((s=u(0,255&S[L-1]))&&d(!1),L++,B--,0===v.avail_out)return NeedMore}else D=1,L++,B--}return 0!==D&&(u(0,255&S[L-1]),D=0),d(t==Z_FINISH),0===v.avail_out?t==Z_FINISH?FinishStarted:NeedMore:t==Z_FINISH?FinishDone:BlockDone}var y=this,v,_,g,q,x,b,k,S,T,A,E,R,F,I,C,O,z,N,M,D,L,H,B,U,P,j,Z,K,W,X,G,Y,J,V=new Tree,Q=new Tree,tt=new Tree;y.depth=[];var et,st,rt,nt,ot,it,at,ut;y.bl_count=[],y.heap=[],G=[],Y=[],J=[],y.pqdownheap=function(t,e){for(var s=y.heap,r=s[e],n=e<<1;n<=y.heap_len&&(n<y.heap_len&&smaller(t,s[n+1],s[n],y.depth)&&n++,!smaller(t,r,s[n],y.depth));)s[e]=s[n],e=n,n<<=1;s[e]=r},y.deflateInit=function(e,s,r,n,o,i){if(n||(n=Z_DEFLATED),o||(o=DEF_MEM_LEVEL),i||(i=Z_DEFAULT_STRATEGY),e.msg=null,s==Z_DEFAULT_COMPRESSION&&(s=6),1>o||o>MAX_MEM_LEVEL||n!=Z_DEFLATED||9>r||r>15||0>s||s>9||0>i||i>Z_HUFFMAN_ONLY)return Z_STREAM_ERROR;for(e.dstate=y,b=r,x=1<<b,k=x-1,I=o+7,F=1<<I,C=F-1,O=Math.floor((I+MIN_MATCH-1)/MIN_MATCH),S=new Uint8Array(2*x),A=[],E=[],st=1<<o+6,y.pending_buf=new Uint8Array(4*st),g=4*st,nt=Math.floor(st/2),et=3*st,Z=s,K=i,e.total_in=e.total_out=0,e.msg=null,y.pending=0,y.pending_out=0,_=BUSY_STATE,q=Z_NO_FLUSH,V.dyn_tree=G,V.stat_desc=StaticTree.static_l_desc,Q.dyn_tree=Y,Q.stat_desc=StaticTree.static_d_desc,tt.dyn_tree=J,tt.stat_desc=StaticTree.static_bl_desc,ut=at=0,it=8,t(),T=2*x,e=E[F-1]=0;F-1>e;e++)E[e]=0;return j=config_table[Z].max_lazy,W=config_table[Z].good_length,X=config_table[Z].nice_length,P=config_table[Z].max_chain,B=z=L=0,N=U=MIN_MATCH-1,R=D=0,Z_OK},y.deflateEnd=function(){return _!=INIT_STATE&&_!=BUSY_STATE&&_!=FINISH_STATE?Z_STREAM_ERROR:(S=A=E=y.pending_buf=null,y.dstate=null,_==BUSY_STATE?Z_DATA_ERROR:Z_OK)},y.deflateParams=function(t,e,s){var r=Z_OK;return e==Z_DEFAULT_COMPRESSION&&(e=6),0>e||e>9||0>s||s>Z_HUFFMAN_ONLY?Z_STREAM_ERROR:(config_table[Z].func!=config_table[e].func&&0!==t.total_in&&(r=t.deflate(Z_PARTIAL_FLUSH)),Z!=e&&(Z=e,j=config_table[Z].max_lazy,W=config_table[Z].good_length,X=config_table[Z].nice_length,P=config_table[Z].max_chain),K=s,r)},y.deflateSetDictionary=function(t,e,s){t=s;var r=0;if(!e||_!=INIT_STATE)return Z_STREAM_ERROR;if(MIN_MATCH>t)return Z_OK;for(t>x-MIN_LOOKAHEAD&&(t=x-MIN_LOOKAHEAD,r=s-t),S.set(e.subarray(r,r+t),0),z=L=t,R=255&S[0],R=(R<<O^255&S[1])&C,e=0;t-MIN_MATCH>=e;e++)R=(R<<O^255&S[e+(MIN_MATCH-1)])&C,A[e&k]=E[R],E[R]=e;return Z_OK},y.deflate=function(t,e){var r,i,c;if(e>Z_FINISH||0>e)return Z_STREAM_ERROR;if(!t.next_out||!t.next_in&&0!==t.avail_in||_==FINISH_STATE&&e!=Z_FINISH)return t.msg=z_errmsg[Z_NEED_DICT-Z_STREAM_ERROR],Z_STREAM_ERROR;if(0===t.avail_out)return t.msg=z_errmsg[Z_NEED_DICT-Z_BUF_ERROR],Z_BUF_ERROR;if(v=t,r=q,q=e,_==INIT_STATE&&(i=Z_DEFLATED+(b-8<<4)<<8,c=(Z-1&255)>>1,c>3&&(c=3),i|=c<<6,0!==L&&(i|=PRESET_DICT),_=BUSY_STATE,i+=31-i%31,s(i>>8&255),s(255&i)),0!==y.pending){if(v.flush_pending(),0===v.avail_out)return q=-1,Z_OK}else if(0===v.avail_in&&r>=e&&e!=Z_FINISH)return v.msg=z_errmsg[Z_NEED_DICT-Z_BUF_ERROR],Z_BUF_ERROR;if(_==FINISH_STATE&&0!==v.avail_in)return t.msg=z_errmsg[Z_NEED_DICT-Z_BUF_ERROR],Z_BUF_ERROR;if(0!==v.avail_in||0!==B||e!=Z_NO_FLUSH&&_!=FINISH_STATE){switch(r=-1,config_table[Z].func){case STORED:r=m(e);break;case FAST:t:{for(r=0;;){if(MIN_LOOKAHEAD>B){if(w(),MIN_LOOKAHEAD>B&&e==Z_NO_FLUSH){r=NeedMore;break t}if(0===B)break}if(B>=MIN_MATCH&&(R=(R<<O^255&S[L+(MIN_MATCH-1)])&C,r=65535&E[R],A[L&k]=E[R],E[R]=L),0!==r&&x-MIN_LOOKAHEAD>=(L-r&65535)&&K!=Z_HUFFMAN_ONLY&&(N=h(r)),N>=MIN_MATCH)if(i=u(L-H,N-MIN_MATCH),B-=N,j>=N&&B>=MIN_MATCH){N--;do L++,R=(R<<O^255&S[L+(MIN_MATCH-1)])&C,r=65535&E[R],A[L&k]=E[R],E[R]=L;while(0!==--N);L++}else L+=N,N=0,R=255&S[L],R=(R<<O^255&S[L+1])&C;else i=u(0,255&S[L]),B--,L++;if(i&&(d(!1),0===v.avail_out)){r=NeedMore;break t}}d(e==Z_FINISH),r=0===v.avail_out?e==Z_FINISH?FinishStarted:NeedMore:e==Z_FINISH?FinishDone:BlockDone}break;case SLOW:r=p(e)}if((r==FinishStarted||r==FinishDone)&&(_=FINISH_STATE),r==NeedMore||r==FinishStarted)return 0===v.avail_out&&(q=-1),Z_OK;if(r==BlockDone){if(e==Z_PARTIAL_FLUSH)n(STATIC_TREES<<1,3),o(END_BLOCK,StaticTree.static_ltree),a(),9>1+it+10-ut&&(n(STATIC_TREES<<1,3),o(END_BLOCK,StaticTree.static_ltree),a()),it=7;else if(f(0,0,!1),e==Z_FULL_FLUSH)for(r=0;F>r;r++)E[r]=0;if(v.flush_pending(),0===v.avail_out)return q=-1,Z_OK}}return e!=Z_FINISH?Z_OK:Z_STREAM_END}}function ZStream(){this.total_out=this.avail_out=this.total_in=this.avail_in=this.next_out_index=this.next_in_index=0}function Deflater(t){var e=new ZStream,s=Z_NO_FLUSH,r=new Uint8Array(512);"undefined"==typeof t&&(t=Z_DEFAULT_COMPRESSION),e.deflateInit(t),e.next_out=r,this.append=function(t,n){var o,i=[],a=0,u=0,c=0,l;if(t.length){e.next_in_index=0,e.next_in=t,e.avail_in=t.length;do{if(e.next_out_index=0,e.avail_out=512,o=e.deflate(s),o!=Z_OK)throw"deflating: "+e.msg;e.next_out_index&&(512==e.next_out_index?i.push(new Uint8Array(r)):i.push(new Uint8Array(r.subarray(0,e.next_out_index)))),c+=e.next_out_index,n&&0<e.next_in_index&&e.next_in_index!=a&&(n(e.next_in_index),a=e.next_in_index)}while(0<e.avail_in||0===e.avail_out);return l=new Uint8Array(c),i.forEach(function(t){l.set(t,u),u+=t.length}),l}},this.flush=function(){var t,s=[],n=0,o=0,i;do{if(e.next_out_index=0,e.avail_out=512,t=e.deflate(Z_FINISH),t!=Z_STREAM_END&&t!=Z_OK)throw"deflating: "+e.msg;0<512-e.avail_out&&s.push(new Uint8Array(r.subarray(0,e.next_out_index))),o+=e.next_out_index}while(0<e.avail_in||0===e.avail_out);return e.deflateEnd(),i=new Uint8Array(o),s.forEach(function(t){i.set(t,n),n+=t.length}),i}}var jsPDF=function(){function t(r,n,o,i){r="undefined"==typeof r?"p":r.toString().toLowerCase(),"undefined"==typeof n&&(n="mm"),"undefined"==typeof o&&(o="a4"),"undefined"==typeof i&&"undefined"==typeof zpipe&&(i=!1);var a=o.toString().toLowerCase(),u=[],c=0,l=i;i={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224]};var f="0 g",d=0,w=[],m=2,h=!1,p=[],y={},v={},_=16,g,q,x,b,k={title:"",subject:"",author:"",keywords:"",creator:""},S=0,T=0,A={},E=new s(A),R,F=function(t){return t.toFixed(2)},I=function(t){var e=t.toFixed(0);return 10>t?"0"+e:e},C=function(t){h?w[d].push(t):(u.push(t),c+=t.length+1)},O=function(){return m++,p[m]=c,C(m+" 0 obj"),m},z=function(t){C("stream"),C(t),C("endstream")},N,M,D,L=function(t,e){var s;s=t;var r=e,n,o,i,a,u,c;if(void 0===r&&(r={}),n=r.sourceEncoding?n:"Unicode",i=r.outputEncoding,(r.autoencode||i)&&y[g].metadata&&y[g].metadata[n]&&y[g].metadata[n].encoding&&(n=y[g].metadata[n].encoding,!i&&y[g].encoding&&(i=y[g].encoding),!i&&n.codePages&&(i=n.codePages[0]),"string"==typeof i&&(i=n[i]),i)){for(u=!1,a=[],n=0,o=s.length;o>n;n++)(c=i[s.charCodeAt(n)])?a.push(String.fromCharCode(c)):a.push(s[n]),a[n].charCodeAt(0)>>8&&(u=!0);s=a.join("")}for(n=s.length;void 0===u&&0!==n;)s.charCodeAt(n-1)>>8&&(u=!0),n--;if(u){for(a=r.noBOM?[]:[254,255],n=0,o=s.length;o>n;n++){if(c=s.charCodeAt(n),r=c>>8,r>>8)throw Error("Character at position "+n.toString(10)+" of string '"+s+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");a.push(r),a.push(c-(r<<8))}s=String.fromCharCode.apply(void 0,a)}return s.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},H=function(){d++,h=!0,w[d]=[],C(F(.200025*b)+" w"),C("0 G"),0!==S&&C(S.toString(10)+" J"),0!==T&&C(T.toString(10)+" j"),E.publish("addPage",{pageNumber:d})},B=function(t,e){var s;void 0===t&&(t=y[g].fontName),void 0===e&&(e=y[g].fontStyle);try{s=v[t][e]}catch(r){s=void 0}if(!s)throw Error("Unable to look up font label for font '"+t+"', '"+e+"'. Refer to getFontList() for available fonts.");return s},U=function(){h=!1,u=[],p=[],C("%PDF-1.3"),N=x*b,M=q*b;var t,e,s,r,n;for(t=1;d>=t;t++){if(O(),C("<</Type /Page"),C("/Parent 1 0 R"),C("/Resources 2 0 R"),C("/Contents "+(m+1)+" 0 R>>"),C("endobj"),e=w[t].join("\n"),O(),l){for(s=[],r=0;r<e.length;++r)s[r]=e.charCodeAt(r);n=adler32cs.from(e),e=new Deflater(6),e.append(new Uint8Array(s)),e=e.flush(),s=[new Uint8Array([120,156]),new Uint8Array(e),new Uint8Array([255&n,n>>8&255,n>>16&255,n>>24&255])],e="";for(r in s)s.hasOwnProperty(r)&&(e+=String.fromCharCode.apply(null,s[r]));C("<</Length "+e.length+" /Filter [/FlateDecode]>>")}else C("<</Length "+e.length+">>");z(e),C("endobj")}for(p[1]=c,C("1 0 obj"),C("<</Type /Pages"),D="/Kids [",r=0;d>r;r++)D+=3+2*r+" 0 R ";C(D+"]"),C("/Count "+d),C("/MediaBox [0 0 "+F(N)+" "+F(M)+"]"),C(">>"),C("endobj");for(var o in y)y.hasOwnProperty(o)&&(t=y[o],t.objectNumber=O(),C("<</BaseFont/"+t.PostScriptName+"/Type/Font"),"string"==typeof t.encoding&&C("/Encoding/"+t.encoding),C("/Subtype/Type1>>"),C("endobj"));E.publish("putResources"),p[2]=c,C("2 0 obj"),C("<<"),C("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),C("/Font <<");for(var i in y)y.hasOwnProperty(i)&&C("/"+i+" "+y[i].objectNumber+" 0 R");for(C(">>"),C("/XObject <<"),E.publish("putXobjectDict"),C(">>"),C(">>"),C("endobj"),E.publish("postPutResources"),O(),C("<<"),C("/Producer (jsPDF 0.9.0rc2)"),k.title&&C("/Title ("+L(k.title)+")"),k.subject&&C("/Subject ("+L(k.subject)+")"),k.author&&C("/Author ("+L(k.author)+")"),k.keywords&&C("/Keywords ("+L(k.keywords)+")"),k.creator&&C("/Creator ("+L(k.creator)+")"),o=new Date,C("/CreationDate (D:"+[o.getFullYear(),I(o.getMonth()+1),I(o.getDate()),I(o.getHours()),I(o.getMinutes()),I(o.getSeconds())].join("")+")"),C(">>"),C("endobj"),O(),C("<<"),C("/Type /Catalog"),C("/Pages 1 0 R"),C("/OpenAction [3 0 R /FitH null]"),C("/PageLayout /OneColumn"),E.publish("putCatalog"),C(">>"),C("endobj"),o=c,C("xref"),C("0 "+(m+1)),C("0000000000 65535 f "),i=1;m>=i;i++)t=p[i].toFixed(0),t=10>t.length?Array(11-t.length).join("0")+t:t,C(t+" 00000 n ");return C("trailer"),C("<<"),C("/Size "+(m+1)),C("/Root "+m+" 0 R"),C("/Info "+(m-1)+" 0 R"),C(">>"),C("startxref"),C(o),C("%%EOF"),h=!0,u.join("\n")},P=function(t){var e="S";return"F"===t?e="f":("FD"===t||"DF"===t)&&(e="B"),e},j=function(t,e){var s,r,n,o;switch(t){case void 0:return U();case"save":if(navigator.getUserMedia&&(void 0===window.URL||void 0===window.URL.createObjectURL))return A.output("dataurlnewwindow");for(s=U(),r=s.length,n=new Uint8Array(new ArrayBuffer(r)),o=0;r>o;o++)n[o]=s.charCodeAt(o);s=new Blob([n],{type:"application/pdf"}),saveAs(s,e);break;case"datauristring":case"dataurlstring":return"data:application/pdf;base64,"+btoa(U());case"datauri":case"dataurl":document.location.href="data:application/pdf;base64,"+btoa(U());break;case"dataurlnewwindow":window.open("data:application/pdf;base64,"+btoa(U()));break;default:throw Error('Output type "'+t+'" is not supported.')}};if("pt"===n)b=1;else if("mm"===n)b=72/25.4;else if("cm"===n)b=72/2.54;else{if("in"!==n)throw"Invalid unit: "+n;b=72}if(i.hasOwnProperty(a))q=i[a][1]/b,x=i[a][0]/b;else try{q=o[1],x=o[0]}catch(Z){throw"Invalid format: "+o}if("p"===r||"portrait"===r)r="p",x>q&&(r=x,x=q,q=r);else{if("l"!==r&&"landscape"!==r)throw"Invalid orientation: "+r;r="l",q>x&&(r=x,x=q,q=r)}A.internal={pdfEscape:L,getStyle:P,getFont:function(){return y[B.apply(A,arguments)]},getFontSize:function(){return _},getLineHeight:function(){return 1.15*_},btoa:btoa,write:function(t,e,s,r){C(1===arguments.length?t:Array.prototype.join.call(arguments," "))},getCoordinateString:function(t){return F(t*b)},getVerticalCoordinateString:function(t){return F((q-t)*b)},collections:{},newObject:O,putStream:z,events:E,scaleFactor:b,pageSize:{width:x,height:q},output:function(t,e){return j(t,e)},getNumberOfPages:function(){return w.length-1},pages:w},A.addPage=function(){return H(),this},A.text=function(t,e,s,r){var n,o;if("number"==typeof t&&(n=t,o=e,t=s,e=n,s=o),"string"==typeof t&&t.match(/[\n\r]/)&&(t=t.split(/\r\n|\r|\n/g)),"undefined"==typeof r?r={noBOM:!0,autoencode:!0}:(void 0===r.noBOM&&(r.noBOM=!0),void 0===r.autoencode&&(r.autoencode=!0)),"string"==typeof t)r=L(t,r);else{if(!(t instanceof Array))throw Error('Type of text must be string or Array. "'+t+'" is not recognized.');for(t=t.concat(),n=t.length-1;-1!==n;n--)t[n]=L(t[n],r);r=t.join(") Tj\nT* (")}return C("BT\n/"+g+" "+_+" Tf\n"+1.15*_+" TL\n"+f+"\n"+F(e*b)+" "+F((q-s)*b)+" Td\n("+r+") Tj\nET"),this},A.line=function(t,e,s,r){return C(F(t*b)+" "+F((q-e)*b)+" m "+F(s*b)+" "+F((q-r)*b)+" l S"),this},A.lines=function(t,e,s,r,n,o){var i,a,u,c,l,f,d,w;for("number"==typeof t&&(i=t,a=e,t=s,e=i,s=a),n=P(n),r=void 0===r?[1,1]:r,C((e*b).toFixed(3)+" "+((q-s)*b).toFixed(3)+" m "),i=r[0],r=r[1],a=t.length,w=s,s=0;a>s;s++)u=t[s],2===u.length?(e=u[0]*i+e,w=u[1]*r+w,C((e*b).toFixed(3)+" "+((q-w)*b).toFixed(3)+" l")):(c=u[0]*i+e,l=u[1]*r+w,f=u[2]*i+e,d=u[3]*r+w,e=u[4]*i+e,w=u[5]*r+w,C((c*b).toFixed(3)+" "+((q-l)*b).toFixed(3)+" "+(f*b).toFixed(3)+" "+((q-d)*b).toFixed(3)+" "+(e*b).toFixed(3)+" "+((q-w)*b).toFixed(3)+" c"));return 1==o&&C(" h"),C(n),this},A.rect=function(t,e,s,r,n){return n=P(n),C([F(t*b),F((q-e)*b),F(s*b),F(-r*b),"re",n].join(" ")),this},A.triangle=function(t,e,s,r,n,o,i){return this.lines([[s-t,r-e],[n-s,o-r],[t-n,e-o]],t,e,[1,1],i,!0),this},A.roundedRect=function(t,e,s,r,n,o,i){var a=4/3*(Math.SQRT2-1);return this.lines([[s-2*n,0],[n*a,0,n,o-o*a,n,o],[0,r-2*o],[0,o*a,-(n*a),o,-n,o],[-s+2*n,0],[-(n*a),0,-n,-(o*a),-n,-o],[0,-r+2*o],[0,-(o*a),n*a,-o,n,-o]],t+n,e,[1,1],i),this},A.ellipse=function(t,e,s,r,n){n=P(n);var o=4/3*(Math.SQRT2-1)*s,i=4/3*(Math.SQRT2-1)*r;return C([F((t+s)*b),F((q-e)*b),"m",F((t+s)*b),F((q-(e-i))*b),F((t+o)*b),F((q-(e-r))*b),F(t*b),F((q-(e-r))*b),"c"].join(" ")),C([F((t-o)*b),F((q-(e-r))*b),F((t-s)*b),F((q-(e-i))*b),F((t-s)*b),F((q-e)*b),"c"].join(" ")),C([F((t-s)*b),F((q-(e+i))*b),F((t-o)*b),F((q-(e+r))*b),F(t*b),F((q-(e+r))*b),"c"].join(" ")),C([F((t+o)*b),F((q-(e+r))*b),F((t+s)*b),F((q-(e+i))*b),F((t+s)*b),F((q-e)*b),"c",n].join(" ")),this},A.circle=function(t,e,s,r){return this.ellipse(t,e,s,s,r)},A.setProperties=function(t){for(var e in k)k.hasOwnProperty(e)&&t[e]&&(k[e]=t[e]);return this},A.setFontSize=function(t){return _=t,this},A.setFont=function(t,e){return g=B(t,e),this},A.setFontStyle=A.setFontType=function(t){return g=B(void 0,t),this},A.getFontList=function(){var t={},e,s,r;for(e in v)if(v.hasOwnProperty(e))for(s in t[e]=r=[],v[e])v[e].hasOwnProperty(s)&&r.push(s);return t},A.setLineWidth=function(t){return C((t*b).toFixed(2)+" w"),this},A.setDrawColor=function(t,e,s,r){return t=void 0===e||void 0===r&&t===e===s?"string"==typeof t?t+" G":F(t/255)+" G":void 0===r?"string"==typeof t?[t,e,s,"RG"].join(" "):[F(t/255),F(e/255),F(s/255),"RG"].join(" "):"string"==typeof t?[t,e,s,r,"K"].join(" "):[F(t),F(e),F(s),F(r),"K"].join(" "),C(t),this},A.setFillColor=function(t,e,s,r){return t=void 0===e||void 0===r&&t===e===s?"string"==typeof t?t+" g":F(t/255)+" g":void 0===r?"string"==typeof t?[t,e,s,"rg"].join(" "):[F(t/255),F(e/255),F(s/255),"rg"].join(" "):"string"==typeof t?[t,e,s,r,"k"].join(" "):[F(t),F(e),F(s),F(r),"k"].join(" "),C(t),this},A.setTextColor=function(t,e,s){return f=0===t&&0===e&&0===s||"undefined"==typeof e?(t/255).toFixed(3)+" g":[(t/255).toFixed(3),(e/255).toFixed(3),(s/255).toFixed(3),"rg"].join(" "),this},A.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},A.setLineCap=function(t){var e=this.CapJoinStyles[t];if(void 0===e)throw Error("Line cap style of '"+t+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return S=e,C(e.toString(10)+" J"),this},A.setLineJoin=function(t){var e=this.CapJoinStyles[t];if(void 0===e)throw Error("Line join style of '"+t+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return T=e,C(e.toString(10)+" j"),this},A.output=j,A.save=function(t){A.output("save",t)};for(R in t.API)t.API.hasOwnProperty(R)&&("events"===R&&t.API.events.length?function(t,e){var s,r,n;for(n=e.length-1;-1!==n;n--)s=e[n][0],r=e[n][1],t.subscribe.apply(t,[s].concat("function"==typeof r?[r]:r))}(E,t.API.events):A[R]=t.API[R]);return function(){var t=[["Helvetica","helvetica","normal"],["Helvetica-Bold","helvetica","bold"],["Helvetica-Oblique","helvetica","italic"],["Helvetica-BoldOblique","helvetica","bolditalic"],["Courier","courier","normal"],["Courier-Bold","courier","bold"],["Courier-Oblique","courier","italic"],["Courier-BoldOblique","courier","bolditalic"],["Times-Roman","times","normal"],["Times-Bold","times","bold"],["Times-Italic","times","italic"],["Times-BoldItalic","times","bolditalic"]],s,r,n,o;for(s=0,r=t.length;r>s;s++){var i=t[s][0],a=t[s][1];n=t[s][2],o="F"+(e(y)+1).toString(10);var i=y[o]={id:o,PostScriptName:i,fontName:a,fontStyle:n,encoding:"StandardEncoding",metadata:{}},u=o;void 0===v[a]&&(v[a]={}),v[a][n]=u,E.publish("addFont",i),n=o,o=t[s][0].split("-"),i=o[0],o=o[1]||"",void 0===v[i]&&(v[i]={}),v[i][o]=n}E.publish("addFonts",{fonts:y,dictionary:v})}(),g="F1",H(),E.publish("initialized"),A}"undefined"==typeof btoa&&(window.btoa=function(t){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".split(""),s,r,n,o,i=0,a=0,u="",u=[];do s=t.charCodeAt(i++),r=t.charCodeAt(i++),n=t.charCodeAt(i++),o=s<<16|r<<8|n,s=o>>18&63,r=o>>12&63,n=o>>6&63,o&=63,u[a++]=e[s]+e[r]+e[n]+e[o];while(i<t.length);return u=u.join(""),t=t.length%3,(t?u.slice(0,t-3):u)+"===".slice(t||3)}),"undefined"==typeof atob&&(window.atob=function(t){var e,s,r,n,o,i=0,a=0;n="";var u=[];if(!t)return t;t+="";do e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(t.charAt(i++)),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(t.charAt(i++)),n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(t.charAt(i++)),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(t.charAt(i++)),r=e<<18|s<<12|n<<6|o,e=r>>16&255,s=r>>8&255,r&=255,64===n?u[a++]=String.fromCharCode(e):64===o?u[a++]=String.fromCharCode(e,s):u[a++]=String.fromCharCode(e,s,r);while(i<t.length);return n=u.join("")});var e="function"==typeof Object.keys?function(t){return Object.keys(t).length}:function(t){var e=0,s;for(s in t)t.hasOwnProperty(s)&&e++;return e},s=function(t){this.topics={},this.context=t,this.publish=function(t,e){if(this.topics[t]){var s=this.topics[t],r=[],n,o,i,a,u=function(){};for(e=Array.prototype.slice.call(arguments,1),o=0,i=s.length;i>o;o++)a=s[o],n=a[0],a[1]&&(a[0]=u,r.push(o)),n.apply(this.context,e);for(o=0,i=r.length;i>o;o++)s.splice(r[o],1)}},this.subscribe=function(t,e,s){return this.topics[t]?this.topics[t].push([e,s]):this.topics[t]=[[e,s]],{topic:t,callback:e}},this.unsubscribe=function(t){if(this.topics[t.topic]){var e=this.topics[t.topic],s,r;for(s=0,r=e.length;r>s;s++)e[s][0]===t.callback&&e.splice(s,1)}}};return t.API={events:[]},t}();!function(t){var e=function(){var t=this.internal.collections.addImage_images,e;for(e in t){var s=t[e],r=this.internal.newObject(),n=this.internal.write,o=this.internal.putStream;if(s.n=r,n("<</Type /XObject"),n("/Subtype /Image"),n("/Width "+s.w),n("/Height "+s.h),"Indexed"===s.cs?n("/ColorSpace [/Indexed /DeviceRGB "+(s.pal.length/3-1)+" "+(r+1)+" 0 R]"):(n("/ColorSpace /"+s.cs),"DeviceCMYK"===s.cs&&n("/Decode [1 0 1 0 1 0 1 0]")),n("/BitsPerComponent "+s.bpc),"f"in s&&n("/Filter /"+s.f),"dp"in s&&n("/DecodeParms <<"+s.dp+">>"),"trns"in s&&s.trns.constructor==Array)for(var i="",a=0;a<s.trns.length;a++)i+=s[i][a]+" "+s.trns[a]+" ",n("/Mask ["+i+"]");"smask"in s&&n("/SMask "+(r+1)+" 0 R"),n("/Length "+s.data.length+">>"),o(s.data),n("endobj")}},s=function(){var t=this.internal.collections.addImage_images,e=this.internal.write,s,r;for(r in t)s=t[r],e("/I"+s.i,s.n,"0","R")};t.addImage=function(t,r,n,o,i,a){if("object"==typeof t&&1===t.nodeType){r=document.createElement("canvas"),r.width=t.clientWidth,r.height=t.clientHeight;var u=r.getContext("2d");if(!u)throw"addImage requires canvas to be supported by browser.";u.drawImage(t,0,0,r.width,r.height),t=r.toDataURL("image/jpeg"),r="JPEG"}if("JPEG"!==r.toUpperCase())throw Error("addImage currently only supports format 'JPEG', not '"+r+"'");var c;r=this.internal.collections.addImage_images;var u=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString;if("data:image/jpeg;base64,"===t.substring(0,23)&&(t=atob(t.replace("data:image/jpeg;base64,",""))),r)if(Object.keys)c=Object.keys(r).length;else{var f=r,d=0;for(c in f)f.hasOwnProperty(c)&&d++;c=d}else c=0,this.internal.collections.addImage_images=r={},this.internal.events.subscribe("putResources",e),this.internal.events.subscribe("putXobjectDict",s);t:{var f=t,w;if(255===!f.charCodeAt(0)||216===!f.charCodeAt(1)||255===!f.charCodeAt(2)||224===!f.charCodeAt(3)||74===!f.charCodeAt(6)||70===!f.charCodeAt(7)||73===!f.charCodeAt(8)||70===!f.charCodeAt(9)||0===!f.charCodeAt(10))throw Error("getJpegSize requires a binary jpeg file");w=256*f.charCodeAt(4)+f.charCodeAt(5);for(var d=4,m=f.length;m>d;){if(d+=w,255!==f.charCodeAt(d))throw Error("getJpegSize could not find the size of the image");if(192===f.charCodeAt(d+1)||193===f.charCodeAt(d+1)||194===f.charCodeAt(d+1)||195===f.charCodeAt(d+1)||196===f.charCodeAt(d+1)||197===f.charCodeAt(d+1)||198===f.charCodeAt(d+1)||199===f.charCodeAt(d+1)){w=256*f.charCodeAt(d+5)+f.charCodeAt(d+6),f=256*f.charCodeAt(d+7)+f.charCodeAt(d+8),f=[f,w];break t}d+=2,w=256*f.charCodeAt(d)+f.charCodeAt(d+1)}f=void 0}return t={w:f[0],h:f[1],cs:"DeviceRGB",bpc:8,f:"DCTDecode",i:c,data:t},r[c]=t,i||a||(a=i=-96),0>i&&(i=-72*t.w/i/this.internal.scaleFactor),0>a&&(a=-72*t.h/a/this.internal.scaleFactor),0===i&&(i=a*t.w/t.h),0===a&&(a=i*t.h/t.w),this.internal.write("q",u(i),"0 0",u(a),u(n),l(o+a),"cm /I"+t.i,"Do Q"),this}}(jsPDF.API),function(t){function e(t,e,s,r){return this.pdf=t,this.x=e,this.y=s,this.settings=r,this.init(),this}function s(t){var e=a[t];return e?e:(e={"xx-small":9,"x-small":11,small:13,medium:16,large:19,"x-large":23,"xx-large":28,auto:0}[t],void 0!==e||(e=parseFloat(t))?a[t]=e/16:(e=t.match(/([\d\.]+)(px)/),3===e.length?a[t]=parseFloat(e[1])/16:a[t]=1))}function r(t,e,a){var u=t.childNodes,c;c=$(t),t={};for(var l,f=c.css("font-family").split(","),d=f.shift();!l&&d;)l=n[d.trim().toLowerCase()],d=f.shift();for(t["font-family"]=l||"times",t["font-style"]=i[c.css("font-style")]||"normal",l=o[c.css("font-weight")]||"normal","bold"===l&&(t["font-style"]="normal"===t["font-style"]?l:l+t["font-style"]),t["font-size"]=s(c.css("font-size"))||1,t["line-height"]=s(c.css("line-height"))||1,t.display="inline"===c.css("display")?"inline":"block","block"===t.display&&(t["margin-top"]=s(c.css("margin-top"))||0,t["margin-bottom"]=s(c.css("margin-bottom"))||0,t["padding-top"]=s(c.css("padding-top"))||0,t["padding-bottom"]=s(c.css("padding-bottom"))||0),(l="block"===t.display)&&(e.setBlockBoundary(),e.setBlockStyle(t)),f=0,d=u.length;d>f;f++)if(c=u[f],"object"==typeof c)if(1===c.nodeType&&"SCRIPT"!=c.nodeName){var w=c,m=e,h=a,p=!1,y=void 0,v=void 0,_=h["#"+w.id];if(_)if("function"==typeof _)p=_(w,m);else for(y=0,v=_.length;!p&&y!==v;)p=_[y](w,m),y++;if(_=h[w.nodeName],!p&&_)if("function"==typeof _)p=_(w,m);else for(y=0,v=_.length;!p&&y!==v;)p=_[y](w,m),y++;p||r(c,e,a)}else 3===c.nodeType&&e.addText(c.nodeValue,t);else"string"==typeof c&&e.addText(c,t);l&&e.setBlockBoundary()}String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),String.prototype.trimLeft||(String.prototype.trimLeft=function(){return this.replace(/^\s+/g,"")}),String.prototype.trimRight||(String.prototype.trimRight=function(){return this.replace(/\s+$/g,"")}),e.prototype.init=function(){this.paragraph={text:[],style:[]},this.pdf.internal.write("q")},e.prototype.dispose=function(){return this.pdf.internal.write("Q"),{x:this.x,y:this.y}},e.prototype.splitFragmentsIntoLines=function(t,e){for(var s=this.pdf.internal.scaleFactor,r={},n,o,i,a,u,c=[],l=[c],f=0,d=this.settings.width;t.length;)if(a=t.shift(),u=e.shift(),a)if(n=u["font-family"],o=u["font-style"],i=r[n+o],i||(i=this.pdf.internal.getFont(n,o).metadata.Unicode,r[n+o]=i),n={widths:i.widths,kerning:i.kerning,fontSize:12*u["font-size"],textIndent:f},o=this.pdf.getStringUnitWidth(a,n)*n.fontSize/s,f+o>d){for(a=this.pdf.splitTextToSize(a,d,n),c.push([a.shift(),u]);a.length;)c=[[a.shift(),u]],l.push(c);f=this.pdf.getStringUnitWidth(c[0][0],n)*n.fontSize/s}else c.push([a,u]),f+=o;return l},e.prototype.RenderTextFragment=function(t,e){var s=this.pdf.internal.getFont(e["font-family"],e["font-style"]);this.pdf.internal.write("/"+s.id,(12*e["font-size"]).toFixed(2),"Tf","("+this.pdf.internal.pdfEscape(t)+") Tj")},e.prototype.renderParagraph=function(){for(var t=this.paragraph.text,e=0,s=t.length,r,n=!1,o=!1;!n&&e!==s;)(r=t[e]=t[e].trimLeft())&&(n=!0),e++;for(e=s-1;s&&!o&&-1!==e;)(r=t[e]=t[e].trimRight())&&(o=!0),e--;for(n=/\s+$/g,o=!0,e=0;e!==s;e++)r=t[e].replace(/\s+/g," "),o&&(r=r.trimLeft()),r&&(o=n.test(r)),t[e]=r;if(e=this.paragraph.style,r=(s=this.paragraph.blockstyle)||{},this.paragraph={text:[],style:[],blockstyle:{},priorblockstyle:s},t.join("").trim()){t=this.splitFragmentsIntoLines(t,e),e=12/this.pdf.internal.scaleFactor,n=(Math.max((s["margin-top"]||0)-(r["margin-bottom"]||0),0)+(s["padding-top"]||0))*e,
s=((s["margin-bottom"]||0)+(s["padding-bottom"]||0))*e,r=this.pdf.internal.write;var i,a;for(this.y+=n,r("q","BT",this.pdf.internal.getCoordinateString(this.x),this.pdf.internal.getVerticalCoordinateString(this.y),"Td");t.length;){for(n=t.shift(),i=o=0,a=n.length;i!==a;i++)n[i][0].trim()&&(o=Math.max(o,n[i][1]["line-height"],n[i][1]["font-size"]));for(r(0,(-12*o).toFixed(2),"Td"),i=0,a=n.length;i!==a;i++)n[i][0]&&this.RenderTextFragment(n[i][0],n[i][1]);this.y+=o*e}r("ET","Q"),this.y+=s}},e.prototype.setBlockBoundary=function(){this.renderParagraph()},e.prototype.setBlockStyle=function(t){this.paragraph.blockstyle=t},e.prototype.addText=function(t,e){this.paragraph.text.push(t),this.paragraph.style.push(e)};var n={helvetica:"helvetica","sans-serif":"helvetica",serif:"times",times:"times","times new roman":"times",monospace:"courier",courier:"courier"},o={100:"normal",200:"normal",300:"normal",400:"normal",500:"bold",600:"bold",700:"bold",800:"bold",900:"bold",normal:"normal",bold:"bold",bolder:"bold",lighter:"normal"},i={normal:"normal",italic:"italic",oblique:"italic"},a={normal:1};t.fromHTML=function(t,s,n,o){if("string"==typeof t){var i="jsPDFhtmlText"+Date.now().toString()+(1e3*Math.random()).toFixed(0);$('<div style="position: absolute !important;clip: rect(1px 1px 1px 1px); /* IE6, IE7 */clip: rect(1px, 1px, 1px, 1px);padding:0 !important;border:0 !important;height: 1px !important;width: 1px !important; top:auto;left:-100px;overflow: hidden;"><iframe style="height:1px;width:1px" name="'+i+'" /></div>').appendTo(document.body),t=$(window.frames[i].document.body).html(t)[0]}return s=new e(this,s,n,o),r(t,s,o.elementHandlers),s.dispose()}}(jsPDF.API),function(t){t.addSVG=function(t,e,s,r,n){function o(t){for(var e=parseFloat(t[1]),s=parseFloat(t[2]),r=[],n=3,o=t.length;o>n;)"c"===t[n]?(r.push([parseFloat(t[n+1]),parseFloat(t[n+2]),parseFloat(t[n+3]),parseFloat(t[n+4]),parseFloat(t[n+5]),parseFloat(t[n+6])]),n+=7):"l"===t[n]?(r.push([parseFloat(t[n+1]),parseFloat(t[n+2])]),n+=3):n+=1;return[e,s,r]}if(void 0===e||void 0===e)throw Error("addSVG needs values for 'x' and 'y'");var i=function(t){var e=t.createElement("iframe"),s=t.createElement("style");return s.type="text/css",s.styleSheet?s.styleSheet.cssText=".jsPDF_sillysvg_iframe {display:none;position:absolute;}":s.appendChild(t.createTextNode(".jsPDF_sillysvg_iframe {display:none;position:absolute;}")),t.getElementsByTagName("head")[0].appendChild(s),e.name="childframe",e.setAttribute("width",0),e.setAttribute("height",0),e.setAttribute("frameborder","0"),e.setAttribute("scrolling","no"),e.setAttribute("seamless","seamless"),e.setAttribute("class","jsPDF_sillysvg_iframe"),t.body.appendChild(e),e}(document),i=function(t,e){var s=(e.contentWindow||e.contentDocument).document;return s.write(t),s.close(),s.getElementsByTagName("svg")[0]}(t,i);t=[1,1];var a=parseFloat(i.getAttribute("width")),u=parseFloat(i.getAttribute("height"));for(a&&u&&(r&&n?t=[r/a,n/u]:r?t=[r/a,r/a]:n&&(t=[n/u,n/u])),i=i.childNodes,r=0,n=i.length;n>r;r++)a=i[r],a.tagName&&"PATH"===a.tagName.toUpperCase()&&(a=o(a.getAttribute("d").split(" ")),a[0]=a[0]*t[0]+e,a[1]=a[1]*t[1]+s,this.lines.call(this,a[2],a[0],a[1],t));return this}}(jsPDF.API),function(t){var e=t.getCharWidthsArray=function(t,e){e||(e={});var s=e.widths?e.widths:this.internal.getFont().metadata.Unicode.widths,r=s.fof?s.fof:1,n=e.kerning?e.kerning:this.internal.getFont().metadata.Unicode.kerning,o=n.fof?n.fof:1,i,a,u,c=0,l=s[0]||r,f=[];for(i=0,a=t.length;a>i;i++)u=t.charCodeAt(i),f.push((s[u]||l)/r+(n[u]&&n[u][c]||0)/o),c=u;return f},s=function(t){for(var e=t.length,s=0;e;)e--,s+=t[e];return s};t.getStringUnitWidth=function(t,r){return s(e.call(this,t,r))};var r=function(t,r,n){n||(n={});var o=e(" ",n)[0],i=t.split(" "),a=[];t=[a];var u=n.textIndent||0,c=0,l=0,f,d,w,m;for(w=0,m=i.length;m>w;w++){if(f=i[w],d=e(f,n),l=s(d),u+c+l>r){if(l>r){for(var l=f,h=d,p=r,y=[],v=0,_=l.length,g=0;v!==_&&g+h[v]<r-(u+c);)g+=h[v],v++;for(y.push(l.slice(0,v)),u=v,g=0;v!==_;)g+h[v]>p&&(y.push(l.slice(u,v)),g=0,u=v),g+=h[v],v++;for(u!==v&&y.push(l.slice(u,v)),u=y,a.push(u.shift()),a=[u.pop()];u.length;)t.push([u.shift()]);l=s(d.slice(f.length-a[0].length))}else a=[f];t.push(a),u=l}else a.push(f),u+=c+l;c=o}for(r=[],w=0,m=t.length;m>w;w++)r.push(t[w].join(" "));return r};t.splitTextToSize=function(t,e,s){s||(s={});var n=s.fontSize||this.internal.getFontSize(),o,i=s;o={0:1};var a={};for(i.widths&&i.kerning?o={widths:i.widths,kerning:i.kerning}:(i=this.internal.getFont(i.fontName,i.fontStyle),o=i.metadata.Unicode?{widths:i.metadata.Unicode.widths||o,kerning:i.metadata.Unicode.kerning||a}:{widths:o,kerning:a}),t=t.match(/[\n\r]/)?t.split(/\r\n|\r|\n/g):[t],e=1*this.internal.scaleFactor*e/n,o.textIndent=s.textIndent?1*s.textIndent*this.internal.scaleFactor/n:0,a=[],s=0,n=t.length;n>s;s++)a=a.concat(r(t[s],e,o));return a}}(jsPDF.API),function(t){var e=function(t){for(var e={},s=0;16>s;s++)e["klmnopqrstuvwxyz"[s]]="0123456789abcdef"[s];for(var r={},n=1,o,i=r,a=[],u,c="",l="",f,d=t.length-1,s=1;s!=d;)u=t[s],s+=1,"'"==u?o?(f=o.join(""),o=void 0):o=[]:o?o.push(u):"{"==u?(a.push([i,f]),i={},f=void 0):"}"==u?(u=a.pop(),u[0][u[1]]=i,f=void 0,i=u[0]):"-"==u?n=-1:void 0===f?e.hasOwnProperty(u)?(c+=e[u],f=parseInt(c,16)*n,n=1,c=""):c+=u:e.hasOwnProperty(u)?(l+=e[u],i[f]=parseInt(l,16)*n,n=1,f=void 0,l=""):l+=u;return r},s={codePages:["WinAnsiEncoding"],WinAnsiEncoding:e("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},r={Unicode:{Courier:s,"Courier-Bold":s,"Courier-BoldOblique":s,"Courier-Oblique":s,Helvetica:s,"Helvetica-Bold":s,"Helvetica-BoldOblique":s,"Helvetica-Oblique":s,"Times-Roman":s,"Times-Bold":s,"Times-BoldItalic":s,"Times-Italic":s}},n={Unicode:{"Courier-Oblique":e("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":e("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":e("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:e("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":e("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":e("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Helvetica:e("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":e("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),"Courier-Bold":e("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":e("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":e("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":e("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFonts",function(t){var e,s,o,i;for(s in t.fonts)t.fonts.hasOwnProperty(s)&&(e=t.fonts[s],(o=n.Unicode[e.PostScriptName])&&(i=e.metadata.Unicode?e.metadata.Unicode:e.metadata.Unicode={},i.widths=o.widths,i.kerning=o.kerning),(o=r.Unicode[e.PostScriptName])&&(i=e.metadata.Unicode?e.metadata.Unicode:e.metadata.Unicode={},i.encoding=o,o.codePages&&o.codePages.length&&(e.encoding=o.codePages[0])))}])}(jsPDF.API),function(t){var e,s,r,n,o={x:void 0,y:void 0,w:void 0,h:void 0,ln:void 0},i=1;t.setHeaderFunction=function(t){n=t},t.getTextDimensions=function(t){e=this.internal.getFont().fontName,s=this.internal.getFontSize(),r=this.internal.getFont().fontStyle;var n=19.049976/25.4,o;return o=document.createElement("font"),o.id="jsPDFCell",o.style.fontStyle=r,o.style.fontName=e,o.style.fontSize=s+"pt",o.innerText=t,document.body.appendChild(o),t={w:(o.offsetWidth+1)*n,h:(o.offsetHeight+1)*n},document.body.removeChild(o),t},t.cellAddPage=function(){this.addPage(),o={x:void 0,y:void 0,w:void 0,h:void 0,ln:void 0},i+=1},t.cellInitialize=function(){o={x:void 0,y:void 0,w:void 0,h:void 0,ln:void 0},i=1},t.cell=function(t,e,s,r,n,i,a){var u=o;if(void 0!==u.ln&&(u.ln===i?(t=u.x+u.w,e=u.y):(u.y+u.h+r+13>=this.internal.pageSize.height&&(this.cellAddPage(),this.printHeaders&&this.tableHeaderRow&&this.printHeaderRow(i)),e=o.y+o.h)),""!==n[0])if(this.printingHeaderRow?this.rect(t,e,s,r,"FD"):this.rect(t,e,s,r),"right"===a){if(n instanceof Array)for(a=0;a<n.length;a++){var u=n[a],c=this.getStringUnitWidth(u)*this.internal.getFontSize();this.text(u,t+s-c-3,e+this.internal.getLineHeight()*(a+1))}}else this.text(n,t+3,e+this.internal.getLineHeight());return o={x:t,y:e,w:s,h:r,ln:i},this},t.getKeys="function"==typeof Object.keys?function(t){return t?Object.keys(t):[]}:function(t){var e=[],s;for(s in t)t.hasOwnProperty(s)&&e.push(s);return e},t.arrayMax=function(t,e){var s=t[0],r,n,o;for(r=0,n=t.length;n>r;r+=1)o=t[r],e?-1===e(s,o)&&(s=o):o>s&&(s=o);return s},t.table=function(e,s,r){var n=[],o=[],i,a,u,c={},l={},f,d,w=[],m,h=[],p;if(this.lnMod=0,r&&(this.printHeaders=r.printHeaders||!0),!e)throw"No data for PDF table";if(void 0===s||null===s)n=this.getKeys(e[0]);else if(s[0]&&"string"!=typeof s[0])for(a=0,u=s.length;u>a;a+=1)i=s[a],n.push(i.name),o.push(i.prompt),l[i.name]=i.width;else n=s;if(r.autoSize)for(p=function(t){return t[i]},a=0,u=n.length;u>a;a+=1){for(i=n[a],c[i]=e.map(p),w.push(this.getTextDimensions(o[a]||i).w),d=c[i],m=0,u=d.length;u>m;m+=1)f=d[m],w.push(this.getTextDimensions(f).w);l[i]=t.arrayMax(w)}if(r.printHeaders){for(r=this.calculateLineHeight(n,l,o.length?o:n),a=0,u=n.length;u>a;a+=1)i=n[a],h.push([13,13,l[i],r,String(o.length?o[a]:i)]);this.setTableHeaderRow(h),this.printHeaderRow(1)}for(a=0,u=e.length;u>a;a+=1)for(o=e[a],r=this.calculateLineHeight(n,l,o),m=0,h=n.length;h>m;m+=1)i=n[m],this.cell(13,13,l[i],r,o[i],a+2,s[m].align);return this},t.calculateLineHeight=function(t,e,s){for(var r,n=0,o=0;o<t.length;o++)r=t[o],s[r]=this.splitTextToSize(String(s[r]),e[r]-3),r=this.internal.getLineHeight()*s[r].length+3,r>n&&(n=r);return n},t.setTableHeaderRow=function(t){this.tableHeaderRow=t},t.printHeaderRow=function(t){if(!this.tableHeaderRow)throw"Property tableHeaderRow does not exist.";var e,s,r;for(this.printingHeaderRow=!0,void 0!==n&&(s=n(this,i),o={x:s[0],y:s[1],w:s[2],h:s[3],ln:-1}),this.setFontStyle("bold"),s=0,r=this.tableHeaderRow.length;r>s;s+=1)this.setFillColor(200,200,200),e=this.tableHeaderRow[s],e=[].concat(e),this.cell.apply(this,e.concat(t));this.setFontStyle("normal"),this.printingHeaderRow=!1}}(jsPDF.API),function(t){t.putTotalPages=function(t){t=RegExp(t,"g");for(var e=1;e<=this.internal.getNumberOfPages();e++)for(var s=0;s<this.internal.pages[e].length;s++)this.internal.pages[e][s]=this.internal.pages[e][s].replace(t,this.internal.getNumberOfPages());return this}}(jsPDF.API);var BlobBuilder=BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder||function(t){var e=function(t){return Object.prototype.toString.call(t).match(/^\[object\s(.*)\]$/)[1]},s=function(){this.data=[]},r=function(t,e,s){this.data=t,this.size=t.length,this.type=e,this.encoding=s},n=s.prototype,o=r.prototype,i=t.FileReaderSync,a=function(t){this.code=this[this.name=t]},u="NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR".split(" "),c=u.length,l=t.URL||t.webkitURL||t,f=l.createObjectURL,d=l.revokeObjectURL,w=l,m=t.btoa,h=t.atob,p=!1,y=function(t){p=!t},v=t.ArrayBuffer,_=t.Uint8Array;for(s.fake=o.fake=!0;c--;)a.prototype[u[c]]=c+1;try{_&&y.apply(0,new _(1))}catch(g){}return l.createObjectURL||(w=t.URL={}),w.createObjectURL=function(t){var e=t.type;return null===e&&(e="application/octet-stream"),t instanceof r?(e="data:"+e,"base64"===t.encoding?e+";base64,"+t.data:"URI"===t.encoding?e+","+decodeURIComponent(t.data):m?e+";base64,"+m(t.data):e+","+encodeURIComponent(t.data)):f?f.call(l,t):void 0},w.revokeObjectURL=function(t){"data:"!==t.substring(0,5)&&d&&d.call(l,t)},n.append=function(t){var s=this.data;if(_&&t instanceof v)if(p)s.push(String.fromCharCode.apply(String,new _(t)));else{s="",t=new _(t);for(var n=0,o=t.length;o>n;n++)s+=String.fromCharCode(t[n])}else if("Blob"===e(t)||"File"===e(t)){if(!i)throw new a("NOT_READABLE_ERR");n=new i,s.push(n.readAsBinaryString(t))}else t instanceof r?"base64"===t.encoding&&h?s.push(h(t.data)):"URI"===t.encoding?s.push(decodeURIComponent(t.data)):"raw"===t.encoding&&s.push(t.data):("string"!=typeof t&&(t+=""),s.push(unescape(encodeURIComponent(t))))},n.getBlob=function(t){return arguments.length||(t=null),new r(this.data.join(""),t,"raw")},n.toString=function(){return"[object BlobBuilder]"},o.slice=function(t,e,s){var n=arguments.length;return 3>n&&(s=null),new r(this.data.slice(t,n>1?e:this.data.length),s,this.encoding)},o.toString=function(){return"[object Blob]"},s}(self),saveAs=saveAs||navigator.msSaveBlob&&navigator.msSaveBlob.bind(navigator)||function(t){var e=t.document,s=t.URL||t.webkitURL||t,r=e.createElementNS("http://www.w3.org/1999/xhtml","a"),n="download"in r,o=function(s){var r=e.createEvent("MouseEvents");return r.initMouseEvent("click",!0,!1,t,0,0,0,0,0,!1,!1,!1,!1,0,null),s.dispatchEvent(r)},i=t.webkitRequestFileSystem,a=t.requestFileSystem||i||t.mozRequestFileSystem,u=function(e){(t.setImmediate||t.setTimeout)(function(){throw e},0)},c=0,l=[],f=function(t,e,s){e=[].concat(e);for(var r=e.length;r--;){var n=t["on"+e[r]];if("function"==typeof n)try{n.call(t,s||t)}catch(o){u(o)}}},d=function(e,s){var u=this,d=e.type,w=!1,m,h,p=function(){var s=(t.URL||t.webkitURL||t).createObjectURL(e);return l.push(s),s},y=function(){f(u,["writestart","progress","write","writeend"])},v=function(){(w||!m)&&(m=p(e)),h&&(h.location.href=m),u.readyState=u.DONE,y()},_=function(t){return function(){return u.readyState!==u.DONE?t.apply(this,arguments):void 0}},g={create:!0,exclusive:!1},q;return u.readyState=u.INIT,s||(s="download"),n&&(m=p(e),r.href=m,r.download=s,o(r))?(u.readyState=u.DONE,void y()):(t.chrome&&d&&"application/octet-stream"!==d&&(q=e.slice||e.webkitSlice,e=q.call(e,0,e.size,"application/octet-stream"),w=!0),i&&"download"!==s&&(s+=".download"),h="application/octet-stream"===d||i?t:t.open(),void(a?(c+=e.size,a(t.TEMPORARY,c,_(function(t){t.root.getDirectory("saved",g,_(function(t){var r=function(){t.getFile(s,g,_(function(t){t.createWriter(_(function(s){s.onwriteend=function(e){h.location.href=t.toURL(),l.push(t),u.readyState=u.DONE,f(u,"writeend",e)},s.onerror=function(){var t=s.error;t.code!==t.ABORT_ERR&&v()},["writestart","progress","write","abort"].forEach(function(t){s["on"+t]=u["on"+t]}),s.write(e),u.abort=function(){s.abort(),u.readyState=u.DONE},u.readyState=u.WRITING}),v)}),v)};t.getFile(s,{create:!1},_(function(t){t.remove(),r()}),_(function(t){t.code===t.NOT_FOUND_ERR?r():v()}))}),v)}),v)):v()))},w=d.prototype;return w.abort=function(){this.readyState=this.DONE,f(this,"abort")},w.readyState=w.INIT=0,w.WRITING=1,w.DONE=2,w.error=w.onwritestart=w.onprogress=w.onwrite=w.onabort=w.onerror=w.onwriteend=null,t.addEventListener("unload",function(){for(var t=l.length;t--;){var e=l[t];"string"==typeof e?s.revokeObjectURL(e):e.remove()}l.length=0},!1),function(t,e){return new d(t,e)}}(self),MAX_BITS=15,D_CODES=30,BL_CODES=19,LENGTH_CODES=29,LITERALS=256,L_CODES=LITERALS+1+LENGTH_CODES,HEAP_SIZE=2*L_CODES+1,END_BLOCK=256,MAX_BL_BITS=7,REP_3_6=16,REPZ_3_10=17,REPZ_11_138=18,Buf_size=16,Z_DEFAULT_COMPRESSION=-1,Z_FILTERED=1,Z_HUFFMAN_ONLY=2,Z_DEFAULT_STRATEGY=0,Z_NO_FLUSH=0,Z_PARTIAL_FLUSH=1,Z_FULL_FLUSH=3,Z_FINISH=4,Z_OK=0,Z_STREAM_END=1,Z_NEED_DICT=2,Z_STREAM_ERROR=-2,Z_DATA_ERROR=-3,Z_BUF_ERROR=-5,_dist_code=[0,1,2,3,4,4,5,5,6,6,6,6,7,7,7,7,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,0,0,16,17,18,18,19,19,20,20,20,20,21,21,21,21,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29];Tree._length_code=[0,1,2,3,4,5,6,7,8,8,9,9,10,10,11,11,12,12,12,12,13,13,13,13,14,14,14,14,15,15,15,15,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,28],Tree.base_length=[0,1,2,3,4,5,6,7,8,10,12,14,16,20,24,28,32,40,48,56,64,80,96,112,128,160,192,224,0],Tree.base_dist=[0,1,2,3,4,6,8,12,16,24,32,48,64,96,128,192,256,384,512,768,1024,1536,2048,3072,4096,6144,8192,12288,16384,24576],Tree.d_code=function(t){return 256>t?_dist_code[t]:_dist_code[256+(t>>>7)]},Tree.extra_lbits=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Tree.extra_dbits=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Tree.extra_blbits=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Tree.bl_order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],StaticTree.static_ltree=[12,8,140,8,76,8,204,8,44,8,172,8,108,8,236,8,28,8,156,8,92,8,220,8,60,8,188,8,124,8,252,8,2,8,130,8,66,8,194,8,34,8,162,8,98,8,226,8,18,8,146,8,82,8,210,8,50,8,178,8,114,8,242,8,10,8,138,8,74,8,202,8,42,8,170,8,106,8,234,8,26,8,154,8,90,8,218,8,58,8,186,8,122,8,250,8,6,8,134,8,70,8,198,8,38,8,166,8,102,8,230,8,22,8,150,8,86,8,214,8,54,8,182,8,118,8,246,8,14,8,142,8,78,8,206,8,46,8,174,8,110,8,238,8,30,8,158,8,94,8,222,8,62,8,190,8,126,8,254,8,1,8,129,8,65,8,193,8,33,8,161,8,97,8,225,8,17,8,145,8,81,8,209,8,49,8,177,8,113,8,241,8,9,8,137,8,73,8,201,8,41,8,169,8,105,8,233,8,25,8,153,8,89,8,217,8,57,8,185,8,121,8,249,8,5,8,133,8,69,8,197,8,37,8,165,8,101,8,229,8,21,8,149,8,85,8,213,8,53,8,181,8,117,8,245,8,13,8,141,8,77,8,205,8,45,8,173,8,109,8,237,8,29,8,157,8,93,8,221,8,61,8,189,8,125,8,253,8,19,9,275,9,147,9,403,9,83,9,339,9,211,9,467,9,51,9,307,9,179,9,435,9,115,9,371,9,243,9,499,9,11,9,267,9,139,9,395,9,75,9,331,9,203,9,459,9,43,9,299,9,171,9,427,9,107,9,363,9,235,9,491,9,27,9,283,9,155,9,411,9,91,9,347,9,219,9,475,9,59,9,315,9,187,9,443,9,123,9,379,9,251,9,507,9,7,9,263,9,135,9,391,9,71,9,327,9,199,9,455,9,39,9,295,9,167,9,423,9,103,9,359,9,231,9,487,9,23,9,279,9,151,9,407,9,87,9,343,9,215,9,471,9,55,9,311,9,183,9,439,9,119,9,375,9,247,9,503,9,15,9,271,9,143,9,399,9,79,9,335,9,207,9,463,9,47,9,303,9,175,9,431,9,111,9,367,9,239,9,495,9,31,9,287,9,159,9,415,9,95,9,351,9,223,9,479,9,63,9,319,9,191,9,447,9,127,9,383,9,255,9,511,9,0,7,64,7,32,7,96,7,16,7,80,7,48,7,112,7,8,7,72,7,40,7,104,7,24,7,88,7,56,7,120,7,4,7,68,7,36,7,100,7,20,7,84,7,52,7,116,7,3,8,131,8,67,8,195,8,35,8,163,8,99,8,227,8],
StaticTree.static_dtree=[0,5,16,5,8,5,24,5,4,5,20,5,12,5,28,5,2,5,18,5,10,5,26,5,6,5,22,5,14,5,30,5,1,5,17,5,9,5,25,5,5,5,21,5,13,5,29,5,3,5,19,5,11,5,27,5,7,5,23,5],StaticTree.static_l_desc=new StaticTree(StaticTree.static_ltree,Tree.extra_lbits,LITERALS+1,L_CODES,MAX_BITS),StaticTree.static_d_desc=new StaticTree(StaticTree.static_dtree,Tree.extra_dbits,0,D_CODES,MAX_BITS),StaticTree.static_bl_desc=new StaticTree(null,Tree.extra_blbits,0,BL_CODES,MAX_BL_BITS);var MAX_MEM_LEVEL=9,DEF_MEM_LEVEL=8,STORED=0,FAST=1,SLOW=2,config_table=[new Config(0,0,0,0,STORED),new Config(4,4,8,4,FAST),new Config(4,5,16,8,FAST),new Config(4,6,32,32,FAST),new Config(4,4,16,16,SLOW),new Config(8,16,32,32,SLOW),new Config(8,16,128,128,SLOW),new Config(8,32,128,256,SLOW),new Config(32,128,258,1024,SLOW),new Config(32,258,258,4096,SLOW)],z_errmsg="need dictionary;stream end;;;stream error;data error;;buffer error;;".split(";"),NeedMore=0,BlockDone=1,FinishStarted=2,FinishDone=3,PRESET_DICT=32,INIT_STATE=42,BUSY_STATE=113,FINISH_STATE=666,Z_DEFLATED=8,STORED_BLOCK=0,STATIC_TREES=1,DYN_TREES=2,MIN_MATCH=3,MAX_MATCH=258,MIN_LOOKAHEAD=MAX_MATCH+MIN_MATCH+1;ZStream.prototype={deflateInit:function(t,e){return this.dstate=new Deflate,e||(e=MAX_BITS),this.dstate.deflateInit(this,t,e)},deflate:function(t){return this.dstate?this.dstate.deflate(this,t):Z_STREAM_ERROR},deflateEnd:function(){if(!this.dstate)return Z_STREAM_ERROR;var t=this.dstate.deflateEnd();return this.dstate=null,t},deflateParams:function(t,e){return this.dstate?this.dstate.deflateParams(this,t,e):Z_STREAM_ERROR},deflateSetDictionary:function(t,e){return this.dstate?this.dstate.deflateSetDictionary(this,t,e):Z_STREAM_ERROR},read_buf:function(t,e,s){var r=this.avail_in;return r>s&&(r=s),0===r?0:(this.avail_in-=r,t.set(this.next_in.subarray(this.next_in_index,this.next_in_index+r),e),this.next_in_index+=r,this.total_in+=r,r)},flush_pending:function(){var t=this.dstate.pending;t>this.avail_out&&(t=this.avail_out),0!==t&&(this.next_out.set(this.dstate.pending_buf.subarray(this.dstate.pending_out,this.dstate.pending_out+t),this.next_out_index),this.next_out_index+=t,this.dstate.pending_out+=t,this.total_out+=t,this.avail_out-=t,this.dstate.pending-=t,0===this.dstate.pending&&(this.dstate.pending_out=0))}},void function(t,e){"object"==typeof module?module.exports=e():"function"==typeof define?define(e):t.adler32cs=e()}(this,function(){var t="function"==typeof ArrayBuffer&&"function"==typeof Uint8Array,e=null,s=function(){if(!t)return function(){return!1};try{var s=require("buffer");"function"==typeof s.Buffer&&(e=s.Buffer)}catch(r){}return function(t){return t instanceof ArrayBuffer||null!==e&&t instanceof e}}(),r=function(){return null!==e?function(t){return new e(t,"utf8").toString("binary")}:function(t){return unescape(encodeURIComponent(t))}}(),n=function(t,e){for(var s=65535&t,r=t>>>16,n=0,o=e.length;o>n;n++)s=(s+(255&e.charCodeAt(n)))%65521,r=(r+s)%65521;return(r<<16|s)>>>0},o=function(t,e){for(var s=65535&t,r=t>>>16,n=0,o=e.length;o>n;n++)s=(s+e[n])%65521,r=(r+s)%65521;return(r<<16|s)>>>0},i={},a=i.Adler32=function(){var e=function(t){if(!(this instanceof e))throw new TypeError("Constructor cannot called be as a function.");if(!isFinite(t=null==t?1:+t))throw Error("First arguments needs to be a finite number.");this.checksum=t>>>0},i=e.prototype={};return i.constructor=e,e.from=function(t){return t.prototype=i,t}(function(t){if(!(this instanceof e))throw new TypeError("Constructor cannot called be as a function.");if(null==t)throw Error("First argument needs to be a string.");this.checksum=n(1,t.toString())}),e.fromUtf8=function(t){return t.prototype=i,t}(function(t){if(!(this instanceof e))throw new TypeError("Constructor cannot called be as a function.");if(null==t)throw Error("First argument needs to be a string.");t=r(t.toString()),this.checksum=n(1,t)}),t&&(e.fromBuffer=function(t){return t.prototype=i,t}(function(t){if(!(this instanceof e))throw new TypeError("Constructor cannot called be as a function.");if(!s(t))throw Error("First argument needs to be ArrayBuffer.");return t=new Uint8Array(t),this.checksum=o(1,t)})),i.update=function(t){if(null==t)throw Error("First argument needs to be a string.");return t=t.toString(),this.checksum=n(this.checksum,t)},i.updateUtf8=function(t){if(null==t)throw Error("First argument needs to be a string.");return t=r(t.toString()),this.checksum=n(this.checksum,t)},t&&(i.updateBuffer=function(t){if(!s(t))throw Error("First argument needs to be ArrayBuffer.");return t=new Uint8Array(t),this.checksum=o(this.checksum,t)}),i.clone=function(){return new a(this.checksum)},e}();return i.from=function(t){if(null==t)throw Error("First argument needs to be a string.");return n(1,t.toString())},i.fromUtf8=function(t){if(null==t)throw Error("First argument needs to be a string.");return t=r(t.toString()),n(1,t)},t&&(i.fromBuffer=function(t){if(!s(t))throw Error("First argument need to be ArrayBuffer.");return t=new Uint8Array(t),o(1,t)}),i});
var QRCode;!function(){function t(t){this.mode=u.MODE_8BIT_BYTE,this.data=t,this.parsedData=[];for(var e=0,r=this.data.length;r>e;e++){var o=[],i=this.data.charCodeAt(e);i>65536?(o[0]=240|(1835008&i)>>>18,o[1]=128|(258048&i)>>>12,o[2]=128|(4032&i)>>>6,o[3]=128|63&i):i>2048?(o[0]=224|(61440&i)>>>12,o[1]=128|(4032&i)>>>6,o[2]=128|63&i):i>128?(o[0]=192|(1984&i)>>>6,o[1]=128|63&i):o[0]=i,this.parsedData.push(o)}this.parsedData=Array.prototype.concat.apply([],this.parsedData),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}function e(t,e){this.typeNumber=t,this.errorCorrectLevel=e,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}function r(t,e){if(void 0==t.length)throw new Error(t.length+"/"+e);for(var r=0;r<t.length&&0==t[r];)r++;this.num=new Array(t.length-r+e);for(var o=0;o<t.length-r;o++)this.num[o]=t[o+r]}function o(t,e){this.totalCount=t,this.dataCount=e}function i(){this.buffer=[],this.length=0}function n(){return"undefined"!=typeof CanvasRenderingContext2D}function a(){var t=!1,e=navigator.userAgent;if(/android/i.test(e)){t=!0;var r=e.toString().match(/android ([0-9]\.[0-9])/i);r&&r[1]&&(t=parseFloat(r[1]))}return t}function s(t,e){for(var r=1,o=h(t),i=0,n=p.length;n>=i;i++){var a=0;switch(e){case l.L:a=p[i][0];break;case l.M:a=p[i][1];break;case l.Q:a=p[i][2];break;case l.H:a=p[i][3]}if(a>=o)break;r++}if(r>p.length)throw new Error("Too long data");return r}function h(t){var e=encodeURI(t).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return e.length+(e.length!=t?3:0)}t.prototype={getLength:function(t){return this.parsedData.length},write:function(t){for(var e=0,r=this.parsedData.length;r>e;e++)t.put(this.parsedData[e],8)}},e.prototype={addData:function(e){var r=new t(e);this.dataList.push(r),this.dataCache=null},isDark:function(t,e){if(0>t||this.moduleCount<=t||0>e||this.moduleCount<=e)throw new Error(t+","+e);return this.modules[t][e]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(t,r){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var o=0;o<this.moduleCount;o++){this.modules[o]=new Array(this.moduleCount);for(var i=0;i<this.moduleCount;i++)this.modules[o][i]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(t,r),this.typeNumber>=7&&this.setupTypeNumber(t),null==this.dataCache&&(this.dataCache=e.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,r)},setupPositionProbePattern:function(t,e){for(var r=-1;7>=r;r++)if(!(-1>=t+r||this.moduleCount<=t+r))for(var o=-1;7>=o;o++)-1>=e+o||this.moduleCount<=e+o||(r>=0&&6>=r&&(0==o||6==o)||o>=0&&6>=o&&(0==r||6==r)||r>=2&&4>=r&&o>=2&&4>=o?this.modules[t+r][e+o]=!0:this.modules[t+r][e+o]=!1)},getBestMaskPattern:function(){for(var t=0,e=0,r=0;8>r;r++){this.makeImpl(!0,r);var o=f.getLostPoint(this);(0==r||t>o)&&(t=o,e=r)}return e},createMovieClip:function(t,e,r){var o=t.createEmptyMovieClip(e,r),i=1;this.make();for(var n=0;n<this.modules.length;n++)for(var a=n*i,s=0;s<this.modules[n].length;s++){var h=s*i,u=this.modules[n][s];u&&(o.beginFill(0,100),o.moveTo(h,a),o.lineTo(h+i,a),o.lineTo(h+i,a+i),o.lineTo(h,a+i),o.endFill())}return o},setupTimingPattern:function(){for(var t=8;t<this.moduleCount-8;t++)null==this.modules[t][6]&&(this.modules[t][6]=t%2==0);for(var e=8;e<this.moduleCount-8;e++)null==this.modules[6][e]&&(this.modules[6][e]=e%2==0)},setupPositionAdjustPattern:function(){for(var t=f.getPatternPosition(this.typeNumber),e=0;e<t.length;e++)for(var r=0;r<t.length;r++){var o=t[e],i=t[r];if(null==this.modules[o][i])for(var n=-2;2>=n;n++)for(var a=-2;2>=a;a++)-2==n||2==n||-2==a||2==a||0==n&&0==a?this.modules[o+n][i+a]=!0:this.modules[o+n][i+a]=!1}},setupTypeNumber:function(t){for(var e=f.getBCHTypeNumber(this.typeNumber),r=0;18>r;r++){var o=!t&&1==(e>>r&1);this.modules[Math.floor(r/3)][r%3+this.moduleCount-8-3]=o}for(var r=0;18>r;r++){var o=!t&&1==(e>>r&1);this.modules[r%3+this.moduleCount-8-3][Math.floor(r/3)]=o}},setupTypeInfo:function(t,e){for(var r=this.errorCorrectLevel<<3|e,o=f.getBCHTypeInfo(r),i=0;15>i;i++){var n=!t&&1==(o>>i&1);6>i?this.modules[i][8]=n:8>i?this.modules[i+1][8]=n:this.modules[this.moduleCount-15+i][8]=n}for(var i=0;15>i;i++){var n=!t&&1==(o>>i&1);8>i?this.modules[8][this.moduleCount-i-1]=n:9>i?this.modules[8][15-i-1+1]=n:this.modules[8][15-i-1]=n}this.modules[this.moduleCount-8][8]=!t},mapData:function(t,e){for(var r=-1,o=this.moduleCount-1,i=7,n=0,a=this.moduleCount-1;a>0;a-=2)for(6==a&&a--;;){for(var s=0;2>s;s++)if(null==this.modules[o][a-s]){var h=!1;n<t.length&&(h=1==(t[n]>>>i&1));var u=f.getMask(e,o,a-s);u&&(h=!h),this.modules[o][a-s]=h,i--,-1==i&&(n++,i=7)}if(o+=r,0>o||this.moduleCount<=o){o-=r,r=-r;break}}}},e.PAD0=236,e.PAD1=17,e.createData=function(t,r,n){for(var a=o.getRSBlocks(t,r),s=new i,h=0;h<n.length;h++){var u=n[h];s.put(u.mode,4),s.put(u.getLength(),f.getLengthInBits(u.mode,t)),u.write(s)}for(var l=0,h=0;h<a.length;h++)l+=a[h].dataCount;if(s.getLengthInBits()>8*l)throw new Error("code length overflow. ("+s.getLengthInBits()+">"+8*l+")");for(s.getLengthInBits()+4<=8*l&&s.put(0,4);s.getLengthInBits()%8!=0;)s.putBit(!1);for(;;){if(s.getLengthInBits()>=8*l)break;if(s.put(e.PAD0,8),s.getLengthInBits()>=8*l)break;s.put(e.PAD1,8)}return e.createBytes(s,a)},e.createBytes=function(t,e){for(var o=0,i=0,n=0,a=new Array(e.length),s=new Array(e.length),h=0;h<e.length;h++){var u=e[h].dataCount,l=e[h].totalCount-u;i=Math.max(i,u),n=Math.max(n,l),a[h]=new Array(u);for(var g=0;g<a[h].length;g++)a[h][g]=255&t.buffer[g+o];o+=u;var d=f.getErrorCorrectPolynomial(l),c=new r(a[h],d.getLength()-1),p=c.mod(d);s[h]=new Array(d.getLength()-1);for(var g=0;g<s[h].length;g++){var m=g+p.getLength()-s[h].length;s[h][g]=m>=0?p.get(m):0}}for(var v=0,g=0;g<e.length;g++)v+=e[g].totalCount;for(var _=new Array(v),C=0,g=0;i>g;g++)for(var h=0;h<e.length;h++)g<a[h].length&&(_[C++]=a[h][g]);for(var g=0;n>g;g++)for(var h=0;h<e.length;h++)g<s[h].length&&(_[C++]=s[h][g]);return _};for(var u={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},l={L:1,M:0,Q:3,H:2},g={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},f={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(t){for(var e=t<<10;f.getBCHDigit(e)-f.getBCHDigit(f.G15)>=0;)e^=f.G15<<f.getBCHDigit(e)-f.getBCHDigit(f.G15);return(t<<10|e)^f.G15_MASK},getBCHTypeNumber:function(t){for(var e=t<<12;f.getBCHDigit(e)-f.getBCHDigit(f.G18)>=0;)e^=f.G18<<f.getBCHDigit(e)-f.getBCHDigit(f.G18);return t<<12|e},getBCHDigit:function(t){for(var e=0;0!=t;)e++,t>>>=1;return e},getPatternPosition:function(t){return f.PATTERN_POSITION_TABLE[t-1]},getMask:function(t,e,r){switch(t){case g.PATTERN000:return(e+r)%2==0;case g.PATTERN001:return e%2==0;case g.PATTERN010:return r%3==0;case g.PATTERN011:return(e+r)%3==0;case g.PATTERN100:return(Math.floor(e/2)+Math.floor(r/3))%2==0;case g.PATTERN101:return e*r%2+e*r%3==0;case g.PATTERN110:return(e*r%2+e*r%3)%2==0;case g.PATTERN111:return(e*r%3+(e+r)%2)%2==0;default:throw new Error("bad maskPattern:"+t)}},getErrorCorrectPolynomial:function(t){for(var e=new r([1],0),o=0;t>o;o++)e=e.multiply(new r([1,d.gexp(o)],0));return e},getLengthInBits:function(t,e){if(e>=1&&10>e)switch(t){case u.MODE_NUMBER:return 10;case u.MODE_ALPHA_NUM:return 9;case u.MODE_8BIT_BYTE:return 8;case u.MODE_KANJI:return 8;default:throw new Error("mode:"+t)}else if(27>e)switch(t){case u.MODE_NUMBER:return 12;case u.MODE_ALPHA_NUM:return 11;case u.MODE_8BIT_BYTE:return 16;case u.MODE_KANJI:return 10;default:throw new Error("mode:"+t)}else{if(!(41>e))throw new Error("type:"+e);switch(t){case u.MODE_NUMBER:return 14;case u.MODE_ALPHA_NUM:return 13;case u.MODE_8BIT_BYTE:return 16;case u.MODE_KANJI:return 12;default:throw new Error("mode:"+t)}}},getLostPoint:function(t){for(var e=t.getModuleCount(),r=0,o=0;e>o;o++)for(var i=0;e>i;i++){for(var n=0,a=t.isDark(o,i),s=-1;1>=s;s++)if(!(0>o+s||o+s>=e))for(var h=-1;1>=h;h++)0>i+h||i+h>=e||(0!=s||0!=h)&&a==t.isDark(o+s,i+h)&&n++;n>5&&(r+=3+n-5)}for(var o=0;e-1>o;o++)for(var i=0;e-1>i;i++){var u=0;t.isDark(o,i)&&u++,t.isDark(o+1,i)&&u++,t.isDark(o,i+1)&&u++,t.isDark(o+1,i+1)&&u++,(0==u||4==u)&&(r+=3)}for(var o=0;e>o;o++)for(var i=0;e-6>i;i++)t.isDark(o,i)&&!t.isDark(o,i+1)&&t.isDark(o,i+2)&&t.isDark(o,i+3)&&t.isDark(o,i+4)&&!t.isDark(o,i+5)&&t.isDark(o,i+6)&&(r+=40);for(var i=0;e>i;i++)for(var o=0;e-6>o;o++)t.isDark(o,i)&&!t.isDark(o+1,i)&&t.isDark(o+2,i)&&t.isDark(o+3,i)&&t.isDark(o+4,i)&&!t.isDark(o+5,i)&&t.isDark(o+6,i)&&(r+=40);for(var l=0,i=0;e>i;i++)for(var o=0;e>o;o++)t.isDark(o,i)&&l++;var g=Math.abs(100*l/e/e-50)/5;return r+=10*g}},d={glog:function(t){if(1>t)throw new Error("glog("+t+")");return d.LOG_TABLE[t]},gexp:function(t){for(;0>t;)t+=255;for(;t>=256;)t-=255;return d.EXP_TABLE[t]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},c=0;8>c;c++)d.EXP_TABLE[c]=1<<c;for(var c=8;256>c;c++)d.EXP_TABLE[c]=d.EXP_TABLE[c-4]^d.EXP_TABLE[c-5]^d.EXP_TABLE[c-6]^d.EXP_TABLE[c-8];for(var c=0;255>c;c++)d.LOG_TABLE[d.EXP_TABLE[c]]=c;r.prototype={get:function(t){return this.num[t]},getLength:function(){return this.num.length},multiply:function(t){for(var e=new Array(this.getLength()+t.getLength()-1),o=0;o<this.getLength();o++)for(var i=0;i<t.getLength();i++)e[o+i]^=d.gexp(d.glog(this.get(o))+d.glog(t.get(i)));return new r(e,0)},mod:function(t){if(this.getLength()-t.getLength()<0)return this;for(var e=d.glog(this.get(0))-d.glog(t.get(0)),o=new Array(this.getLength()),i=0;i<this.getLength();i++)o[i]=this.get(i);for(var i=0;i<t.getLength();i++)o[i]^=d.gexp(d.glog(t.get(i))+e);return new r(o,0).mod(t)}},o.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],o.getRSBlocks=function(t,e){var r=o.getRsBlockTable(t,e);if(void 0==r)throw new Error("bad rs block @ typeNumber:"+t+"/errorCorrectLevel:"+e);for(var i=r.length/3,n=[],a=0;i>a;a++)for(var s=r[3*a+0],h=r[3*a+1],u=r[3*a+2],l=0;s>l;l++)n.push(new o(h,u));return n},o.getRsBlockTable=function(t,e){switch(e){case l.L:return o.RS_BLOCK_TABLE[4*(t-1)+0];case l.M:return o.RS_BLOCK_TABLE[4*(t-1)+1];case l.Q:return o.RS_BLOCK_TABLE[4*(t-1)+2];case l.H:return o.RS_BLOCK_TABLE[4*(t-1)+3];default:return}},i.prototype={get:function(t){var e=Math.floor(t/8);return 1==(this.buffer[e]>>>7-t%8&1)},put:function(t,e){for(var r=0;e>r;r++)this.putBit(1==(t>>>e-r-1&1))},getLengthInBits:function(){return this.length},putBit:function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}};var p=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]],m=function(){var t=function(t,e){this._el=t,this._htOption=e};return t.prototype.draw=function(t){function e(t,e){var r=document.createElementNS("http://www.w3.org/2000/svg",t);for(var o in e)e.hasOwnProperty(o)&&r.setAttribute(o,e[o]);return r}var r=this._htOption,o=this._el,i=t.getModuleCount(),n=Math.floor(r.width/i),a=Math.floor(r.height/i);this.clear();var s=e("svg",{viewBox:"0 0 "+String(i)+" "+String(i),width:"100%",height:"100%",fill:r.colorLight});s.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),o.appendChild(s),s.appendChild(e("rect",{fill:r.colorLight,width:"100%",height:"100%"})),s.appendChild(e("rect",{fill:r.colorDark,width:"1",height:"1",id:"template"}));for(var h=0;i>h;h++)for(var u=0;i>u;u++)if(t.isDark(h,u)){var l=e("use",{x:String(u),y:String(h)});l.setAttributeNS("http://www.w3.org/1999/xlink","href","#template"),s.appendChild(l)}},t.prototype.clear=function(){for(;this._el.hasChildNodes();)this._el.removeChild(this._el.lastChild)},t}(),v="svg"===document.documentElement.tagName.toLowerCase(),_=v?m:n()?function(){function t(){this._elImage.src=this._elCanvas.toDataURL("image/png"),this._elImage.style.display="block",this._elCanvas.style.display="none"}function e(t,e){var r=this;if(r._fFail=e,r._fSuccess=t,null===r._bSupportDataURI){var o=document.createElement("img"),i=function(){r._bSupportDataURI=!1,r._fFail&&r._fFail.call(r)},n=function(){r._bSupportDataURI=!0,r._fSuccess&&r._fSuccess.call(r)};return o.onabort=i,o.onerror=i,o.onload=n,void(o.src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==")}r._bSupportDataURI===!0&&r._fSuccess?r._fSuccess.call(r):r._bSupportDataURI===!1&&r._fFail&&r._fFail.call(r)}if(this._android&&this._android<=2.1){var r=1/window.devicePixelRatio,o=CanvasRenderingContext2D.prototype.drawImage;CanvasRenderingContext2D.prototype.drawImage=function(t,e,i,n,a,s,h,u,l){if("nodeName"in t&&/img/i.test(t.nodeName))for(var g=arguments.length-1;g>=1;g--)arguments[g]=arguments[g]*r;else"undefined"==typeof u&&(arguments[1]*=r,arguments[2]*=r,arguments[3]*=r,arguments[4]*=r);o.apply(this,arguments)}}var i=function(t,e){this._bIsPainted=!1,this._android=a(),this._htOption=e,this._elCanvas=document.createElement("canvas"),this._elCanvas.width=e.width,this._elCanvas.height=e.height,t.appendChild(this._elCanvas),this._el=t,this._oContext=this._elCanvas.getContext("2d"),this._bIsPainted=!1,this._elImage=document.createElement("img"),this._elImage.alt="Scan me!",this._elImage.style.display="none",this._el.appendChild(this._elImage),this._bSupportDataURI=null};return i.prototype.draw=function(t){var e=this._elImage,r=this._oContext,o=this._htOption,i=t.getModuleCount(),n=o.width/i,a=o.height/i,s=Math.round(n),h=Math.round(a);e.style.display="none",this.clear();for(var u=0;i>u;u++)for(var l=0;i>l;l++){var g=t.isDark(u,l),f=l*n,d=u*a;r.strokeStyle=g?o.colorDark:o.colorLight,r.lineWidth=1,r.fillStyle=g?o.colorDark:o.colorLight,r.fillRect(f,d,n,a),r.strokeRect(Math.floor(f)+.5,Math.floor(d)+.5,s,h),r.strokeRect(Math.ceil(f)-.5,Math.ceil(d)-.5,s,h)}this._bIsPainted=!0},i.prototype.makeImage=function(){this._bIsPainted&&e.call(this,t)},i.prototype.isPainted=function(){return this._bIsPainted},i.prototype.clear=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height),this._bIsPainted=!1},i.prototype.round=function(t){return t?Math.floor(1e3*t)/1e3:t},i}():function(){var t=function(t,e){this._el=t,this._htOption=e};return t.prototype.draw=function(t){for(var e=this._htOption,r=this._el,o=t.getModuleCount(),i=Math.floor(e.width/o),n=Math.floor(e.height/o),a=['<table style="border:0;border-collapse:collapse;">'],s=0;o>s;s++){a.push("<tr>");for(var h=0;o>h;h++)a.push('<td style="border:0;border-collapse:collapse;padding:0;margin:0;width:'+i+"px;height:"+n+"px;background-color:"+(t.isDark(s,h)?e.colorDark:e.colorLight)+';"></td>');a.push("</tr>")}a.push("</table>"),r.innerHTML=a.join("");var u=r.childNodes[0],l=(e.width-u.offsetWidth)/2,g=(e.height-u.offsetHeight)/2;l>0&&g>0&&(u.style.margin=g+"px "+l+"px")},t.prototype.clear=function(){this._el.innerHTML=""},t}();QRCode=function(t,e){if(this._htOption={width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:l.H},"string"==typeof e&&(e={text:e}),e)for(var r in e)this._htOption[r]=e[r];"string"==typeof t&&(t=document.getElementById(t)),this._htOption.useSVG&&(_=m),this._android=a(),this._el=t,this._oQRCode=null,this._oDrawing=new _(this._el,this._htOption),this._htOption.text&&this.makeCode(this._htOption.text)},QRCode.prototype.makeCode=function(t){this._oQRCode=new e(s(t,this._htOption.correctLevel),this._htOption.correctLevel),this._oQRCode.addData(t),this._oQRCode.make(),this._el.title=t,this._oDrawing.draw(this._oQRCode),this.makeImage()},QRCode.prototype.makeImage=function(){"function"==typeof this._oDrawing.makeImage&&(!this._android||this._android>=3)&&this._oDrawing.makeImage()},QRCode.prototype.clear=function(){this._oDrawing.clear()},QRCode.CorrectLevel=l}();
!function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t(require("jquery")):t(jQuery)}(function($){"use strict";function t(){var t=document.createElement("input");return t.setAttribute("type","range"),"text"!==t.type}function i(t,i){var e=Array.prototype.slice.call(arguments,2);return setTimeout(function(){return t.apply(null,e)},i)}function e(t,i){return i=i||100,function(){if(!t.debouncing){var e=Array.prototype.slice.apply(arguments);t.lastReturnVal=t.apply(window,e),t.debouncing=!0}return clearTimeout(t.debounceTimeout),t.debounceTimeout=setTimeout(function(){t.debouncing=!1},i),t.lastReturnVal}}function n(t){return t&&(0===t.offsetWidth||0===t.offsetHeight||t.open===!1)}function o(t){for(var i=[],e=t.parentNode;n(e);)i.push(e),e=e.parentNode;return i}function s(t,i){function e(t){"undefined"!=typeof t.open&&(t.open=t.open?!1:!0)}var n=o(t),s=n.length,r=[],h=t[i];if(s){for(var a=0;s>a;a++)r[a]=n[a].style.cssText,n[a].style.display="block",n[a].style.height="0",n[a].style.overflow="hidden",n[a].style.visibility="hidden",e(n[a]);h=t[i];for(var l=0;s>l;l++)n[l].style.cssText=r[l],e(n[l])}return h}function r(t,i){var e=parseFloat(t);return Number.isNaN(e)?i:e}function h(t){return t.charAt(0).toUpperCase()+t.substr(1)}function a(t,n){if(this.$window=$(window),this.$document=$(document),this.$element=$(t),this.options=$.extend({},p,n),this.polyfill=this.options.polyfill,this.orientation=this.$element[0].getAttribute("data-orientation")||this.options.orientation,this.onInit=this.options.onInit,this.onSlide=this.options.onSlide,this.onSlideEnd=this.options.onSlideEnd,this.DIMENSION=f.orientation[this.orientation].dimension,this.DIRECTION=f.orientation[this.orientation].direction,this.DIRECTION_STYLE=f.orientation[this.orientation].directionStyle,this.COORDINATE=f.orientation[this.orientation].coordinate,this.polyfill&&u)return!1;this.identifier="js-"+l+"-"+d++,this.startEvent=this.options.startEvent.join("."+this.identifier+" ")+"."+this.identifier,this.moveEvent=this.options.moveEvent.join("."+this.identifier+" ")+"."+this.identifier,this.endEvent=this.options.endEvent.join("."+this.identifier+" ")+"."+this.identifier,this.toFixed=(this.step+"").replace(".","").length-1,this.$fill=$('<div class="'+this.options.fillClass+'" />'),this.$handle=$('<div class="'+this.options.handleClass+'" />'),this.$range=$('<div class="'+this.options.rangeClass+" "+this.options[this.orientation+"Class"]+'" id="'+this.identifier+'" />').insertAfter(this.$element).prepend(this.$fill,this.$handle),this.$element.css({position:"absolute",width:"1px",height:"1px",overflow:"hidden",opacity:"0"}),this.handleDown=$.proxy(this.handleDown,this),this.handleMove=$.proxy(this.handleMove,this),this.handleEnd=$.proxy(this.handleEnd,this),this.init();var o=this;this.$window.on("resize."+this.identifier,e(function(){i(function(){o.update()},300)},20)),this.$document.on(this.startEvent,"#"+this.identifier+":not(."+this.options.disabledClass+")",this.handleDown),this.$element.on("change."+this.identifier,function(t,i){if(!i||i.origin!==o.identifier){var e=t.target.value,n=o.getPositionFromValue(e);o.setPosition(n)}})}Number.isNaN=Number.isNaN||function(t){return"number"==typeof t&&t!==t};var l="rangeslider",d=0,u=t(),p={polyfill:!0,orientation:"horizontal",rangeClass:"rangeslider",disabledClass:"rangeslider--disabled",horizontalClass:"rangeslider--horizontal",verticalClass:"rangeslider--vertical",fillClass:"rangeslider__fill",handleClass:"rangeslider__handle",startEvent:["mousedown","touchstart","pointerdown"],moveEvent:["mousemove","touchmove","pointermove"],endEvent:["mouseup","touchend","pointerup"]},f={orientation:{horizontal:{dimension:"width",direction:"left",directionStyle:"left",coordinate:"x"},vertical:{dimension:"height",direction:"top",directionStyle:"bottom",coordinate:"y"}}};a.prototype.init=function(){this.update(!0,!1),this.onInit&&"function"==typeof this.onInit&&this.onInit()},a.prototype.update=function(t,i){t=t||!1,t&&(this.min=r(this.$element[0].getAttribute("min"),0),this.max=r(this.$element[0].getAttribute("max"),100),this.value=r(this.$element[0].value,Math.round(this.min+(this.max-this.min)/2)),this.step=r(this.$element[0].getAttribute("step"),1)),this.handleDimension=s(this.$handle[0],"offset"+h(this.DIMENSION)),this.rangeDimension=s(this.$range[0],"offset"+h(this.DIMENSION)),this.maxHandlePos=this.rangeDimension-this.handleDimension,this.grabPos=this.handleDimension/2,this.position=this.getPositionFromValue(this.value),this.$element[0].disabled?this.$range.addClass(this.options.disabledClass):this.$range.removeClass(this.options.disabledClass),this.setPosition(this.position,i)},a.prototype.handleDown=function(t){if(this.$document.on(this.moveEvent,this.handleMove),this.$document.on(this.endEvent,this.handleEnd),!((" "+t.target.className+" ").replace(/[\n\t]/g," ").indexOf(this.options.handleClass)>-1)){var i=this.getRelativePosition(t),e=this.$range[0].getBoundingClientRect()[this.DIRECTION],n=this.getPositionFromNode(this.$handle[0])-e,o="vertical"===this.orientation?this.maxHandlePos-(i-this.grabPos):i-this.grabPos;this.setPosition(o),i>=n&&i<n+this.handleDimension&&(this.grabPos=i-n)}},a.prototype.handleMove=function(t){t.preventDefault();var i=this.getRelativePosition(t),e="vertical"===this.orientation?this.maxHandlePos-(i-this.grabPos):i-this.grabPos;this.setPosition(e)},a.prototype.handleEnd=function(t){t.preventDefault(),this.$document.off(this.moveEvent,this.handleMove),this.$document.off(this.endEvent,this.handleEnd),this.$element.trigger("change",{origin:this.identifier}),this.onSlideEnd&&"function"==typeof this.onSlideEnd&&this.onSlideEnd(this.position,this.value)},a.prototype.cap=function(t,i,e){return i>t?i:t>e?e:t},a.prototype.setPosition=function(t,i){var e,n;void 0===i&&(i=!0),e=this.getValueFromPosition(this.cap(t,0,this.maxHandlePos)),n=this.getPositionFromValue(e),this.$fill[0].style[this.DIMENSION]=n+this.grabPos+"px",this.$handle[0].style[this.DIRECTION_STYLE]=n+"px",this.setValue(e),this.position=n,this.value=e,i&&this.onSlide&&"function"==typeof this.onSlide&&this.onSlide(n,e)},a.prototype.getPositionFromNode=function(t){for(var i=0;null!==t;)i+=t.offsetLeft,t=t.offsetParent;return i},a.prototype.getRelativePosition=function(t){var i=h(this.COORDINATE),e=this.$range[0].getBoundingClientRect()[this.DIRECTION],n=0;return"undefined"!=typeof t["page"+i]?n=t["client"+i]:"undefined"!=typeof t.originalEvent["client"+i]?n=t.originalEvent["client"+i]:t.originalEvent.touches&&t.originalEvent.touches[0]&&"undefined"!=typeof t.originalEvent.touches[0]["client"+i]?n=t.originalEvent.touches[0]["client"+i]:t.currentPoint&&"undefined"!=typeof t.currentPoint[this.COORDINATE]&&(n=t.currentPoint[this.COORDINATE]),n-e},a.prototype.getPositionFromValue=function(t){var i,e;return i=(t-this.min)/(this.max-this.min),e=Number.isNaN(i)?0:i*this.maxHandlePos},a.prototype.getValueFromPosition=function(t){var i,e;return i=t/(this.maxHandlePos||1),e=this.step*Math.round(i*(this.max-this.min)/this.step)+this.min,Number(e.toFixed(this.toFixed))},a.prototype.setValue=function(t){(t!==this.value||""===this.$element[0].value)&&this.$element.val(t).trigger("input",{origin:this.identifier})},a.prototype.destroy=function(){this.$document.off("."+this.identifier),this.$window.off("."+this.identifier),this.$element.off("."+this.identifier).removeAttr("style").removeData("plugin_"+l),this.$range&&this.$range.length&&this.$range[0].parentNode.removeChild(this.$range[0])},$.fn[l]=function(t){var i=Array.prototype.slice.call(arguments,1);return this.each(function(){var e=$(this),n=e.data("plugin_"+l);n||e.data("plugin_"+l,n=new a(this,t)),"string"==typeof t&&n[t].apply(n,i)})}});
!function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports&&"object"==typeof module?module.exports=t:t(jQuery)}(function($,t){"use strict";function e(t,e,r,n){for(var a=[],i=0;i<t.length;i++){var s=t[i];if(s){var o=tinycolor(s),l=o.toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light";l+=tinycolor.equals(e,s)?" sp-thumb-active":"";var c=o.toString(n.preferredFormat||"rgb"),f=g?"background-color:"+o.toRgbString():"filter:"+o.toFilter();a.push('<span title="'+c+'" data-color="'+o.toRgbString()+'" class="'+l+'"><span class="sp-thumb-inner" style="'+f+';" /></span>')}else{var u="sp-clear-display";a.push($("<div />").append($('<span data-color="" style="background-color:transparent;" class="'+u+'"></span>').attr("title",n.noColorSelectedText)).html())}}return"<div class='sp-cf "+r+"'>"+a.join("")+"</div>"}function r(){for(var t=0;t<d.length;t++)d[t]&&d[t].hide()}function n(t,e){var r=$.extend({},h,t);return r.callbacks={move:l(r.move,e),change:l(r.change,e),show:l(r.show,e),hide:l(r.hide,e),beforeShow:l(r.beforeShow,e)},r}function a(a,s){function l(){if(W.showPaletteOnly&&(W.showPalette=!0),It.text(W.showPaletteOnly?W.togglePaletteMoreText:W.togglePaletteLessText),W.palette){dt=W.palette.slice(0),pt=$.isArray(dt[0])?dt:[dt],gt={};for(var t=0;t<pt.length;t++)for(var e=0;e<pt[t].length;e++){var r=tinycolor(pt[t][e]).toRgbString();gt[r]=!0}}St.toggleClass("sp-flat",X),St.toggleClass("sp-input-disabled",!W.showInput),St.toggleClass("sp-alpha-enabled",W.showAlpha),St.toggleClass("sp-clear-enabled",Ut),St.toggleClass("sp-buttons-disabled",!W.showButtons),St.toggleClass("sp-palette-buttons-disabled",!W.togglePaletteOnly),St.toggleClass("sp-palette-disabled",!W.showPalette),St.toggleClass("sp-palette-only",W.showPaletteOnly),St.toggleClass("sp-initial-disabled",!W.showInitial),St.addClass(W.className).addClass(W.containerClassName),I()}function h(){function t(t){return t.data&&t.data.ignore?(F($(t.target).closest(".sp-thumb-el").data("color")),E()):(F($(t.target).closest(".sp-thumb-el").data("color")),E(),D(!0),W.hideAfterPaletteSelect&&H()),!1}if(p&&St.find("*:not(input)").attr("unselectable","on"),l(),Lt&&xt.after(Kt).hide(),Ut||qt.hide(),X)xt.after(St).hide();else{var e="parent"===W.appendTo?xt.parent():$(W.appendTo);1!==e.length&&(e=$("body")),e.append(St)}m(),Vt.bind("click.spectrum touchstart.spectrum",function(t){kt||P(),t.stopPropagation(),$(t.target).is("input")||t.preventDefault()}),(xt.is(":disabled")||W.disabled===!0)&&K(),St.click(o),Ot.change(C),Ot.bind("paste",function(){setTimeout(C,1)}),Ot.keydown(function(t){13==t.keyCode&&C()}),jt.text(W.cancelText),jt.bind("click.spectrum",function(t){t.stopPropagation(),t.preventDefault(),T(),H()}),qt.attr("title",W.clearText),qt.bind("click.spectrum",function(t){t.stopPropagation(),t.preventDefault(),Jt=!0,E(),X&&D(!0)}),Dt.text(W.chooseText),Dt.bind("click.spectrum",function(t){t.stopPropagation(),t.preventDefault(),p&&Ot.is(":focus")&&Ot.trigger("change"),N()&&(D(!0),H())}),It.text(W.showPaletteOnly?W.togglePaletteMoreText:W.togglePaletteLessText),It.bind("click.spectrum",function(t){t.stopPropagation(),t.preventDefault(),W.showPaletteOnly=!W.showPaletteOnly,W.showPaletteOnly||X||St.css("left","-="+(Ct.outerWidth(!0)+5)),l()}),c(Tt,function(t,e,r){ht=t/st,Jt=!1,r.shiftKey&&(ht=Math.round(10*ht)/10),E()},k,S),c(Mt,function(t,e){ct=parseFloat(e/at),Jt=!1,W.showAlpha||(ht=1),E()},k,S),c(Pt,function(t,e,r){if(r.shiftKey){if(!yt){var n=ft*et,a=rt-ut*rt,i=Math.abs(t-n)>Math.abs(e-a);yt=i?"x":"y"}}else yt=null;var s=!yt||"x"===yt,o=!yt||"y"===yt;s&&(ft=parseFloat(t/et)),o&&(ut=parseFloat((rt-e)/rt)),Jt=!1,W.showAlpha||(ht=1),E()},k,S),Wt?(F(Wt),j(),Gt=Yt||tinycolor(Wt).format,y(Wt)):j(),X&&A();var r=p?"mousedown.spectrum":"click.spectrum touchstart.spectrum";Nt.delegate(".sp-thumb-el",r,t),Et.delegate(".sp-thumb-el:nth-child(1)",r,{ignore:!0},t)}function m(){if(G&&window.localStorage){try{var t=window.localStorage[G].split(",#");t.length>1&&(delete window.localStorage[G],$.each(t,function(t,e){y(e)}))}catch(e){}try{bt=window.localStorage[G].split(";")}catch(e){}}}function y(t){if(Y){var e=tinycolor(t).toRgbString();if(!gt[e]&&-1===$.inArray(e,bt))for(bt.push(e);bt.length>vt;)bt.shift();if(G&&window.localStorage)try{window.localStorage[G]=bt.join(";")}catch(r){}}}function w(){var t=[];if(W.showPalette)for(var e=0;e<bt.length;e++){var r=tinycolor(bt[e]).toRgbString();gt[r]||t.push(bt[e])}return t.reverse().slice(0,W.maxSelectionSize)}function _(){var t=O(),r=$.map(pt,function(r,n){return e(r,t,"sp-palette-row sp-palette-row-"+n,W)});m(),bt&&r.push(e(w(),t,"sp-palette-row sp-palette-row-selection",W)),Nt.html(r.join(""))}function x(){if(W.showInitial){var t=Xt,r=O();Et.html(e([t,r],r,"sp-palette-row-initial",W))}}function k(){(0>=rt||0>=et||0>=at)&&I(),tt=!0,St.addClass(mt),yt=null,xt.trigger("dragstart.spectrum",[O()])}function S(){tt=!1,St.removeClass(mt),xt.trigger("dragstop.spectrum",[O()])}function C(){var t=Ot.val();if(null!==t&&""!==t||!Ut){var e=tinycolor(t);e.isValid()?(F(e),D(!0)):Ot.addClass("sp-validation-error")}else F(null),D(!0)}function P(){Z?H():A()}function A(){var t=$.Event("beforeShow.spectrum");return Z?void I():(xt.trigger(t,[O()]),void(J.beforeShow(O())===!1||t.isDefaultPrevented()||(r(),Z=!0,$(wt).bind("keydown.spectrum",M),$(wt).bind("click.spectrum",R),$(window).bind("resize.spectrum",U),Kt.addClass("sp-active"),St.removeClass("sp-hidden"),I(),j(),Xt=O(),x(),J.show(Xt),xt.trigger("show.spectrum",[Xt]))))}function M(t){27===t.keyCode&&H()}function R(t){2!=t.button&&(tt||(Qt?D(!0):T(),H()))}function H(){Z&&!X&&(Z=!1,$(wt).unbind("keydown.spectrum",M),$(wt).unbind("click.spectrum",R),$(window).unbind("resize.spectrum",U),Kt.removeClass("sp-active"),St.addClass("sp-hidden"),J.hide(O()),xt.trigger("hide.spectrum",[O()]))}function T(){F(Xt,!0)}function F(t,e){if(tinycolor.equals(t,O()))return void j();var r,n;!t&&Ut?Jt=!0:(Jt=!1,r=tinycolor(t),n=r.toHsv(),ct=n.h%360/360,ft=n.s,ut=n.v,ht=n.a),j(),r&&r.isValid()&&!e&&(Gt=Yt||r.getFormat())}function O(t){return t=t||{},Ut&&Jt?null:tinycolor.fromRatio({h:ct,s:ft,v:ut,a:Math.round(100*ht)/100},{format:t.format||Gt})}function N(){return!Ot.hasClass("sp-validation-error")}function E(){j(),J.move(O()),xt.trigger("move.spectrum",[O()])}function j(){Ot.removeClass("sp-validation-error"),q();var t=tinycolor.fromRatio({h:ct,s:1,v:1});Pt.css("background-color",t.toHexString());var e=Gt;1>ht&&(0!==ht||"name"!==e)&&("hex"===e||"hex3"===e||"hex6"===e||"name"===e)&&(e="rgb");var r=O({format:e}),n="";if($t.removeClass("sp-clear-display"),$t.css("background-color","transparent"),!r&&Ut)$t.addClass("sp-clear-display");else{var a=r.toHexString(),i=r.toRgbString();if(g||1===r.alpha?$t.css("background-color",i):($t.css("background-color","transparent"),$t.css("filter",r.toFilter())),W.showAlpha){var s=r.toRgb();s.a=0;var o=tinycolor(s).toRgbString(),l="linear-gradient(left, "+o+", "+a+")";p?Ht.css("filter",tinycolor(o).toFilter({gradientType:1},a)):(Ht.css("background","-webkit-"+l),Ht.css("background","-moz-"+l),Ht.css("background","-ms-"+l),Ht.css("background","linear-gradient(to right, "+o+", "+a+")"))}n=r.toString(e)}W.showInput&&Ot.val(n),W.showPalette&&_(),x()}function q(){var t=ft,e=ut;if(Ut&&Jt)Ft.hide(),Rt.hide(),At.hide();else{Ft.show(),Rt.show(),At.show();var r=t*et,n=rt-e*rt;r=Math.max(-nt,Math.min(et-nt,r-nt)),n=Math.max(-nt,Math.min(rt-nt,n-nt)),At.css({top:n+"px",left:r+"px"});var a=ht*st;Ft.css({left:a-ot/2+"px"});var i=ct*at;Rt.css({top:i-lt+"px"})}}function D(t){var e=O(),r="",n=!tinycolor.equals(e,Xt);e&&(r=e.toString(Gt),y(e)),zt&&xt.val(r),t&&n&&(J.change(e),xt.trigger("change",[e]))}function I(){et=Pt.width(),rt=Pt.height(),nt=At.height(),it=Mt.width(),at=Mt.height(),lt=Rt.height(),st=Tt.width(),ot=Ft.width(),X||(St.css("position","absolute"),W.offset?St.offset(W.offset):St.offset(i(St,Vt))),q(),W.showPalette&&_(),xt.trigger("reflow.spectrum")}function z(){xt.show(),Vt.unbind("click.spectrum touchstart.spectrum"),St.remove(),Kt.remove(),d[Zt.id]=null}function B(e,r){return e===t?$.extend({},W):r===t?W[e]:(W[e]=r,void l())}function L(){kt=!1,xt.attr("disabled",!1),Vt.removeClass("sp-disabled")}function K(){H(),kt=!0,xt.attr("disabled",!0),Vt.addClass("sp-disabled")}function V(t){W.offset=t,I()}var W=n(s,a),X=W.flat,Y=W.showSelectionPalette,G=W.localStorageKey,Q=W.theme,J=W.callbacks,U=f(I,10),Z=!1,tt=!1,et=0,rt=0,nt=0,at=0,it=0,st=0,ot=0,lt=0,ct=0,ft=0,ut=0,ht=1,dt=[],pt=[],gt={},bt=W.selectionPalette.slice(0),vt=W.maxSelectionSize,mt="sp-dragging",yt=null,wt=a.ownerDocument,_t=wt.body,xt=$(a),kt=!1,St=$(v,wt).addClass(Q),Ct=St.find(".sp-picker-container"),Pt=St.find(".sp-color"),At=St.find(".sp-dragger"),Mt=St.find(".sp-hue"),Rt=St.find(".sp-slider"),Ht=St.find(".sp-alpha-inner"),Tt=St.find(".sp-alpha"),Ft=St.find(".sp-alpha-handle"),Ot=St.find(".sp-input"),Nt=St.find(".sp-palette"),Et=St.find(".sp-initial"),jt=St.find(".sp-cancel"),qt=St.find(".sp-clear"),Dt=St.find(".sp-choose"),It=St.find(".sp-palette-toggle"),zt=xt.is("input"),Bt=zt&&"color"===xt.attr("type")&&u(),Lt=zt&&!X,Kt=Lt?$(b).addClass(Q).addClass(W.className).addClass(W.replacerClassName):$([]),Vt=Lt?Kt:xt,$t=Kt.find(".sp-preview-inner"),Wt=W.color||zt&&xt.val(),Xt=!1,Yt=W.preferredFormat,Gt=Yt,Qt=!W.showButtons||W.clickoutFiresChange,Jt=!Wt,Ut=W.allowEmpty&&!Bt;h();var Zt={show:A,hide:H,toggle:P,reflow:I,option:B,enable:L,disable:K,offset:V,set:function(t){F(t),D()},get:O,destroy:z,container:St};return Zt.id=d.push(Zt)-1,Zt}function i(t,e){var r=0,n=t.outerWidth(),a=t.outerHeight(),i=e.outerHeight(),s=t[0].ownerDocument,o=s.documentElement,l=o.clientWidth+$(s).scrollLeft(),c=o.clientHeight+$(s).scrollTop(),f=e.offset();return f.top+=i,f.left-=Math.min(f.left,f.left+n>l&&l>n?Math.abs(f.left+n-l):0),f.top-=Math.min(f.top,f.top+a>c&&c>a?Math.abs(a+i-r):r),f}function s(){}function o(t){t.stopPropagation()}function l(t,e){var r=Array.prototype.slice,n=r.call(arguments,2);return function(){return t.apply(e,n.concat(r.call(arguments)))}}function c(t,e,r,n){function a(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),t.returnValue=!1}function i(r){if(c){if(p&&l.documentMode<9&&!r.button)return o();var n=r.originalEvent&&r.originalEvent.touches&&r.originalEvent.touches[0],i=n&&n.pageX||r.pageX,s=n&&n.pageY||r.pageY,g=Math.max(0,Math.min(i-f.left,h)),b=Math.max(0,Math.min(s-f.top,u));d&&a(r),e.apply(t,[g,b,r])}}function s(e){var n=e.which?3==e.which:2==e.button;n||c||r.apply(t,arguments)!==!1&&(c=!0,u=$(t).height(),h=$(t).width(),f=$(t).offset(),$(l).bind(g),$(l.body).addClass("sp-dragging"),i(e),a(e))}function o(){c&&($(l).unbind(g),$(l.body).removeClass("sp-dragging"),setTimeout(function(){n.apply(t,arguments)},0)),c=!1}e=e||function(){},r=r||function(){},n=n||function(){};var l=document,c=!1,f={},u=0,h=0,d="ontouchstart"in window,g={};g.selectstart=a,g.dragstart=a,g["touchmove mousemove"]=i,g["touchend mouseup"]=o,$(t).bind("touchstart mousedown",s)}function f(t,e,r){var n;return function(){var a=this,i=arguments,s=function(){n=null,t.apply(a,i)};r&&clearTimeout(n),(r||!n)&&(n=setTimeout(s,e))}}function u(){return $.fn.spectrum.inputTypeColorSupport()}var h={beforeShow:s,move:s,change:s,show:s,hide:s,color:!1,flat:!1,showInput:!1,allowEmpty:!1,showButtons:!0,clickoutFiresChange:!0,showInitial:!1,showPalette:!1,showPaletteOnly:!1,hideAfterPaletteSelect:!1,togglePaletteOnly:!1,showSelectionPalette:!0,localStorageKey:!1,appendTo:"body",maxSelectionSize:7,cancelText:"cancel",chooseText:"choose",togglePaletteMoreText:"more",togglePaletteLessText:"less",clearText:"Clear Color Selection",noColorSelectedText:"No Color Selected",preferredFormat:!1,className:"",containerClassName:"",replacerClassName:"",showAlpha:!1,theme:"sp-light",palette:[["#ffffff","#000000","#ff0000","#ff8000","#ffff00","#008000","#0000ff","#4b0082","#9400d3"]],selectionPalette:[],disabled:!1,offset:null},d=[],p=!!/msie/i.exec(window.navigator.userAgent),g=function(){function t(t,e){return!!~(""+t).indexOf(e)}var e=document.createElement("div"),r=e.style;return r.cssText="background-color:rgba(0,0,0,.5)",t(r.backgroundColor,"rgba")||t(r.backgroundColor,"hsla")}(),b=["<div class='sp-replacer'>","<div class='sp-preview'><div class='sp-preview-inner'></div></div>","<div class='sp-dd'>&#9660;</div>","</div>"].join(""),v=function(){var t="";if(p)for(var e=1;6>=e;e++)t+="<div class='sp-"+e+"'></div>";return["<div class='sp-container sp-hidden'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'></div>","<div class='sp-palette-button-container sp-cf'>","<button type='button' class='sp-palette-toggle'></button>","</div>","</div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'></div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'></div>","</div>","</div>","</div>","<div class='sp-clear sp-clear-display'>","</div>","<div class='sp-hue'>","<div class='sp-slider'></div>",t,"</div>","</div>","<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>","</div>","<div class='sp-input-container sp-cf'>","<input class='sp-input' type='text' spellcheck='false'  />","</div>","<div class='sp-initial sp-thumb sp-cf'></div>","<div class='sp-button-container sp-cf'>","<a class='sp-cancel' href='#'></a>","<button type='button' class='sp-choose'></button>","</div>","</div>","</div>"].join("")}(),m="spectrum.id";$.fn.spectrum=function(t,e){if("string"==typeof t){var r=this,n=Array.prototype.slice.call(arguments,1);return this.each(function(){var e=d[$(this).data(m)];if(e){var a=e[t];if(!a)throw new Error("Spectrum: no such method: '"+t+"'");"get"==t?r=e.get():"container"==t?r=e.container:"option"==t?r=e.option.apply(e,n):"destroy"==t?(e.destroy(),$(this).removeData(m)):a.apply(e,n)}}),r}return this.spectrum("destroy").each(function(){var e=$.extend({},t,$(this).data()),r=a(this,e);$(this).data(m,r.id)})},$.fn.spectrum.load=!0,$.fn.spectrum.loadOpts={},$.fn.spectrum.draggable=c,$.fn.spectrum.defaults=h,$.fn.spectrum.inputTypeColorSupport=function y(){if("undefined"==typeof y._cachedResult){var t=$("<input type='color'/>")[0];y._cachedResult="color"===t.type&&""!==t.value}return y._cachedResult},$.spectrum={},$.spectrum.localization={},$.spectrum.palettes={},$.fn.spectrum.processNativeColorInputs=function(){var t=$("input[type=color]");t.length&&!u()&&t.spectrum({preferredFormat:"hex6"})},function(){function t(t){var r={r:0,g:0,b:0},a=1,s=!1,o=!1;return"string"==typeof t&&(t=F(t)),"object"==typeof t&&(t.hasOwnProperty("r")&&t.hasOwnProperty("g")&&t.hasOwnProperty("b")?(r=e(t.r,t.g,t.b),s=!0,o="%"===String(t.r).substr(-1)?"prgb":"rgb"):t.hasOwnProperty("h")&&t.hasOwnProperty("s")&&t.hasOwnProperty("v")?(t.s=R(t.s),t.v=R(t.v),r=i(t.h,t.s,t.v),s=!0,o="hsv"):t.hasOwnProperty("h")&&t.hasOwnProperty("s")&&t.hasOwnProperty("l")&&(t.s=R(t.s),t.l=R(t.l),r=n(t.h,t.s,t.l),s=!0,o="hsl"),t.hasOwnProperty("a")&&(a=t.a)),a=x(a),{ok:s,format:t.format||o,r:D(255,I(r.r,0)),g:D(255,I(r.g,0)),b:D(255,I(r.b,0)),a:a}}function e(t,e,r){return{r:255*k(t,255),g:255*k(e,255),b:255*k(r,255)}}function r(t,e,r){t=k(t,255),e=k(e,255),r=k(r,255);var n=I(t,e,r),a=D(t,e,r),i,s,o=(n+a)/2;if(n==a)i=s=0;else{var l=n-a;switch(s=o>.5?l/(2-n-a):l/(n+a),n){case t:i=(e-r)/l+(r>e?6:0);break;case e:i=(r-t)/l+2;break;case r:i=(t-e)/l+4}i/=6}return{h:i,s:s,l:o}}function n(t,e,r){function n(t,e,r){return 0>r&&(r+=1),r>1&&(r-=1),1/6>r?t+6*(e-t)*r:.5>r?e:2/3>r?t+(e-t)*(2/3-r)*6:t}var a,i,s;if(t=k(t,360),e=k(e,100),r=k(r,100),0===e)a=i=s=r;else{var o=.5>r?r*(1+e):r+e-r*e,l=2*r-o;a=n(l,o,t+1/3),i=n(l,o,t),s=n(l,o,t-1/3)}return{r:255*a,g:255*i,b:255*s}}function a(t,e,r){t=k(t,255),e=k(e,255),r=k(r,255);var n=I(t,e,r),a=D(t,e,r),i,s,o=n,l=n-a;if(s=0===n?0:l/n,n==a)i=0;else{switch(n){case t:i=(e-r)/l+(r>e?6:0);break;case e:i=(r-t)/l+2;break;case r:i=(t-e)/l+4}i/=6}return{h:i,s:s,v:o}}function i(t,e,r){t=6*k(t,360),e=k(e,100),r=k(r,100);var n=j.floor(t),a=t-n,i=r*(1-e),s=r*(1-a*e),o=r*(1-(1-a)*e),l=n%6,c=[r,s,i,i,o,r][l],f=[o,r,r,s,i,i][l],u=[i,i,o,r,r,s][l];return{r:255*c,g:255*f,b:255*u}}function s(t,e,r,n){var a=[M(q(t).toString(16)),M(q(e).toString(16)),M(q(r).toString(16))];return n&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0):a.join("")}function o(t,e,r,n){var a=[M(H(n)),M(q(t).toString(16)),M(q(e).toString(16)),M(q(r).toString(16))];return a.join("")}function l(t,e){e=0===e?0:e||10;var r=B(t).toHsl();return r.s-=e/100,r.s=S(r.s),B(r)}function c(t,e){e=0===e?0:e||10;var r=B(t).toHsl();return r.s+=e/100,r.s=S(r.s),B(r)}function f(t){return B(t).desaturate(100)}function u(t,e){e=0===e?0:e||10;var r=B(t).toHsl();return r.l+=e/100,r.l=S(r.l),B(r)}function h(t,e){e=0===e?0:e||10;var r=B(t).toRgb();return r.r=I(0,D(255,r.r-q(255*-(e/100)))),r.g=I(0,D(255,r.g-q(255*-(e/100)))),r.b=I(0,D(255,r.b-q(255*-(e/100)))),B(r)}function d(t,e){e=0===e?0:e||10;var r=B(t).toHsl();return r.l-=e/100,r.l=S(r.l),B(r)}function p(t,e){var r=B(t).toHsl(),n=(q(r.h)+e)%360;return r.h=0>n?360+n:n,B(r)}function g(t){var e=B(t).toHsl();return e.h=(e.h+180)%360,B(e)}function b(t){var e=B(t).toHsl(),r=e.h;return[B(t),B({h:(r+120)%360,s:e.s,l:e.l}),B({h:(r+240)%360,s:e.s,l:e.l})]}function v(t){var e=B(t).toHsl(),r=e.h;return[B(t),B({h:(r+90)%360,s:e.s,l:e.l}),B({h:(r+180)%360,s:e.s,l:e.l}),B({h:(r+270)%360,s:e.s,l:e.l})]}function m(t){var e=B(t).toHsl(),r=e.h;return[B(t),B({h:(r+72)%360,s:e.s,l:e.l}),B({h:(r+216)%360,s:e.s,l:e.l})]}function y(t,e,r){e=e||6,r=r||30;var n=B(t).toHsl(),a=360/r,i=[B(t)];for(n.h=(n.h-(a*e>>1)+720)%360;--e;)n.h=(n.h+a)%360,i.push(B(n));return i}function w(t,e){e=e||6;for(var r=B(t).toHsv(),n=r.h,a=r.s,i=r.v,s=[],o=1/e;e--;)s.push(B({h:n,s:a,v:i})),i=(i+o)%1;return s}function _(t){var e={};for(var r in t)t.hasOwnProperty(r)&&(e[t[r]]=r);return e}function x(t){return t=parseFloat(t),(isNaN(t)||0>t||t>1)&&(t=1),t}function k(t,e){P(t)&&(t="100%");var r=A(t);return t=D(e,I(0,parseFloat(t))),r&&(t=parseInt(t*e,10)/100),j.abs(t-e)<1e-6?1:t%e/parseFloat(e)}function S(t){return D(1,I(0,t))}function C(t){return parseInt(t,16)}function P(t){return"string"==typeof t&&-1!=t.indexOf(".")&&1===parseFloat(t)}function A(t){return"string"==typeof t&&-1!=t.indexOf("%")}function M(t){return 1==t.length?"0"+t:""+t}function R(t){return 1>=t&&(t=100*t+"%"),t}function H(t){return Math.round(255*parseFloat(t)).toString(16)}function T(t){return C(t)/255}function F(t){t=t.replace(O,"").replace(N,"").toLowerCase();var e=!1;if(L[t])t=L[t],e=!0;else if("transparent"==t)return{r:0,g:0,b:0,a:0,format:"name"};var r;return(r=V.rgb.exec(t))?{r:r[1],g:r[2],b:r[3]}:(r=V.rgba.exec(t))?{r:r[1],g:r[2],b:r[3],a:r[4]}:(r=V.hsl.exec(t))?{h:r[1],s:r[2],l:r[3]}:(r=V.hsla.exec(t))?{h:r[1],s:r[2],l:r[3],a:r[4]}:(r=V.hsv.exec(t))?{h:r[1],s:r[2],v:r[3]}:(r=V.hsva.exec(t))?{h:r[1],s:r[2],v:r[3],a:r[4]}:(r=V.hex8.exec(t))?{a:T(r[1]),r:C(r[2]),g:C(r[3]),b:C(r[4]),format:e?"name":"hex8"}:(r=V.hex6.exec(t))?{r:C(r[1]),g:C(r[2]),b:C(r[3]),format:e?"name":"hex"}:(r=V.hex3.exec(t))?{r:C(r[1]+""+r[1]),g:C(r[2]+""+r[2]),b:C(r[3]+""+r[3]),format:e?"name":"hex"}:!1}var O=/^[\s,#]+/,N=/\s+$/,E=0,j=Math,q=j.round,D=j.min,I=j.max,z=j.random,B=function(e,r){if(e=e?e:"",r=r||{},e instanceof B)return e;if(!(this instanceof B))return new B(e,r);var n=t(e);this._originalInput=e,this._r=n.r,this._g=n.g,this._b=n.b,this._a=n.a,this._roundA=q(100*this._a)/100,this._format=r.format||n.format,this._gradientType=r.gradientType,this._r<1&&(this._r=q(this._r)),this._g<1&&(this._g=q(this._g)),this._b<1&&(this._b=q(this._b)),this._ok=n.ok,this._tc_id=E++};B.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var t=this.toRgb();return(299*t.r+587*t.g+114*t.b)/1e3},setAlpha:function(t){return this._a=x(t),this._roundA=q(100*this._a)/100,this},toHsv:function(){var t=a(this._r,this._g,this._b);return{h:360*t.h,s:t.s,v:t.v,a:this._a}},toHsvString:function(){var t=a(this._r,this._g,this._b),e=q(360*t.h),r=q(100*t.s),n=q(100*t.v);return 1==this._a?"hsv("+e+", "+r+"%, "+n+"%)":"hsva("+e+", "+r+"%, "+n+"%, "+this._roundA+")"},toHsl:function(){var t=r(this._r,this._g,this._b);return{h:360*t.h,s:t.s,l:t.l,a:this._a}},toHslString:function(){var t=r(this._r,this._g,this._b),e=q(360*t.h),n=q(100*t.s),a=q(100*t.l);return 1==this._a?"hsl("+e+", "+n+"%, "+a+"%)":"hsla("+e+", "+n+"%, "+a+"%, "+this._roundA+")"},toHex:function(t){return s(this._r,this._g,this._b,t)},toHexString:function(t){return"#"+this.toHex(t)},toHex8:function(){return o(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:q(this._r),g:q(this._g),b:q(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+q(this._r)+", "+q(this._g)+", "+q(this._b)+")":"rgba("+q(this._r)+", "+q(this._g)+", "+q(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:q(100*k(this._r,255))+"%",g:q(100*k(this._g,255))+"%",b:q(100*k(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+q(100*k(this._r,255))+"%, "+q(100*k(this._g,255))+"%, "+q(100*k(this._b,255))+"%)":"rgba("+q(100*k(this._r,255))+"%, "+q(100*k(this._g,255))+"%, "+q(100*k(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":this._a<1?!1:K[s(this._r,this._g,this._b,!0)]||!1},toFilter:function(t){var e="#"+o(this._r,this._g,this._b,this._a),r=e,n=this._gradientType?"GradientType = 1, ":"";if(t){var a=B(t);r=a.toHex8String()}return"progid:DXImageTransform.Microsoft.gradient("+n+"startColorstr="+e+",endColorstr="+r+")"},toString:function(t){var e=!!t;t=t||this._format;var r=!1,n=this._a<1&&this._a>=0,a=!e&&n&&("hex"===t||"hex6"===t||"hex3"===t||"name"===t);return a?"name"===t&&0===this._a?this.toName():this.toRgbString():("rgb"===t&&(r=this.toRgbString()),"prgb"===t&&(r=this.toPercentageRgbString()),("hex"===t||"hex6"===t)&&(r=this.toHexString()),"hex3"===t&&(r=this.toHexString(!0)),"hex8"===t&&(r=this.toHex8String()),"name"===t&&(r=this.toName()),"hsl"===t&&(r=this.toHslString()),"hsv"===t&&(r=this.toHsvString()),r||this.toHexString())},_applyModification:function(t,e){var r=t.apply(null,[this].concat([].slice.call(e)));return this._r=r._r,this._g=r._g,this._b=r._b,this.setAlpha(r._a),this},lighten:function(){return this._applyModification(u,arguments)},brighten:function(){return this._applyModification(h,arguments)},darken:function(){return this._applyModification(d,arguments)},desaturate:function(){return this._applyModification(l,arguments)},saturate:function(){return this._applyModification(c,arguments)},greyscale:function(){return this._applyModification(f,arguments)},spin:function(){return this._applyModification(p,arguments)},_applyCombination:function(t,e){return t.apply(null,[this].concat([].slice.call(e)))},analogous:function(){return this._applyCombination(y,arguments)},complement:function(){return this._applyCombination(g,arguments)},monochromatic:function(){return this._applyCombination(w,arguments)},splitcomplement:function(){return this._applyCombination(m,arguments)},triad:function(){return this._applyCombination(b,arguments)},tetrad:function(){return this._applyCombination(v,arguments)}},B.fromRatio=function(t,e){if("object"==typeof t){var r={};for(var n in t)t.hasOwnProperty(n)&&("a"===n?r[n]=t[n]:r[n]=R(t[n]));t=r}return B(t,e)},B.equals=function(t,e){return t&&e?B(t).toRgbString()==B(e).toRgbString():!1},B.random=function(){return B.fromRatio({r:z(),g:z(),b:z()})},B.mix=function(t,e,r){r=0===r?0:r||50;var n=B(t).toRgb(),a=B(e).toRgb(),i=r/100,s=2*i-1,o=a.a-n.a,l;l=s*o==-1?s:(s+o)/(1+s*o),l=(l+1)/2;var c=1-l,f={r:a.r*l+n.r*c,g:a.g*l+n.g*c,b:a.b*l+n.b*c,a:a.a*i+n.a*(1-i)};return B(f)},B.readability=function(t,e){var r=B(t),n=B(e),a=r.toRgb(),i=n.toRgb(),s=r.getBrightness(),o=n.getBrightness(),l=Math.max(a.r,i.r)-Math.min(a.r,i.r)+Math.max(a.g,i.g)-Math.min(a.g,i.g)+Math.max(a.b,i.b)-Math.min(a.b,i.b);return{brightness:Math.abs(s-o),color:l}},B.isReadable=function(t,e){var r=B.readability(t,e);return r.brightness>125&&r.color>500},B.mostReadable=function(t,e){for(var r=null,n=0,a=!1,i=0;i<e.length;i++){var s=B.readability(t,e[i]),o=s.brightness>125&&s.color>500,l=3*(s.brightness/125)+s.color/500;(o&&!a||o&&a&&l>n||!o&&!a&&l>n)&&(a=o,n=l,r=B(e[i]))}return r};var L=B.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},K=B.hexNames=_(L),V=function(){var t="[-\\+]?\\d+%?",e="[-\\+]?\\d*\\.\\d+%?",r="(?:"+e+")|(?:"+t+")",n="[\\s|\\(]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")\\s*\\)?",a="[\\s|\\(]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")\\s*\\)?";return{rgb:new RegExp("rgb"+n),rgba:new RegExp("rgba"+a),hsl:new RegExp("hsl"+n),hsla:new RegExp("hsla"+a),hsv:new RegExp("hsv"+n),hsva:new RegExp("hsva"+a),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();window.tinycolor=B}(),$(function(){$.fn.spectrum.load&&$.fn.spectrum.processNativeColorInputs()})});;jQuery(document).ready(function(){var $PrintYukDesigner=$("#printyuk-designer"),pluginOpts={stageWidth:1122,stageHeight:650,mainBarModules:["products","images","text","designs","manage-layers","saved","checkout"],editorMode:!1,customTextParameters:{zChangeable:!0,colors:!0,removable:!0,resizable:!0,draggable:!0,rotatable:!0,autoCenter:!0},customImageParameters:{zChangeable:!0,draggable:!0,removable:!0,resizable:!0,rotatable:!0,colors:!0,filter:!0,availableFilters:["grayscale","sepia","sepia2"],autoCenter:!0},actions:{left:["preview-lightbox","ruler","snap","zoom","reset-product","qr-code","undo","redo"]},toolbarPlacement:"dynamic",boundingBoxColor:"#00f",outOfBoundaryColor:"#f00",cornerIconColor:"#000",langJSON:"https://printyuk.com/js/otfjs/lang/"+lang_iso+".json"},PrintYukDesigner=new FancyProductDesigner($PrintYukDesigner,pluginOpts);$(document).on('click touchstart','.newdesign',function(e){var ctm_qty=$('#ctm_qty').val();if(ctm_qty===''){alert('Please Pick Your Delivery and Quantity!');$('html, body').animate({scrollTop:$("#pickPrice").offset().top},1000);}else{var thumbnail='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8Xw8AAoMBgDTD2qgAAAAASUVORK5CYII=';var d=new Date().toDateString();var title=names;if(idp==40){width=21;height=29.7;}else if(idp==41){width=21;height=29.7;}else if(idp==51){width=20;height=8;}else if(idp==29){width=8.6;height=5.4;}else if(idp==44){width=21;height=29.7;}else if(idp==48){width=8;height=8;}else if(idp==49){width=8;height=8;}else if(idp==5){width=14.8;height=21;}else if(idp==27){width=29.7;height=42;}
var stageWidth=(width*10)*12;var stageHeight=(height*10)*12;var pages=1;if($('input[name=eq_color]').length){pages=parseInt($('input[name=eq_color]:checked').val())-42;}
var designProduct='';for(x=1;x<=pages;x++){var elements='{"title":"'+title+' '+d+' '+x+'","thumbnail":"'+thumbnail+'","elements":[],"options":{"stageWidth":'+stageWidth+',"stageHeight":'+stageHeight+',"customAdds":{"designs":true,"uploads":true,"texts":true,"saving":true,"drawing":true}},"names_numbers":null}';designProduct+=elements;if(x!=pages){designProduct+=',';}}
PrintYukDesigner.loadProduct(JSON.parse('['+designProduct+']'));$("#mpickdesign").css("display","block");}});$(document).on('click touchstart','.pickTemplate',function(e){var ctm_qty=$('#ctm_qty').val();if(ctm_qty===''){alert('Please Pick Your Delivery and Quantity!');$('html, body').animate({scrollTop:$("#pickPrice").offset().top},1000);}else{var id_otf_template=$(this).attr("id");$.ajax({type:"POST",url:"https://printyuk.com/webservice/json.php",data:{ids:id_otf_template,act:"pickDesign"},success:function(data){PrintYukDesigner.loadProduct(JSON.parse(data));}});$("#mpickdesign").css("display","block");}});});;(function($){$.fn.idTabs=function(){var s={"start":null,"return":false,"click":null};for(var i=0;i<arguments.length;++i){var n={},a=arguments[i];switch(typeof a){case"object":$.extend(n,a);break;case"number":case"string":n.start=a;break;case"boolean":n["return"]=a;break;case"function":n.click=a;break;};$.extend(s,n);}
var self=this;var list=$("a[href^='#']",this).click(function(){if($("a.selected",self)[0]==this)
return s["return"];var id="#"+this.href.split('#')[1];var aList=[];var idList=[];$("a",self).each(function(){if(this.href.match(/#/)){aList[aList.length]=this;idList[idList.length]="#"+this.href.split('#')[1];}});if(s.click&&!s.click(id,idList,self))return s["return"];for(i in aList)$(aList[i]).removeClass("selected");for(i in idList){$(idList[i]).addClass('block_hidden_only_for_screen');}
$(this).addClass("selected");$(id).removeClass('block_hidden_only_for_screen');return s["return"];});var test;if(typeof s.start=="number"&&(test=list.filter(":eq("+s.start+")")).length)
test.click();else if(typeof s.start=="string"&&(test=list.filter("[href='#"+s.start+"']")).length)
test.click();else if((test=list.filter(".selected")).length)
test.removeClass("selected").click();else list.filter(":first").click();return this;};$(function(){$(".idTabs").each(function(){$(this).idTabs();});});})(jQuery);;(function(k){'use strict';k(['jquery'],function($){var j=$.scrollTo=function(a,b,c){return $(window).scrollTo(a,b,c)};j.defaults={axis:'xy',duration:0,limit:!0};j.window=function(a){return $(window)._scrollable()};$.fn._scrollable=function(){return this.map(function(){var a=this,isWin=!a.nodeName||$.inArray(a.nodeName.toLowerCase(),['iframe','#document','html','body'])!=-1;if(!isWin)return a;var b=(a.contentWindow||a).document||a.ownerDocument||a;return/webkit/i.test(navigator.userAgent)||b.compatMode=='BackCompat'?b.body:b.documentElement})};$.fn.scrollTo=function(f,g,h){if(typeof g=='object'){h=g;g=0}if(typeof h=='function')h={onAfter:h};if(f=='max')f=9e9;h=$.extend({},j.defaults,h);g=g||h.duration;h.queue=h.queue&&h.axis.length>1;if(h.queue)g/=2;h.offset=both(h.offset);h.over=both(h.over);return this._scrollable().each(function(){if(f==null)return;var d=this,$elem=$(d),targ=f,toff,attr={},win=$elem.is('html,body');switch(typeof targ){case'number':case'string':if(/^([+-]=?)?\d+(\.\d+)?(px|%)?$/.test(targ)){targ=both(targ);break}targ=win?$(targ):$(targ,this);if(!targ.length)return;case'object':if(targ.is||targ.style)toff=(targ=$(targ)).offset()}var e=$.isFunction(h.offset)&&h.offset(d,targ)||h.offset;$.each(h.axis.split(''),function(i,a){var b=a=='x'?'Left':'Top',pos=b.toLowerCase(),key='scroll'+b,old=d[key],max=j.max(d,a);if(toff){attr[key]=toff[pos]+(win?0:old-$elem.offset()[pos]);if(h.margin){attr[key]-=parseInt(targ.css('margin'+b))||0;attr[key]-=parseInt(targ.css('border'+b+'Width'))||0}attr[key]+=e[pos]||0;if(h.over[pos])attr[key]+=targ[a=='x'?'width':'height']()*h.over[pos]}else{var c=targ[pos];attr[key]=c.slice&&c.slice(-1)=='%'?parseFloat(c)/100*max:c}if(h.limit&&/^\d+$/.test(attr[key]))attr[key]=attr[key]<=0?0:Math.min(attr[key],max);if(!i&&h.queue){if(old!=attr[key])animate(h.onAfterFirst);delete attr[key]}});animate(h.onAfter);function animate(a){$elem.animate(attr,g,h.easing,a&&function(){a.call(this,targ,h)})}}).end()};j.max=function(a,b){var c=b=='x'?'Width':'Height',scroll='scroll'+c;if(!$(a).is('html,body'))return a[scroll]-$(a)[c.toLowerCase()]();var d='client'+c,html=a.ownerDocument.documentElement,body=a.ownerDocument.body;return Math.max(html[scroll],body[scroll])-Math.min(html[d],body[d])};function both(a){return $.isFunction(a)||$.isPlainObject(a)?a:{top:a,left:a}}return j})}(typeof define==='function'&&define.amd?define:function(a,b){if(typeof module!=='undefined'&&module.exports){module.exports=b(require('jquery'))}else{b(jQuery)}}));;(function(a){var b=a.serialScroll=function(c){return a(window).serialScroll(c)};b.defaults={duration:1e3,axis:"x",event:"click",start:0,step:1,lock:!0,cycle:!0,constant:!0};a.fn.serialScroll=function(c){return this.each(function(){var t=a.extend({},b.defaults,c),s=t.event,i=t.step,r=t.lazy,e=t.target?this:document,u=a(t.target||this,e),p=u[0],m=t.items,h=t.start,g=t.interval,k=t.navigation,l;if(!r){m=d()}if(t.force){f({},h)}a(t.prev||[],e).bind(s,-i,q);a(t.next||[],e).bind(s,i,q);if(!p.ssbound){u.bind("prev.serialScroll",-i,q).bind("next.serialScroll",i,q).bind("goto.serialScroll",f)}if(g){u.bind("start.serialScroll",function(v){if(!g){o();g=!0;n()}}).bind("stop.serialScroll",function(){o();g=!1})}u.bind("notify.serialScroll",function(x,w){var v=j(w);if(v>-1){h=v}});p.ssbound=!0;if(t.jump){(r?u:d()).bind(s,function(v){f(v,j(v.target))})}if(k){k=a(k,e).bind(s,function(v){v.data=Math.round(d().length/k.length)*k.index(this);f(v,this)})}function q(v){v.data+=h;f(v,this)}function f(B,z){if(!isNaN(z)){B.data=z;z=p}var C=B.data,v,D=B.type,A=t.exclude?d().slice(0,-t.exclude):d(),y=A.length,w=A[C],x=t.duration;if(D){B.preventDefault()}if(g){o();l=setTimeout(n,t.interval)}if(!w){v=C<0?0:y-1;if(h!=v){C=v}else{if(!t.cycle){return}else{C=y-v-1}}w=A[C]}if(!w||t.lock&&u.is(":animated")||D&&t.onBefore&&t.onBefore(B,w,u,d(),C)===!1){return}if(t.stop){u.queue("fx",[]).stop()}if(t.constant){x=Math.abs(x/i*(h-C))}u.scrollTo(w,x,t).trigger("notify.serialScroll",[C])}function n(){u.trigger("next.serialScroll")}function o(){clearTimeout(l)}function d(){return a(m,p)}function j(w){if(!isNaN(w)){return w}var x=d(),v;while((v=x.index(w))==-1&&w!=p){w=w.parentNode}return v}})}})(jQuery);;!function(t){var e={},s={mode:"horizontal",slideSelector:"",infiniteLoop:!0,hideControlOnEnd:!1,speed:500,easing:null,slideMargin:0,startSlide:0,randomStart:!1,captions:!1,ticker:!1,tickerHover:!1,adaptiveHeight:!1,adaptiveHeightSpeed:500,video:!1,useCSS:!0,preloadImages:"visible",responsive:!0,slideZIndex:50,touchEnabled:!0,swipeThreshold:50,oneToOneTouch:!0,preventDefaultSwipeX:!0,preventDefaultSwipeY:!1,pager:!0,pagerType:"full",pagerShortSeparator:" / ",pagerSelector:null,buildPager:null,pagerCustom:null,controls:!0,nextText:"Next",prevText:"Prev",nextSelector:null,prevSelector:null,autoControls:!1,startText:"Start",stopText:"Stop",autoControlsCombine:!1,autoControlsSelector:null,auto:!1,pause:4e3,autoStart:!0,autoDirection:"next",autoHover:!1,autoDelay:0,minSlides:1,maxSlides:1,moveSlides:0,slideWidth:0,onSliderLoad:function(){},onSlideBefore:function(){},onSlideAfter:function(){},onSlideNext:function(){},onSlidePrev:function(){},onSliderResize:function(){}};t.fn.bxSlider=function(n){if(0==this.length)return this;if(this.length>1)return this.each(function(){t(this).bxSlider(n)}),this;var o={},r=this;e.el=this;var a=t(window).width(),l=t(window).height(),d=function(){o.settings=t.extend({},s,n),o.settings.slideWidth=parseInt(o.settings.slideWidth),o.children=r.children(o.settings.slideSelector),o.children.length<o.settings.minSlides&&(o.settings.minSlides=o.children.length),o.children.length<o.settings.maxSlides&&(o.settings.maxSlides=o.children.length),o.settings.randomStart&&(o.settings.startSlide=Math.floor(Math.random()*o.children.length)),o.active={index:o.settings.startSlide},o.carousel=o.settings.minSlides>1||o.settings.maxSlides>1,o.carousel&&(o.settings.preloadImages="all"),o.minThreshold=o.settings.minSlides*o.settings.slideWidth+(o.settings.minSlides-1)*o.settings.slideMargin,o.maxThreshold=o.settings.maxSlides*o.settings.slideWidth+(o.settings.maxSlides-1)*o.settings.slideMargin,o.working=!1,o.controls={},o.interval=null,o.animProp="vertical"==o.settings.mode?"top":"left",o.usingCSS=o.settings.useCSS&&"fade"!=o.settings.mode&&function(){var t=document.createElement("div"),e=["WebkitPerspective","MozPerspective","OPerspective","msPerspective"];for(var i in e)if(void 0!==t.style[e[i]])return o.cssPrefix=e[i].replace("Perspective","").toLowerCase(),o.animProp="-"+o.cssPrefix+"-transform",!0;return!1}(),"vertical"==o.settings.mode&&(o.settings.maxSlides=o.settings.minSlides),r.data("origStyle",r.attr("style")),r.children(o.settings.slideSelector).each(function(){t(this).data("origStyle",t(this).attr("style"))}),c()},c=function(){r.wrap('<div class="bx-wrapper"><div class="bx-viewport"></div></div>'),o.viewport=r.parent(),o.loader=t('<div class="bx-loading" />'),o.viewport.prepend(o.loader),r.css({width:"horizontal"==o.settings.mode?100*o.children.length+215+"%":"auto",position:"relative"}),o.usingCSS&&o.settings.easing?r.css("-"+o.cssPrefix+"-transition-timing-function",o.settings.easing):o.settings.easing||(o.settings.easing="swing"),f(),o.viewport.css({width:"100%",overflow:"hidden",position:"relative"}),o.viewport.parent().css({maxWidth:p()}),o.settings.pager||o.viewport.parent().css({margin:"0 auto 0px"}),o.children.css({"float":"horizontal"==o.settings.mode?"left":"none",listStyle:"none",position:"relative"}),o.children.css("width",u()),"horizontal"==o.settings.mode&&o.settings.slideMargin>0&&o.children.css("marginRight",o.settings.slideMargin),"vertical"==o.settings.mode&&o.settings.slideMargin>0&&o.children.css("marginBottom",o.settings.slideMargin),"fade"==o.settings.mode&&(o.children.css({position:"absolute",zIndex:0,display:"none"}),o.children.eq(o.settings.startSlide).css({zIndex:o.settings.slideZIndex,display:"block"})),o.controls.el=t('<div class="bx-controls" />'),o.settings.captions&&P(),o.active.last=o.settings.startSlide==x()-1,o.settings.video&&r.fitVids();var e=o.children.eq(o.settings.startSlide);"all"==o.settings.preloadImages&&(e=o.children),o.settings.ticker?o.settings.pager=!1:(o.settings.pager&&T(),o.settings.controls&&C(),o.settings.auto&&o.settings.autoControls&&E(),(o.settings.controls||o.settings.autoControls||o.settings.pager)&&o.viewport.after(o.controls.el)),g(e,h)},g=function(e,i){var s=e.find("img, iframe").length;if(0==s)return i(),void 0;var n=0;e.find("img, iframe").each(function(){t(this).one("load",function(){++n==s&&i()}).each(function(){this.complete&&t(this).load()})})},h=function(){if(o.settings.infiniteLoop&&"fade"!=o.settings.mode&&!o.settings.ticker){var e="vertical"==o.settings.mode?o.settings.minSlides:o.settings.maxSlides,i=o.children.slice(0,e).clone().addClass("bx-clone"),s=o.children.slice(-e).clone().addClass("bx-clone");r.append(i).prepend(s)}o.loader.remove(),S(),"vertical"==o.settings.mode&&(o.settings.adaptiveHeight=!0),o.viewport.height(v()),r.redrawSlider(),o.settings.onSliderLoad(o.active.index),o.initialized=!0,o.settings.responsive&&t(window).bind("resize",Z),o.settings.auto&&o.settings.autoStart&&H(),o.settings.ticker&&L(),o.settings.pager&&q(o.settings.startSlide),o.settings.controls&&W(),o.settings.touchEnabled&&!o.settings.ticker&&O()},v=function(){var e=0,s=t();if("vertical"==o.settings.mode||o.settings.adaptiveHeight)if(o.carousel){var n=1==o.settings.moveSlides?o.active.index:o.active.index*m();for(s=o.children.eq(n),i=1;i<=o.settings.maxSlides-1;i++)s=n+i>=o.children.length?s.add(o.children.eq(i-1)):s.add(o.children.eq(n+i))}else s=o.children.eq(o.active.index);else s=o.children;return"vertical"==o.settings.mode?(s.each(function(){e+=t(this).outerHeight()}),o.settings.slideMargin>0&&(e+=o.settings.slideMargin*(o.settings.minSlides-1))):e=Math.max.apply(Math,s.map(function(){return t(this).outerHeight(!1)}).get()),e},p=function(){var t="100%";return o.settings.slideWidth>0&&(t="horizontal"==o.settings.mode?o.settings.maxSlides*o.settings.slideWidth+(o.settings.maxSlides-1)*o.settings.slideMargin:o.settings.slideWidth),t},u=function(){var t=o.settings.slideWidth,e=o.viewport.width();return 0==o.settings.slideWidth||o.settings.slideWidth>e&&!o.carousel||"vertical"==o.settings.mode?t=e:o.settings.maxSlides>1&&"horizontal"==o.settings.mode&&(e>o.maxThreshold||e<o.minThreshold&&(t=(e-o.settings.slideMargin*(o.settings.minSlides-1))/o.settings.minSlides)),t},f=function(){var t=1;if("horizontal"==o.settings.mode&&o.settings.slideWidth>0)if(o.viewport.width()<o.minThreshold)t=o.settings.minSlides;else if(o.viewport.width()>o.maxThreshold)t=o.settings.maxSlides;else{var e=o.children.first().width();t=Math.floor(o.viewport.width()/e)}else"vertical"==o.settings.mode&&(t=o.settings.minSlides);return t},x=function(){var t=0;if(o.settings.moveSlides>0)if(o.settings.infiniteLoop)t=o.children.length/m();else for(var e=0,i=0;e<o.children.length;)++t,e=i+f(),i+=o.settings.moveSlides<=f()?o.settings.moveSlides:f();else t=Math.ceil(o.children.length/f());return t},m=function(){return o.settings.moveSlides>0&&o.settings.moveSlides<=f()?o.settings.moveSlides:f()},S=function(){if(o.children.length>o.settings.maxSlides&&o.active.last&&!o.settings.infiniteLoop){if("horizontal"==o.settings.mode){var t=o.children.last(),e=t.position();b(-(e.left-(o.viewport.width()-t.width())),"reset",0)}else if("vertical"==o.settings.mode){var i=o.children.length-o.settings.minSlides,e=o.children.eq(i).position();b(-e.top,"reset",0)}}else{var e=o.children.eq(o.active.index*m()).position();o.active.index==x()-1&&(o.active.last=!0),void 0!=e&&("horizontal"==o.settings.mode?b(-e.left,"reset",0):"vertical"==o.settings.mode&&b(-e.top,"reset",0))}},b=function(t,e,i,s){if(o.usingCSS){var n="vertical"==o.settings.mode?"translate3d(0, "+t+"px, 0)":"translate3d("+t+"px, 0, 0)";r.css("-"+o.cssPrefix+"-transition-duration",i/1e3+"s"),"slide"==e?(r.css(o.animProp,n),r.bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){r.unbind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd"),D()})):"reset"==e?r.css(o.animProp,n):"ticker"==e&&(r.css("-"+o.cssPrefix+"-transition-timing-function","linear"),r.css(o.animProp,n),r.bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){r.unbind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd"),b(s.resetValue,"reset",0),N()}))}else{var a={};a[o.animProp]=t,"slide"==e?r.animate(a,i,o.settings.easing,function(){D()}):"reset"==e?r.css(o.animProp,t):"ticker"==e&&r.animate(a,speed,"linear",function(){b(s.resetValue,"reset",0),N()})}},w=function(){for(var e="",i=x(),s=0;i>s;s++){var n="";o.settings.buildPager&&t.isFunction(o.settings.buildPager)?(n=o.settings.buildPager(s),o.pagerEl.addClass("bx-custom-pager")):(n=s+1,o.pagerEl.addClass("bx-default-pager")),e+='<div class="bx-pager-item"><a href="" data-slide-index="'+s+'" class="bx-pager-link">'+n+"</a></div>"}o.pagerEl.html(e)},T=function(){o.settings.pagerCustom?o.pagerEl=t(o.settings.pagerCustom):(o.pagerEl=t('<div class="bx-pager" />'),o.settings.pagerSelector?t(o.settings.pagerSelector).html(o.pagerEl):o.controls.el.addClass("bx-has-pager").append(o.pagerEl),w()),o.pagerEl.on("click","a",I)},C=function(){o.controls.next=t('<a class="bx-next" href="">'+o.settings.nextText+"</a>"),o.controls.prev=t('<a class="bx-prev" href="">'+o.settings.prevText+"</a>"),o.controls.next.bind("click",y),o.controls.prev.bind("click",z),o.settings.nextSelector&&t(o.settings.nextSelector).append(o.controls.next),o.settings.prevSelector&&t(o.settings.prevSelector).append(o.controls.prev),o.settings.nextSelector||o.settings.prevSelector||(o.controls.directionEl=t('<div class="bx-controls-direction" />'),o.controls.directionEl.append(o.controls.prev).append(o.controls.next),o.controls.el.addClass("bx-has-controls-direction").append(o.controls.directionEl))},E=function(){o.controls.start=t('<div class="bx-controls-auto-item"><a class="bx-start" href="">'+o.settings.startText+"</a></div>"),o.controls.stop=t('<div class="bx-controls-auto-item"><a class="bx-stop" href="">'+o.settings.stopText+"</a></div>"),o.controls.autoEl=t('<div class="bx-controls-auto" />'),o.controls.autoEl.on("click",".bx-start",k),o.controls.autoEl.on("click",".bx-stop",M),o.settings.autoControlsCombine?o.controls.autoEl.append(o.controls.start):o.controls.autoEl.append(o.controls.start).append(o.controls.stop),o.settings.autoControlsSelector?t(o.settings.autoControlsSelector).html(o.controls.autoEl):o.controls.el.addClass("bx-has-controls-auto").append(o.controls.autoEl),A(o.settings.autoStart?"stop":"start")},P=function(){o.children.each(function(){var e=t(this).find("img:first").attr("title");void 0!=e&&(""+e).length&&t(this).append('<div class="bx-caption"><span>'+e+"</span></div>")})},y=function(t){o.settings.auto&&r.stopAuto(),r.goToNextSlide(),t.preventDefault()},z=function(t){o.settings.auto&&r.stopAuto(),r.goToPrevSlide(),t.preventDefault()},k=function(t){r.startAuto(),t.preventDefault()},M=function(t){r.stopAuto(),t.preventDefault()},I=function(e){o.settings.auto&&r.stopAuto();var i=t(e.currentTarget),s=parseInt(i.attr("data-slide-index"));s!=o.active.index&&r.goToSlide(s),e.preventDefault()},q=function(e){var i=o.children.length;return"short"==o.settings.pagerType?(o.settings.maxSlides>1&&(i=Math.ceil(o.children.length/o.settings.maxSlides)),o.pagerEl.html(e+1+o.settings.pagerShortSeparator+i),void 0):(o.pagerEl.find("a").removeClass("active"),o.pagerEl.each(function(i,s){t(s).find("a").eq(e).addClass("active")}),void 0)},D=function(){if(o.settings.infiniteLoop){var t="";0==o.active.index?t=o.children.eq(0).position():o.active.index==x()-1&&o.carousel?t=o.children.eq((x()-1)*m()).position():o.active.index==o.children.length-1&&(t=o.children.eq(o.children.length-1).position()),t&&("horizontal"==o.settings.mode?b(-t.left,"reset",0):"vertical"==o.settings.mode&&b(-t.top,"reset",0))}o.working=!1,o.settings.onSlideAfter(o.children.eq(o.active.index),o.oldIndex,o.active.index)},A=function(t){o.settings.autoControlsCombine?o.controls.autoEl.html(o.controls[t]):(o.controls.autoEl.find("a").removeClass("active"),o.controls.autoEl.find("a:not(.bx-"+t+")").addClass("active"))},W=function(){1==x()?(o.controls.prev.addClass("disabled"),o.controls.next.addClass("disabled")):!o.settings.infiniteLoop&&o.settings.hideControlOnEnd&&(0==o.active.index?(o.controls.prev.addClass("disabled"),o.controls.next.removeClass("disabled")):o.active.index==x()-1?(o.controls.next.addClass("disabled"),o.controls.prev.removeClass("disabled")):(o.controls.prev.removeClass("disabled"),o.controls.next.removeClass("disabled")))},H=function(){o.settings.autoDelay>0?setTimeout(r.startAuto,o.settings.autoDelay):r.startAuto(),o.settings.autoHover&&r.hover(function(){o.interval&&(r.stopAuto(!0),o.autoPaused=!0)},function(){o.autoPaused&&(r.startAuto(!0),o.autoPaused=null)})},L=function(){var e=0;if("next"==o.settings.autoDirection)r.append(o.children.clone().addClass("bx-clone"));else{r.prepend(o.children.clone().addClass("bx-clone"));var i=o.children.first().position();e="horizontal"==o.settings.mode?-i.left:-i.top}b(e,"reset",0),o.settings.pager=!1,o.settings.controls=!1,o.settings.autoControls=!1,o.settings.tickerHover&&!o.usingCSS&&o.viewport.hover(function(){r.stop()},function(){var e=0;o.children.each(function(){e+="horizontal"==o.settings.mode?t(this).outerWidth(!0):t(this).outerHeight(!0)});var i=o.settings.speed/e,s="horizontal"==o.settings.mode?"left":"top",n=i*(e-Math.abs(parseInt(r.css(s))));N(n)}),N()},N=function(t){speed=t?t:o.settings.speed;var e={left:0,top:0},i={left:0,top:0};"next"==o.settings.autoDirection?e=r.find(".bx-clone").first().position():i=o.children.first().position();var s="horizontal"==o.settings.mode?-e.left:-e.top,n="horizontal"==o.settings.mode?-i.left:-i.top,a={resetValue:n};b(s,"ticker",speed,a)},O=function(){o.touch={start:{x:0,y:0},end:{x:0,y:0}},o.viewport.bind("touchstart",X)},X=function(t){if(o.working)t.preventDefault();else{o.touch.originalPos=r.position();var e=t.originalEvent;o.touch.start.x=e.changedTouches[0].pageX,o.touch.start.y=e.changedTouches[0].pageY,o.viewport.bind("touchmove",Y),o.viewport.bind("touchend",V)}},Y=function(t){var e=t.originalEvent,i=Math.abs(e.changedTouches[0].pageX-o.touch.start.x),s=Math.abs(e.changedTouches[0].pageY-o.touch.start.y);if(3*i>s&&o.settings.preventDefaultSwipeX?t.preventDefault():3*s>i&&o.settings.preventDefaultSwipeY&&t.preventDefault(),"fade"!=o.settings.mode&&o.settings.oneToOneTouch){var n=0;if("horizontal"==o.settings.mode){var r=e.changedTouches[0].pageX-o.touch.start.x;n=o.touch.originalPos.left+r}else{var r=e.changedTouches[0].pageY-o.touch.start.y;n=o.touch.originalPos.top+r}b(n,"reset",0)}},V=function(t){o.viewport.unbind("touchmove",Y);var e=t.originalEvent,i=0;if(o.touch.end.x=e.changedTouches[0].pageX,o.touch.end.y=e.changedTouches[0].pageY,"fade"==o.settings.mode){var s=Math.abs(o.touch.start.x-o.touch.end.x);s>=o.settings.swipeThreshold&&(o.touch.start.x>o.touch.end.x?r.goToNextSlide():r.goToPrevSlide(),r.stopAuto())}else{var s=0;"horizontal"==o.settings.mode?(s=o.touch.end.x-o.touch.start.x,i=o.touch.originalPos.left):(s=o.touch.end.y-o.touch.start.y,i=o.touch.originalPos.top),!o.settings.infiniteLoop&&(0==o.active.index&&s>0||o.active.last&&0>s)?b(i,"reset",200):Math.abs(s)>=o.settings.swipeThreshold?(0>s?r.goToNextSlide():r.goToPrevSlide(),r.stopAuto()):b(i,"reset",200)}o.viewport.unbind("touchend",V)},Z=function(){var e=t(window).width(),i=t(window).height();(a!=e||l!=i)&&(a=e,l=i,r.redrawSlider(),o.settings.onSliderResize.call(r,o.active.index))};return r.goToSlide=function(e,i){if(!o.working&&o.active.index!=e)if(o.working=!0,o.oldIndex=o.active.index,o.active.index=0>e?x()-1:e>=x()?0:e,o.settings.onSlideBefore(o.children.eq(o.active.index),o.oldIndex,o.active.index),"next"==i?o.settings.onSlideNext(o.children.eq(o.active.index),o.oldIndex,o.active.index):"prev"==i&&o.settings.onSlidePrev(o.children.eq(o.active.index),o.oldIndex,o.active.index),o.active.last=o.active.index>=x()-1,o.settings.pager&&q(o.active.index),o.settings.controls&&W(),"fade"==o.settings.mode)o.settings.adaptiveHeight&&o.viewport.height()!=v()&&o.viewport.animate({height:v()},o.settings.adaptiveHeightSpeed),o.children.filter(":visible").fadeOut(o.settings.speed).css({zIndex:0}),o.children.eq(o.active.index).css("zIndex",o.settings.slideZIndex+1).fadeIn(o.settings.speed,function(){t(this).css("zIndex",o.settings.slideZIndex),D()});else{o.settings.adaptiveHeight&&o.viewport.height()!=v()&&o.viewport.animate({height:v()},o.settings.adaptiveHeightSpeed);var s=0,n={left:0,top:0};if(!o.settings.infiniteLoop&&o.carousel&&o.active.last)if("horizontal"==o.settings.mode){var a=o.children.eq(o.children.length-1);n=a.position(),s=o.viewport.width()-a.outerWidth()}else{var l=o.children.length-o.settings.minSlides;n=o.children.eq(l).position()}else if(o.carousel&&o.active.last&&"prev"==i){var d=1==o.settings.moveSlides?o.settings.maxSlides-m():(x()-1)*m()-(o.children.length-o.settings.maxSlides),a=r.children(".bx-clone").eq(d);n=a.position()}else if("next"==i&&0==o.active.index)n=r.find("> .bx-clone").eq(o.settings.maxSlides).position(),o.active.last=!1;else if(e>=0){var c=e*m();n=o.children.eq(c).position()}if("undefined"!=typeof n){var g="horizontal"==o.settings.mode?-(n.left-s):-n.top;b(g,"slide",o.settings.speed)}}},r.goToNextSlide=function(){if(o.settings.infiniteLoop||!o.active.last){var t=parseInt(o.active.index)+1;r.goToSlide(t,"next")}},r.goToPrevSlide=function(){if(o.settings.infiniteLoop||0!=o.active.index){var t=parseInt(o.active.index)-1;r.goToSlide(t,"prev")}},r.startAuto=function(t){o.interval||(o.interval=setInterval(function(){"next"==o.settings.autoDirection?r.goToNextSlide():r.goToPrevSlide()},o.settings.pause),o.settings.autoControls&&1!=t&&A("stop"))},r.stopAuto=function(t){o.interval&&(clearInterval(o.interval),o.interval=null,o.settings.autoControls&&1!=t&&A("start"))},r.getCurrentSlide=function(){return o.active.index},r.getCurrentSlideElement=function(){return o.children.eq(o.active.index)},r.getSlideCount=function(){return o.children.length},r.redrawSlider=function(){o.children.add(r.find(".bx-clone")).outerWidth(u()),o.viewport.css("height",v()),o.settings.ticker||S(),o.active.last&&(o.active.index=x()-1),o.active.index>=x()&&(o.active.last=!0),o.settings.pager&&!o.settings.pagerCustom&&(w(),q(o.active.index))},r.destroySlider=function(){o.initialized&&(o.initialized=!1,t(".bx-clone",this).remove(),o.children.each(function(){void 0!=t(this).data("origStyle")?t(this).attr("style",t(this).data("origStyle")):t(this).removeAttr("style")}),void 0!=t(this).data("origStyle")?this.attr("style",t(this).data("origStyle")):t(this).removeAttr("style"),t(this).unwrap().unwrap(),o.controls.el&&o.controls.el.remove(),o.controls.next&&o.controls.next.remove(),o.controls.prev&&o.controls.prev.remove(),o.pagerEl&&o.settings.controls&&o.pagerEl.remove(),t(".bx-caption",this).remove(),o.controls.autoEl&&o.controls.autoEl.remove(),clearInterval(o.interval),o.settings.responsive&&t(window).unbind("resize",Z))},r.reloadSlider=function(t){void 0!=t&&(n=t),r.destroySlider(),d()},d(),this}}(jQuery);;var serialScrollNbImagesDisplayed;var selectedCombination=[];var globalQuantity=0;var colors=[];var original_url=window.location+'';var first_url_check=true;var firstTime=true;if(typeof customizationFields!=='undefined'&&customizationFields)
{var customizationFieldsBk=customizationFields;customizationFields=[];var j=0;for(var i=0;i<customizationFieldsBk.length;++i)
{var key='pictures_'+parseInt(id_product)+'_'+parseInt(customizationFieldsBk[i]['id_customization_field']);customizationFields[i]=[];customizationFields[i][0]=(parseInt(customizationFieldsBk[i]['type'])==0)?'img'+i:'textField'+j++;customizationFields[i][1]=(parseInt(customizationFieldsBk[i]['type'])==0&&customizationFieldsBk[i][key])?2:parseInt(customizationFieldsBk[i]['required']);}}
if(typeof combinationImages!=='undefined'&&combinationImages)
{combinationImagesJS=[];combinationImagesJS[0]=[];var k=0;for(var i in combinationImages)
{combinationImagesJS[i]=[];for(var j in combinationImages[i])
{var id_image=parseInt(combinationImages[i][j]['id_image']);if(id_image)
{combinationImagesJS[0][k++]=id_image;combinationImagesJS[i][j]=[];combinationImagesJS[i][j]=id_image;}}}
if(typeof combinationImagesJS[0]!=='undefined'&&combinationImagesJS[0])
{var array_values=[];for(var key in arrayUnique(combinationImagesJS[0]))
array_values.push(combinationImagesJS[0][key]);combinationImagesJS[0]=array_values;}
combinationImages=combinationImagesJS;}
if(typeof combinations!=='undefined'&&combinations)
{combinationsJS=[];var k=0;for(var i in combinations)
{globalQuantity+=combinations[i]['quantity'];combinationsJS[k]=[];combinationsJS[k]['idCombination']=parseInt(i);combinationsJS[k]['idsAttributes']=combinations[i]['attributes'];combinationsJS[k]['quantity']=combinations[i]['quantity'];combinationsJS[k]['price']=combinations[i]['price'];combinationsJS[k]['ecotax']=combinations[i]['ecotax'];combinationsJS[k]['image']=parseInt(combinations[i]['id_image']);combinationsJS[k]['reference']=combinations[i]['reference'];combinationsJS[k]['unit_price']=combinations[i]['unit_impact'];combinationsJS[k]['minimal_quantity']=parseInt(combinations[i]['minimal_quantity']);combinationsJS[k]['available_date']=[];combinationsJS[k]['available_date']['date']=combinations[i]['available_date'];combinationsJS[k]['available_date']['date_formatted']=combinations[i]['date_formatted'];combinationsJS[k]['specific_price']=[];combinationsJS[k]['specific_price']['reduction_percent']=(combinations[i]['specific_price']&&combinations[i]['specific_price']['reduction']&&combinations[i]['specific_price']['reduction_type']=='percentage')?combinations[i]['specific_price']['reduction']*100:0;combinationsJS[k]['specific_price']['reduction_price']=(combinations[i]['specific_price']&&combinations[i]['specific_price']['reduction']&&combinations[i]['specific_price']['reduction_type']=='amount')?combinations[i]['specific_price']['reduction']:0;combinationsJS[k]['price']=(combinations[i]['specific_price']&&combinations[i]['specific_price']['price']&&parseInt(combinations[i]['specific_price']['price'])!=-1)?combinations[i]['specific_price']['price']:combinations[i]['price'];combinationsJS[k]['reduction_type']=(combinations[i]['specific_price']&&combinations[i]['specific_price']['reduction_type'])?combinations[i]['specific_price']['reduction_type']:'';combinationsJS[k]['id_product_attribute']=(combinations[i]['specific_price']&&combinations[i]['specific_price']['id_product_attribute'])?combinations[i]['specific_price']['id_product_attribute']:0;k++;}
combinations=combinationsJS;}
$(document).ready(function()
{var url_found=checkUrl();if(!url_found)
{if(typeof productHasAttributes!='undefined'&&productHasAttributes)
findCombination();else
refreshProductImages(0);}
serialScrollSetNbImages();if(!!$.prototype.serialScroll)
$('#thumbs_list').serialScroll({items:'li:visible',prev:'#view_scroll_left',next:'#view_scroll_right',axis:'x',offset:0,start:0,stop:true,onBefore:serialScrollFixLock,duration:700,lazy:true,lock:false,force:false,cycle:false});$('#thumbs_list').trigger('goto',0);if(typeof(jqZoomEnabled)!='undefined'&&jqZoomEnabled)
{if($('#thumbs_list .shown img').length)
{var new_src=$('#thumbs_list .shown img').attr('src').replace('cart_','large_');if($('.jqzoom img').attr('src')!=new_src)
$('.jqzoom img').attr('src',new_src).parent().attr('href',new_src);}
$('.jqzoom').jqzoom({zoomType:'innerzoom',zoomWidth:458,zoomHeight:458,xOffset:21,yOffset:0,title:false});}
if(typeof(contentOnly)!='undefined'&&!contentOnly)
{if(!!$.prototype.fancybox){$('li:visible .fancybox, .fancybox.shown').fancybox({'hideOnContentClick':true,'openEffect':'elastic','closeEffect':'elastic'});}}
else if(typeof ajax_allowed!='undefined'&&!ajax_allowed)
$('#buy_block').attr('target','_top');if($('#bxslider li').length&&!!$.prototype.bxSlider)
$('#bxslider').bxSlider({minSlides:1,maxSlides:6,slideWidth:178,slideMargin:20,pager:false,nextText:'',prevText:'',moveSlides:1,infiniteLoop:false,hideControlOnEnd:true});if(!$('#bxslider li').length)
$('.accessories-block').parent().remove();if(!!$.prototype.uniform)
{if(typeof product_fileDefaultHtml!=='undefined')
$.uniform.defaults.fileDefaultHtml=product_fileDefaultHtml;if(typeof product_fileButtonHtml!=='undefined')
$.uniform.defaults.fileButtonHtml=product_fileButtonHtml;}
if($('#customizationForm').length)
{var url=window.location+'';if(url.indexOf('#')!=-1)
getProductAttribute();}
var baseUrl=$("#baseUrl").val();});$(window).resize(function(){serialScrollSetNbImages();$('#thumbs_list').trigger('goto',0);serialScrollFixLock('','','','',0);});$(window).bind('hashchange',function(){checkUrl();findCombination();});$(document).on('mouseover','#views_block li a',function(){displayImage($(this));});$(document).on('click','#view_full_size, #image-block',function(e){$('#views_block .shown').click();});$(document).on('click','#short_description_block .button',function(e){$('#more_info_tab_more_info').click();$.scrollTo('#more_info_tabs',1200);});$(document).on('click','#customizedDatas input',function(e){$('#customizedDatas input').hide();$('#ajax-loader').fadeIn();$('#customizedDatas').append(uploading_in_progress);});$(document).on('click','a[data-id=resetImages]',function(e){e.preventDefault();refreshProductImages(0);});$(document).on('click','.color_pick',function(e){e.preventDefault();colorPickerClick($(this));getProductAttribute();});$(document).on('change','.attribute_select',function(e){e.preventDefault();findCombination();getProductAttribute();});$(document).on('click','.attribute_radio',function(e){e.preventDefault();findCombination();getProductAttribute();});$(document).on('click','button[name=saveCustomization]',function(e){saveCustomization();});if(typeof ad!=='undefined'&&ad&&typeof adtoken!=='undefined'&&adtoken)
{$(document).on('click','a#publish_button',function(e){e.preventDefault();submitPublishProduct(ad,0,adtoken);});$(document).on('click','a#lnk_view',function(e){e.preventDefault();submitPublishProduct(ad,1,adtoken);});}
if(typeof(contentOnly)!='undefined'&&contentOnly)
{$(document).on('click','.fancybox',function(e){e.preventDefault();});$(document).on('click','#image-block',function(e){e.preventDefault();var productUrl=window.document.location.href+'';var data=productUrl.replace(/[\?|&]content_only=1/,'');if(window.parent.page_name=='search')
data+=((data.indexOf('?')<0)?'?':'&')+'HTTP_REFERER='+encodeURIComponent(window.parent.document.location.href);window.parent.document.location.href=data;return;});}
$(document).on('click','.product_quantity_up',function(e){e.preventDefault();fieldName=$(this).data('field-qty');var currentVal=parseInt($('input[name='+fieldName+']').val());if(!allowBuyWhenOutOfStock&&quantityAvailable>0)
quantityAvailableT=quantityAvailable;else
quantityAvailableT=100000000;if(!isNaN(currentVal)&&currentVal<quantityAvailableT)
$('input[name='+fieldName+']').val(currentVal+1).trigger('keyup');else
$('input[name='+fieldName+']').val(quantityAvailableT);});$(document).on('click','.product_quantity_down',function(e){e.preventDefault();fieldName=$(this).data('field-qty');var currentVal=parseInt($('input[name='+fieldName+']').val());if(!isNaN(currentVal)&&currentVal>1)
$('input[name='+fieldName+']').val(currentVal-1).trigger('keyup');else
$('input[name='+fieldName+']').val(1);});if(typeof minimalQuantity!='undefined'&&minimalQuantity)
{checkMinimalQuantity();$(document).on('keyup','input[name=qty]',function(e){checkMinimalQuantity(minimalQuantity);});}
function arrayUnique(a)
{return a.reduce(function(p,c){if(p.indexOf(c)<0)
p.push(c);return p;},[]);};function function_exists(function_name)
{if(typeof function_name==='string')
function_name=this.window[function_name];return typeof function_name==='function';}
function oosHookJsCode()
{for(var i=0;i<oosHookJsCodeFunctions.length;i++)
{if(function_exists(oosHookJsCodeFunctions[i]))
setTimeout(oosHookJsCodeFunctions[i]+'()',0);}}
function addCombination(idCombination,arrayOfIdAttributes,quantity,price,ecotax,id_image,reference,unit_price,minimal_quantity,available_date,combination_specific_price)
{globalQuantity+=quantity;var combination=[];combination['idCombination']=idCombination;combination['quantity']=quantity;combination['idsAttributes']=arrayOfIdAttributes;combination['price']=price;combination['ecotax']=ecotax;combination['image']=id_image;combination['reference']=reference;combination['unit_price']=unit_price;combination['minimal_quantity']=minimal_quantity;combination['available_date']=[];combination['available_date']=available_date;combination['specific_price']=[];combination['specific_price']=combination_specific_price;combinations.push(combination);}
function findCombination()
{$('#minimal_quantity_wanted_p').fadeOut();if(typeof $('#minimal_quantity_label').text()==='undefined'||$('#minimal_quantity_label').html()>1)
$('#quantity_wanted').val(1);var choice=[];var radio_inputs=parseInt($('#attributes .checked > input[type=radio]').length);if(radio_inputs)
radio_inputs='#attributes .checked > input[type=radio]';else
radio_inputs='#attributes input[type=radio]:checked';$('#attributes select, #attributes input[type=hidden], '+radio_inputs).each(function(){choice.push(parseInt($(this).val()));});if(typeof combinations=='undefined'||!combinations)
combinations=[];for(var combination=0;combination<combinations.length;++combination)
{var combinationMatchForm=true;$.each(combinations[combination]['idsAttributes'],function(key,value)
{if(!in_array(parseInt(value),choice))
combinationMatchForm=false;});if(combinationMatchForm)
{if(combinations[combination]['minimal_quantity']>1)
{$('#minimal_quantity_label').html(combinations[combination]['minimal_quantity']);$('#minimal_quantity_wanted_p').fadeIn();$('#quantity_wanted').val(combinations[combination]['minimal_quantity']);$('#quantity_wanted').bind('keyup',function(){checkMinimalQuantity(combinations[combination]['minimal_quantity']);});}
selectedCombination['unavailable']=false;selectedCombination['reference']=combinations[combination]['reference'];$('#idCombination').val(combinations[combination]['idCombination']);quantityAvailable=combinations[combination]['quantity'];selectedCombination['price']=combinations[combination]['price'];selectedCombination['unit_price']=combinations[combination]['unit_price'];selectedCombination['specific_price']=combinations[combination]['specific_price'];if(combinations[combination]['ecotax'])
selectedCombination['ecotax']=combinations[combination]['ecotax'];else
selectedCombination['ecotax']=default_eco_tax;if(combinations[combination]['image']&&combinations[combination]['image']!=-1)
displayImage($('#thumb_'+combinations[combination]['image']).parent());if(combinations[combination]['idCombination']&&combinations[combination]['idCombination']>0)
displayDiscounts(combinations[combination]['idCombination']);selectedCombination['available_date']=combinations[combination]['available_date'];updateDisplay();if(firstTime)
{refreshProductImages(0);firstTime=false;}
else
refreshProductImages(combinations[combination]['idCombination']);return;}}
selectedCombination['unavailable']=true;if(typeof(selectedCombination['available_date'])!='undefined')
delete selectedCombination['available_date'];updateDisplay();}
function updateDisplay()
{var productPriceDisplay=productPrice;var productPriceWithoutReductionDisplay=productPriceWithoutReduction;if(!selectedCombination['unavailable']&&quantityAvailable>0&&productAvailableForOrder==1)
{$('#quantity_wanted_p:hidden').show('slow');$('#add_to_cart:hidden').fadeIn(600);$('#oosHook').hide();$('#availability_date').fadeOut();if(stock_management&&availableNowValue!='')
{$('#availability_value').removeClass('label-warning').addClass('label-success').text(availableNowValue).show();$('#availability_statut:hidden').show('slow');}
else
$('#availability_statut:visible').hide('slow');if(!allowBuyWhenOutOfStock)
{if(quantityAvailable<=maxQuantityToAllowDisplayOfLastQuantityMessage)
$('#last_quantities').show('slow');else
$('#last_quantities').hide('slow');}
if(quantitiesDisplayAllowed)
{$('#pQuantityAvailable:hidden').show('slow');$('#quantityAvailable').text(quantityAvailable);if(quantityAvailable<2)
{$('#quantityAvailableTxt').show();$('#quantityAvailableTxtMultiple').hide();}
else
{$('#quantityAvailableTxt').hide();$('#quantityAvailableTxtMultiple').show();}}}
else
{if(productAvailableForOrder==1)
{$('#oosHook').show();if($('#oosHook').length>0&&function_exists('oosHookJsCode'))
oosHookJsCode();}
$('#last_quantities:visible').hide('slow');$('#pQuantityAvailable:visible').hide('slow');if(!allowBuyWhenOutOfStock)
$('#quantity_wanted_p:visible').hide('slow');if(!selectedCombination['unavailable'])
{$('#availability_value').text(doesntExistNoMore+(globalQuantity>0?' '+doesntExistNoMoreBut:''));if(!allowBuyWhenOutOfStock)
$('#availability_value').removeClass('label-success').addClass('label-warning');}
else
{$('#availability_value').text(doesntExist).removeClass('label-success').addClass('label-warning');$('#oosHook').hide();}
if((stock_management==1&&!allowBuyWhenOutOfStock)||(!stock_management&&selectedCombination['unavailable']))
$('#availability_statut:hidden').show();if(typeof(selectedCombination['available_date'])!='undefined'&&typeof(selectedCombination['available_date']['date_formatted'])!='undefined'&&selectedCombination['available_date']['date'].length!=0)
{var available_date=selectedCombination['available_date']['date'];var tab_date=available_date.split('-');var time_available=new Date(tab_date[0],tab_date[1],tab_date[2]);time_available.setMonth(time_available.getMonth()-1);var now=new Date();if(now.getTime()<time_available.getTime()&&$('#availability_date_value').text()!=selectedCombination['available_date']['date_formatted'])
{$('#availability_date').fadeOut('normal',function(){$('#availability_date_value').text(selectedCombination['available_date']['date_formatted']);$(this).fadeIn();});}
else if(now.getTime()<time_available.getTime())
$('#availability_date').fadeIn();}
else
$('#availability_date').fadeOut();if(allowBuyWhenOutOfStock&&!selectedCombination['unavailable']&&productAvailableForOrder)
{$('#add_to_cart:hidden').fadeIn(600);if(stock_management&&availableLaterValue!='')
{$('#availability_value').addClass('label-warning').text(availableLaterValue).show('slow');$('#availability_statut:hidden').show('slow');}
else
$('#availability_statut:visible').hide('slow');}
else
{$('#add_to_cart:visible').fadeOut(600);if(stock_management==1&&productAvailableForOrder)
$('#availability_statut:hidden').show('slow');}
if(productAvailableForOrder==0)
$('#availability_statut:visible').hide();}
if(selectedCombination['reference']||productReference)
{if(selectedCombination['reference'])
$('#product_reference span').text(selectedCombination['reference']);else if(productReference)
$('#product_reference span').text(productReference);$('#product_reference:hidden').show('slow');}
else
$('#product_reference:visible').hide('slow');if(productHasAttributes)
updatePrice();}
function updatePrice()
{var combID=$('#idCombination').val();var combination=combinationsFromController[combID];if(typeof combination=='undefined')
return;var basePriceWithoutTax=+productPriceTaxExcluded;var basePriceWithTax=+productPriceTaxIncluded;var priceWithGroupReductionWithoutTax=0;priceWithGroupReductionWithoutTax=basePriceWithoutTax*(1-groupReduction);basePriceWithoutTax=basePriceWithoutTax+ +combination.price;basePriceWithTax=basePriceWithTax+ +combination.price*(taxRate/100+1);if(combination.specific_price&&combination.specific_price.price>0)
{basePriceWithoutTax=+combination.specific_price.price;basePriceWithTax=+combination.specific_price.price*(taxRate/100+1);}
var priceWithDiscountsWithoutTax=basePriceWithoutTax;var priceWithDiscountsWithTax=basePriceWithTax;if(default_eco_tax)
{priceWithDiscountsWithoutTax=priceWithDiscountsWithoutTax+default_eco_tax*(1+ecotaxTax_rate/100);priceWithDiscountsWithTax=priceWithDiscountsWithTax+default_eco_tax*(1+ecotaxTax_rate/100);basePriceWithTax=basePriceWithTax+default_eco_tax*(1+ecotaxTax_rate/100);basePriceWithoutTax=basePriceWithoutTax+default_eco_tax*(1+ecotaxTax_rate/100);}
if(combination.specific_price&&combination.specific_price.reduction>0)
{if(combination.specific_price.reduction_type=='amount')
{if(typeof combination.specific_price.reduction_tax!=='undefined'&&combination.specific_price.reduction_tax==="0")
{var reduction=combination.specific_price.reduction;if(combination.specific_price.id_currency==0)
reduction=reduction*currencyRate*(1-groupReduction);priceWithDiscountsWithoutTax-=reduction;priceWithDiscountsWithTax-=reduction*(taxRate/100+1);}}
else if(combination.specific_price.reduction_type=='percentage')
{priceWithDiscountsWithoutTax=priceWithDiscountsWithoutTax*(1-+combination.specific_price.reduction);priceWithDiscountsWithTax=priceWithDiscountsWithTax*(1-+combination.specific_price.reduction);}}
if(noTaxForThisProduct||customerGroupWithoutTax)
{basePriceDisplay=basePriceWithoutTax;priceWithDiscountsDisplay=priceWithDiscountsWithoutTax;}
else
{basePriceDisplay=basePriceWithTax;priceWithDiscountsDisplay=priceWithDiscountsWithTax;}
if(combination.specific_price&&combination.specific_price.reduction>0)
{if(combination.specific_price.reduction_type=='amount')
{if(typeof combination.specific_price.reduction_tax==='undefined'||(typeof combination.specific_price.reduction_tax!=='undefined'&&combination.specific_price.reduction_tax==='1'))
{var reduction=combination.specific_price.reduction;if(typeof specific_currency!=='undefined'&&specific_currency&&parseInt(combination.specific_price.id_currency)&&combination.specific_price.id_currency!=currency.id)
reduction=reduction/currencyRate;else if(!specific_currency)
reduction=reduction*currencyRate;if(typeof groupReduction!=='undefined'&&groupReduction>0)
reduction*=1-parseFloat(groupReduction);priceWithDiscountsDisplay-=reduction;priceWithDiscountsWithoutTax=priceWithDiscountsDisplay-reduction*(1/(1+taxRate/100));}}}
if(basePriceDisplay!=priceWithDiscountsDisplay)
{var discountValue=basePriceDisplay-priceWithDiscountsDisplay;var discountPercentage=(1-(priceWithDiscountsDisplay/basePriceDisplay))*100;}
var unit_impact=+combination.unit_impact;if(productUnitPriceRatio>0||unit_impact)
{if(unit_impact)
{baseUnitPrice=productBasePriceTaxExcl/productUnitPriceRatio;unit_price=baseUnitPrice+unit_impact;if(!noTaxForThisProduct||!customerGroupWithoutTax)
unit_price=unit_price*(taxRate/100+1);}
else
unit_price=priceWithDiscountsDisplay/productUnitPriceRatio;}
$('#reduction_percent').hide();$('#reduction_amount').hide();$('#old_price, #old_price_display, #old_price_display_taxes').hide();$('.price-ecotax').hide();$('.unit-price').hide();$('#our_price_display').text(formatCurrency(priceWithDiscountsDisplay,currencyFormat,currencySign,currencyBlank)).trigger('change');if(priceWithDiscountsDisplay.toFixed(2)!=basePriceDisplay.toFixed(2))
{$('#old_price_display span.price').text(formatCurrency(basePriceDisplay,currencyFormat,currencySign,currencyBlank));$('#old_price, #old_price_display, #old_price_display_taxes').removeClass('hidden').show();if(priceWithDiscountsWithoutTax!=priceWithGroupReductionWithoutTax)
{if(combination.specific_price.reduction_type=='amount')
{$('#reduction_amount_display').html('-'+formatCurrency(discountValue,currencyFormat,currencySign,currencyBlank));$('#reduction_amount').show();}
else
{var toFix=2;if((parseFloat(discountPercentage).toFixed(2)-parseFloat(discountPercentage).toFixed(0))==0)
toFix=0;$('#reduction_percent_display').html('-'+parseFloat(discountPercentage).toFixed(toFix)+'%');$('#reduction_percent').show();}}}
if(default_eco_tax)
{ecotax=default_eco_tax;if(combination.ecotax)
ecotax=+combination.ecotax;if(!noTaxForThisProduct)
ecotax=ecotax*(1+ecotaxTax_rate/100)
$('#ecotax_price_display').text(formatCurrency(ecotax*currencyRate,currencyFormat,currencySign,currencyBlank));$('.price-ecotax').show();}
if(productUnitPriceRatio>0)
{$('#unit_price_display').text(formatCurrency(unit_price*currencyRate,currencyFormat,currencySign,currencyBlank));$('.unit-price').show();}
if(noTaxForThisProduct||customerGroupWithoutTax)
updateDiscountTable(productBasePriceTaxExcl);else
updateDiscountTable(productBasePriceTaxIncl);}
function displayImage(domAAroundImgThumb,no_animation)
{if(typeof(no_animation)=='undefined')
no_animation=false;if(domAAroundImgThumb.attr('href'))
{var new_src=domAAroundImgThumb.attr('href').replace('thickbox','large');var new_title=domAAroundImgThumb.attr('title');var new_href=domAAroundImgThumb.attr('href');if($('#bigpic').attr('src')!=new_src)
{$('#bigpic').attr({'src':new_src,'alt':new_title,'title':new_title}).load(function(){if(typeof(jqZoomEnabled)!='undefined'&&jqZoomEnabled)
$(this).attr('rel',new_href);});}
$('#views_block li a').removeClass('shown');$(domAAroundImgThumb).addClass('shown');}}
function displayDiscounts(combination)
{var quantityDiscountTable=$('#quantityDiscount');var combinationsSpecificQuantityDiscount=$('#quantityDiscount_'+combination,quantityDiscountTable);var allQuantityDiscount=$('#quantityDiscount_0',quantityDiscountTable);if(combinationsSpecificQuantityDiscount.length!=0)
{combinationsSpecificQuantityDiscount.show();allQuantityDiscount.hide();quantityDiscountTable.show();}
else if(allQuantityDiscount.length!=0)
{allQuantityDiscount.show();$('tbody tr',quantityDiscountTable).not('#quantityDiscount_0').hide();quantityDiscountTable.show();}
else
{quantityDiscountTable.hide();}}
function updateDiscountTable(newPrice)
{$('#quantityDiscount tbody tr').each(function(){var type=$(this).data("discount-type");var discount=$(this).data("discount");var quantity=$(this).data("discount-quantity");if(type=='percentage')
{var discountedPrice=newPrice*(1-discount/100);var discountUpTo=newPrice*(discount/100)*quantity;}
else if(type=='amount')
{var discountedPrice=newPrice-discount;var discountUpTo=discount*quantity;}
if(displayDiscountPrice!=0)
$(this).children('td').eq(1).text(formatCurrency(discountedPrice*currencyRate,currencyFormat,currencySign,currencyBlank));$(this).children('td').eq(2).text(upToTxt+' '+formatCurrency(discountUpTo*currencyRate,currencyFormat,currencySign,currencyBlank));});}
function serialScrollFixLock(event,targeted,scrolled,items,position)
{var serialScrollNbImages=$('#thumbs_list li:visible').length;var leftArrow=position==0?true:false;var rightArrow=position+serialScrollNbImagesDisplayed>=serialScrollNbImages?true:false;$('#view_scroll_left').css('cursor',leftArrow?'default':'pointer').css('display',leftArrow?'none':'block').fadeTo(0,leftArrow?0:1);$('#view_scroll_right').css('cursor',rightArrow?'default':'pointer').fadeTo(0,rightArrow?0:1).css('display',rightArrow?'none':'block');return true;}
function serialScrollSetNbImages()
{serialScrollNbImagesDisplayed=4;if($('#thumbs_list').outerWidth(true)<194)
serialScrollNbImagesDisplayed=1;else if($('#thumbs_list').outerWidth(true)<294)
serialScrollNbImagesDisplayed=2;else if($('#thumbs_list').outerWidth(true)<392)
serialScrollNbImagesDisplayed=3;}
function refreshProductImages(id_product_attribute)
{id_product_attribute=parseInt(id_product_attribute);if(id_product_attribute>0&&typeof(combinationImages)!='undefined'&&typeof(combinationImages[id_product_attribute])!='undefined')
{$('#thumbs_list li').hide();for(var i=0;i<combinationImages[id_product_attribute].length;i++)
if(typeof(jqZoomEnabled)!='undefined'&&jqZoomEnabled)
$('#thumbnail_'+parseInt(combinationImages[id_product_attribute][i])).show().children('a.shown').trigger('click');else
$('#thumbnail_'+parseInt(combinationImages[id_product_attribute][i])).show();}
else
{$('#thumbs_list li').show();var choice=[];var radio_inputs=parseInt($('#attributes .checked > input[type=radio]').length);if(radio_inputs)
radio_inputs='#attributes .checked > input[type=radio]';else
radio_inputs='#attributes input[type=radio]:checked';$('#attributes select, #attributes input[type=hidden], '+radio_inputs).each(function(){choice.push(parseInt($(this).val()));});if(typeof combinations=='undefined'||!combinations)
combinations=[];for(var combination=0;combination<combinations.length;++combination)
{var combinationMatchForm=true;$.each(combinations[combination]['idsAttributes'],function(key,value)
{if(!in_array(parseInt(value),choice))
combinationMatchForm=false;});if(combinationMatchForm)
{if(combinations[combination]['image']&&combinations[combination]['image']!=-1)
displayImage($('#thumb_'+combinations[combination]['image']).parent());}}}
if(parseInt($('#thumbs_list_frame >li:visible').length)!=parseInt($('#thumbs_list_frame >li').length))
$('#wrapResetImages').stop(true,true).show();else
$('#wrapResetImages').stop(true,true).hide();$('#thumbs_list_frame').width(parseInt($('#thumbs_list_frame >li').outerWidth(true)*$('#thumbs_list_frame >li').length)+'px');$('#thumbs_list').trigger('goto',0);serialScrollFixLock('','','','',0);}
function saveCustomization()
{$('#quantityBackup').val($('#quantity_wanted').val());$('#customizationForm').submit();}
function submitPublishProduct(url,redirect,token)
{var id_product=$('#admin-action-product-id').val();$.ajaxSetup({async:false});$.post(url+'/index.php',{action:'publishProduct',id_product:id_product,status:1,redirect:redirect,ajax:1,tab:'AdminProducts',token:token},function(data)
{if(data.indexOf('error')===-1)
document.location.href=data;});return true;}
function checkMinimalQuantity(minimal_quantity)
{if($('#quantity_wanted').val()<minimal_quantity)
{$('#quantity_wanted').css('border','1px solid red');$('#minimal_quantity_wanted_p').css('color','red');}
else
{$('#quantity_wanted').css('border','1px solid #BDC2C9');$('#minimal_quantity_wanted_p').css('color','#374853');}}
function colorPickerClick(elt)
{id_attribute=$(elt).attr('id').replace('color_','');$(elt).parent().parent().children().removeClass('selected');$(elt).fadeTo('fast',1,function(){$(this).fadeTo('fast',0,function(){$(this).fadeTo('fast',1,function(){$(this).parent().addClass('selected');});});});$(elt).parent().parent().parent().children('.color_pick_hidden').val(id_attribute);}
function getProductAttribute()
{request='';var tab_attributes=[];var radio_inputs=parseInt($('#attributes .checked > input[type=radio]').length);if(radio_inputs)
radio_inputs='#attributes .checked > input[type=radio]';else
radio_inputs='#attributes input[type=radio]:checked';$('#attributes select, #attributes input[type=hidden], '+radio_inputs).each(function(){tab_attributes.push($(this).val());});for(var i in attributesCombinations)
for(var a in tab_attributes)
if(attributesCombinations[i]['id_attribute']===tab_attributes[a])
request+='/'+attributesCombinations[i]['id_attribute']+'-'+attributesCombinations[i]['group']+attribute_anchor_separator+attributesCombinations[i]['attribute'];request=request.replace(request.substring(0,1),'#/');var url=window.location+'';if(url.indexOf('#')!=-1)
url=url.substring(0,url.indexOf('#'));if($('#customizationForm').length)
{customAction=$('#customizationForm').attr('action');if(customAction.indexOf('#')!=-1)
customAction=customAction.substring(0,customAction.indexOf('#'));$('#customizationForm').attr('action',customAction+request);}
window.location.replace(url+request);}
function checkUrl()
{if(original_url!=window.location||first_url_check)
{first_url_check=false;var url=window.location+'';if(url.indexOf('#/')!=-1)
{params=url.substring(url.indexOf('#')+1,url.length);tabParams=params.split('/');tabValues=[];if(tabParams[0]=='')
tabParams.shift();var len=tabParams.length;for(var i=0;i<len;i++)
tabValues.push(tabParams[i].split(attribute_anchor_separator));$('.color_pick').removeClass('selected').parent().parent().children().removeClass('selected');count=0;for(var z in tabValues)
for(var a in attributesCombinations)
if(attributesCombinations[a]['group']===decodeURIComponent(tabValues[z][1])&&attributesCombinations[a]['id_attribute']===decodeURIComponent(tabValues[z][0]))
{count++;$('#color_'+attributesCombinations[a]['id_attribute']).addClass('selected').parent().addClass('selected');$('input:radio[value='+attributesCombinations[a]['id_attribute']+']').prop('checked',true);$('input[type=hidden][name=group_'+attributesCombinations[a]['id_attribute_group']+']').val(attributesCombinations[a]['id_attribute']);$('select[name=group_'+attributesCombinations[a]['id_attribute_group']+']').val(attributesCombinations[a]['id_attribute']);if(!!$.prototype.uniform)
$.uniform.update('input[name=group_'+attributesCombinations[a]['id_attribute_group']+'], select[name=group_'+attributesCombinations[a]['id_attribute_group']+']');}
if(count)
{if(firstTime)
{firstTime=false;findCombination();}
original_url=url;return true;}
else
window.location.replace(url.substring(0,url.indexOf('#')));}}
return false;};;"function"!==typeof Object.create&&(Object.create=function(d){function h(){}h.prototype=d;return new h});(function(d,h,l,m){var k={init:function(b,a){var c=this;c.elem=a;c.$elem=d(a);c.imageSrc=c.$elem.data("zoom-image")?c.$elem.data("zoom-image"):c.$elem.attr("src");c.options=d.extend({},d.fn.elevateZoom.options,b);c.options.tint&&(c.options.lensColour="none",c.options.lensOpacity="1");"inner"==c.options.zoomType&&(c.options.showLens=!1);c.$elem.parent().removeAttr("title").removeAttr("alt");c.zoomImage=c.imageSrc;c.refresh(1);d("#"+c.options.gallery+" a").click(function(a){c.options.galleryActiveClass&&(d("#"+c.options.gallery+" a").removeClass(c.options.galleryActiveClass),d(this).addClass(c.options.galleryActiveClass));a.preventDefault();d(this).data("zoom-image")?c.zoomImagePre=d(this).data("zoom-image"):c.zoomImagePre=d(this).data("image");c.swaptheimage(d(this).data("image"),c.zoomImagePre);return!1})},refresh:function(b){var a=this;setTimeout(function(){a.fetch(a.imageSrc)},b||a.options.refresh)},fetch:function(b){var a=this,c=new Image;c.onload=function(){a.largeWidth=c.width;a.largeHeight=c.height;a.startZoom();a.currentImage=a.imageSrc;a.options.onZoomedImageLoaded(a.$elem)};c.src=b},startZoom:function(){var b=this;b.nzWidth=b.$elem.width();b.nzHeight=b.$elem.height();b.isWindowActive=!1;b.isLensActive=!1;b.isTintActive=!1;b.overWindow=!1;b.options.imageCrossfade&&(b.zoomWrap=b.$elem.wrap('<div style="height:'+b.nzHeight+"px;width:"+b.nzWidth+'px;" class="zoomWrapper" />'),b.$elem.css("position","absolute"));b.zoomLock=1;b.scrollingLock=!1;b.changeBgSize=!1;b.currentZoomLevel=b.options.zoomLevel;b.nzOffset=b.$elem.offset();b.widthRatio=b.largeWidth/b.currentZoomLevel/b.nzWidth;b.heightRatio=b.largeHeight/b.currentZoomLevel/b.nzHeight;"window"==b.options.zoomType&&(b.zoomWindowStyle="overflow: hidden;background-position: 0px 0px;text-align:center;background-color: "+String(b.options.zoomWindowBgColour)+";width: "+String(b.options.zoomWindowWidth)+"px;height: "+String(b.options.zoomWindowHeight)+"px;float: left;background-size: "+b.largeWidth/b.currentZoomLevel+"px "+b.largeHeight/b.currentZoomLevel+"px;display: none;z-index:100;border: "+String(b.options.borderSize)+"px solid "+b.options.borderColour+";background-repeat: no-repeat;position: absolute;");if("inner"==b.options.zoomType){var a=b.$elem.css("border-left-width");b.zoomWindowStyle="overflow: hidden;margin-left: "+String(a)+";margin-top: "+String(a)+";background-position: 0px 0px;width: "+String(b.nzWidth)+"px;height: "+String(b.nzHeight)+"px;float: left;display: none;cursor:"+b.options.cursor+";px solid "+b.options.borderColour+";background-repeat: no-repeat;position: absolute;"}"window"==b.options.zoomType&&(lensHeight=b.nzHeight<b.options.zoomWindowWidth/b.widthRatio?b.nzHeight:String(b.options.zoomWindowHeight/b.heightRatio),lensWidth=b.largeWidth<b.options.zoomWindowWidth?b.nzWidth:b.options.zoomWindowWidth/b.widthRatio,b.lensStyle="background-position: 0px 0px;width: "+String(b.options.zoomWindowWidth/b.widthRatio)+"px;height: "+String(b.options.zoomWindowHeight/b.heightRatio)+"px;float: right;display: none;overflow: hidden;z-index: 999;-webkit-transform: translateZ(0);opacity:"+
b.options.lensOpacity+";filter: alpha(opacity = "+100*b.options.lensOpacity+"); zoom:1;width:"+lensWidth+"px;height:"+lensHeight+"px;background-color:"+b.options.lensColour+";cursor:"+b.options.cursor+";border: "+b.options.lensBorderSize+"px solid "+b.options.lensBorderColour+";background-repeat: no-repeat;position: absolute;");b.tintStyle="display: block;position: absolute;background-color: "+b.options.tintColour+";filter:alpha(opacity=0);opacity: 0;width: "+b.nzWidth+"px;height: "+b.nzHeight+"px;";b.lensRound="";"lens"==b.options.zoomType&&(b.lensStyle="background-position: 0px 0px;float: left;display: none;border: "+String(b.options.borderSize)+"px solid "+b.options.borderColour+";width:"+String(b.options.lensSize)+"px;height:"+String(b.options.lensSize)+"px;background-repeat: no-repeat;position: absolute;");"round"==b.options.lensShape&&(b.lensRound="border-top-left-radius: "+String(b.options.lensSize/2+b.options.borderSize)+"px;border-top-right-radius: "+String(b.options.lensSize/2+b.options.borderSize)+"px;border-bottom-left-radius: "+String(b.options.lensSize/2+b.options.borderSize)+"px;border-bottom-right-radius: "+String(b.options.lensSize/2+b.options.borderSize)+"px;");b.zoomContainer=d('<div class="zoomContainer" style="-webkit-transform: translateZ(0);position:absolute;left:'+b.nzOffset.left+"px;top:"+b.nzOffset.top+"px;height:"+b.nzHeight+"px;width:"+b.nzWidth+'px;"></div>');d("body").append(b.zoomContainer);b.options.containLensZoom&&"lens"==b.options.zoomType&&b.zoomContainer.css("overflow","hidden");"inner"!=b.options.zoomType&&(b.zoomLens=d("<div class='zoomLens' style='"+b.lensStyle+b.lensRound+"'>&nbsp;</div>").appendTo(b.zoomContainer).click(function(){b.$elem.trigger("click")}),b.options.tint&&(b.tintContainer=d("<div/>").addClass("tintContainer"),b.zoomTint=d("<div class='zoomTint' style='"+b.tintStyle+"'></div>"),b.zoomLens.wrap(b.tintContainer),b.zoomTintcss=b.zoomLens.after(b.zoomTint),b.zoomTintImage=d('<img style="position: absolute; left: 0px; top: 0px; max-width: none; width: '+
b.nzWidth+"px; height: "+b.nzHeight+'px;" src="'+b.imageSrc+'">').appendTo(b.zoomLens).click(function(){b.$elem.trigger("click")})));isNaN(b.options.zoomWindowPosition)?b.zoomWindow=d("<div style='z-index:999;left:"+b.windowOffsetLeft+"px;top:"+b.windowOffsetTop+"px;"+b.zoomWindowStyle+"' class='zoomWindow'>&nbsp;</div>").appendTo("body").click(function(){b.$elem.trigger("click")}):b.zoomWindow=d("<div style='z-index:999;left:"+b.windowOffsetLeft+"px;top:"+b.windowOffsetTop+"px;"+b.zoomWindowStyle+"' class='zoomWindow'>&nbsp;</div>").appendTo(b.zoomContainer).click(function(){b.$elem.trigger("click")});b.zoomWindowContainer=d("<div/>").addClass("zoomWindowContainer").css("width",b.options.zoomWindowWidth);b.zoomWindow.wrap(b.zoomWindowContainer);"lens"==b.options.zoomType&&b.zoomLens.css({backgroundImage:"url('"+b.imageSrc+"')"});"window"==b.options.zoomType&&b.zoomWindow.css({backgroundImage:"url('"+b.imageSrc+"')"});"inner"==b.options.zoomType&&b.zoomWindow.css({backgroundImage:"url('"+b.imageSrc+"')"});b.$elem.bind("touchmove",function(a){a.preventDefault();b.setPosition(a.originalEvent.touches[0]||a.originalEvent.changedTouches[0])});b.zoomContainer.bind("touchmove",function(a){"inner"==b.options.zoomType&&b.showHideWindow("show");a.preventDefault();b.setPosition(a.originalEvent.touches[0]||a.originalEvent.changedTouches[0])});b.zoomContainer.bind("touchend",function(a){b.showHideWindow("hide");b.options.showLens&&b.showHideLens("hide");b.options.tint&&"inner"!=b.options.zoomType&&b.showHideTint("hide")});b.$elem.bind("touchend",function(a){b.showHideWindow("hide");b.options.showLens&&b.showHideLens("hide");b.options.tint&&"inner"!=b.options.zoomType&&b.showHideTint("hide")});b.options.showLens&&(b.zoomLens.bind("touchmove",function(a){a.preventDefault();b.setPosition(a.originalEvent.touches[0]||a.originalEvent.changedTouches[0])}),b.zoomLens.bind("touchend",function(a){b.showHideWindow("hide");b.options.showLens&&b.showHideLens("hide");b.options.tint&&"inner"!=b.options.zoomType&&b.showHideTint("hide")}));b.$elem.bind("mousemove",function(a){!1==b.overWindow&&b.setElements("show");if(b.lastX!==a.clientX||b.lastY!==a.clientY)b.setPosition(a),b.currentLoc=a;b.lastX=a.clientX;b.lastY=a.clientY});b.zoomContainer.bind("mousemove",function(a){!1==b.overWindow&&b.setElements("show");if(b.lastX!==a.clientX||b.lastY!==a.clientY)b.setPosition(a),b.currentLoc=a;b.lastX=a.clientX;b.lastY=a.clientY});"inner"!=b.options.zoomType&&b.zoomLens.bind("mousemove",function(a){if(b.lastX!==a.clientX||b.lastY!==a.clientY)b.setPosition(a),b.currentLoc=a;b.lastX=a.clientX;b.lastY=a.clientY});b.options.tint&&"inner"!=b.options.zoomType&&b.zoomTint.bind("mousemove",function(a){if(b.lastX!==a.clientX||b.lastY!==a.clientY)b.setPosition(a),b.currentLoc=a;b.lastX=a.clientX;b.lastY=a.clientY});"inner"==b.options.zoomType&&b.zoomWindow.bind("mousemove",function(a){if(b.lastX!==a.clientX||b.lastY!==a.clientY)b.setPosition(a),b.currentLoc=a;b.lastX=a.clientX;b.lastY=a.clientY});b.zoomContainer.add(b.$elem).mouseenter(function(){!1==b.overWindow&&b.setElements("show")}).mouseleave(function(){b.scrollLock||b.setElements("hide")});"inner"!=b.options.zoomType&&b.zoomWindow.mouseenter(function(){b.overWindow=!0;b.setElements("hide")}).mouseleave(function(){b.overWindow=!1});b.minZoomLevel=b.options.minZoomLevel?b.options.minZoomLevel:2*b.options.scrollZoomIncrement;b.options.scrollZoom&&b.zoomContainer.add(b.$elem).bind("mousewheel DOMMouseScroll MozMousePixelScroll",function(a){b.scrollLock=!0;clearTimeout(d.data(this,"timer"));d.data(this,"timer",setTimeout(function(){b.scrollLock=!1},250));var e=a.originalEvent.wheelDelta||-1*a.originalEvent.detail;a.stopImmediatePropagation();a.stopPropagation();a.preventDefault();0<e/120?b.currentZoomLevel>=b.minZoomLevel&&b.changeZoomLevel(b.currentZoomLevel-b.options.scrollZoomIncrement):b.options.maxZoomLevel?b.currentZoomLevel<=b.options.maxZoomLevel&&b.changeZoomLevel(parseFloat(b.currentZoomLevel)+b.options.scrollZoomIncrement):b.changeZoomLevel(parseFloat(b.currentZoomLevel)+b.options.scrollZoomIncrement);return!1})},setElements:function(b){if(!this.options.zoomEnabled)return!1;"show"==b&&this.isWindowSet&&("inner"==this.options.zoomType&&this.showHideWindow("show"),"window"==this.options.zoomType&&this.showHideWindow("show"),this.options.showLens&&this.showHideLens("show"),this.options.tint&&"inner"!=this.options.zoomType&&this.showHideTint("show"));"hide"==b&&("window"==this.options.zoomType&&this.showHideWindow("hide"),this.options.tint||this.showHideWindow("hide"),this.options.showLens&&this.showHideLens("hide"),this.options.tint&&this.showHideTint("hide"))},setPosition:function(b){if(!this.options.zoomEnabled)return!1;this.nzHeight=this.$elem.height();this.nzWidth=this.$elem.width();this.nzOffset=this.$elem.offset();this.options.tint&&"inner"!=this.options.zoomType&&(this.zoomTint.css({top:0}),this.zoomTint.css({left:0}));this.options.responsive&&!this.options.scrollZoom&&this.options.showLens&&(lensHeight=this.nzHeight<this.options.zoomWindowWidth/this.widthRatio?this.nzHeight:String(this.options.zoomWindowHeight/this.heightRatio),lensWidth=this.largeWidth<this.options.zoomWindowWidth?this.nzWidth:this.options.zoomWindowWidth/this.widthRatio,this.widthRatio=this.largeWidth/this.nzWidth,this.heightRatio=this.largeHeight/this.nzHeight,"lens"!=this.options.zoomType&&(lensHeight=this.nzHeight<this.options.zoomWindowWidth/this.widthRatio?this.nzHeight:String(this.options.zoomWindowHeight/this.heightRatio),lensWidth=this.options.zoomWindowWidth<this.options.zoomWindowWidth?this.nzWidth:this.options.zoomWindowWidth/this.widthRatio,this.zoomLens.css("width",lensWidth),this.zoomLens.css("height",lensHeight),this.options.tint&&(this.zoomTintImage.css("width",this.nzWidth),this.zoomTintImage.css("height",this.nzHeight))),"lens"==this.options.zoomType&&this.zoomLens.css({width:String(this.options.lensSize)+"px",height:String(this.options.lensSize)+"px"}));this.zoomContainer.css({top:this.nzOffset.top});this.zoomContainer.css({left:this.nzOffset.left});this.mouseLeft=parseInt(b.pageX-this.nzOffset.left);this.mouseTop=parseInt(b.pageY-this.nzOffset.top);"window"==this.options.zoomType&&(this.Etoppos=this.mouseTop<this.zoomLens.height()/2,this.Eboppos=this.mouseTop>this.nzHeight-this.zoomLens.height()/2-2*this.options.lensBorderSize,this.Eloppos=this.mouseLeft<0+this.zoomLens.width()/2,this.Eroppos=this.mouseLeft>this.nzWidth-this.zoomLens.width()/2-2*this.options.lensBorderSize);"inner"==this.options.zoomType&&(this.Etoppos=this.mouseTop<this.nzHeight/2/this.heightRatio,this.Eboppos=this.mouseTop>this.nzHeight-
this.nzHeight/2/this.heightRatio,this.Eloppos=this.mouseLeft<0+this.nzWidth/2/this.widthRatio,this.Eroppos=this.mouseLeft>this.nzWidth-this.nzWidth/2/this.widthRatio-2*this.options.lensBorderSize);0>=this.mouseLeft||0>this.mouseTop||this.mouseLeft>this.nzWidth||this.mouseTop>this.nzHeight?this.setElements("hide"):(this.options.showLens&&(this.lensLeftPos=String(this.mouseLeft-this.zoomLens.width()/2),this.lensTopPos=String(this.mouseTop-this.zoomLens.height()/2)),this.Etoppos&&(this.lensTopPos=0),this.Eloppos&&(this.tintpos=this.lensLeftPos=this.windowLeftPos=0),"window"==this.options.zoomType&&(this.Eboppos&&(this.lensTopPos=Math.max(this.nzHeight-this.zoomLens.height()-2*this.options.lensBorderSize,0)),this.Eroppos&&(this.lensLeftPos=this.nzWidth-this.zoomLens.width()-2*this.options.lensBorderSize)),"inner"==this.options.zoomType&&(this.Eboppos&&(this.lensTopPos=Math.max(this.nzHeight-2*this.options.lensBorderSize,0)),this.Eroppos&&(this.lensLeftPos=this.nzWidth-this.nzWidth-2*this.options.lensBorderSize)),"lens"==this.options.zoomType&&(this.windowLeftPos=String(-1*((b.pageX-this.nzOffset.left)*this.widthRatio-this.zoomLens.width()/2)),this.windowTopPos=String(-1*((b.pageY-this.nzOffset.top)*this.heightRatio-this.zoomLens.height()/2)),this.zoomLens.css({backgroundPosition:this.windowLeftPos+"px "+this.windowTopPos+"px"}),this.changeBgSize&&(this.nzHeight>this.nzWidth?("lens"==this.options.zoomType&&this.zoomLens.css({"background-size":this.largeWidth/this.newvalueheight+"px "+this.largeHeight/this.newvalueheight+"px"}),this.zoomWindow.css({"background-size":this.largeWidth/this.newvalueheight+"px "+this.largeHeight/this.newvalueheight+"px"})):("lens"==this.options.zoomType&&this.zoomLens.css({"background-size":this.largeWidth/this.newvaluewidth+"px "+this.largeHeight/this.newvaluewidth+"px"}),this.zoomWindow.css({"background-size":this.largeWidth/this.newvaluewidth+"px "+this.largeHeight/this.newvaluewidth+"px"})),this.changeBgSize=!1),this.setWindowPostition(b)),this.options.tint&&"inner"!=this.options.zoomType&&this.setTintPosition(b),"window"==this.options.zoomType&&this.setWindowPostition(b),"inner"==this.options.zoomType&&this.setWindowPostition(b),this.options.showLens&&(this.fullwidth&&"lens"!=this.options.zoomType&&(this.lensLeftPos=0),this.zoomLens.css({left:this.lensLeftPos+"px",top:this.lensTopPos+"px"})))},showHideWindow:function(b){"show"!=b||this.isWindowActive||(this.options.zoomWindowFadeIn?this.zoomWindow.stop(!0,!0,!1).fadeIn(this.options.zoomWindowFadeIn):this.zoomWindow.show(),this.isWindowActive=!0);"hide"==b&&this.isWindowActive&&(this.options.zoomWindowFadeOut?this.zoomWindow.stop(!0,!0).fadeOut(this.options.zoomWindowFadeOut):this.zoomWindow.hide(),this.isWindowActive=!1)},showHideLens:function(b){"show"!=b||this.isLensActive||(this.options.lensFadeIn?this.zoomLens.stop(!0,!0,!1).fadeIn(this.options.lensFadeIn):this.zoomLens.show(),this.isLensActive=!0);"hide"==b&&this.isLensActive&&(this.options.lensFadeOut?this.zoomLens.stop(!0,!0).fadeOut(this.options.lensFadeOut):this.zoomLens.hide(),this.isLensActive=!1)},showHideTint:function(b){"show"!=b||this.isTintActive||(this.options.zoomTintFadeIn?this.zoomTint.css({opacity:this.options.tintOpacity}).animate().stop(!0,!0).fadeIn("slow"):(this.zoomTint.css({opacity:this.options.tintOpacity}).animate(),this.zoomTint.show()),this.isTintActive=!0);"hide"==b&&this.isTintActive&&(this.options.zoomTintFadeOut?this.zoomTint.stop(!0,!0).fadeOut(this.options.zoomTintFadeOut):this.zoomTint.hide(),this.isTintActive=!1)},setLensPostition:function(b){},setWindowPostition:function(b){var a=this;if(isNaN(a.options.zoomWindowPosition))a.externalContainer=d("#"+a.options.zoomWindowPosition),a.externalContainerWidth=a.externalContainer.width(),a.externalContainerHeight=a.externalContainer.height(),a.externalContainerOffset=a.externalContainer.offset(),a.windowOffsetTop=a.externalContainerOffset.top,a.windowOffsetLeft=a.externalContainerOffset.left;else switch(a.options.zoomWindowPosition){case 1:a.windowOffsetTop=a.options.zoomWindowOffety;a.windowOffsetLeft=+a.nzWidth;break;case 2:a.options.zoomWindowHeight>a.nzHeight&&(a.windowOffsetTop=-1*(a.options.zoomWindowHeight/2-a.nzHeight/2),a.windowOffsetLeft=a.nzWidth);break;case 3:a.windowOffsetTop=a.nzHeight-a.zoomWindow.height()-2*a.options.borderSize;a.windowOffsetLeft=a.nzWidth;break;case 4:a.windowOffsetTop=a.nzHeight;a.windowOffsetLeft=a.nzWidth;break;case 5:a.windowOffsetTop=a.nzHeight;a.windowOffsetLeft=a.nzWidth-a.zoomWindow.width()-2*a.options.borderSize;break;case 6:a.options.zoomWindowHeight>a.nzHeight&&(a.windowOffsetTop=a.nzHeight,a.windowOffsetLeft=-1*(a.options.zoomWindowWidth/2-a.nzWidth/2+2*a.options.borderSize));break;case 7:a.windowOffsetTop=a.nzHeight;a.windowOffsetLeft=0;break;case 8:a.windowOffsetTop=a.nzHeight;a.windowOffsetLeft=-1*(a.zoomWindow.width()+2*a.options.borderSize);break;case 9:a.windowOffsetTop=a.nzHeight-a.zoomWindow.height()-2*a.options.borderSize;a.windowOffsetLeft=-1*(a.zoomWindow.width()+2*a.options.borderSize);break;case 10:a.options.zoomWindowHeight>a.nzHeight&&(a.windowOffsetTop=-1*(a.options.zoomWindowHeight/2-a.nzHeight/2),a.windowOffsetLeft=-1*(a.zoomWindow.width()+2*a.options.borderSize));break;case 11:a.windowOffsetTop=a.options.zoomWindowOffety;a.windowOffsetLeft=-1*(a.zoomWindow.width()+2*a.options.borderSize);break;case 12:a.windowOffsetTop=-1*(a.zoomWindow.height()+2*a.options.borderSize);a.windowOffsetLeft=-1*(a.zoomWindow.width()+2*a.options.borderSize);break;case 13:a.windowOffsetTop=-1*(a.zoomWindow.height()+2*a.options.borderSize);a.windowOffsetLeft=0;break;case 14:a.options.zoomWindowHeight>a.nzHeight&&(a.windowOffsetTop=-1*(a.zoomWindow.height()+2*a.options.borderSize),a.windowOffsetLeft=-1*(a.options.zoomWindowWidth/2-a.nzWidth/2+2*a.options.borderSize));break;case 15:a.windowOffsetTop=-1*(a.zoomWindow.height()+2*a.options.borderSize);a.windowOffsetLeft=a.nzWidth-a.zoomWindow.width()-2*a.options.borderSize;break;case 16:a.windowOffsetTop=-1*(a.zoomWindow.height()+2*a.options.borderSize);a.windowOffsetLeft=a.nzWidth;break;default:a.windowOffsetTop=a.options.zoomWindowOffety,a.windowOffsetLeft=a.nzWidth}a.isWindowSet=!0;a.windowOffsetTop+=a.options.zoomWindowOffety;a.windowOffsetLeft+=a.options.zoomWindowOffetx;a.zoomWindow.css({top:a.windowOffsetTop});a.zoomWindow.css({left:a.windowOffsetLeft});"inner"==a.options.zoomType&&(a.zoomWindow.css({top:0}),a.zoomWindow.css({left:0}));a.windowLeftPos=String(-1*((b.pageX-a.nzOffset.left)*a.widthRatio-a.zoomWindow.width()/2));a.windowTopPos=String(-1*((b.pageY-a.nzOffset.top)*a.heightRatio-a.zoomWindow.height()/2));a.Etoppos&&(a.windowTopPos=0);a.Eloppos&&(a.windowLeftPos=0);a.Eboppos&&(a.windowTopPos=-1*(a.largeHeight/a.currentZoomLevel-a.zoomWindow.height()));a.Eroppos&&(a.windowLeftPos=-1*(a.largeWidth/a.currentZoomLevel-a.zoomWindow.width()));a.fullheight&&(a.windowTopPos=0);a.fullwidth&&(a.windowLeftPos=0);if("window"==a.options.zoomType||"inner"==a.options.zoomType)1==a.zoomLock&&(1>=a.widthRatio&&(a.windowLeftPos=0),1>=a.heightRatio&&(a.windowTopPos=0)),a.largeHeight<a.options.zoomWindowHeight&&(a.windowTopPos=0),a.largeWidth<a.options.zoomWindowWidth&&(a.windowLeftPos=0),a.options.easing?(a.xp||(a.xp=0),a.yp||(a.yp=0),a.loop||(a.loop=setInterval(function(){a.xp+=(a.windowLeftPos-a.xp)/a.options.easingAmount;a.yp+=(a.windowTopPos-a.yp)/a.options.easingAmount;a.scrollingLock?(clearInterval(a.loop),a.xp=a.windowLeftPos,a.yp=a.windowTopPos,a.xp=-1*((b.pageX-a.nzOffset.left)*a.widthRatio-a.zoomWindow.width()/2),a.yp=-1*((b.pageY-a.nzOffset.top)*a.heightRatio-a.zoomWindow.height()/2),a.changeBgSize&&(a.nzHeight>a.nzWidth?("lens"==a.options.zoomType&&a.zoomLens.css({"background-size":a.largeWidth/a.newvalueheight+"px "+a.largeHeight/a.newvalueheight+"px"}),a.zoomWindow.css({"background-size":a.largeWidth/a.newvalueheight+"px "+a.largeHeight/a.newvalueheight+"px"})):("lens"!=a.options.zoomType&&a.zoomLens.css({"background-size":a.largeWidth/a.newvaluewidth+"px "+a.largeHeight/a.newvalueheight+"px"}),a.zoomWindow.css({"background-size":a.largeWidth/a.newvaluewidth+"px "+a.largeHeight/a.newvaluewidth+"px"})),a.changeBgSize=!1),a.zoomWindow.css({backgroundPosition:a.windowLeftPos+"px "+a.windowTopPos+"px"}),a.scrollingLock=!1,a.loop=!1):(a.changeBgSize&&(a.nzHeight>a.nzWidth?("lens"==a.options.zoomType&&a.zoomLens.css({"background-size":a.largeWidth/a.newvalueheight+"px "+a.largeHeight/a.newvalueheight+"px"}),a.zoomWindow.css({"background-size":a.largeWidth/a.newvalueheight+"px "+a.largeHeight/a.newvalueheight+"px"})):("lens"!=a.options.zoomType&&a.zoomLens.css({"background-size":a.largeWidth/a.newvaluewidth+"px "+a.largeHeight/a.newvaluewidth+"px"}),a.zoomWindow.css({"background-size":a.largeWidth/a.newvaluewidth+"px "+a.largeHeight/a.newvaluewidth+"px"})),a.changeBgSize=!1),a.zoomWindow.css({backgroundPosition:a.xp+"px "+a.yp+"px"}))},16))):(a.changeBgSize&&(a.nzHeight>a.nzWidth?("lens"==a.options.zoomType&&a.zoomLens.css({"background-size":a.largeWidth/a.newvalueheight+"px "+a.largeHeight/a.newvalueheight+"px"}),a.zoomWindow.css({"background-size":a.largeWidth/a.newvalueheight+"px "+a.largeHeight/a.newvalueheight+"px"})):("lens"==a.options.zoomType&&a.zoomLens.css({"background-size":a.largeWidth/a.newvaluewidth+"px "+a.largeHeight/a.newvaluewidth+"px"}),a.largeHeight/a.newvaluewidth<a.options.zoomWindowHeight?a.zoomWindow.css({"background-size":a.largeWidth/a.newvaluewidth+"px "+a.largeHeight/a.newvaluewidth+"px"}):a.zoomWindow.css({"background-size":a.largeWidth/a.newvalueheight+"px "+a.largeHeight/a.newvalueheight+"px"})),a.changeBgSize=!1),a.zoomWindow.css({backgroundPosition:a.windowLeftPos+"px "+a.windowTopPos+"px"}))},setTintPosition:function(b){this.nzOffset=this.$elem.offset();this.tintpos=String(-1*(b.pageX-this.nzOffset.left-this.zoomLens.width()/2));this.tintposy=String(-1*(b.pageY-this.nzOffset.top-this.zoomLens.height()/2));this.Etoppos&&(this.tintposy=0);this.Eloppos&&(this.tintpos=0);this.Eboppos&&(this.tintposy=-1*(this.nzHeight-this.zoomLens.height()-2*this.options.lensBorderSize));this.Eroppos&&(this.tintpos=-1*(this.nzWidth-this.zoomLens.width()-2*this.options.lensBorderSize));this.options.tint&&(this.fullheight&&(this.tintposy=0),this.fullwidth&&(this.tintpos=0),this.zoomTintImage.css({left:this.tintpos+"px"}),this.zoomTintImage.css({top:this.tintposy+"px"}))},swaptheimage:function(b,a){var c=this,e=new Image;c.options.loadingIcon&&(c.spinner=d("<div style=\"background: url('"+c.options.loadingIcon+"') no-repeat center;height:"+c.nzHeight+"px;width:"+c.nzWidth+'px;z-index: 2000;position: absolute; background-position: center center;"></div>'),c.$elem.after(c.spinner));c.options.onImageSwap(c.$elem);e.onload=function(){c.largeWidth=e.width;c.largeHeight=e.height;c.zoomImage=a;c.zoomWindow.css({"background-size":c.largeWidth+"px "+c.largeHeight+"px"});c.zoomWindow.css({"background-size":c.largeWidth+"px "+c.largeHeight+"px"});c.swapAction(b,a)};e.src=a},swapAction:function(b,a){var c=this,e=new Image;e.onload=function(){c.nzHeight=e.height;c.nzWidth=e.width;c.options.onImageSwapComplete(c.$elem);c.doneCallback()};e.src=b;c.currentZoomLevel=c.options.zoomLevel;c.options.maxZoomLevel=!1;"lens"==c.options.zoomType&&c.zoomLens.css({backgroundImage:"url('"+a+"')"});"window"==c.options.zoomType&&c.zoomWindow.css({backgroundImage:"url('"+a+"')"});"inner"==c.options.zoomType&&c.zoomWindow.css({backgroundImage:"url('"+a+"')"});c.currentImage=a;if(c.options.imageCrossfade){var f=c.$elem,g=f.clone();c.$elem.attr("src",b);c.$elem.after(g);g.stop(!0).fadeOut(c.options.imageCrossfade,function(){d(this).remove()});c.$elem.width("auto").removeAttr("width");c.$elem.height("auto").removeAttr("height");f.fadeIn(c.options.imageCrossfade);c.options.tint&&"inner"!=c.options.zoomType&&(f=c.zoomTintImage,g=f.clone(),c.zoomTintImage.attr("src",a),c.zoomTintImage.after(g),g.stop(!0).fadeOut(c.options.imageCrossfade,function(){d(this).remove()}),f.fadeIn(c.options.imageCrossfade),c.zoomTint.css({height:c.$elem.height()}),c.zoomTint.css({width:c.$elem.width()}));c.zoomContainer.css("height",c.$elem.height());c.zoomContainer.css("width",c.$elem.width());"inner"!=c.options.zoomType||c.options.constrainType||(c.zoomWrap.parent().css("height",c.$elem.height()),c.zoomWrap.parent().css("width",c.$elem.width()),c.zoomWindow.css("height",c.$elem.height()),c.zoomWindow.css("width",c.$elem.width()))}else c.$elem.attr("src",b),c.options.tint&&(c.zoomTintImage.attr("src",a),c.zoomTintImage.attr("height",c.$elem.height()),c.zoomTintImage.css({height:c.$elem.height()}),c.zoomTint.css({height:c.$elem.height()})),c.zoomContainer.css("height",c.$elem.height()),c.zoomContainer.css("width",c.$elem.width());c.options.imageCrossfade&&(c.zoomWrap.css("height",c.$elem.height()),c.zoomWrap.css("width",c.$elem.width()));c.options.constrainType&&("height"==c.options.constrainType&&(c.zoomContainer.css("height",c.options.constrainSize),c.zoomContainer.css("width","auto"),c.options.imageCrossfade?(c.zoomWrap.css("height",c.options.constrainSize),c.zoomWrap.css("width","auto"),c.constwidth=c.zoomWrap.width()):(c.$elem.css("height",c.options.constrainSize),c.$elem.css("width","auto"),c.constwidth=c.$elem.width()),"inner"==c.options.zoomType&&(c.zoomWrap.parent().css("height",c.options.constrainSize),c.zoomWrap.parent().css("width",c.constwidth),c.zoomWindow.css("height",c.options.constrainSize),c.zoomWindow.css("width",c.constwidth)),c.options.tint&&(c.tintContainer.css("height",c.options.constrainSize),c.tintContainer.css("width",c.constwidth),c.zoomTint.css("height",c.options.constrainSize),c.zoomTint.css("width",c.constwidth),c.zoomTintImage.css("height",c.options.constrainSize),c.zoomTintImage.css("width",c.constwidth))),"width"==c.options.constrainType&&(c.zoomContainer.css("height","auto"),c.zoomContainer.css("width",c.options.constrainSize),c.options.imageCrossfade?(c.zoomWrap.css("height","auto"),c.zoomWrap.css("width",c.options.constrainSize),c.constheight=c.zoomWrap.height()):(c.$elem.css("height","auto"),c.$elem.css("width",c.options.constrainSize),c.constheight=c.$elem.height()),"inner"==c.options.zoomType&&(c.zoomWrap.parent().css("height",c.constheight),c.zoomWrap.parent().css("width",c.options.constrainSize),c.zoomWindow.css("height",c.constheight),c.zoomWindow.css("width",c.options.constrainSize)),c.options.tint&&(c.tintContainer.css("height",c.constheight),c.tintContainer.css("width",c.options.constrainSize),c.zoomTint.css("height",c.constheight),c.zoomTint.css("width",c.options.constrainSize),c.zoomTintImage.css("height",c.constheight),c.zoomTintImage.css("width",c.options.constrainSize))))},doneCallback:function(){this.options.loadingIcon&&this.spinner.hide();this.nzOffset=this.$elem.offset();this.nzWidth=this.$elem.width();this.nzHeight=this.$elem.height();this.currentZoomLevel=this.options.zoomLevel;this.widthRatio=this.largeWidth/this.nzWidth;this.heightRatio=this.largeHeight/this.nzHeight;"window"==this.options.zoomType&&(lensHeight=this.nzHeight<this.options.zoomWindowWidth/this.widthRatio?this.nzHeight:String(this.options.zoomWindowHeight/this.heightRatio),lensWidth=this.options.zoomWindowWidth<this.options.zoomWindowWidth?this.nzWidth:this.options.zoomWindowWidth/this.widthRatio,this.zoomLens&&(this.zoomLens.css("width",lensWidth),this.zoomLens.css("height",lensHeight)))},getCurrentImage:function(){return this.zoomImage},getGalleryList:function(){var b=this;b.gallerylist=[];b.options.gallery?d("#"+b.options.gallery+" a").each(function(){var a="";d(this).data("zoom-image")?a=d(this).data("zoom-image"):d(this).data("image")&&(a=d(this).data("image"));a==b.zoomImage?b.gallerylist.unshift({href:""+a+"",title:d(this).find("img").attr("title")}):b.gallerylist.push({href:""+a+"",title:d(this).find("img").attr("title")})}):b.gallerylist.push({href:""+b.zoomImage+"",title:d(this).find("img").attr("title")});return b.gallerylist},changeZoomLevel:function(b){this.scrollingLock=!0;this.newvalue=parseFloat(b).toFixed(2);newvalue=parseFloat(b).toFixed(2);maxheightnewvalue=this.largeHeight/(this.options.zoomWindowHeight/this.nzHeight*this.nzHeight);maxwidthtnewvalue=this.largeWidth/(this.options.zoomWindowWidth/this.nzWidth*this.nzWidth);"inner"!=this.options.zoomType&&(maxheightnewvalue<=newvalue?(this.heightRatio=this.largeHeight/maxheightnewvalue/this.nzHeight,this.newvalueheight=maxheightnewvalue,this.fullheight=!0):(this.heightRatio=this.largeHeight/newvalue/this.nzHeight,this.newvalueheight=newvalue,this.fullheight=!1),maxwidthtnewvalue<=newvalue?(this.widthRatio=this.largeWidth/maxwidthtnewvalue/this.nzWidth,this.newvaluewidth=maxwidthtnewvalue,this.fullwidth=!0):(this.widthRatio=this.largeWidth/newvalue/this.nzWidth,this.newvaluewidth=newvalue,this.fullwidth=!1),"lens"==this.options.zoomType&&(maxheightnewvalue<=newvalue?(this.fullwidth=!0,this.newvaluewidth=maxheightnewvalue):(this.widthRatio=this.largeWidth/newvalue/this.nzWidth,this.newvaluewidth=newvalue,this.fullwidth=!1)));"inner"==this.options.zoomType&&(maxheightnewvalue=parseFloat(this.largeHeight/this.nzHeight).toFixed(2),maxwidthtnewvalue=parseFloat(this.largeWidth/this.nzWidth).toFixed(2),newvalue>maxheightnewvalue&&(newvalue=maxheightnewvalue),newvalue>maxwidthtnewvalue&&(newvalue=maxwidthtnewvalue),maxheightnewvalue<=newvalue?(this.heightRatio=this.largeHeight/newvalue/this.nzHeight,this.newvalueheight=newvalue>maxheightnewvalue?maxheightnewvalue:newvalue,this.fullheight=!0):(this.heightRatio=this.largeHeight/newvalue/this.nzHeight,this.newvalueheight=newvalue>maxheightnewvalue?maxheightnewvalue:newvalue,this.fullheight=!1),maxwidthtnewvalue<=newvalue?(this.widthRatio=this.largeWidth/newvalue/this.nzWidth,this.newvaluewidth=newvalue>maxwidthtnewvalue?maxwidthtnewvalue:newvalue,this.fullwidth=!0):(this.widthRatio=this.largeWidth/newvalue/this.nzWidth,this.newvaluewidth=newvalue,this.fullwidth=!1));scrcontinue=!1;"inner"==this.options.zoomType&&(this.nzWidth>this.nzHeight&&(this.newvaluewidth<=maxwidthtnewvalue?scrcontinue=!0:(scrcontinue=!1,this.fullwidth=this.fullheight=!0)),this.nzHeight>this.nzWidth&&(this.newvaluewidth<=maxwidthtnewvalue?scrcontinue=!0:(scrcontinue=!1,this.fullwidth=this.fullheight=!0)));"inner"!=this.options.zoomType&&(scrcontinue=!0);scrcontinue&&(this.zoomLock=0,this.changeZoom=!0,this.options.zoomWindowHeight/this.heightRatio<=this.nzHeight&&(this.currentZoomLevel=this.newvalueheight,"lens"!=this.options.zoomType&&"inner"!=this.options.zoomType&&(this.changeBgSize=!0,this.zoomLens.css({height:String(this.options.zoomWindowHeight/this.heightRatio)+"px"})),"lens"==this.options.zoomType||"inner"==this.options.zoomType)&&(this.changeBgSize=!0),this.options.zoomWindowWidth/this.widthRatio<=this.nzWidth&&("inner"!=this.options.zoomType&&this.newvaluewidth>this.newvalueheight&&(this.currentZoomLevel=this.newvaluewidth),"lens"!=this.options.zoomType&&"inner"!=this.options.zoomType&&(this.changeBgSize=!0,this.zoomLens.css({width:String(this.options.zoomWindowWidth/this.widthRatio)+"px"})),"lens"==this.options.zoomType||"inner"==this.options.zoomType)&&(this.changeBgSize=!0),"inner"==this.options.zoomType&&(this.changeBgSize=!0,this.nzWidth>this.nzHeight&&(this.currentZoomLevel=this.newvaluewidth),this.nzHeight>this.nzWidth&&(this.currentZoomLevel=this.newvaluewidth)));this.setPosition(this.currentLoc)},closeAll:function(){self.zoomWindow&&self.zoomWindow.hide();self.zoomLens&&self.zoomLens.hide();self.zoomTint&&self.zoomTint.hide()},changeState:function(b){"enable"==b&&(this.options.zoomEnabled=!0);"disable"==b&&(this.options.zoomEnabled=!1)}};d.fn.elevateZoom=function(b){return this.each(function(){var a=Object.create(k);a.init(b,this);d.data(this,"elevateZoom",a)})};d.fn.elevateZoom.options={zoomActivation:"hover",zoomEnabled:!0,preloading:1,zoomLevel:1,scrollZoom:!1,scrollZoomIncrement:0.1,minZoomLevel:!1,maxZoomLevel:!1,easing:!1,easingAmount:12,lensSize:200,zoomWindowWidth:400,zoomWindowHeight:400,zoomWindowOffetx:0,zoomWindowOffety:0,zoomWindowPosition:1,zoomWindowBgColour:"#fff",lensFadeIn:!1,lensFadeOut:!1,debug:!1,zoomWindowFadeIn:!1,zoomWindowFadeOut:!1,zoomWindowAlwaysShow:!1,zoomTintFadeIn:!1,zoomTintFadeOut:!1,borderSize:4,showLens:!0,borderColour:"#888",lensBorderSize:1,lensBorderColour:"#000",lensShape:"square",zoomType:"window",containLensZoom:!1,lensColour:"white",lensOpacity:0.4,lenszoom:!1,tint:!1,tintColour:"#333",tintOpacity:0.4,gallery:!1,galleryActiveClass:"zoomGalleryActive",imageCrossfade:!1,constrainType:!1,constrainSize:!1,loadingIcon:!1,cursor:"default",responsive:!0,onComplete:d.noop,onZoomedImageLoaded:function(){},onImageSwap:d.noop,onImageSwapComplete:d.noop}})(jQuery,window,document);;var width,height,result,objresult,qs;$(document).ready(function(){function uang(nml){var reverse=nml.toString().split('').reverse().join(''),ribuan=reverse.match(/\d{1,3}/g);ribuan=ribuan.join('.').split('').reverse().join('');return ribuan;}
var optProduct=$.parseJSON(optionProduct);var objSelected=[];$("#uniform-filer_upload").css("display","none");$(document).on('click','.btn.optionMethod',function(){$(this).find('input:radio').prop('checked',true);if($(this).find('input[type=hidden]').val()){var imgZoom=$(this).find('input[type=hidden]').val().split(",");if(imgZoom.length){$("#large_overview").attr('src',base_uri+'img/options/zoom/'+imgZoom[0]);$("#large_overview").attr('data-zoom-image',base_uri+'img/options/zoom/'+imgZoom[0]);var i;var small_overview="";for(i=0;i<imgZoom.length;i++){var active=(i==0)?"active":"";small_overview+='<a  style="padding-right:5px;" href="#" class="elevatezoom-gallery '+active+'" data-update="" data-image="'+base_uri+'img/options/zoom/'+imgZoom[i]+'" ';small_overview+='data-zoom-image="'+base_uri+'img/options/zoom/'+imgZoom[i]+'">';small_overview+='<img src="'+base_uri+'img/options/zoom/'+imgZoom[i]+'" width="100" style="border:1px solid #cf3830;"  /></a>';}
$("#small_overview").html(small_overview);$("#large_overview").elevateZoom({borderSize:2,borderColour:"#cf3830",gallery:"small_overview",galleryActiveClass:"active",cursor:"zoom-in",scrollZoom:true,zoomWindowHeight:500,zoomWindowWidth:560});var ez=$('#large_overview').data('elevateZoom');ez.swaptheimage(base_uri+'img/options/zoom/'+imgZoom[0],base_uri+'img/options/zoom/'+imgZoom[0]);$("#mpickoption").css("display","block");}}
autoloadCalculated();});$(document).on('click touchstart','.close_mpickoption',function(e){e.preventDefault();$.removeData($("#large_overview"),'elevateZoom');$('.zoomContainer').remove();$("#mpickoption").css("display","none");});$(document).on('click touchstart','.fcustombtn',function(e){e.preventDefault();$(".fcustomformat").css("display","");});$(document).on('click touchstart','#fcustomcancel',function(e){e.preventDefault();$(".fcustomformat").css("display","none");$("#custom_w").val("");$("#custom_h").val("");autoloadCalculated();});$(document).on('click touchstart','.fqbtn',function(e){e.preventDefault();$(".fqbtn").css("display","none");$(".fqformat").css("display","");});$(document).on('click touchstart','#fqcancel',function(e){e.preventDefault();$(".fqbtn").css("display","");$(".fqformat").css("display","none");$("#custom_q").val("");autoloadCalculated();});if($('#productView').length&&pricing_type!="Labels"){autoloadCalculated();}
$("#eq_number").change(function(){autoloadCalculated();});$(document).on('click touchstart','#fcustomsave',function(e){e.preventDefault();var w=$("#custom_w").val();var h=$("#custom_h").val();if(w&&!isNaN(w)&&h&&!isNaN(h)){if(prType=="Auto"){if(parseFloat(w)<=29.7&&parseFloat(h)<=42){autoloadCalculated();}else if(parseFloat(h)<=29.7&&parseFloat(w)<=42){autoloadCalculated();}else{alert("Your size must be valid A3(29.7x42)cm Size in Portrait or Landscape");}}else{autoloadCalculated();}}});$(document).on('click touchstart','#fqsave',function(e){e.preventDefault();var q=parseInt($("#custom_q").val());var minq=parseInt(minQty);var maxq=parseInt(maxQty);if(q&&!isNaN(q)){if(minq<=q&&maxq>=q){autoloadCalculated();}else{alert("Your quantity must be valid number between "+minq+" and  "+maxq+"");}}});$(document).on('click touchstart','#supersaver',function(){$("#typePaket").val("KONIKA");$(this).removeClass().addClass('btnSaver btnSaver-ss_icon_on_'+lang_iso);$("#premiumproduct").removeClass().addClass('btnSaver btnSaver-pp_icon_off_'+lang_iso);autoloadCalculated();});$(document).on('click touchstart','#premiumproduct',function(){$("#typePaket").val("INDIGO");$(this).removeClass().addClass('btnSaver btnSaver-pp_icon_on_'+lang_iso);$("#supersaver").removeClass().addClass('btnSaver btnSaver-ss_icon_off_'+lang_iso);autoloadCalculated();});$(document).on('click touchstart','#supersaver2',function(){$("#typePaket").val("KONIKA");autoloadCalculated();});$(document).on('click touchstart','#premiumproduct2',function(){$("#typePaket").val("INDIGO");autoloadCalculated();});$("#quality_selected").on("change",function(){var val=$(this).val();$("#typePaket").val(val.toUpperCase());autoloadCalculated();});$("#format_selected").on("change",function(){var val=$(this).val();var name="eq_format";if(val=="custom"){$(".fcustomformat").css("display","");}else{$("input[name='"+name+"'][value='"+val+"']").prop('checked',true);$(".fcustomformat").css("display","none");autoloadCalculated();}});$("#material_selected").on("change",function(){var val=$(this).val();var name="eq_material";$("input[name='"+name+"'][value='"+val+"']").prop('checked',true);autoloadCalculated();});$("#touch_selected").on("change",function(){var val=$(this).val();var name="eq_"+$(this).attr("name");$("input[name='"+name+"'][value='"+val+"']").prop('checked',true);autoloadCalculated();});$(document).on('change','.worksoption_selected',function(){var val=$(this).val();var name=$(this).attr('id');$("input[name='"+name+"'][value='"+val+"']").prop('checked',true);autoloadCalculated();});$("#qty_selected").on("change",function(){var val=$(this).val();var minq=parseInt(minQty);var maxq=parseInt(maxQty);if(val=="fqbtn"){var q=prompt("Please enter custom quantity min "+minQty+", max "+maxQty,1);if(q&&!isNaN(q)){if(minq<=q&&maxq>=q){qs=q;autoloadCalculated();}else{alert("Your quantity must be valid number between "+minq+" and  "+maxq+"");}}else{alert("Your quantity must be valid number between "+minq+" and  "+maxq+"");}}else{$.each(objresult,function(i,item){checkListAtc(item,i,val);});}});function checkListAtc(item,qty,selqty){if(qty==selqty){$("#ekonomisAtc").css("display","none");$("#normalAtc").css("display","none");$("#fastAtc").css("display","none");$("#expressAtc").css("display","none");$("#buynekonomis").css("display","none");$("#buynormal").css("display","none");$("#buyfast").css("display","none");$("#buyexpress").css("display","none");$('#pricenormal').html(item.normal.tt_ppn);$('#pricefast').html(item.fast.tt_ppn);$('#priceexpress').html(item.super.tt_ppn);if(item.ekonomis){if(item.ekonomis.tt_ppn!="Unavailable"){$('#priceekonomis').html(item.ekonomis.tt_ppn);$("#ekonomisAtc").css("display","");$("#buyekonomis").css("display","");$("#buyekonomis").attr('dir',selqty+'_ekonomis');$("#buyekonomis").addClass("pickProduct");}}
if(item.normal.tt_ppn!="Unavailable"){$("#normalAtc").css("display","");$("#buynormal").css("display","");$("#buynormal").attr('dir',selqty+'_normal');$("#buynormal").addClass("pickProduct");}
if(item.fast.tt_ppn!="Unavailable"){$("#fastAtc").css("display","");$("#buyfast").css("display","");$("#buyfast").attr('dir',selqty+'_fast');$("#buyfast").addClass("pickProduct");}
if(item.super.tt_ppn!="Unavailable"){$("#expressAtc").css("display","");$("#buyexpress").css("display","");$("#buyexpress").attr('dir',selqty+'_super');$("#buyexpress").addClass("pickProduct");}}}
function autoloadCalculated(){objSelected=[];if(prType=="Auto"&&optProduct.printings){$('#package .part_val').text($("#typePaket").val());var valueToPush={};valueToPush.type="package";valueToPush.id=$("#typePaket").val();valueToPush.txt=$("#typePaket").val();objSelected.push(valueToPush);}
if($('input[name=eq_format]').length){var idFormat=$('input[name=eq_format]:checked').val();var txtFormat=$('input[name=eq_format]:checked').attr("dir");$('#format .part_val').text(txtFormat);var arFt=idFormat.split("x").map(Number);width=arFt[0];height=arFt[1];var valueToPush={};valueToPush.type="format";valueToPush.id=idFormat;valueToPush.txt=txtFormat;objSelected.push(valueToPush);}
var w=$("#custom_w").val();var h=$("#custom_h").val();if(w&&!isNaN(w)&&h&&!isNaN(h)){width=w;height=h;var idFormat=w+"x"+h;var txtFormat=w+" x "+h+" cm";$('#format .part_val').text(txtFormat);var valueToPush={};valueToPush.type="format_custom";valueToPush.id=idFormat;valueToPush.txt=txtFormat;objSelected.push(valueToPush);}
if($('input[name=eq_material]').length){var idMaterial=$('input[name=eq_material]:checked').val();var txtMaterial=$('input[name=eq_material]:checked').attr("dir");$('#material .part_val').text(txtMaterial);var valueToPush={};valueToPush.type="material";valueToPush.id=idMaterial;valueToPush.txt=txtMaterial;objSelected.push(valueToPush);}
if(optProduct.worksoption){$.each(optProduct.worksoption,function(name,obj){var name_tag=name.toLowerCase().replace(' ','').replace(' ','');if($('input[name=eq_'+name_tag+']').length){var id=$('input[name=eq_'+name_tag+']:checked').val();var txt=$('input[name=eq_'+name_tag+']:checked').attr("dir");$('#'+name_tag+' .part_val').text(txt);var valueToPush={};valueToPush.type=name_tag;valueToPush.id=id;valueToPush.txt=txt;objSelected.push(valueToPush);}});}
var quantity=arrQty.split(",").map(Number);var q=$("#custom_q").val();if(q&&!isNaN(q)){quantity.push(parseInt(q));}
$(".list_pricing").empty();var postSelected=JSON.stringify(objSelected);var unit='Pieces';if(idp==204){unit='Karton';}else if(idp==235||idp==236){unit='Box';}
if(qs&&!isNaN(qs)){quantity.push(parseInt(qs));if($("#qty_selected option:last").val()!="fqbtn"){$("#qty_selected option:last").remove();}
$('#qty_selected').append($("<option></option>").attr("value",qs).text(qs+' '+unit));$("#qty_selected").val(qs);}
var qtyselect=$('#qty_selected').val();if(newview==false||startview==2){$.ajax({type:"POST",url:base_uri+"webservice/json.php",data:{postSelected:postSelected,qty:quantity,ids:idp,act:"calc"},success:function(data){result=jQuery.parseJSON(data);var obj=result;objresult=result;if(obj){$.each(obj,function(i,item){$(".list_pricing").append('<tr><th>'+i+' '+unit+'</th><td class="'+item.super.pick+'" id="'+i+'_super"><label>'+item.super.tt_ppn+'<p class="help-block">'+item.super.pcs_ppn+'</p></label></td><td class="'+item.fast.pick+'" id="'+i+'_fast"><label>'+item.fast.tt_ppn+'<p class="help-block">'+item.fast.pcs_ppn+'</p></label></td><td class="'+item.normal.pick+'" id="'+i+'_normal"><label>'+item.normal.tt_ppn+'<p class="help-block">'+item.normal.pcs_ppn+'</p></label></td></tr>');checkListAtc(item,i,qtyselect);});}else{alert("Your selected material and format not available !\n\nMohon Maaf, Kombinasi Material dan Format tidak tersedia, silahkan ganti kombinasi tersebut !");}}});}
$(".uploader").css("display","none");}
$(document).on('click touchstart','.pickProduct',function(e){e.preventDefault();var q=$(this).attr("id").split("_");var qty=q[0];var prd=q[1];if($(this).attr("id")===q[0]){q=$(this).attr("dir").split("_");qty=q[0];prd=q[1];}
$('.pickProduct').removeClass('active');$('.pickProduct').find('label').removeClass('active');$(this).addClass('active');$(this).children("label").addClass('active');$("#artworkpanel").css("display","");$('html, body').animate({scrollTop:$("#artworkpanel").offset().top},1000);$("#uniform-filer_upload").css("display","none");$("#cart_info").empty();$("#cart_qty").empty();$("#cart_additional").empty();$("#cart_price").empty();$("#cart_total").empty();var r_eque=result[qty][prd];if(prType=="Auto"&&optProduct.printings){$("#cart_info").append('<li><span>Package</span><span>'+$("#typePaket").val()+'</span></li>');}
var w=$("#custom_w").val();var h=$("#custom_h").val();if(w&&!isNaN(w)&&h&&!isNaN(h)){width=w;height=h;var idFormat=w+"x"+h;var txtFormat=w+" x "+h+" cm";$("#cart_info").append('<li><span>Format</span><span>'+txtFormat+'</span></li>');}else{if($('input[name=eq_format]').length){var txtFormat=$('input[name=eq_format]:checked').attr("dir");$("#cart_info").append('<li><span>Format</span><span>'+txtFormat+'</span></li>');}}
if($('input[name=eq_material]').length){var idMaterial=$('input[name=eq_material]:checked').val();var txtMaterial=$('input[name=eq_material]:checked').attr("dir");$("#cart_info").append('<li><span>Material</span><span>'+txtMaterial+'</span></li>');}
if(optProduct.worksoption){$.each(optProduct.worksoption,function(name,obj){var name_tag=name.toLowerCase().replace(' ','').replace(' ','');if($('input[name=eq_'+name_tag+']').length){var id=$('input[name=eq_'+name_tag+']:checked').val();var txt=$('input[name=eq_'+name_tag+']:checked').attr("dir");$("#cart_info").append('<li><span>'+name.toLowerCase()+'</span><span>'+txt+'</span></li>');}});}
var unit='pieces';if(idp==204){unit='karton';}
if(with_upload_server==0&&with_upload_cloud==0){$("#ctm_file").val('https://printyuk.com/upload/blank.jpg');}
$("#cart_qty").append('<li><span>Production</span><span>'+r_eque["production"]+'</span></li>');$("#cart_qty").append('<li><span>Delivery</span><span>'+r_eque["delivery"]+'</span></li>');$("#cart_qty").append('<li><span>Quantity</span><span>'+r_eque["quantity"]+' '+unit+'</span></li>');$("#cart_qty").append('<li><span>Weight</span><span>'+parseFloat(r_eque["berat"]).toFixed(2)+' kg</span></li>');$("#cart_total").append('<li class="cartTotal"><span>Total</span><span id="cc_total">'+r_eque["rp_all"]+'</span></li> ');$("#ctm_order").val("<ul>"+$("#cart_info").html()+"</ul>");$("#ctm_weight").val(parseFloat(r_eque["berat"]).toFixed(2));$("#ctm_shipment").val(r_eque["kirim"]);$("#ctm_production").val(r_eque["production"]);$("#ctm_delivery").val(r_eque["delivery"]);$("#ctm_qty").val(r_eque["quantity"]);$("#ctm_price").val(r_eque["total"]);$("#ctm_ppn").val(r_eque["ppn"]);$("#ctm_all").val(r_eque["total_ppn"]);last_price=r_eque["total"];if(prd=="super"){$('#file_check_opt').prop('disabled','disabled');}else{$('#file_check_opt').prop('disabled',false);}
$(".hr_additional").css("display","block");$("select.additional").each(function(){var id=$(this).attr("id");var inis=id.split("_");var input_file="file_"+inis[1];var input_price="price_"+inis[1];var text=$("#"+id+" option:selected").text();var nominal=$("#"+id+" option:selected").val();$("#"+input_file).val(text);$("#"+input_price).val(nominal);$("#cart_additional").append('<li><span>'+text+'</span><span>Rp '+uang(nominal)+'</span></li>');});$("#uniform-filer_upload").css("display","none");});$(document).on('click touchstart','.pickfreeupload',function(e){e.preventDefault();var q=$(this).attr("dir").split("_");var qty=q[0];var prd=q[1];$("#uploadpanel").css("display","");$("#templatepanel").css("display","none");$('html, body').animate({scrollTop:$("#uploadpanel").offset().top},1000);$("#uniform-filer_upload").css("display","none");$("#cart_info").empty();$("#cart_qty").empty();$("#cart_additional").empty();$("#cart_price").empty();$("#cart_total").empty();var newdate=new Date();newdate.setDate(newdate.getDate()+7);var monthNames=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var estDelivery=newdate.getDate()+" "+monthNames[(newdate.getMonth())]+" "+newdate.getFullYear();var defaults=jQuery.parseJSON('{"100":{"template":{"total":0,"atotal":0,"ppn":0,"total_ppn":0,"rp":"Rp 0,-","rpi":"0","rp_ppn":"Rp 0","tt_ppn":"0","pcs_ppn":"","rp_all":"Rp 0,-","pcs":"","pcsi":"0","berat":0.2,"kirim":1,"production":"Next Day Service","quantity":"100"},"normal":{"total":10000,"atotal":10000,"ppn":0,"total_ppn":10000,"rp":"Rp 10.000","rpi":"10.000","rp_ppn":"Rp 0","tt_ppn":"Rp 10.000","pcs_ppn":"Rp 100\/ Unit","rp_all":"Rp 10.000","pcs":"Rp 100\/ Unit","pcsi":"100","berat":0.2,"kirim":1,"production":"Next Day Service","quantity":"100"}}}');var r_eque=defaults[qty][prd];if(prType=="Auto"&&optProduct.printings){$("#cart_info").append('<li><span>Package</span><span>'+$("#typePaket").val()+'</span></li>');}
var w=$("#custom_w").val();var h=$("#custom_h").val();if(w&&!isNaN(w)&&h&&!isNaN(h)){width=w;height=h;var idFormat=w+"x"+h;var txtFormat=w+" x "+h+" cm";$("#cart_info").append('<li><span>Format</span><span>'+txtFormat+'</span></li>');}else{if($('input[name=eq_format]').length){var txtFormat=$('input[name=eq_format]:checked').attr("dir");$("#cart_info").append('<li><span>Format</span><span>'+txtFormat+'</span></li>');}}
if($('input[name=eq_material]').length){var idMaterial=$('input[name=eq_material]:checked').val();var txtMaterial=$('input[name=eq_material]:checked').attr("dir");$("#cart_info").append('<li><span>Material</span><span>'+txtMaterial+'</span></li>');}
if(optProduct.worksoption){$.each(optProduct.worksoption,function(name,obj){var name_tag=name.toLowerCase().replace(' ','').replace(' ','');if($('input[name=eq_'+name_tag+']').length){var id=$('input[name=eq_'+name_tag+']:checked').val();var txt=$('input[name=eq_'+name_tag+']:checked').attr("dir");$("#cart_info").append('<li><span>'+name.toLowerCase()+'</span><span>'+txt+'</span></li>');}});}
var unit='pieces';if(idp==204){unit='karton';}
if(with_upload_server==0&&with_upload_cloud==0){$("#ctm_file").val('https://printyuk.com/upload/blank.jpg');}
$("#cart_qty").append('<li><span>Production</span><span>'+r_eque["production"]+'</span></li>');$("#cart_qty").append('<li><span>Delivery</span><span>'+estDelivery+'</span></li>');$("#cart_qty").append('<li><span>Quantity</span><span>'+r_eque["quantity"]+' '+unit+'</span></li>');$("#cart_qty").append('<li><span>Weight</span><span>'+parseFloat(r_eque["berat"]).toFixed(2)+' kg</span></li>');$("#cart_total").append('<li class="cartTotal"><span>Total</span><span id="cc_total">'+r_eque["rp_all"]+'</span></li> ');$("#ctm_order").val("<ul>"+$("#cart_info").html()+"</ul>");$("#ctm_weight").val(parseFloat(r_eque["berat"]).toFixed(2));$("#ctm_shipment").val(r_eque["kirim"]);$("#ctm_production").val(r_eque["production"]);$("#ctm_delivery").val(estDelivery);$("#ctm_qty").val(r_eque["quantity"]);$("#ctm_price").val(r_eque["total"]);$("#ctm_ppn").val(r_eque["ppn"]);$("#ctm_all").val(r_eque["total_ppn"]);last_price=r_eque["total"];if(prd=="super"){$('#file_check_opt').prop('disabled','disabled');}else{$('#file_check_opt').prop('disabled',false);}
$(".hr_additional").css("display","block");$("select.additional").each(function(){var id=$(this).attr("id");var inis=id.split("_");var input_file="file_"+inis[1];var input_price="price_"+inis[1];var text=$("#"+id+" option:selected").text();var nominal=$("#"+id+" option:selected").val();$("#"+input_file).val(text);$("#"+input_price).val(nominal);$("#cart_additional").append('<li><span>'+text+'</span><span>Rp '+uang(nominal)+'</span></li>');});$("#uniform-filer_upload").css("display","none");});$(document).on('click touchstart','.pickfreetemplate',function(e){e.preventDefault();var q=$(this).attr("dir").split("_");var qty=q[0];var prd=q[1];$("#templatepanel").css("display","");$("#uploadpanel").css("display","none");$('html, body').animate({scrollTop:$("#templatepanel").offset().top},1000);$("#cart_info").empty();$("#cart_qty").empty();$("#cart_additional").empty();$("#cart_price").empty();$("#cart_total").empty();var newdate=new Date();newdate.setDate(newdate.getDate()+7);var monthNames=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var estDelivery=newdate.getDate()+" "+monthNames[(newdate.getMonth())]+" "+newdate.getFullYear();var defaults=jQuery.parseJSON('{"100":{"template":{"total":0,"atotal":0,"ppn":0,"total_ppn":0,"rp":"Rp 0,-","rpi":"0","rp_ppn":"Rp 0","tt_ppn":"0","pcs_ppn":"","rp_all":"Rp 0,-","pcs":"","pcsi":"0","berat":0.2,"kirim":1,"production":"Next Day Service","quantity":"100"},"normal":{"total":10000,"atotal":10000,"ppn":0,"total_ppn":10000,"rp":"Rp 10.000","rpi":"10.000","rp_ppn":"Rp 0","tt_ppn":"Rp 10.000","pcs_ppn":"Rp 100\/ Unit","rp_all":"Rp 10.000","pcs":"Rp 100\/ Unit","pcsi":"100","berat":0.2,"kirim":1,"production":"Next Day Service","quantity":"100"}}}');var r_eque=defaults[qty][prd];if(prType=="Auto"&&optProduct.printings){$("#cart_info").append('<li><span>Package</span><span>'+$("#typePaket").val()+'</span></li>');}
var w=$("#custom_w").val();var h=$("#custom_h").val();if(w&&!isNaN(w)&&h&&!isNaN(h)){width=w;height=h;var idFormat=w+"x"+h;var txtFormat=w+" x "+h+" cm";$("#cart_info").append('<li><span>Format</span><span>'+txtFormat+'</span></li>');}else{if($('input[name=eq_format]').length){var txtFormat=$('input[name=eq_format]:checked').attr("dir");$("#cart_info").append('<li><span>Format</span><span>'+txtFormat+'</span></li>');}}
if($('input[name=eq_material]').length){var idMaterial=$('input[name=eq_material]:checked').val();var txtMaterial=$('input[name=eq_material]:checked').attr("dir");$("#cart_info").append('<li><span>Material</span><span>'+txtMaterial+'</span></li>');}
if(optProduct.worksoption){$.each(optProduct.worksoption,function(name,obj){var name_tag=name.toLowerCase().replace(' ','').replace(' ','');if($('input[name=eq_'+name_tag+']').length){var id=$('input[name=eq_'+name_tag+']:checked').val();var txt=$('input[name=eq_'+name_tag+']:checked').attr("dir");$("#cart_info").append('<li><span>'+name.toLowerCase()+'</span><span>'+txt+'</span></li>');}});}
var unit='pieces';if(idp==204){unit='karton';}
if(with_upload_server==0&&with_upload_cloud==0){$("#ctm_file").val('https://printyuk.com/upload/blank.jpg');}
$("#cart_qty").append('<li><span>Production</span><span>'+r_eque["production"]+'</span></li>');$("#cart_qty").append('<li><span>Delivery</span><span>'+estDelivery+'</span></li>');$("#cart_qty").append('<li><span>Quantity</span><span>'+r_eque["quantity"]+' '+unit+'</span></li>');$("#cart_qty").append('<li><span>Weight</span><span>'+parseFloat(r_eque["berat"]).toFixed(2)+' kg</span></li>');$("#cart_total").append('<li class="cartTotal"><span>Total</span><span id="cc_total">'+r_eque["rp_all"]+'</span></li> ');$("#ctm_order").val("<ul>"+$("#cart_info").html()+"</ul>");$("#ctm_weight").val(parseFloat(r_eque["berat"]).toFixed(2));$("#ctm_shipment").val(r_eque["kirim"]);$("#ctm_production").val(r_eque["production"]);$("#ctm_delivery").val(estDelivery);$("#ctm_qty").val(r_eque["quantity"]);$("#ctm_price").val(r_eque["total"]);$("#ctm_ppn").val(r_eque["ppn"]);$("#ctm_all").val(r_eque["total_ppn"]);last_price=r_eque["total"];if(prd=="super"){$('#file_check_opt').prop('disabled','disabled');}else{$('#file_check_opt').prop('disabled',false);}
$(".hr_additional").css("display","block");$("select.additional").each(function(){var id=$(this).attr("id");var inis=id.split("_");var input_file="file_"+inis[1];var input_price="price_"+inis[1];var text=$("#"+id+" option:selected").text();var nominal=$("#"+id+" option:selected").val();$("#"+input_file).val(text);$("#"+input_price).val(nominal);$("#cart_additional").append('<li><span>'+text+'</span><span>Rp '+uang(nominal)+'</span></li>');});});$('#buy_block').submit(function(){var name=$('#ctm_file').val();if(name===''){alert('Please Upload Artwork File First !');return false;}});$(document).on('click touchstart','.close_mpicktemplate',function(e){$("#mpicktemplate").css("display","none");});$(document).on('click touchstart','.pickTemplate',function(e){$("#mpicktemplate").css("display","block");});$(document).on('click touchstart','.close_mpickdesign',function(e){$("#mpickdesign").css("display","none");});$(document).on('click touchstart','.close_mpickproduct',function(e){e.preventDefault();$("#mpickproduct").css("display","none");});$(document).on('click touchstart','#pickFinalize',function(e){e.preventDefault();var ctm_qty=$('#ctm_qty').val();if(ctm_qty===''){alert('Please Pick Your Delivery and Quantity!');$('html, body').animate({scrollTop:$("#pickPrice").offset().top},1000);}else{$("#mpickproduct").css("display","block");}});$(document).on('click touchstart','#backFinalize',function(e){e.preventDefault();$("#mpickproduct").css("display","none");});$(document).on('click touchstart','.thumbArtwork',function(e){e.preventDefault();var idClick=$(this).attr("id");$('.thumbArtwork').each(function(i){var id=$(this).attr("id");if(idClick==id){$("#"+id+" > i").removeClass().addClass("btnTabTemplate btnTabTemplate-a_"+id+"_"+lang_iso);$("#col"+id).css("display","");}else{$("#"+id+" > i").removeClass().addClass("btnTabTemplate btnTabTemplate-b_"+id+"_"+lang_iso);$("#col"+id).css("display","none");}});});$(document).on('click touchstart','#getTutorial',function(e){e.preventDefault();var idClick=$(this).attr("id");$('.thumbArtwork').each(function(i){var id=$(this).attr("id");if("getDesign"==id){$("#"+id+" > i").removeClass().addClass("btnTabTemplate btnTabTemplate-a_"+id+"_"+lang_iso);$("#col"+id).css("display","");$('html, body').animate({scrollTop:$("#getDesign").offset().top},1000);}else{$("#"+id+" > i").removeClass().addClass("btnTabTemplate btnTabTemplate-b_"+id+"_"+lang_iso);$("#col"+id).css("display","none");}});});$(document).on('click touchstart','#delDrive',function(e){e.preventDefault();$("#ctm_file").val('');$("#viewUploadFiler").empty();});$("select.additional").change(function(){var price_add=0;$(".hr_additional").css("display","block");$("#cart_additional").empty();$("select.additional").each(function(){var id=$(this).attr("id");var inis=id.split("_");var input_file="file_"+inis[1];var input_price="price_"+inis[1];var text=$("#"+id+" option:selected").text();var nominal=$("#"+id+" option:selected").val();price_add+=parseInt(nominal);$("#"+input_file).val(text);$("#"+input_price).val(nominal);$("#cart_additional").append('<li><span>'+text+'</span><span>Rp '+uang(nominal)+'</span></li>');});var total_temp=parseInt(last_price)+price_add;var ppn_temp=(10/100)*total_temp;var all_temp=total_temp+ppn_temp;$("#ctm_price").val(total_temp);$("#ctm_ppn").val(ppn_temp);$("#ctm_all").val(all_temp);$("#cc_rp").text("Rp "+uang(total_temp));$("#cc_ppn").text("Rp "+uang(ppn_temp));$("#cc_total").text("Rp "+uang(all_temp));});var new_file_name;if(parseInt(with_upload_server)==1){$("#filer_upload").filer({limit:1,maxSize:12,extensions:Array('jpg','png','jpeg','psd','eps','tiff','ai','pdf','zip','rar'),changeInput:'<div class="jFiler-input-dragDrop"><div class="jFiler-input-inner"><a class="jFiler-input-choose-btn blue"><i class="productImg productImg-fileUpload"></i> Browse Your Artwork File</a></div></div>',showThumbs:true,theme:"dragdropbox",appendTo:$('#viewUploadFiler'),templates:{box:'<ul class="jFiler-items-list jFiler-items-grid"></ul>',item:'<li class="jFiler-item">\
                                <div class="jFiler-item-container">\
                                    <div class="jFiler-item-inner">\
                                        <div class="jFiler-item-thumb">\
                                            <div class="jFiler-item-status"></div>\
                                            <div class="jFiler-item-thumb-overlay">\
                                                <div class="jFiler-item-info">\
                                                    <div style="display:table-cell;vertical-align: middle;">\
                                                        <span class="jFiler-item-title"><b title="{{fi-name}}">{{fi-name}}</b></span>\
                                                        <span class="jFiler-item-others">{{fi-size2}}</span>\
                                                    </div>\
                                                </div>\
                                            </div>\
                                            {{fi-image}}\
                                        </div>\
                                        <div class="jFiler-item-assets jFiler-row">\
                                            <ul class="list-inline pull-left">\
                                                <li>{{fi-progressBar}}</li>\
                                            </ul>\
                                            <ul class="list-inline pull-right">\
                                                <li><a class="icon-jfi-trash jFiler-item-trash-action"></a></li>\
                                            </ul>\
                                        </div>\
                                    </div>\
                                </div>\
                            </li>',itemAppend:'',progressBar:'<div class="bar"></div>',itemAppendToEnd:false,canvasImage:true,removeConfirmation:true,_selectors:{list:'.jFiler-items-list',item:'.jFiler-item',progressBar:'.bar',remove:'.jFiler-item-trash-action'}},dragDrop:{dragEnter:null,dragLeave:null,drop:null,dragContainer:null,},uploadFile:{url:base_uri+"webservice/file_upload.php",data:null,type:'POST',enctype:'multipart/form-data',synchron:true,beforeSend:function(){},success:function(data,itemEl,listEl,boxEl,newInputEl,inputEl,id){var parent=itemEl.find(".jFiler-jProgressBar").parent();new_file_name=JSON.parse(data);$("#ctm_file").val(base_uri+"artwork/"+new_file_name);itemEl.find(".jFiler-jProgressBar").fadeOut("slow",function(){$("<div class=\"jFiler-item-others text-success\"><i class=\"icon-jfi-check-circle\"></i> Success</div>").hide().appendTo(parent).fadeIn("slow");var file_type=new_file_name.substr(new_file_name.lastIndexOf('.')).toLowerCase();if(file_type==='.pdf'){$("#pdfArtwork").css("display","block");$("#imgArtwork").css("display","none");renderPdf(base_uri+"artwork/"+new_file_name);}else{$("#pdfArtwork").css("display","none");$("#imgArtwork").css("display","block");$("#imgArtwork").attr("src",base_uri+"artwork/"+new_file_name);}
$("#confirmFinalize").css("display","block");});},error:function(el){var parent=el.find(".jFiler-jProgressBar").parent();el.find(".jFiler-jProgressBar").fadeOut("slow",function(){$("<div class=\"jFiler-item-others text-error\"><i class=\"icon-jfi-minus-circle\"></i> Error</div>").hide().appendTo(parent).fadeIn("slow");});},statusCode:null,onProgress:null,onComplete:function(data,itemEl,listEl,boxEl,newInputEl,inputEl,id){},},files:null,addMore:false,allowDuplicates:true,clipBoardPaste:true,excludeName:null,beforeRender:null,afterRender:function(listEl,parentEl,newInputEl,inputEl){$("#uniform-filer_upload").css("display","none");},beforeShow:null,beforeSelect:function(listEl,parentEl,newInputEl,inputEl){$("#viewUploadFiler").empty();$("#ctm_file").val('');$("#confirmFinalize").css("display","none");},onSelect:null,afterShow:function(listEl,parentEl,newInputEl,inputEl){$("#uniform-filer_upload").css("display","none");},onRemove:function(itemEl,file,id,listEl,boxEl,newInputEl,inputEl){var url_name=$("#ctm_file").val();var file_name=url_name.split('/').pop();$.post(base_uri+"webservice/file_remove.php",{file:file_name});$("#ctm_file").val('');$("#confirmFinalize").css("display","none");},onEmpty:null,options:null,dialogs:{alert:function(text){return alert(text);},confirm:function(text,callback){confirm(text)?callback():null;}},captions:{button:"Choose Files",feedback:"Choose files To Upload",feedback2:"files were chosen",drop:"Drop file here to Upload",removeConfirmation:"Are you sure you want to remove this file?",errors:{filesLimit:"Only {{fi-limit}} files are allowed to be uploaded, please delete your upload file first.",filesType:"Only file type (pdf, jpg, jpeg, png, psd, eps, tiff, ai) are allowed to be uploaded.",filesSize:"{{fi-name}} is too large! Please upload file up to {{fi-maxSize}} MB. Or Upload Using Google Drive and Pickup using Your Account",filesSizeMin:"{{fi-name}} is too small! Please upload file minimum {{fi-minSize}} MB.",filesSizeAll:"Files you've choosed are too large! Please upload files up to {{fi-maxSize}} MB."}}});function renderPdf(url){PDFJS.workerSrc=base_uri+'js/pdfjs/build/pdf.worker.js';var loadingTask=PDFJS.getDocument(url);loadingTask.promise.then(function(pdf){var pageNumber=1;pdf.getPage(pageNumber).then(function(page){var scale=1.5;var canvas=document.getElementById('pdfArtwork');var context=canvas.getContext('2d');var viewport=page.getViewport(canvas.width/page.getViewport(1.0).width);canvas.height=viewport.height;var renderContext={canvasContext:context,viewport:viewport};var renderTask=page.render(renderContext);renderTask.then(function(){});});},function(reason){});}}});function drivePicker(){if(parseInt(with_upload_cloud)==1){if($('#drivePick').length){var picker=new FilePicker({apiKey:'AIzaSyDvIoGBh5__lbNurYER1hQfHb8oZxC-4CQ',clientId:'480685116093-v945cnl4flfpp67o2l8t4ke1b08p47af',buttonEl:document.getElementById('drivePick'),onSelect:function(file){var url_name=$("#ctm_file").val();$("#confirmFinalize").css("display","none");if(url_name==''){$("#ctm_file").val(file.alternateLink);$("#viewUploadFiler").empty();$("#viewUploadFiler").append('<div class="jFiler-items jFiler-row"><ul class="jFiler-items-list jFiler-items-grid"><li class="jFiler-item" data-jfiler-index="0" style=""><div class="jFiler-item-container"><div class="jFiler-item-inner"><div class="jFiler-item-thumb"><div class="jFiler-item-status"></div> <div class="jFiler-item-thumb-image"><img src="'+file.thumbnailLink+'" draggable="false" style="height:220px;"></div></div><div class="jFiler-item-assets jFiler-row"><ul class="list-inline pull-left"><li><div class="jFiler-item-others text-success" style=""><i class="icon-jfi-check-circle"></i> Success</div></li></ul><ul class="list-inline pull-right"><li><a class="icon-jfi-trash jFiler-item-trash-action" id="delDrive"></a></li></ul></div></div></div></li></ul></div>');$("#pdfArtwork").css("display","none");$("#imgArtwork").attr("src",file.thumbnailLink);$("#confirmFinalize").css("display","block");}else{alert("Only 1 files are allowed to be uploaded, please delete your upload file first.");$("#confirmFinalize").css("display","none");}}});}}}
(function(){if(parseInt(with_upload_cloud)==1){var FilePicker=window.FilePicker=function(options){this.apiKey=options.apiKey;this.clientId=options.clientId;this.buttonEl=options.buttonEl;this.onSelect=options.onSelect;this.buttonEl.addEventListener('click',this.open.bind(this));this.buttonEl.disabled=true;gapi.client.setApiKey(this.apiKey);gapi.client.load('drive','v2',this._driveApiLoaded.bind(this));google.load('picker','1',{callback:this._pickerApiLoaded.bind(this)});}
FilePicker.prototype={open:function(){var token=gapi.auth.getToken();if(token){this._showPicker();}else{this._doAuth(false,function(){this._showPicker();}.bind(this));}},_showPicker:function(){var accessToken=gapi.auth.getToken().access_token;this.picker=new google.picker.PickerBuilder().addView(google.picker.ViewId.DOCS).setAppId(this.clientId).setOAuthToken(accessToken).setCallback(this._pickerCallback.bind(this)).build().setVisible(true);},_pickerCallback:function(data){if(data[google.picker.Response.ACTION]==google.picker.Action.PICKED){var file=data[google.picker.Response.DOCUMENTS][0],id=file[google.picker.Document.ID],request=gapi.client.drive.files.get({fileId:id});request.execute(this._fileGetCallback.bind(this));}},_fileGetCallback:function(file){if(this.onSelect){this.onSelect(file);}},_pickerApiLoaded:function(){this.buttonEl.disabled=false;},_driveApiLoaded:function(){this._doAuth(true);},_doAuth:function(immediate,callback){gapi.auth.authorize({client_id:this.clientId+'.apps.googleusercontent.com',scope:'https://www.googleapis.com/auth/drive.readonly',immediate:immediate},callback);}};}}());$(document).ready(function(){$('a[data-toggle="tab"]').on('show.bs.tab',function(e){var $target=$(e.target);if($target.parent().hasClass('disabled')){return false;}});$(".next-step").click(function(e){var $active=$('.wizard .nav-tabs li.active');$active.next().removeClass('disabled');nextTab($active);});$(".prev-step").click(function(e){var $active=$('.wizard .nav-tabs li.active');prevTab($active);});});function nextTab(elem){$(elem).next().find('a[data-toggle="tab"]').click();}
function prevTab(elem){$(elem).prev().find('a[data-toggle="tab"]').click();};;$(document).ready(function(){var txtbtn=(lang_iso=='en')?'Check Our Price Now':'Cek Harga Sekarang';var txtbtn2=(lang_iso=='en')?'Order Now':'Pesan Sekarang Juga';var lang=lang_iso;if(newview){if(startview){if(islogin){$('#gotoform').html('<form action="" method="post"><div class="row"><div class="col-md-6"> <button type="submit" name="endform" class="btn btn-lg btn-block btn-rfq" style="background-color:#10143c;">'+txtbtn+'</button> </div> <div class="col-md-6"><a class="btn btn-lg btn-block btn-rfq" target="_blank" href="https://wa.me/628118959011" style="background-color:#ef4e26;border-color: #ef4e26;">'+txtbtn2+'</a> </div></div></form>');}else{$('#gotoform').html('<div class="row"><div class="col-md-6"><a class="btn btn-lg btn-block btn-rfq "  style="background-color:#10143c;" href="https://printyuk.com/id/login">'+txtbtn+'</a> </div> <div class="col-md-6"> <a class="btn btn-lg btn-block btn-rfq" target="_blank" href="https://wa.me/628118959011" style="background-color:#ef4e26;border-color: #ef4e26;">'+txtbtn2+'</a> </div></div>');}
$('#lpnew6').html(`<div id="myCarousel2"class="carousel slide"data-ride="carousel"style="margin: 0px -50px;"><!--Wrapper for slides--><div class="carousel-inner"><div class="item active"><a target="_blank"><img class="img-responsive"width="100%"src="https://printyuk.com/img/testi/What Customer Say-Belimobilgue_IND.jpg"alt="What Customer Say-Belimobilgue"></a></div><div class="item"><a target="_blank"><img class="img-responsive"width="100%"src="https://printyuk.com/img/testi/What Customer Say-BRANKAS_IND.jpg"alt="What Customer Say-BRANKAS"></a></div><div class="item"><a target="_blank"><img class="img-responsive"width="100%"src="https://printyuk.com/img/testi/testi-3-`+lang+`.png"alt=""></a></div><div class="item"><a target="_blank"><img class="img-responsive"width="100%"src="https://printyuk.com/img/testi/testi-4-`+lang+`.png"alt=""></a></div><div class="item"><a target="_blank"><img class="img-responsive"width="100%"src="https://printyuk.com/img/testi/testi-5-`+lang+`.png"alt=""></a></div></div><!--Left and right controls--><a class="left carousel-control"href="#myCarousel2"data-slide="prev"><span class="glyphicon glyphicon-chevron-left"></span><span class="sr-only">Previous</span></a><a class="right carousel-control"href="#myCarousel2"data-slide="next"><span class="glyphicon glyphicon-chevron-right"></span><span class="sr-only">Next</span></a></div>`)}}
$(document).on('click touchstart','#cekprice',function(e){e.preventDefault();$("#formlead").css("display","block");});$(document).on('click touchstart','.remmodal',function(e){e.preventDefault();$("#formlead").css("display","none");});$('#formLeadInput').on('keyup keypress',function(e){var keyCode=e.keyCode||e.which;if(keyCode===13){e.preventDefault();return false;}});$('#thanksform').click(function(e){e.preventDefault();var textbtn=(lang_iso=='en')?'Please wait....':'Silahkan tunggu.....';$(this).html(textbtn);$(this).attr('disabled','true');$.ajax({type:'POST',url:baseUri+"webservice/json.php",data:$('#formLeadInput').serialize()+"&act=savenewlanding",success:function(data){alerinfo=JSON.parse(data);if(alerinfo.info=='error'){var textbtn=(lang_iso=='en')?'Register Now (Free!)':'Daftar Sekarang (Gratis !)';$('#thanksform').html(textbtn);$('#thanksform').removeAttr('disabled');alert(alerinfo.text);return false;}else{$('#idcsc').val(alerinfo.text);$('#formLeadInput').submit();}}});});});;$(document).ready(function(){$('ul.tree.dhtml').hide();if(!$('ul.tree.dhtml').hasClass('dynamized'))
{$('ul.tree.dhtml ul').prev().before("<span class='grower OPEN'> </span>");$('ul.tree.dhtml ul li:last-child, ul.tree.dhtml li:last-child').addClass('last');$('ul.tree.dhtml span.grower.OPEN').addClass('CLOSE').removeClass('OPEN').parent().find('ul:first').hide();$('ul.tree.dhtml').show();$('ul.tree.dhtml .selected').parents().each(function(){if($(this).is('ul'))
toggleBranch($(this).prev().prev(),true);});toggleBranch($('ul.tree.dhtml .selected').prev(),true);$('ul.tree.dhtml span.grower').click(function(){toggleBranch($(this));});$('ul.tree.dhtml').addClass('dynamized');$('ul.tree.dhtml').removeClass('dhtml');}});function openBranch(jQueryElement,noAnimation)
{jQueryElement.addClass('OPEN').removeClass('CLOSE');if(noAnimation)
jQueryElement.parent().find('ul:first').show();else
jQueryElement.parent().find('ul:first').slideDown();}
function closeBranch(jQueryElement,noAnimation)
{jQueryElement.addClass('CLOSE').removeClass('OPEN');if(noAnimation)
jQueryElement.parent().find('ul:first').hide();else
jQueryElement.parent().find('ul:first').slideUp();}
function toggleBranch(jQueryElement,noAnimation)
{if(jQueryElement.hasClass('OPEN'))
closeBranch(jQueryElement,noAnimation);else
openBranch(jQueryElement,noAnimation);};;$(document).ready(function(){$("#newsletter-input").on({focus:function(){$(this).val()!=placeholder_blocknewsletter&&$(this).val()!=msg_newsl||$(this).val("")},blur:function(){""==$(this).val()&&$(this).val(placeholder_blocknewsletter)}});var a="alert alert-danger";"undefined"==typeof nw_error||nw_error||(a="alert alert-success"),"undefined"!=typeof msg_newsl&&msg_newsl&&($("#columns").prepend('<div class="clearfix"></div><p class="'+a+'"> '+alert_blocknewsletter+"</p>"),$("html, body").animate({scrollTop:$("#columns").offset().top},"slow"))});;(function($){$.fn.extend({autocomplete:function(urlOrData,options){var isUrl=typeof urlOrData=="string";options=$.extend({},$.Autocompleter.defaults,{url:isUrl?urlOrData:null,data:isUrl?null:urlOrData,delay:isUrl?$.Autocompleter.defaults.delay:10,max:options&&!options.scroll?10:150},options);options.highlight=options.highlight||function(value){return value;};options.formatMatch=options.formatMatch||options.formatItem;return this.each(function(){new $.Autocompleter(this,options);});},result:function(handler){return this.bind("result",handler);},search:function(handler){return this.trigger("search",[handler]);},flushCache:function(){return this.trigger("flushCache");},setOptions:function(options){return this.trigger("setOptions",[options]);},unautocomplete:function(){return this.trigger("unautocomplete");}});$.Autocompleter=function(input,options){var KEY={UP:38,DOWN:40,DEL:46,TAB:9,RETURN:13,ESC:27,COMMA:188,PAGEUP:33,PAGEDOWN:34,BACKSPACE:8};var $input=$(input).attr("autocomplete","off").addClass(options.inputClass);var timeout;var previousValue="";var cache=$.Autocompleter.Cache(options);var hasFocus=0;var lastKeyPressCode;var config={mouseDownOnSelect:false};var select=$.Autocompleter.Select(options,input,selectCurrent,config);var blockSubmit;$.browser.opera&&$(input.form).bind("submit.autocomplete",function(){if(blockSubmit){blockSubmit=false;return false;}});$input.bind(($.browser.opera?"keypress":"keydown")+".autocomplete",function(event){lastKeyPressCode=event.keyCode;switch(event.keyCode){case KEY.UP:event.preventDefault();if(select.visible()){select.prev();}else{onChange(0,true);}
break;case KEY.DOWN:event.preventDefault();if(select.visible()){select.next();}else{onChange(0,true);}
break;case KEY.PAGEUP:event.preventDefault();if(select.visible()){select.pageUp();}else{onChange(0,true);}
break;case KEY.PAGEDOWN:event.preventDefault();if(select.visible()){select.pageDown();}else{onChange(0,true);}
break;case options.multiple&&$.trim(options.multipleSeparator)==","&&KEY.COMMA:case KEY.TAB:case KEY.RETURN:if(selectCurrent()){event.preventDefault();blockSubmit=true;return false;}
break;case KEY.ESC:select.hide();break;default:clearTimeout(timeout);timeout=setTimeout(onChange,options.delay);break;}}).focus(function(){hasFocus++;}).blur(function(){hasFocus=0;if(!config.mouseDownOnSelect){hideResults();}}).click(function(){if(hasFocus++>1&&!select.visible()){onChange(0,true);}}).bind("search",function(){var fn=(arguments.length>1)?arguments[1]:null;function findValueCallback(q,data){var result;if(data&&data.length){for(var i=0;i<data.length;i++){if(data[i].result.toLowerCase()==q.toLowerCase()){result=data[i];break;}}}
if(typeof fn=="function")fn(result);else $input.trigger("result",result&&[result.data,result.value]);}
$.each(trimWords($input.val()),function(i,value){request(value,findValueCallback,findValueCallback);});}).bind("flushCache",function(){cache.flush();}).bind("setOptions",function(){$.extend(options,arguments[1]);if("data"in arguments[1])
cache.populate();}).bind("unautocomplete",function(){select.unbind();$input.unbind();$(input.form).unbind(".autocomplete");});function selectCurrent(){var selected=select.selected();if(!selected)
return false;var v=selected.result;previousValue=v;if(options.multiple){var words=trimWords($input.val());if(words.length>1){v=words.slice(0,words.length-1).join(options.multipleSeparator)+options.multipleSeparator+v;}
v+=options.multipleSeparator;}
$input.val(v);hideResultsNow();$input.trigger("result",[selected.data,selected.value]);return true;}
function onChange(crap,skipPrevCheck){if(lastKeyPressCode==KEY.DEL){select.hide();return;}
var currentValue=$input.val();if(!skipPrevCheck&&currentValue==previousValue)
return;previousValue=currentValue;currentValue=lastWord(currentValue);if(currentValue.length>=options.minChars){$input.addClass(options.loadingClass);if(!options.matchCase)
currentValue=currentValue.toLowerCase();request(currentValue,receiveData,hideResultsNow);}else{stopLoading();select.hide();}};function trimWords(value){if(!value){return[""];}
var words=value.split(options.multipleSeparator);var result=[];$.each(words,function(i,value){if($.trim(value))
result[i]=$.trim(value);});return result;}
function lastWord(value){if(!options.multiple)
return value;var words=trimWords(value);return words[words.length-1];}
function autoFill(q,sValue){if(options.autoFill&&(lastWord($input.val()).toLowerCase()==q.toLowerCase())&&lastKeyPressCode!=KEY.BACKSPACE){$input.val($input.val()+sValue.substring(lastWord(previousValue).length));$.Autocompleter.Selection(input,previousValue.length,previousValue.length+sValue.length);}};function hideResults(){clearTimeout(timeout);timeout=setTimeout(hideResultsNow,200);};function hideResultsNow(){var wasVisible=select.visible();select.hide();clearTimeout(timeout);stopLoading();if(options.mustMatch){$input.search(function(result){if(!result){if(options.multiple){var words=trimWords($input.val()).slice(0,-1);$input.val(words.join(options.multipleSeparator)+(words.length?options.multipleSeparator:""));}
else
$input.val("");}});}
if(wasVisible)
$.Autocompleter.Selection(input,input.value.length,input.value.length);};function receiveData(q,data){if(data&&data.length&&hasFocus){stopLoading();select.display(data,q);autoFill(q,data[0].value);select.show();}else{hideResultsNow();}};function request(term,success,failure){if(!options.matchCase)
term=term.toLowerCase();var data=cache.load(term);if(data&&data.length){success(term,data);}else if((typeof options.url=="string")&&(options.url.length>0)){var extraParams={timestamp:+new Date()};$.each(options.extraParams,function(key,param){extraParams[key]=typeof param=="function"?param():param;});$.ajax({mode:"abort",port:"autocomplete"+input.name,dataType:options.dataType,url:options.url,data:$.extend({q:lastWord(term),limit:options.max},extraParams),success:function(data){var parsed=options.parse&&options.parse(data)||parse(data);cache.add(term,parsed);success(term,parsed);}});}else{select.emptyList();failure(term);}};function parse(data){var parsed=[];var rows=data.split("\n");for(var i=0;i<rows.length;i++){var row=$.trim(rows[i]);if(row){row=row.split("|");parsed[parsed.length]={data:row,value:row[0],result:options.formatResult&&options.formatResult(row,row[0])||row[0]};}}
return parsed;};function stopLoading(){$input.removeClass(options.loadingClass);};};$.Autocompleter.defaults={inputClass:"ac_input",resultsClass:"ac_results",loadingClass:"ac_loading",minChars:1,delay:400,matchCase:false,matchSubset:true,matchContains:false,cacheLength:10,max:100,mustMatch:false,extraParams:{},selectFirst:true,formatItem:function(row){return row[0];},formatMatch:null,autoFill:false,width:0,multiple:false,multipleSeparator:", ",highlight:function(value,term){return value.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+term.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1")+")(?![^<>]*>)(?![^&;]+;)","gi"),"<strong>$1</strong>");},scroll:true,scrollHeight:180};$.Autocompleter.Cache=function(options){var data={};var length=0;function matchSubset(s,sub){if(!options.matchCase)
s=s.toLowerCase();var i=s.indexOf(sub);if(i==-1)return false;return i==0||options.matchContains;};function add(q,value){if(length>options.cacheLength){flush();}
if(!data[q]){length++;}
data[q]=value;}
function populate(){if(!options.data)return false;var stMatchSets={},nullData=0;if(!options.url)options.cacheLength=1;stMatchSets[""]=[];for(var i=0,ol=options.data.length;i<ol;i++){var rawValue=options.data[i];rawValue=(typeof rawValue=="string")?[rawValue]:rawValue;var value=options.formatMatch(rawValue,i+1,options.data.length);if(value===false)
continue;var firstChar=value.charAt(0).toLowerCase();if(!stMatchSets[firstChar])
stMatchSets[firstChar]=[];var row={value:value,data:rawValue,result:options.formatResult&&options.formatResult(rawValue)||value};stMatchSets[firstChar].push(row);if(nullData++<options.max){stMatchSets[""].push(row);}};$.each(stMatchSets,function(i,value){options.cacheLength++;add(i,value);});}
setTimeout(populate,25);function flush(){data={};length=0;}
return{flush:flush,add:add,populate:populate,load:function(q){if(!options.cacheLength||!length)
return null;if(!options.url&&options.matchContains){var csub=[];for(var k in data){if(k.length>0){var c=data[k];$.each(c,function(i,x){if(matchSubset(x.value,q)){csub.push(x);}});}}
return csub;}else
if(data[q]){return data[q];}else
if(options.matchSubset){for(var i=q.length-1;i>=options.minChars;i--){var c=data[q.substr(0,i)];if(c){var csub=[];$.each(c,function(i,x){if(matchSubset(x.value,q)){csub[csub.length]=x;}});return csub;}}}
return null;}};};$.Autocompleter.Select=function(options,input,select,config){var CLASSES={ACTIVE:"ac_over"};var listItems,active=-1,data,term="",needsInit=true,element,list;function init(){if(!needsInit)
return;element=$("<div/>").hide().addClass(options.resultsClass).css("position","absolute").appendTo(document.body);list=$("<ul/>").appendTo(element).mouseover(function(event){if(target(event).nodeName&&target(event).nodeName.toUpperCase()=='LI'){active=$("li",list).removeClass(CLASSES.ACTIVE).index(target(event));$(target(event)).addClass(CLASSES.ACTIVE);}}).click(function(event){$(target(event)).addClass(CLASSES.ACTIVE);select();input.focus();return false;}).mousedown(function(){config.mouseDownOnSelect=true;}).mouseup(function(){config.mouseDownOnSelect=false;});if(options.width>0)
element.css("width",options.width);needsInit=false;}
function target(event){var element=event.target;while(element&&element.tagName!="LI")
element=element.parentNode;if(!element)
return[];return element;}
function moveSelect(step){listItems.slice(active,active+1).removeClass(CLASSES.ACTIVE);movePosition(step);var activeItem=listItems.slice(active,active+1).addClass(CLASSES.ACTIVE);if(options.scroll){var offset=0;listItems.slice(0,active).each(function(){offset+=this.offsetHeight;});if((offset+activeItem[0].offsetHeight-list.scrollTop())>list[0].clientHeight){list.scrollTop(offset+activeItem[0].offsetHeight-list.innerHeight());}else if(offset<list.scrollTop()){list.scrollTop(offset);}}};function movePosition(step){active+=step;if(active<0){active=listItems.size()-1;}else if(active>=listItems.size()){active=0;}}
function limitNumberOfItems(available){return options.max&&options.max<available?options.max:available;}
function fillList(){list.empty();var max=limitNumberOfItems(data.length);for(var i=0;i<max;i++){if(!data[i])
continue;var formatted=options.formatItem(data[i].data,i+1,max,data[i].value,term);if(formatted===false)
continue;var li=$("<li/>").html(options.highlight(formatted,term)).addClass(i%2==0?"ac_even":"ac_odd").appendTo(list)[0];$.data(li,"ac_data",data[i]);}
listItems=list.find("li");if(options.selectFirst){listItems.slice(0,1).addClass(CLASSES.ACTIVE);active=0;}
if($.fn.bgiframe)
list.bgiframe();}
return{display:function(d,q){init();data=d;term=q;fillList();},next:function(){moveSelect(1);},prev:function(){moveSelect(-1);},pageUp:function(){if(active!=0&&active-8<0){moveSelect(-active);}else{moveSelect(-8);}},pageDown:function(){if(active!=listItems.size()-1&&active+8>listItems.size()){moveSelect(listItems.size()-1-active);}else{moveSelect(8);}},hide:function(){element&&element.hide();listItems&&listItems.removeClass(CLASSES.ACTIVE);active=-1;},visible:function(){return element&&element.is(":visible");},current:function(){return this.visible()&&(listItems.filter("."+CLASSES.ACTIVE)[0]||options.selectFirst&&listItems[0]);},show:function(){var offset=$(input).offset();element.css({width:typeof options.width=="string"||options.width>0?options.width:($(input).width()+parseInt($(input).css('padding-left'))+parseInt($(input).css('padding-right'))+parseInt($(input).css('margin-left'))+parseInt($(input).css('margin-right'))),top:offset.top+input.offsetHeight,left:offset.left}).show();if(options.scroll){list.css({maxHeight:options.scrollHeight,overflow:'auto'});if($.browser.msie&&typeof document.body.style.maxHeight==="undefined"){var listHeight=0;listItems.each(function(){listHeight+=this.offsetHeight;});var scrollbarsVisible=listHeight>options.scrollHeight;list.css('height',scrollbarsVisible?options.scrollHeight:listHeight);if(!scrollbarsVisible){listItems.width(list.width()-parseInt(listItems.css("padding-left"))-parseInt(listItems.css("padding-right")));}}}},selected:function(){var selected=listItems&&listItems.filter("."+CLASSES.ACTIVE).removeClass(CLASSES.ACTIVE);return selected&&selected.length&&$.data(selected[0],"ac_data");},emptyList:function(){list&&list.empty();},unbind:function(){element&&element.remove();}};};$.Autocompleter.Selection=function(field,start,end){if(field.createTextRange){var selRange=field.createTextRange();selRange.collapse(true);selRange.moveStart("character",start);selRange.moveEnd("character",end);selRange.select();}else if(field.setSelectionRange){field.setSelectionRange(start,end);}else{if(field.selectionStart){field.selectionStart=start;field.selectionEnd=end;}}
field.focus();};})(jQuery);;var instantSearchQueries=[];$(document).ready(function()
{if(typeof blocksearch_type=='undefined')
return;var $input=$("#search_query_"+blocksearch_type);var width_ac_results=$input.parent('form').outerWidth();if(typeof ajaxsearch!='undefined'&&ajaxsearch){$input.autocomplete(search_url,{minChars:3,max:10,width:(width_ac_results>0?width_ac_results:500),selectFirst:false,scroll:false,dataType:"json",formatItem:function(data,i,max,value,term){return value;},parse:function(data){var mytab=[];for(var i=0;i<data.length;i++)
mytab[mytab.length]={data:data[i],value:data[i].cname+' > '+data[i].pname};return mytab;},extraParams:{ajaxSearch:1,id_lang:id_lang}}).result(function(event,data,formatted){$input.val(data.pname);document.location.href=data.product_link;});}
if(typeof instantsearch!='undefined'&&instantsearch){$input.on('keyup',function(){if($(this).val().length>4)
{stopInstantSearchQueries();instantSearchQuery=$.ajax({url:search_url+'?rand='+new Date().getTime(),data:{instantSearch:1,id_lang:id_lang,q:$(this).val()},dataType:'html',type:'POST',headers:{"cache-control":"no-cache"},async:true,cache:false,success:function(data){if($input.val().length>0){tryToCloseInstantSearch();$('#center_column').attr('id','old_center_column');$('#old_center_column').after('<div id="center_column" class="'+$('#old_center_column').attr('class')+'">'+data+'</div>').hide();ajaxCart.overrideButtonsInThePage();$("#instant_search_results a.close").on('click',function(){$input.val('');return tryToCloseInstantSearch();});return false;}
else
tryToCloseInstantSearch();}});instantSearchQueries.push(instantSearchQuery);}
else
tryToCloseInstantSearch();});}});function tryToCloseInstantSearch()
{var $oldCenterColumn=$('#old_center_column');if($oldCenterColumn.length>0)
{$('#center_column').remove();$oldCenterColumn.attr('id','center_column').show();return false;}}
function stopInstantSearchQueries()
{for(var i=0;i<instantSearchQueries.length;i++)
instantSearchQueries[i].abort();instantSearchQueries=[];};;$(document).ready(function(){if(!!$.prototype.fancybox)
$('#send_friend_button').fancybox({'hideOnContentClick':false});$('#send_friend_form_content .closefb').click(function(e){$.fancybox.close();e.preventDefault();});$('#sendEmail').click(function(){var name=$('#friend_name').val();var email=$('#friend_email').val();if(name&&email&&!isNaN(id_product))
{$.ajax({url:baseDir+'modules/sendtoafriend/sendtoafriend_ajax.php?rand='+new Date().getTime(),type:"POST",headers:{"cache-control":"no-cache"},data:{action:'sendToMyFriend',secure_key:stf_secure_key,name:name,email:email,id_product:id_product},dataType:"json",success:function(result){$.fancybox.close();fancyMsgBox((result?stf_msg_success:stf_msg_error),stf_msg_title);}});}
else
$('#send_friend_form_error').text(stf_msg_required);});});;/*!
 * jQuery Cookie Plugin v1.4.1
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2006, 2014 Klaus Hartl
 * Released under the MIT license
 */
(function(factory){if(typeof define==='function'&&define.amd){define(['jquery'],factory);}else if(typeof exports==='object'){factory(require('jquery'));}else{factory(jQuery);}}(function($){var pluses=/\+/g;function encode(s){return config.raw?s:encodeURIComponent(s);}
function decode(s){return config.raw?s:decodeURIComponent(s);}
function stringifyCookieValue(value){return encode(config.json?JSON.stringify(value):String(value));}
function parseCookieValue(s){if(s.indexOf('"')===0){s=s.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,'\\');}
try{s=decodeURIComponent(s.replace(pluses,' '));return config.json?JSON.parse(s):s;}catch(e){}}
function read(s,converter){var value=config.raw?s:parseCookieValue(s);return $.isFunction(converter)?converter(value):value;}
var config=$.cookie=function(key,value,options){if(arguments.length>1&&!$.isFunction(value)){options=$.extend({},config.defaults,options);if(typeof options.expires==='number'){var days=options.expires,t=options.expires=new Date();t.setTime(+t+days*864e+5);}
return(document.cookie=[encode(key),'=',stringifyCookieValue(value),options.expires?'; expires='+options.expires.toUTCString():'',options.path?'; path='+options.path:'',options.domain?'; domain='+options.domain:'',options.secure?'; secure':''].join(''));}
var result=key?undefined:{};var cookies=document.cookie?document.cookie.split('; '):[];for(var i=0,l=cookies.length;i<l;i++){var parts=cookies[i].split('=');var name=decode(parts.shift());var cookie=parts.join('=');if(key&&key===name){result=read(cookie,value);break;}
if(!key&&(cookie=read(cookie))!==undefined){result[name]=cookie;}}
return result;};config.defaults={};$.removeCookie=function(key,options){if($.cookie(key)===undefined){return false;}
$.cookie(key,'',$.extend({},options,{expires:-1}));return!$.cookie(key);};}));/*-------------------------------

	POPUP.JS

	Simple Popup plugin for jQuery

	@author Todd Francis
	@version 2.2.0

-------------------------------*/

(function(b,t){b.fn.popup=function(h){var p=this.selector,l=new b.Popup(h),m=h&&h.content?h.content:b(this).attr("href");b(document).on("click.popup",p,function(b){b.preventDefault();l.open(m,void 0,this)});return this.each(function(){b(this).data("popup",l)})};b.Popup=function(h){function p(a){var d;b.each(a,function(a,c){if(c)return d=c,!1});return d}function l(a){return"function"===typeof a?"function":a instanceof b?"jQuery":"#"===a.substr(0,1)||"."===a.substr(0,1)?"inline":-1!==b.inArray(a.substr(a.length-
3),u)?"image":"http"===a.substr(0,4)?"external":"ajax"}function m(c){r&&r.fadeOut("fast",function(){b(this).remove()});var d=!0;void 0===f&&(d=!1,f=b('<div class="'+a.o.containerClass+'">'),n=b(a.o.markup).appendTo(f),b(a.o.closeContent).one("click",function(){a.close()}).appendTo(f),b(t).resize(a.center),f.appendTo(b("body")).css("opacity",0));var e=b("."+a.o.contentClass,f);a.width?e.css("width",a.width,10):e.css("width","");a.height?e.css("height",a.height,10):e.css("height","");n.hasClass(a.o.contentClass)?
n.html(c):n.find("."+a.o.contentClass).html(c);d?a.o.replaced.call(a,f,g):a.o.show.call(a,f,g)}function q(a,d){var b=(new RegExp("[?&]"+a+"=([^&]*)")).exec(d);return b&&decodeURIComponent(b[1].replace(/\+/g," "))}var a=this,u=["png","jpg","gif"],k,s,g,f,r,n;a.ele=void 0;a.o=b.extend(!0,{},{backClass:"popup_back",backOpacity:.7,containerClass:"popup_cont",closeContent:'<div class="popup_close"><span>&times;</span></div>',markup:'<div class="popup"><div class="popup_content"/></div>',contentClass:"popup_content",
preloaderContent:'<p class="preloader">Loading</p>',activeClass:"popup_active",hideFlash:!1,speed:200,popupPlaceholderClass:"popup_placeholder",keepInlineChanges:!0,modal:!1,content:null,type:"auto",width:null,height:null,typeParam:"pt",widthParam:"pw",heightParam:"ph",beforeOpen:function(a){},afterOpen:function(){},beforeClose:function(){},afterClose:function(){},error:function(){},show:function(a,b){var e=this;e.center();a.animate({opacity:1},e.o.speed,function(){e.o.afterOpen.call(e)})},replaced:function(a,
b){this.center().o.afterOpen.call(this)},hide:function(a,b){void 0!==a&&a.animate({opacity:0},this.o.speed)},types:{inline:function(c,d){var e=b(c);e.addClass(a.o.popupPlaceholderClass);a.o.keepInlineChanges||(s=e.html());d.call(this,e.children())},image:function(c,d){var e=this;b("<img />").one("load",function(){var a=this;setTimeout(function(){d.call(e,a)},0)}).one("error",function(){a.o.error.call(a,c,"image")}).attr("src",c).each(function(){this.complete&&b(this).trigger("load")})},external:function(c,
d){var e=b("<iframe />").attr({src:c,frameborder:0,width:a.width,height:a.height});d.call(this,e)},html:function(a,b){b.call(this,a)},jQuery:function(a,b){b.call(this,a.html())},"function":function(b,d){d.call(this,b.call(a))},ajax:function(c,d){b.ajax({url:c,success:function(a){d.call(this,a)},error:function(b){a.o.error.call(a,c,"ajax")}})}}},h);a.open=function(c,d,e){c=void 0===c||"#"===c?a.o.content:c;if(null===c)return a.o.error.call(a,c,k),!1;void 0!==e&&(a.ele&&a.o.activeClass&&b(a.ele).removeClass(a.o.activeClass),
a.ele=e,a.ele&&a.o.activeClass&&b(a.ele).addClass(a.o.activeClass));if(void 0===g){g=b('<div class="'+a.o.backClass+'"/>').appendTo(b("body")).css("opacity",0).animate({opacity:a.o.backOpacity},a.o.speed);if(!a.o.modal)g.one("click.popup",function(){});a.o.hideFlash&&b("object, embed").css("visibility","hidden");a.o.preloaderContent&&(r=b(a.o.preloaderContent).appendTo(b("body")))}d=p([d,a.o.type]);k=d="auto"===d?l(c):d;a.width=a.o.width?a.o.width:null;a.height=a.o.height?a.o.height:null;
if(-1===b.inArray(d,["inline","jQuery","function"])){e=q(a.o.typeParam,c);var f=q(a.o.widthParam,c),h=q(a.o.heightParam,c);d=null!==e?e:d;a.width=null!==f?f:a.width;a.height=null!==h?h:a.height}a.o.beforeOpen.call(a,d);a.o.types[d]?a.o.types[d].call(a,c,m):a.o.types.ajax.call(a,c,m)};a.close=function(){a.o.beforeClose.call(a);"inline"===k&&a.o.keepInlineChanges&&(s=b("."+a.o.contentClass).html());void 0!==g&&g.animate({opacity:0},a.o.speed,function(){a.cleanUp()});a.o.hide.call(a,f,g);return a};a.cleanUp=
function(){g.add(f).remove();f=g=void 0;b(t).unbind("resize",a.center);a.o.hideFlash&&b("object, embed").css("visibility","visible");a.ele&&a.o.activeClass&&b(a.ele).removeClass(a.o.activeClass);var c=b("."+a.o.popupPlaceholderClass);"inline"==k&&c.length&&c.html(s).removeClass(a.o.popupPlaceholderClass);k=null;a.o.afterClose.call(a);return a};a.center=function(){f.css(a.getCenter());g.css({height:document.documentElement.clientHeight});return a};a.getCenter=function(){var a=f.children().outerWidth(!0),
b=f.children().outerHeight(!0);return{top:.5*document.documentElement.clientHeight-.5*b,left:.5*document.documentElement.clientWidth-.5*a}}}})(jQuery,window);
/*
 ### jQuery Star Rating Plugin v2.0 - 2008-03-12 ###
 By Diego A, http://www.fyneworks.com, diego@fyneworks.com
 - v2 by Keith Wood, kbwood@virginbroadband.com.au
 
 Project: http://plugins.jquery.com/project/MultipleFriendlyStarRating
 Website: http://www.fyneworks.com/jquery/star-rating/
	
	This is a modified version of the star rating plugin from:
 http://www.phpletter.com/Demo/Jquery-Star-Rating-Plugin/
*/
eval(function(p,a,c,k,e,r){e=function(c){return(c<a?'':e(parseInt(c/a)))+((c=c%a)>35?String.fromCharCode(c+29):c.toString(36))};if(!''.replace(/^/,String)){while(c--)r[e(c)]=k[c]||e(c);k=[function(e){return r[e]}];e=function(){return'\\w+'};c=1};while(c--)if(k[c])p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c]);return p}(';4(w)(3($){$.Y.T=3(c){c=$.15({m:\'X U\',E:\'\',B:z,8:z},c||{});o d={};o e={t:3(n,a,b){2.6(n);$(a).D(\'.j\').A().l(b||\'x\')},6:3(n){$(d[n].7).O(\'.j\').u(\'9\').u(\'x\')},h:3(n){4(!$(d[n].5).Z(\'.m\')){$(d[n].5).D(\'.j\').A().l(\'9\')}},g:3(n,a){d[n].5=a;o b=$(a).L(\'a\').K();$(d[n].7).J(b);e.6(n);e.h(n);4(c.I)c.I.W(d[n].7,[b,a])}};2.V(3(i){o n=2.G;4(!d[n])d[n]={r:0};i=d[n].r;d[n].r++;4(i==0){c.8=$(2).S(\'p\')||c.8;d[n].7=$(\'<R Q="P" G="\'+n+\'" q=""\'+(c.8?\' p="p"\':\'\')+\'>\');$(2).C(d[n].7);4(c.8||c.B){}F{$(2).C($(\'<k y="m"><a s="\'+c.m+\'">\'+c.E+\'</a></k>\').H(3(){e.6(n);$(2).l(\'9\')}).v(3(){e.h(n);$(2).u(\'9\')}).g(3(){e.g(n,2)}))}};f=$(\'<k y="j"><a s="\'+(2.s||2.q)+\'">\'+2.q+\'</a></k>\');$(2).N(f);4(c.8){$(f).l(\'M\')}F{$(f).H(3(){e.6(n);e.t(n,2)}).v(3(){e.6(n);e.h(n)}).g(3(){e.g(n,2)})};4(2.14)d[n].5=f;$(2).13();4(i+1==2.12)e.h(n)});11(n 10 d)4(d[n].5){e.t(n,d[n].5,\'9\');$(d[n].7).J($(d[n].5).L(\'a\').K())}16 2}})(w);',62,69,'||this|function|if|currentElem|drain|valueElem|readOnly|star_on||||||eStar|click|reset||star|div|addClass|cancel||var|disabled|value|count|title|fill|removeClass|mouseout|jQuery|star_hover|class|false|andSelf|required|before|prevAll|cancelValue|else|name|mouseover|callback|val|text|children|star_readonly|after|siblings|hidden|type|input|attr|rating|Rating|each|apply|Cancel|fn|is|in|for|length|remove|checked|extend|return'.split('|'),0,{}));;(function($){$.fn.textareaCount=function(options,fn){var defaults={maxCharacterSize:-1,originalStyle:'originalTextareaInfo',warningStyle:'warningTextareaInfo',warningNumber:20,displayFormat:'#input characters | #words words'};var options=$.extend(defaults,options);var container=$(this);$("<div class='charleft'>&nbsp;</div>").insertAfter(container);var charLeftCss={'width':container.width()};var charLeftInfo=getNextCharLeftInformation(container);charLeftInfo.addClass(options.originalStyle);charLeftInfo.css(charLeftCss);var numInput=0;var maxCharacters=options.maxCharacterSize;var numLeft=0;var numWords=0;container.bind('keyup',function(event){limitTextAreaByCharacterCount();}).bind('mouseover',function(event){setTimeout(function(){limitTextAreaByCharacterCount();},10);}).bind('paste',function(event){setTimeout(function(){limitTextAreaByCharacterCount();},10);});function limitTextAreaByCharacterCount(){charLeftInfo.html(countByCharacters());if(typeof fn!='undefined'){fn.call(this,getInfo());}
return true;}
function countByCharacters(){var content=container.val();var contentLength=content.length;if(options.maxCharacterSize>0){if(contentLength>=options.maxCharacterSize){content=content.substring(0,options.maxCharacterSize);}
var newlineCount=getNewlineCount(content);var systemmaxCharacterSize=options.maxCharacterSize-newlineCount;if(!isWin()){systemmaxCharacterSize=options.maxCharacterSize}
if(contentLength>systemmaxCharacterSize){var originalScrollTopPosition=this.scrollTop;container.val(content.substring(0,systemmaxCharacterSize));this.scrollTop=originalScrollTopPosition;}
charLeftInfo.removeClass(options.warningStyle);if(systemmaxCharacterSize-contentLength<=options.warningNumber){charLeftInfo.addClass(options.warningStyle);}
numInput=container.val().length+newlineCount;if(!isWin()){numInput=container.val().length;}
numWords=countWord(getCleanedWordString(container.val()));numLeft=maxCharacters-numInput;}else{var newlineCount=getNewlineCount(content);numInput=container.val().length+newlineCount;if(!isWin()){numInput=container.val().length;}
numWords=countWord(getCleanedWordString(container.val()));}
return formatDisplayInfo();}
function formatDisplayInfo(){var format=options.displayFormat;format=format.replace('#input',numInput);format=format.replace('#words',numWords);if(maxCharacters>0){format=format.replace('#max',maxCharacters);format=format.replace('#left',numLeft);}
return format;}
function getInfo(){var info={input:numInput,max:maxCharacters,left:numLeft,words:numWords};return info;}
function getNextCharLeftInformation(container){return container.next('.charleft');}
function isWin(){var strOS=navigator.appVersion;if(strOS.toLowerCase().indexOf('win')!=-1){return true;}
return false;}
function getNewlineCount(content){var newlineCount=0;for(var i=0;i<content.length;i++){if(content.charAt(i)=='\n'){newlineCount++;}}
return newlineCount;}
function getCleanedWordString(content){var fullStr=content+" ";var initial_whitespace_rExp=/^[^A-Za-z0-9]+/gi;var left_trimmedStr=fullStr.replace(initial_whitespace_rExp,"");var non_alphanumerics_rExp=rExp=/[^A-Za-z0-9]+/gi;var cleanedStr=left_trimmedStr.replace(non_alphanumerics_rExp," ");var splitString=cleanedStr.split(" ");return splitString;}
function countWord(cleanedWordString){var word_count=cleanedWordString.length-1;return word_count;}};})(jQuery);;$(document).ready(function(){$('input.star').rating();$('.auto-submit-star').rating();if(!!$.prototype.fancybox)
$('.open-comment-form').fancybox({'autoSize':false,'width':600,'height':'auto','hideOnContentClick':false});$(document).on('click','#id_new_comment_form .closefb',function(e){e.preventDefault();$.fancybox.close();});$(document).on('click','a[href=#idTab5]',function(e){$('*[id^="idTab"]').addClass('block_hidden_only_for_screen');$('div#idTab5').removeClass('block_hidden_only_for_screen');$('ul#more_info_tabs a[href^="#idTab"]').removeClass('selected');$('a[href="#idTab5"]').addClass('selected');});$(document).on('click','button.usefulness_btn',function(e){var id_product_comment=$(this).data('id-product-comment');var is_usefull=$(this).data('is-usefull');var parent=$(this).parent();$.ajax({url:productcomments_controller_url+'?rand='+new Date().getTime(),data:{id_product_comment:id_product_comment,action:'comment_is_usefull',value:is_usefull},type:'POST',headers:{"cache-control":"no-cache"},success:function(result){parent.fadeOut('slow',function(){parent.remove();});}});});$(document).on('click','span.report_btn',function(e){if(confirm(confirm_report_message))
{var idProductComment=$(this).data('id-product-comment');var parent=$(this).parent();$.ajax({url:productcomments_controller_url+'?rand='+new Date().getTime(),data:{id_product_comment:idProductComment,action:'report_abuse'},type:'POST',headers:{"cache-control":"no-cache"},success:function(result){parent.fadeOut('slow',function(){parent.remove();});}});}});$(document).on('click','#submitNewMessage',function(e){e.preventDefault();url_options='?';if(!productcomments_url_rewrite)
url_options='&';$.ajax({url:productcomments_controller_url+url_options+'action=add_comment&secure_key='+secure_key+'&rand='+new Date().getTime(),data:$('#id_new_comment_form').serialize(),type:'POST',headers:{"cache-control":"no-cache"},dataType:"json",success:function(data){if(data.result)
{$.fancybox.close();var buttons={};buttons[productcomment_ok]="productcommentRefreshPage";fancyChooseBox(moderation_active?productcomment_added_moderation:productcomment_added,productcomment_title,buttons);}
else
{$('#new_comment_form_error ul').html('');$.each(data.errors,function(index,value){$('#new_comment_form_error ul').append('<li>'+value+'</li>');});$('#new_comment_form_error').slideDown('slow');}}});});});function productcommentRefreshPage()
{window.location.reload();};